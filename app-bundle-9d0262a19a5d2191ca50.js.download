!function(e){function t(t){for(var i,r,s=t[0],c=t[1],u=t[2],d=t[3]||[],p=0,f=[];p<s.length;p++)r=s[p],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&f.push(o[r][0]),o[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);for(h&&h(t),l.push.apply(l,d);f.length;)f.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,r=1;r<n.length;r++)0!==o[n[r]]&&(i=!1);i&&(a.splice(t--,1),e=c(c.s=n[0]))}return 0===a.length&&(l.forEach((function(e){if(void 0===o[e]){o[e]=null;var t=document.createElement("link");t.crossOrigin="anonymous",c.nc&&t.setAttribute("nonce",c.nc),t.rel="prefetch",t.as="script",t.href=s(e),document.head.appendChild(t)}})),l.length=0),e}var i={},r={60:0},o={60:0},a=[],l=[];function s(e){return c.p+""+({5:"officehome-async-styles",8:"vendors~action-context-menu-rc~app-host-component~cc~confirmation-dialog-rc~create-spaces-dialog-rc~~a6379b48",9:"vendors~action-context-menu-rc~app-host-component~cc~confirmation-dialog-rc~create-spaces-dialog-rc~~6d8c23f6",10:"vendors~app-host-component~cc~confirmation-dialog-rc~create-spaces-dialog-rc~error-dialog-rc~ew-rc~f~94ce955f",14:"vendors~create-spaces-dialog-component~create-spaces-dialog-rc~ew-rc~mc~mfs-storage-provider~qa~show~59f3cbc5",15:"vendors~cc~ew-rc~fc~flerrordialog~fpm~leap~mc~qa~rec1-rc~staying-aware~staying-aware-rq",16:"vendors~cc~ew-rc~fc~fpm~left-nav-rc~mc~qa~rec1-rc~space-cnt",17:"vendors~create-spaces-dialog-component~create-spaces-dialog-rc~fc~fl-cnt~fpm~showcreatespacesdialog~~3914b619",19:"vendors~app-host-component~fc~fl-cnt~fpm~mc~sideload-m365apps-dialog-control~space-cnt~spaces",20:"vendors~create-spaces-dialog-component~create-spaces-dialog-rc~ew-rc~mc~mfs-storage-provider~qa~show~0d1fb54a",21:"vendors~create-spaces-dialog-component~create-spaces-dialog-rc~fc~fpm~showcreatespacesdialog~space-cnt~spaces",23:"calendar~forms-group~mru~officeforms-group-forms~officeforms-my-forms~places",24:"vendors~create-spaces-dialog-component~create-spaces-dialog-rc~ew-rc~qa~showcreatespacesdialog~space~3e32d003",25:"vendors~app-host-component~fc~fl-cnt~fpm~sideload-m365apps-dialog-control",26:"auto-suggest~bc~search-preload~search-results",27:"vendors~auto-suggest~bc~search-preload~search-results",28:"vendors~cc~rec1-rc~staying-aware~staying-aware-rq",29:"vendors~m365-apps~officeflonedssink~oteljs1ds~task-dialog-rc",30:"vendors~staying-aware~staying-aware-badge~staying-aware-data-service~staying-aware-rq",31:"create-menu~templates~wac-start",32:"vendors~action-context-menu-rc~cc~rec1-rc",33:"vendors~cc~create-onenote-page-dialog-rc~rec1-rc",34:"vendors~cc~fc~fpm",35:"vendors~cc~staying-aware~staying-aware-rq",36:"vendors~create-spaces-dialog-component~create-spaces-dialog-rc~showcreatespacesdialog",37:"vendors~deferredcomponents~deferredoperations~itemsview",38:"vendors~edgeworth~input-dialog~wac-start",39:"vendors~fc~fl-cnt~fpm",40:"vendors~fc~flerrordialog~fpm",41:"vendors~fc~fpm~menu-view-service",42:"vendors~fl-cnt~m365-apps~task-dialog-rc",43:"vendors~m365-apps~officeflonedssink~task-dialog-rc",45:"fl-cnt~share-control",46:"templates~wac-start",47:"vendors~deferredcomponents~itemsview",48:"vendors~fc~fpm",49:"vendors~flerrordialog~leap",50:"vendors~itemsview~itemsview-deferredactions",51:"vendors~m365-apps~task-dialog-rc",52:"vendors~space-cnt~spaces",53:"vendors~staying-aware-badge~staying-aware-data-service",54:"vendors~staying-aware~staying-aware-data-service",55:"vendors~staying-aware~staying-aware-rq",56:"wac-cnt",59:"action-context-menu-rc",61:"app-gallery",62:"appbar",63:"auto-suggest",64:"axios-interceptors",65:"banner",66:"bc",67:"calendar",68:"catchupactivityflyout",69:"catchupactivitystrings0",70:"catchupactivitystrings1",71:"catchupactivitystrings10",72:"catchupactivitystrings11",73:"catchupactivitystrings12",74:"catchupactivitystrings13",75:"catchupactivitystrings14",76:"catchupactivitystrings15",77:"catchupactivitystrings16",78:"catchupactivitystrings17",79:"catchupactivitystrings18",80:"catchupactivitystrings19",81:"catchupactivitystrings2",82:"catchupactivitystrings20",83:"catchupactivitystrings21",84:"catchupactivitystrings22",85:"catchupactivitystrings23",86:"catchupactivitystrings24",87:"catchupactivitystrings25",88:"catchupactivitystrings26",89:"catchupactivitystrings27",90:"catchupactivitystrings28",91:"catchupactivitystrings29",92:"catchupactivitystrings3",93:"catchupactivitystrings30",94:"catchupactivitystrings31",95:"catchupactivitystrings32",96:"catchupactivitystrings33",97:"catchupactivitystrings34",98:"catchupactivitystrings35",99:"catchupactivitystrings36",100:"catchupactivitystrings37",101:"catchupactivitystrings38",102:"catchupactivitystrings39",103:"catchupactivitystrings4",104:"catchupactivitystrings40",105:"catchupactivitystrings41",106:"catchupactivitystrings42",107:"catchupactivitystrings43",108:"catchupactivitystrings44",109:"catchupactivitystrings45",110:"catchupactivitystrings46",111:"catchupactivitystrings47",112:"catchupactivitystrings48",113:"catchupactivitystrings49",114:"catchupactivitystrings5",115:"catchupactivitystrings50",116:"catchupactivitystrings51",117:"catchupactivitystrings52",118:"catchupactivitystrings53",119:"catchupactivitystrings54",120:"catchupactivitystrings55",121:"catchupactivitystrings56",122:"catchupactivitystrings57",123:"catchupactivitystrings58",124:"catchupactivitystrings59",125:"catchupactivitystrings6",126:"catchupactivitystrings60",127:"catchupactivitystrings61",128:"catchupactivitystrings62",129:"catchupactivitystrings63",130:"catchupactivitystrings64",131:"catchupactivitystrings65",132:"catchupactivitystrings66",133:"catchupactivitystrings67",134:"catchupactivitystrings68",135:"catchupactivitystrings69",136:"catchupactivitystrings7",137:"catchupactivitystrings70",138:"catchupactivitystrings71",139:"catchupactivitystrings72",140:"catchupactivitystrings73",141:"catchupactivitystrings74",142:"catchupactivitystrings75",143:"catchupactivitystrings76",144:"catchupactivitystrings77",145:"catchupactivitystrings78",146:"catchupactivitystrings79",147:"catchupactivitystrings8",148:"catchupactivitystrings80",149:"catchupactivitystrings81",150:"catchupactivitystrings82",151:"catchupactivitystrings83",152:"catchupactivitystrings84",153:"catchupactivitystrings85",154:"catchupactivitystrings9",155:"cc",156:"confirmation-dialog-component",157:"confirmation-dialog-rc",158:"context-menu",159:"create-folder-dialog",160:"create-folder-wizard",161:"create-links-control-icns",162:"create-menu",163:"create-onenote-page-dialog-rc",164:"create-spaces-dialog-component",165:"create-spaces-dialog-rc",166:"deferredoperations",167:"document-creator",168:"edgeworth",169:"edgeworth-trie-webworker",170:"edgeworth-worker",171:"error-dialog",172:"error-dialog-rc",173:"ew-rc",174:"fb-theme",175:"fc",176:"feature-callout",177:"feature-tooltip-container",178:"feedback",179:"first-run",180:"fl-cnt",181:"fl-unsupported-page",182:"flcontainerstrings0",183:"flcontainerstrings1",184:"flcontainerstrings10",185:"flcontainerstrings11",186:"flcontainerstrings12",187:"flcontainerstrings13",188:"flcontainerstrings14",189:"flcontainerstrings15",190:"flcontainerstrings16",191:"flcontainerstrings17",192:"flcontainerstrings18",193:"flcontainerstrings19",194:"flcontainerstrings2",195:"flcontainerstrings20",196:"flcontainerstrings21",197:"flcontainerstrings22",198:"flcontainerstrings23",199:"flcontainerstrings24",200:"flcontainerstrings25",201:"flcontainerstrings26",202:"flcontainerstrings27",203:"flcontainerstrings28",204:"flcontainerstrings29",205:"flcontainerstrings3",206:"flcontainerstrings30",207:"flcontainerstrings31",208:"flcontainerstrings32",209:"flcontainerstrings33",210:"flcontainerstrings34",211:"flcontainerstrings35",212:"flcontainerstrings36",213:"flcontainerstrings37",214:"flcontainerstrings38",215:"flcontainerstrings39",216:"flcontainerstrings4",217:"flcontainerstrings40",218:"flcontainerstrings41",219:"flcontainerstrings42",220:"flcontainerstrings43",221:"flcontainerstrings44",222:"flcontainerstrings45",223:"flcontainerstrings46",224:"flcontainerstrings47",225:"flcontainerstrings48",226:"flcontainerstrings49",227:"flcontainerstrings5",228:"flcontainerstrings50",229:"flcontainerstrings51",230:"flcontainerstrings52",231:"flcontainerstrings53",232:"flcontainerstrings54",233:"flcontainerstrings55",234:"flcontainerstrings56",235:"flcontainerstrings57",236:"flcontainerstrings58",237:"flcontainerstrings59",238:"flcontainerstrings6",239:"flcontainerstrings60",240:"flcontainerstrings61",241:"flcontainerstrings62",242:"flcontainerstrings63",243:"flcontainerstrings64",244:"flcontainerstrings65",245:"flcontainerstrings66",246:"flcontainerstrings67",247:"flcontainerstrings68",248:"flcontainerstrings69",249:"flcontainerstrings7",250:"flcontainerstrings70",251:"flcontainerstrings71",252:"flcontainerstrings72",253:"flcontainerstrings73",254:"flcontainerstrings74",255:"flcontainerstrings75",256:"flcontainerstrings76",257:"flcontainerstrings77",258:"flcontainerstrings78",259:"flcontainerstrings79",260:"flcontainerstrings8",261:"flcontainerstrings80",262:"flcontainerstrings81",263:"flcontainerstrings82",264:"flcontainerstrings83",265:"flcontainerstrings84",266:"flcontainerstrings85",267:"flcontainerstrings9",268:"flframework-hashfallback",269:"fluent-theme-provider",270:"forms-group",271:"fpm",272:"home",273:"hostuxstrings0",274:"hostuxstrings1",275:"hostuxstrings10",276:"hostuxstrings11",277:"hostuxstrings12",278:"hostuxstrings13",279:"hostuxstrings14",280:"hostuxstrings15",281:"hostuxstrings16",282:"hostuxstrings17",283:"hostuxstrings18",284:"hostuxstrings19",285:"hostuxstrings2",286:"hostuxstrings20",287:"hostuxstrings21",288:"hostuxstrings22",289:"hostuxstrings23",290:"hostuxstrings24",291:"hostuxstrings25",292:"hostuxstrings26",293:"hostuxstrings27",294:"hostuxstrings28",295:"hostuxstrings29",296:"hostuxstrings3",297:"hostuxstrings30",298:"hostuxstrings31",299:"hostuxstrings32",300:"hostuxstrings33",301:"hostuxstrings34",302:"hostuxstrings35",303:"hostuxstrings36",304:"hostuxstrings37",305:"hostuxstrings38",306:"hostuxstrings39",307:"hostuxstrings4",308:"hostuxstrings40",309:"hostuxstrings41",310:"hostuxstrings42",311:"hostuxstrings43",312:"hostuxstrings44",313:"hostuxstrings45",314:"hostuxstrings46",315:"hostuxstrings47",316:"hostuxstrings48",317:"hostuxstrings49",318:"hostuxstrings5",319:"hostuxstrings50",320:"hostuxstrings51",321:"hostuxstrings52",322:"hostuxstrings53",323:"hostuxstrings54",324:"hostuxstrings55",325:"hostuxstrings56",326:"hostuxstrings57",327:"hostuxstrings58",328:"hostuxstrings59",329:"hostuxstrings6",330:"hostuxstrings60",331:"hostuxstrings61",332:"hostuxstrings62",333:"hostuxstrings63",334:"hostuxstrings64",335:"hostuxstrings65",336:"hostuxstrings66",337:"hostuxstrings67",338:"hostuxstrings68",339:"hostuxstrings69",340:"hostuxstrings7",341:"hostuxstrings70",342:"hostuxstrings71",343:"hostuxstrings72",344:"hostuxstrings73",345:"hostuxstrings74",346:"hostuxstrings75",347:"hostuxstrings76",348:"hostuxstrings77",349:"hostuxstrings78",350:"hostuxstrings79",351:"hostuxstrings8",352:"hostuxstrings80",353:"hostuxstrings81",354:"hostuxstrings82",355:"hostuxstrings83",356:"hostuxstrings84",357:"hostuxstrings85",358:"hostuxstrings9",359:"hwalaunchfile",360:"hwalaunchurl",361:"informationprotectionstrings0",362:"informationprotectionstrings1",363:"informationprotectionstrings10",364:"informationprotectionstrings11",365:"informationprotectionstrings12",366:"informationprotectionstrings13",367:"informationprotectionstrings14",368:"informationprotectionstrings15",369:"informationprotectionstrings16",370:"informationprotectionstrings17",371:"informationprotectionstrings18",372:"informationprotectionstrings19",373:"informationprotectionstrings2",374:"informationprotectionstrings20",375:"informationprotectionstrings21",376:"informationprotectionstrings22",377:"informationprotectionstrings23",378:"informationprotectionstrings24",379:"informationprotectionstrings25",380:"informationprotectionstrings26",381:"informationprotectionstrings27",382:"informationprotectionstrings28",383:"informationprotectionstrings29",384:"informationprotectionstrings3",385:"informationprotectionstrings30",386:"informationprotectionstrings31",387:"informationprotectionstrings32",388:"informationprotectionstrings33",389:"informationprotectionstrings34",390:"informationprotectionstrings35",391:"informationprotectionstrings36",392:"informationprotectionstrings37",393:"informationprotectionstrings38",394:"informationprotectionstrings39",395:"informationprotectionstrings4",396:"informationprotectionstrings40",397:"informationprotectionstrings41",398:"informationprotectionstrings42",399:"informationprotectionstrings43",400:"informationprotectionstrings44",401:"informationprotectionstrings45",402:"informationprotectionstrings46",403:"informationprotectionstrings47",404:"informationprotectionstrings48",405:"informationprotectionstrings49",406:"informationprotectionstrings5",407:"informationprotectionstrings50",408:"informationprotectionstrings51",409:"informationprotectionstrings52",410:"informationprotectionstrings53",411:"informationprotectionstrings54",412:"informationprotectionstrings55",413:"informationprotectionstrings56",414:"informationprotectionstrings57",415:"informationprotectionstrings58",416:"informationprotectionstrings59",417:"informationprotectionstrings6",418:"informationprotectionstrings60",419:"informationprotectionstrings61",420:"informationprotectionstrings62",421:"informationprotectionstrings63",422:"informationprotectionstrings64",423:"informationprotectionstrings65",424:"informationprotectionstrings66",425:"informationprotectionstrings67",426:"informationprotectionstrings68",427:"informationprotectionstrings69",428:"informationprotectionstrings7",429:"informationprotectionstrings70",430:"informationprotectionstrings71",431:"informationprotectionstrings72",432:"informationprotectionstrings73",433:"informationprotectionstrings74",434:"informationprotectionstrings75",435:"informationprotectionstrings76",436:"informationprotectionstrings77",437:"informationprotectionstrings78",438:"informationprotectionstrings79",439:"informationprotectionstrings8",440:"informationprotectionstrings80",441:"informationprotectionstrings81",442:"informationprotectionstrings82",443:"informationprotectionstrings83",444:"informationprotectionstrings84",445:"informationprotectionstrings85",446:"informationprotectionstrings9",447:"initialize-fluent-theme",448:"input-dialog",449:"install",450:"install-wizard",451:"instrumentation-service",452:"itemsview-deferredoperations",453:"leap",454:"left-nav-rc",455:"m365-apps",456:"mc",457:"mfs-storage-provider",458:"midgard-bootstrapper",459:"mobile-app-banner",460:"move-to-folder-control",461:"mru",462:"new-user-shelf",463:"odsp-start-onedrive",464:"odsp-start-sharepoint",465:"office-theme",466:"officeflonedssink",467:"officeforms-group-forms",468:"officeforms-my-forms",469:"places",471:"previewlabelcallout",472:"pull-to-refresh",473:"qa",474:"rec1-rc",475:"renderdiscovermenu",476:"search-page-strings",477:"search-preload",478:"search-results",479:"share-control",480:"sharecallout",481:"sharedialog",482:"showcreatespacesdialog",483:"side-popup-menu",484:"space-cnt",485:"spaces",486:"spaces-storage-service",487:"spaces-tinylicious-client",488:"staying-aware",489:"staying-aware-badge",490:"staying-aware-data-service",491:"staying-aware-rq",492:"support-central-rc",493:"task-dialog-rc",494:"templates",495:"text-encoder-lite",496:"toast-container-rc",497:"upload-button",498:"upload-dialog",500:"vendors~app-host-component",501:"vendors~appbar",502:"vendors~catchupactivityflyout",503:"vendors~cc",504:"vendors~confirmation-dialog-rc",505:"vendors~create-onenote-page-dialog-rc",506:"vendors~create-spaces-dialog-rc",507:"vendors~data-prefetch-service",508:"vendors~deferredcomponents",509:"vendors~edgeworth",510:"vendors~error-dialog-rc",511:"vendors~fl-cnt",512:"vendors~flerrordialog",513:"vendors~fpm",514:"vendors~itemsview",515:"vendors~itemsview-deferredactions",516:"vendors~left-nav-rc",517:"vendors~menu-view-service",518:"vendors~oteljs",519:"vendors~oteljs1ds",520:"vendors~renderdiscovermenu",521:"vendors~search-preload",522:"vendors~search-results",523:"vendors~searchux-logger",524:"vendors~searchux-main",525:"vendors~sideload-m365apps-dialog-control",526:"vendors~space-cnt",527:"vendors~spaces",528:"vendors~spaces-tinylicious-client",529:"vendors~staying-aware-rq",530:"vendors~support-central-rc",531:"vendors~vroom-service",532:"wac-start",533:"web-vitals",534:"workspace-nav"}[e]||e)+"."+{0:"8a5e7be01f49e0ddb829",1:"647c466d17c92724bf65",2:"7495361d6ac502fc7ae4",3:"5b3d942e845c193b5e3c",4:"29ff5bb84257e60c9aba",5:"6da89e66e059c93eb40c",6:"ae1cc34f82114fba3ccf",7:"b75e9ed6e52db04d85ad",8:"3262a07c8338656ae2e5",9:"412791cd9beb986656fd",10:"5136d663ff305a24022d",11:"864a44556f77e532f862",12:"1563bc8e361697e6c64c",13:"d6f5c2b1e906402e6e31",14:"1b00bd310a0fe715b959",15:"9a3c25bcbe52cf233b0b",16:"f92882931709db44944f",17:"19f15e699c96fe99b343",18:"29ec97d66d7c7cd727e0",19:"9803eae337b54d75724a",20:"d740c77dce17debda4a7",21:"fadcdd4760b0bd9f21e0",22:"833b981f5765de999caa",23:"0a64a27a6a62927cb6d2",24:"5b1c4929d434a9108096",25:"c77171b335b65f79db9d",26:"d62d2a790d0973954c34",27:"99b0cec035680ea4588a",28:"0e711ee806195bad7c6e",29:"15dc41206c224b9f4210",30:"4b7beca295bda70b9436",31:"9d916a24fd765b99568d",32:"9419253a9adec539dc49",33:"6b374317e7467e3e5ef5",34:"1ede136a9edcc3742fa2",35:"e4912e7604c2499efaf3",36:"d770c12bbd44d22cf4b6",37:"1c8a0384903b580692ac",38:"23f9072ffea8957ba818",39:"54e613573d11bfe2af48",40:"000803c19bf8c16a1003",41:"d41057a6fde70f4f2272",42:"cad5c2e983d83b4806ae",43:"56780144e9754bdda4dc",44:"10914bd23394de9a09ec",45:"27175efd5251f3265a4b",46:"cbe0519c09a94e3cfd9e",47:"7b772480a9eb9044342d",48:"175a5643292d7a19a82f",49:"bef1577623974764fac7",50:"78b6a00553078965aa28",51:"f16a434407b9390286aa",52:"9c050884961b6239ef0c",53:"07a4b30fdb212301044f",54:"5a5be8ecb7d4d075b59f",55:"3a78914fdfef0d9c8581",56:"e87ee1018adc18f14285",57:"9c3cc1b86d97ec93944e",58:"04358dfa37c281bfc705",59:"178469f068c682cd3918",61:"4d0d6eee7899a848c1d7",62:"01ae29ca5d433d821308",63:"21bea2a9976d39cb33c6",64:"4fcc2815cfc32ee33e70",65:"5ab2175fcb38c9eec80a",66:"7664f83c58af50a87610",67:"095b568a194b5e082d13",68:"4967386c8950ef31e472",69:"34867a8064a856fc16cb",70:"694b92b54a85729ff962",71:"4ed03e1747f8382ac27c",72:"e27e626908515de21595",73:"92da578a453e1b0afedd",74:"d0c4b3899a78b855306c",75:"5f8a39bf1e640e506bba",76:"ebc24ed217b141fcd99d",77:"cbfda752ff5baff3e4bb",78:"c329939cc05a482197ad",79:"390f04bce811c2c1be88",80:"a327cbafa887c529c741",81:"a7d3f48ba1a16b974a95",82:"aaa7e44d231521149472",83:"8a9ebeb472e99dbf2ad3",84:"9bba7513699c712f679f",85:"18368b27aea57e00dcec",86:"7e59b6aa772e0ed1816e",87:"aa8832c06bbfd941e427",88:"b97e415a32ab523eff6d",89:"e97779abbf2e6d9c9168",90:"3bbcb51ad1636eabe1c8",91:"375b4c86a4055a6af648",92:"497405f0ad752891e41f",93:"ac400cd2d6e642227789",94:"34a5aea514e59ec6dee2",95:"222bd05e35c6cb09a078",96:"68406f0857fd57a17582",97:"f3d186938196a5e95649",98:"9dc8baeb1d79e1ccd540",99:"f561e2a146331ab7d57b",100:"17da060a63de7fa4dd84",101:"c316d72164570119fecb",102:"5cf24087da51cc9f2841",103:"c5d7f60e570f49d69c0b",104:"aed6c1980fa5b279e1d9",105:"2feef793685288364fa0",106:"9dfbf2992494064d3dd0",107:"72a12638a697b33f03cd",108:"edef3df306ad78cb559e",109:"61df6de04ab8fd09f133",110:"e5f7bcf1b0698d97f11a",111:"e7c851fdc7fafc2eebc2",112:"052a5d12fd490a0785e3",113:"bb3d4f4d391eea0e8fe0",114:"72dff4f9e72979ecde81",115:"dd32ce96f92b1f32130b",116:"77050d99f9c23dc6d69d",117:"8322619a7c6a895647a7",118:"cca661aeb9e9a9079375",119:"0753a934c9bf528ea571",120:"ab7d99429e6044ea91c0",121:"a1f12680977853f7b756",122:"793fd2cf0f718dde10e2",123:"8147b1e522b60427217e",124:"a600e0df49d335352f34",125:"d5d0afeacb228c84429a",126:"a93bcfab2cca56ae42ae",127:"488768bc79b32b9fa2ca",128:"96e5c4735e71136543ef",129:"9e25a6beced486f70a57",130:"912655481fc13e25d733",131:"85d6bfe69d4164f0270d",132:"9d949eb5aa36e94ae8eb",133:"62befeaba76d9022a1e1",134:"f680ab9e9eb0878d0bce",135:"93570124d47e7f93e015",136:"fbdf8fdb1540b4a400ab",137:"2b7a97b7d0e738c37fac",138:"d14ee6b6ec88a86801fc",139:"35b2c6d76ddff9ba62d1",140:"668d43fc8c708c1bd7e6",141:"1345619f91aca13b77ea",142:"f6abeff584fc3d2dc2d0",143:"4112046f25190fb24ea4",144:"b2cb0d9ea01246f207bb",145:"7f69b5b3314344efc312",146:"63bd0fdca7e07184a6b3",147:"062e47b7c0aa1b0ba524",148:"66b0cb2078c55b3085b9",149:"f5560cb98d4b83190f05",150:"1dabe08c95a3e14e7e18",151:"f4be2126a6f13b98d40e",152:"9630b46da34666733778",153:"1b13f729d6bba6a1ec53",154:"8f6437ee43bfe0ad9bd5",155:"18a5dc4a913b04072588",156:"faa800e1162c0bd4d89f",157:"669ab6a7ec1eae26104c",158:"2b5a34484589f3a83c9b",159:"ac82d490e068be314493",160:"35e6595b8c60e6180fd2",161:"21e007a34af8704f8bde",162:"4666db3c6739e3237e58",163:"78c985339aa9e5a52e90",164:"7a869e34c4f272fefd6e",165:"2579e53fa0cd6a66ee52",166:"5d14e4f2dd492c21ac46",167:"71d2dbf7e7a4d8e1bb98",168:"c7e9b8bc1ae46137f376",169:"1deb2d999ff87d84745a",170:"008d6ebe219dceb30347",171:"3a2f1b6c8796c492c60f",172:"016a6a31a39b33ea9e0a",173:"1c11726000e4640ba2cc",174:"3bfe642486d5570523a6",175:"fb6018987c6ae1b2d699",176:"5ca8fd4cea676bf5c505",177:"05abb70c3a1650cf78ba",178:"7b4f46c883a51abb8345",179:"5429ffbb5815ecddd424",180:"58aaea084c05d4568728",181:"a5791ea33bc995a6af6d",182:"1062434080aa7de559e7",183:"05d7453894b7049d59f2",184:"467afca884f607299d60",185:"e410fe5afc427f4b2e4d",186:"da153f5280ce801168ab",187:"d2e8946d2f1527fd6963",188:"c4878b391a20ad3766b7",189:"a4d3435bc5190b323f74",190:"f29964ffdee61b3240bf",191:"52f8d9031962f781b83f",192:"1f46238a436b0a849fcd",193:"01b2f20f5385e08fbba3",194:"d1944c2e1a4ad6a72ec9",195:"00d4201dbfe2d42e598d",196:"65e245df6297a133c27c",197:"430ea7929fce983dea5c",198:"78ca7e3b2293676ff1a6",199:"542ad1a3f37501447f9d",200:"c75880c066a5ffb1e2c8",201:"cfb2269f90a84fe6cca8",202:"185c69b2a692dfa29205",203:"5574dff41c8dba1c2d49",204:"24b46eb2040c1c8ac1f7",205:"dfe61598acace02dd547",206:"6c728215492c6458a881",207:"d33d52c6db6feb0e3b4e",208:"2caaf5f8b33d34ad7327",209:"ea2aa47b886c8c88e2bb",210:"25dd07c9e910dfc1592d",211:"7e660721c72083e47e22",212:"55ae3f5a5c6cdacf9d88",213:"4ea8434c4780fa4fde6a",214:"92eb71c708ac1ddb91b7",215:"cd7307a155b25aacc942",216:"97c682ce9aad2265aa5b",217:"933052be3d561449d037",218:"cdb7263733df3a108ebc",219:"6bc59f754e74e2af5aeb",220:"0b8e20d14b783ea449f2",221:"9f217dd891a3c6216968",222:"a5203de72282248c1ed0",223:"7de9adc5ce05779cfff1",224:"06941a0a02548a19d45c",225:"b5bad1160ff2b40ab2dd",226:"d9bf7761df3a2ab4da97",227:"e9dd3fa51f4f049438f2",228:"6038b17e500ca9e8531b",229:"6018c65cda0470eddb67",230:"b362ca51cbfccc06e3be",231:"31ef82b8ae8f3dbf28ba",232:"07a2c2fa53d7b04ae791",233:"86cfe3b168a550d23446",234:"95006870f0405daaf28e",235:"03343d4b11ba1a41ef94",236:"25185fc24f6e4bcf73ef",237:"98efef541c4c66f7e9b8",238:"00c25baac71a3702e195",239:"de8bc5e8c26f4a1eb3fe",240:"a95c7ff0cf2c64c0f2c1",241:"46f8af8043164634c792",242:"927ace28b145818e3d05",243:"2920c2535a4834ff3388",244:"1d7b5ea39a4605970997",245:"29da18a20c6e5fc625ea",246:"ce98555c44800e312590",247:"017362b9d537843b652a",248:"56a8f1909883d0c236b7",249:"7324a862045927d7e11a",250:"897fcc2b11cb69f8b6ae",251:"7e1fcb0ab63f139587e1",252:"ffa7ff33e11371820d52",253:"736b231fa987306fe2bb",254:"649ae2dbbf390d111ffe",255:"d032ef26c90a227d46eb",256:"e5da52a4a877f9538b44",257:"6466c5bf6893f0776291",258:"0d71ba81e2dee4542bd8",259:"4677ac1a0d3437486c86",260:"332df0e5776bf5b6c70a",261:"2efd848987a5d01bf451",262:"e1919a99d28ec0389051",263:"ee1914ce81bda95a4ba0",264:"e31d0726876738f5a245",265:"3773dbb5bb2a8b71d620",266:"3006bf0d60b65ed28057",267:"27e73c67592916358359",268:"858da479655368f6e519",269:"64414f062ad03e4146d8",270:"09f36df81e92f82b9eba",271:"9079cd428ded83cfafe1",272:"1ad8db19d000cf1aeb4a",273:"1213f7897c21d53845ec",274:"9df4aeeaa52d963ebe7e",275:"5086a4a5ca6dea1fa7f4",276:"76b5e6f27bdd67e07a38",277:"3740b05fc520d973ced1",278:"902f9e8358dd80e28f04",279:"aa0cbb311cb8d9bc874c",280:"a0b19cd630555c5205a8",281:"bfdb3106ef03959fe9f2",282:"dfac73c888e11cb8573a",283:"60fb8937af43f7a99c90",284:"dedfa7fa5a3dddfcc388",285:"20fc977de3e9097c45e0",286:"63eef4f17c2e782836c3",287:"ee9906c0f79c00cd43eb",288:"ecedcc938b6f5444aac7",289:"ca54aefc3628a4cc24e1",290:"0ed1dd50404481edb4d1",291:"6cc16a1fcdc5a36a6fe9",292:"4b186d59a17e949b1255",293:"40d6d5da66f6a4ef4bd3",294:"34c4853b5d66fe08049a",295:"8ff3ab042258fe12cdef",296:"3b46edbe6d024d5a9dff",297:"11cf4e2ca3bcf13fcd65",298:"dc4f82ad99675c1b4b6c",299:"0a76253a96956ba395c8",300:"576235dd95cef5707e7a",301:"9783cdb41befc61eb2ab",302:"59510d00709850e913fd",303:"541016b0c6b834ee51e7",304:"a750e8ccf160ec5fcd9e",305:"768ebe1298e457281b7a",306:"c5ad4e95c79769c9dc91",307:"4029c1efc0af60468e51",308:"319f7eee35e58cefedb0",309:"6e5c310e4dc8cf98363c",310:"e2093d6b21e81d8f7ea0",311:"7455712ecfe44f9f8033",312:"a7197ab0e828ae27b6a3",313:"2f15f5a7b19880ab74d0",314:"6f3135240f1f302e320a",315:"a616e8d15afa7d325afb",316:"c4d567703d446bdebaa2",317:"77bf05a0ccc04460d7d0",318:"18f309e47c4ef7220c44",319:"b84d9913d6bfec023cfa",320:"631fb44665f827d67215",321:"54d646b90161797b18b4",322:"d784aa2cdea329f67055",323:"1a5cd96c091e9b25e163",324:"5cd35514e7552170573b",325:"aa4ce236ecf11a44b7ae",326:"e7685a9f2f142d1d3a01",327:"ed71532121cc9dcfcd00",328:"556c4a4aee69d1422b7b",329:"1a642e64cf85a58d41a7",330:"0715c3827784198d7499",331:"5dd407620b3e4b9d782b",332:"e3436eec6dce9d36362b",333:"399c90f459692054efd5",334:"5ddfeab32e98ad015d01",335:"739f3540031043cc0189",336:"89cd915611c527736690",337:"5160a924775f0a208153",338:"65f3d2c90e252c2a1b6c",339:"feda07b78db90ade238f",340:"f0abc5a775657d5bc4af",341:"fb86f65ceaa1f994f7ca",342:"a2ae8ab8b54bf2cbdbc3",343:"49850a0b6d03244fe123",344:"cf226095ed7b11dae101",345:"7f8b8d65fcfb55e426f4",346:"091fa0692ca81cf27ae5",347:"4d1e083467df6072b69a",348:"392850cfb3ec8e588987",349:"eeba4ab003e4ca789a3b",350:"7aee0e570af450836c2c",351:"dc6517d67f8c1d0dd200",352:"108e92c4f50a82321cf7",353:"f139fded9a49859b809e",354:"8d6e62f6bb4cb139f7d8",355:"84f49f8619990bd80528",356:"f39d261c4b1f4ad5aeb7",357:"1f66f69e1af6987c8bd2",358:"c4d2f4be8e6f7023eae9",359:"97784d255f805f3155df",360:"f4934ec2c2c5a26c7414",361:"9ac8b0cdafa03d1e70b7",362:"108f54e4d96e7968f5a7",363:"667f61a05b854bf9166d",364:"95469dfb3fea7e9270b7",365:"8e11edec13d77eff982a",366:"8d15381692b3246a4881",367:"32f398c35a9a5ae99590",368:"4ab8eea3c4a2cdd08a3f",369:"bab7c011633079cbd636",370:"6262f601aa9d0a8917bf",371:"7965d9c3af5bbf33d9d0",372:"b00b3e26860482340392",373:"8d93ebbf4cc972b234de",374:"553bd429237c99e14328",375:"c6f87771fbb5f6d3256a",376:"761ed7bbba4fd8a942d1",377:"1f96dd09202e806dcf4a",378:"fb4fe8ac7ab2443918a6",379:"af565a30a91a86ec93af",380:"7ad9b058d4154d744c8f",381:"d2752360539d286df584",382:"31fcdbd02e98492301c4",383:"bab91647dd0f7e91abd0",384:"dced5aa558008cf27d68",385:"49f3bd639a8b08f33dcc",386:"cd1cefa14a895a352c96",387:"fab8e870bde58f2e1c9b",388:"b1fbf2710ae88d96ecc1",389:"433b8114fb8098033344",390:"813ee67a84895c3fccf8",391:"4e9af9da4550e18045a8",392:"ddc8e21f6891ed69ce8f",393:"be5a1d66d8f348bdbe84",394:"fd28d146def0f0725941",395:"19fd37acd83ffd33088b",396:"38f0fcc3ba3cc27ab610",397:"471cb46bc8c4d39e9ed4",398:"39bcfe0b999c2c11ad33",399:"7e31388d889faeb22221",400:"757312673c4be03cb424",401:"93eab50c522a8dcd25b0",402:"41f913750c388c762cc0",403:"b460b5e47196c23b603b",404:"e1df5a711f0bd7f3b8af",405:"040c779f14856e163788",406:"4715d0c1460bb5cc8d4d",407:"34043c8ab3360143de82",408:"9240dc36122a31f13040",409:"cc5bbfaf87b1123ab03e",410:"e5b352df799a4964c467",411:"1ee79bb579cfd65895d3",412:"f614df138f672c7e6469",413:"367327f89c898621764e",414:"f49f74dfcb3e13a362b1",415:"b9890e7ca4add5893f7d",416:"583eef28a14208af04e2",417:"e2c7ba32b82b5ac8429b",418:"1d93a8438f550aa2cc79",419:"5784671d4f0dd1814f7a",420:"3e783eec3bb76fcf4708",421:"1240003bec820b7e60a1",422:"5373a40fe311392d91a7",423:"fb7b623603c0611dad39",424:"f6be15cc67e14e39b8be",425:"4b900b1b81df18506a9c",426:"f3d7f93a102ddc6a706e",427:"56b5e48e64d7a5a26325",428:"4a1956b9dec70a2833d5",429:"6b506151b8bbc0a3edf8",430:"48a6c44aaead6a67e4f0",431:"2649568772f0839906eb",432:"a78620c6b9671f178ade",433:"188f019d7056a20b3493",434:"c677f3b886b2bd6a2c51",435:"d6879f25d44fe0bc9ad5",436:"c0cd67b404c70a4cfcfd",437:"8580c58e739dbb6336c7",438:"416d642513e856096251",439:"037943d4e527080b3d6f",440:"ed67bafede1e1f0e3424",441:"d742685948b4e69202f1",442:"459ed0db78c9cd3f5cdc",443:"c846d2470daa25a41ebf",444:"c32a8e7c6c45c221abbe",445:"0f42380f5052642daae5",446:"e3061dd081860eb064e0",447:"b2cec6873f68eab51140",448:"6a08371cf0f1fe2ad89c",449:"2bd2a991b24bfeddfd92",450:"5af0b8170467b0322298",451:"c15ad622140c3706cff5",452:"d690ee07db8ee60b3859",453:"3dbefe1522781860b866",454:"15bdd49934de7f088adc",455:"43bf1832d93224742446",456:"3772cf1278c51735e6d6",457:"ffc79188442aaa3280b9",458:"1120d52e650114af18d7",459:"06c7c4b609ae92e61f91",460:"346cfbb8c7029295eeb3",461:"3337d22bf79fc6b9bf5d",462:"bda2caea89ae0de3d796",463:"e0f8282dd8da01c6eb49",464:"9b01489c4d93cf44b4a8",465:"f2626d51db4e85b92504",466:"da5832f4111cabc329a1",467:"9842ef83ac001964e991",468:"6c93e6030c84e5feec78",469:"fcafd9d2c948fde040d3",471:"96ae7c37f14d23fd660d",472:"c6fb9042d0c95f1b2c14",473:"26327cbba0c1b1aede11",474:"52c0fff16c6e88e1774e",475:"76b584cce454303adb92",476:"d59e2db604c29ff0a4f0",477:"35d5f20368cd5d4832de",478:"43cc6362815617b545c7",479:"1536843c5dc5b00aeb21",480:"2427275ca3f1558355ac",481:"e0f8e5bc949895af874f",482:"362c6db320efd6277b53",483:"ac7f857a784506dbad3c",484:"5d8c27ee491fe43c78df",485:"4b9587d91b02ccaf9abe",486:"29d552bf5587704d8c4f",487:"c17d65187b258b1effad",488:"7ef6ff4cc43b038af509",489:"d748221b9aaecbfcc39d",490:"eb351c281d54bdf703e7",491:"18d310b7611e7e89a76a",492:"2dcb32aef6afbf47b759",493:"ef291d20cb3252b69b01",494:"7e6f9e18a762c7127d1c",495:"24abb51ff1c64d9e5860",496:"3dacf060bf46c15b507c",497:"add561eb80c269e14f75",498:"7b6a26ddbc04beb46914",500:"f21d5e960b6c9ec53fed",501:"23a12385023c2a1b0126",502:"21b7c3360cc00e8e6f32",503:"5f4622121dc1b1c1296f",504:"108278a51636eb2a02a8",505:"9c514f42e399a381ed11",506:"661248b93d0bae466e61",507:"ae5c9fdf8b32ca578a59",508:"e8d1c468bb00b548fde4",509:"fd3bade6f60fba137f14",510:"ac2ceeacb3851e84dfaf",511:"cadfe81039ea04a6690b",512:"e2e76937a439f1e5d231",513:"ea80ec8dc5fc098a3aa8",514:"2d3438c00481a2d82986",515:"0157f93126117ec70bc3",516:"0b3b87b227ef89642763",517:"a9ff4e881dba302546a3",518:"cd641f4c60d221e650e8",519:"f42fae4d18957a5ab3db",520:"9789f285ed2eb20a1da8",521:"4f99b2579a279c88295b",522:"e5685be09ac88afcd9bb",523:"53350654edb93a79a01a",524:"10d9071953289721f01b",525:"12887725be30937528e5",526:"bac5d38e7009bb805f34",527:"beadd498aed25a6ec1d8",528:"f023caa2731168b0d289",529:"c2b74dde2b95769f1c9b",530:"b174add0960d01cfef27",531:"ec5319d546d520af7c84",532:"2b673e108b6eec5eca21",533:"9f4449f2a12f2edb7b1b",534:"f1fecf1832a002192c39",535:"91f75efcfd4b58964ebe",536:"8f981e0cf09b5a0b8749",537:"087d0671fc1877555262",538:"c494a6d7a9dac7437edd",539:"561aed60cb905896247a",540:"8384052fb45d28784f74",541:"60d521a9eb2105c6e8d2",542:"c22997b6cc7b826c4f67",543:"219b67a27e8a31c9bd2f",544:"15cab99f3e82a10e07c9",545:"f81a92726a3821822185",546:"106ec78d0d223f9b452b"}[e]+".chunk.v5.js"}function c(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[];r[e]?t.push(r[e]):0!==r[e]&&{5:1,33:1,35:1,36:1,46:1,51:1,52:1,55:1,61:1,63:1,67:1,156:1,173:1,176:1,179:1,270:1,450:1,456:1,461:1,467:1,473:1,474:1,478:1,494:1,500:1,501:1,503:1,504:1,505:1,510:1,511:1,516:1,525:1,526:1,527:1,530:1,532:1,535:1}[e]&&t.push(r[e]=new Promise((function(t,n){for(var i=({5:"officehome-async-styles",8:"vendors~action-context-menu-rc~app-host-component~cc~confirmation-dialog-rc~create-spaces-dialog-rc~~a6379b48",9:"vendors~action-context-menu-rc~app-host-component~cc~confirmation-dialog-rc~create-spaces-dialog-rc~~6d8c23f6",10:"vendors~app-host-component~cc~confirmation-dialog-rc~create-spaces-dialog-rc~error-dialog-rc~ew-rc~f~94ce955f",14:"vendors~create-spaces-dialog-component~create-spaces-dialog-rc~ew-rc~mc~mfs-storage-provider~qa~show~59f3cbc5",15:"vendors~cc~ew-rc~fc~flerrordialog~fpm~leap~mc~qa~rec1-rc~staying-aware~staying-aware-rq",16:"vendors~cc~ew-rc~fc~fpm~left-nav-rc~mc~qa~rec1-rc~space-cnt",17:"vendors~create-spaces-dialog-component~create-spaces-dialog-rc~fc~fl-cnt~fpm~showcreatespacesdialog~~3914b619",19:"vendors~app-host-component~fc~fl-cnt~fpm~mc~sideload-m365apps-dialog-control~space-cnt~spaces",20:"vendors~create-spaces-dialog-component~create-spaces-dialog-rc~ew-rc~mc~mfs-storage-provider~qa~show~0d1fb54a",21:"vendors~create-spaces-dialog-component~create-spaces-dialog-rc~fc~fpm~showcreatespacesdialog~space-cnt~spaces",23:"calendar~forms-group~mru~officeforms-group-forms~officeforms-my-forms~places",24:"vendors~create-spaces-dialog-component~create-spaces-dialog-rc~ew-rc~qa~showcreatespacesdialog~space~3e32d003",25:"vendors~app-host-component~fc~fl-cnt~fpm~sideload-m365apps-dialog-control",26:"auto-suggest~bc~search-preload~search-results",27:"vendors~auto-suggest~bc~search-preload~search-results",28:"vendors~cc~rec1-rc~staying-aware~staying-aware-rq",29:"vendors~m365-apps~officeflonedssink~oteljs1ds~task-dialog-rc",30:"vendors~staying-aware~staying-aware-badge~staying-aware-data-service~staying-aware-rq",31:"create-menu~templates~wac-start",32:"vendors~action-context-menu-rc~cc~rec1-rc",33:"vendors~cc~create-onenote-page-dialog-rc~rec1-rc",34:"vendors~cc~fc~fpm",35:"vendors~cc~staying-aware~staying-aware-rq",36:"vendors~create-spaces-dialog-component~create-spaces-dialog-rc~showcreatespacesdialog",37:"vendors~deferredcomponents~deferredoperations~itemsview",38:"vendors~edgeworth~input-dialog~wac-start",39:"vendors~fc~fl-cnt~fpm",40:"vendors~fc~flerrordialog~fpm",41:"vendors~fc~fpm~menu-view-service",42:"vendors~fl-cnt~m365-apps~task-dialog-rc",43:"vendors~m365-apps~officeflonedssink~task-dialog-rc",45:"fl-cnt~share-control",46:"templates~wac-start",47:"vendors~deferredcomponents~itemsview",48:"vendors~fc~fpm",49:"vendors~flerrordialog~leap",50:"vendors~itemsview~itemsview-deferredactions",51:"vendors~m365-apps~task-dialog-rc",52:"vendors~space-cnt~spaces",53:"vendors~staying-aware-badge~staying-aware-data-service",54:"vendors~staying-aware~staying-aware-data-service",55:"vendors~staying-aware~staying-aware-rq",56:"wac-cnt",59:"action-context-menu-rc",61:"app-gallery",62:"appbar",63:"auto-suggest",64:"axios-interceptors",65:"banner",66:"bc",67:"calendar",68:"catchupactivityflyout",69:"catchupactivitystrings0",70:"catchupactivitystrings1",71:"catchupactivitystrings10",72:"catchupactivitystrings11",73:"catchupactivitystrings12",74:"catchupactivitystrings13",75:"catchupactivitystrings14",76:"catchupactivitystrings15",77:"catchupactivitystrings16",78:"catchupactivitystrings17",79:"catchupactivitystrings18",80:"catchupactivitystrings19",81:"catchupactivitystrings2",82:"catchupactivitystrings20",83:"catchupactivitystrings21",84:"catchupactivitystrings22",85:"catchupactivitystrings23",86:"catchupactivitystrings24",87:"catchupactivitystrings25",88:"catchupactivitystrings26",89:"catchupactivitystrings27",90:"catchupactivitystrings28",91:"catchupactivitystrings29",92:"catchupactivitystrings3",93:"catchupactivitystrings30",94:"catchupactivitystrings31",95:"catchupactivitystrings32",96:"catchupactivitystrings33",97:"catchupactivitystrings34",98:"catchupactivitystrings35",99:"catchupactivitystrings36",100:"catchupactivitystrings37",101:"catchupactivitystrings38",102:"catchupactivitystrings39",103:"catchupactivitystrings4",104:"catchupactivitystrings40",105:"catchupactivitystrings41",106:"catchupactivitystrings42",107:"catchupactivitystrings43",108:"catchupactivitystrings44",109:"catchupactivitystrings45",110:"catchupactivitystrings46",111:"catchupactivitystrings47",112:"catchupactivitystrings48",113:"catchupactivitystrings49",114:"catchupactivitystrings5",115:"catchupactivitystrings50",116:"catchupactivitystrings51",117:"catchupactivitystrings52",118:"catchupactivitystrings53",119:"catchupactivitystrings54",120:"catchupactivitystrings55",121:"catchupactivitystrings56",122:"catchupactivitystrings57",123:"catchupactivitystrings58",124:"catchupactivitystrings59",125:"catchupactivitystrings6",126:"catchupactivitystrings60",127:"catchupactivitystrings61",128:"catchupactivitystrings62",129:"catchupactivitystrings63",130:"catchupactivitystrings64",131:"catchupactivitystrings65",132:"catchupactivitystrings66",133:"catchupactivitystrings67",134:"catchupactivitystrings68",135:"catchupactivitystrings69",136:"catchupactivitystrings7",137:"catchupactivitystrings70",138:"catchupactivitystrings71",139:"catchupactivitystrings72",140:"catchupactivitystrings73",141:"catchupactivitystrings74",142:"catchupactivitystrings75",143:"catchupactivitystrings76",144:"catchupactivitystrings77",145:"catchupactivitystrings78",146:"catchupactivitystrings79",147:"catchupactivitystrings8",148:"catchupactivitystrings80",149:"catchupactivitystrings81",150:"catchupactivitystrings82",151:"catchupactivitystrings83",152:"catchupactivitystrings84",153:"catchupactivitystrings85",154:"catchupactivitystrings9",155:"cc",156:"confirmation-dialog-component",157:"confirmation-dialog-rc",158:"context-menu",159:"create-folder-dialog",160:"create-folder-wizard",161:"create-links-control-icns",162:"create-menu",163:"create-onenote-page-dialog-rc",164:"create-spaces-dialog-component",165:"create-spaces-dialog-rc",166:"deferredoperations",167:"document-creator",168:"edgeworth",169:"edgeworth-trie-webworker",170:"edgeworth-worker",171:"error-dialog",172:"error-dialog-rc",173:"ew-rc",174:"fb-theme",175:"fc",176:"feature-callout",177:"feature-tooltip-container",178:"feedback",179:"first-run",180:"fl-cnt",181:"fl-unsupported-page",182:"flcontainerstrings0",183:"flcontainerstrings1",184:"flcontainerstrings10",185:"flcontainerstrings11",186:"flcontainerstrings12",187:"flcontainerstrings13",188:"flcontainerstrings14",189:"flcontainerstrings15",190:"flcontainerstrings16",191:"flcontainerstrings17",192:"flcontainerstrings18",193:"flcontainerstrings19",194:"flcontainerstrings2",195:"flcontainerstrings20",196:"flcontainerstrings21",197:"flcontainerstrings22",198:"flcontainerstrings23",199:"flcontainerstrings24",200:"flcontainerstrings25",201:"flcontainerstrings26",202:"flcontainerstrings27",203:"flcontainerstrings28",204:"flcontainerstrings29",205:"flcontainerstrings3",206:"flcontainerstrings30",207:"flcontainerstrings31",208:"flcontainerstrings32",209:"flcontainerstrings33",210:"flcontainerstrings34",211:"flcontainerstrings35",212:"flcontainerstrings36",213:"flcontainerstrings37",214:"flcontainerstrings38",215:"flcontainerstrings39",216:"flcontainerstrings4",217:"flcontainerstrings40",218:"flcontainerstrings41",219:"flcontainerstrings42",220:"flcontainerstrings43",221:"flcontainerstrings44",222:"flcontainerstrings45",223:"flcontainerstrings46",224:"flcontainerstrings47",225:"flcontainerstrings48",226:"flcontainerstrings49",227:"flcontainerstrings5",228:"flcontainerstrings50",229:"flcontainerstrings51",230:"flcontainerstrings52",231:"flcontainerstrings53",232:"flcontainerstrings54",233:"flcontainerstrings55",234:"flcontainerstrings56",235:"flcontainerstrings57",236:"flcontainerstrings58",237:"flcontainerstrings59",238:"flcontainerstrings6",239:"flcontainerstrings60",240:"flcontainerstrings61",241:"flcontainerstrings62",242:"flcontainerstrings63",243:"flcontainerstrings64",244:"flcontainerstrings65",245:"flcontainerstrings66",246:"flcontainerstrings67",247:"flcontainerstrings68",248:"flcontainerstrings69",249:"flcontainerstrings7",250:"flcontainerstrings70",251:"flcontainerstrings71",252:"flcontainerstrings72",253:"flcontainerstrings73",254:"flcontainerstrings74",255:"flcontainerstrings75",256:"flcontainerstrings76",257:"flcontainerstrings77",258:"flcontainerstrings78",259:"flcontainerstrings79",260:"flcontainerstrings8",261:"flcontainerstrings80",262:"flcontainerstrings81",263:"flcontainerstrings82",264:"flcontainerstrings83",265:"flcontainerstrings84",266:"flcontainerstrings85",267:"flcontainerstrings9",268:"flframework-hashfallback",269:"fluent-theme-provider",270:"forms-group",271:"fpm",272:"home",273:"hostuxstrings0",274:"hostuxstrings1",275:"hostuxstrings10",276:"hostuxstrings11",277:"hostuxstrings12",278:"hostuxstrings13",279:"hostuxstrings14",280:"hostuxstrings15",281:"hostuxstrings16",282:"hostuxstrings17",283:"hostuxstrings18",284:"hostuxstrings19",285:"hostuxstrings2",286:"hostuxstrings20",287:"hostuxstrings21",288:"hostuxstrings22",289:"hostuxstrings23",290:"hostuxstrings24",291:"hostuxstrings25",292:"hostuxstrings26",293:"hostuxstrings27",294:"hostuxstrings28",295:"hostuxstrings29",296:"hostuxstrings3",297:"hostuxstrings30",298:"hostuxstrings31",299:"hostuxstrings32",300:"hostuxstrings33",301:"hostuxstrings34",302:"hostuxstrings35",303:"hostuxstrings36",304:"hostuxstrings37",305:"hostuxstrings38",306:"hostuxstrings39",307:"hostuxstrings4",308:"hostuxstrings40",309:"hostuxstrings41",310:"hostuxstrings42",311:"hostuxstrings43",312:"hostuxstrings44",313:"hostuxstrings45",314:"hostuxstrings46",315:"hostuxstrings47",316:"hostuxstrings48",317:"hostuxstrings49",318:"hostuxstrings5",319:"hostuxstrings50",320:"hostuxstrings51",321:"hostuxstrings52",322:"hostuxstrings53",323:"hostuxstrings54",324:"hostuxstrings55",325:"hostuxstrings56",326:"hostuxstrings57",327:"hostuxstrings58",328:"hostuxstrings59",329:"hostuxstrings6",330:"hostuxstrings60",331:"hostuxstrings61",332:"hostuxstrings62",333:"hostuxstrings63",334:"hostuxstrings64",335:"hostuxstrings65",336:"hostuxstrings66",337:"hostuxstrings67",338:"hostuxstrings68",339:"hostuxstrings69",340:"hostuxstrings7",341:"hostuxstrings70",342:"hostuxstrings71",343:"hostuxstrings72",344:"hostuxstrings73",345:"hostuxstrings74",346:"hostuxstrings75",347:"hostuxstrings76",348:"hostuxstrings77",349:"hostuxstrings78",350:"hostuxstrings79",351:"hostuxstrings8",352:"hostuxstrings80",353:"hostuxstrings81",354:"hostuxstrings82",355:"hostuxstrings83",356:"hostuxstrings84",357:"hostuxstrings85",358:"hostuxstrings9",359:"hwalaunchfile",360:"hwalaunchurl",361:"informationprotectionstrings0",362:"informationprotectionstrings1",363:"informationprotectionstrings10",364:"informationprotectionstrings11",365:"informationprotectionstrings12",366:"informationprotectionstrings13",367:"informationprotectionstrings14",368:"informationprotectionstrings15",369:"informationprotectionstrings16",370:"informationprotectionstrings17",371:"informationprotectionstrings18",372:"informationprotectionstrings19",373:"informationprotectionstrings2",374:"informationprotectionstrings20",375:"informationprotectionstrings21",376:"informationprotectionstrings22",377:"informationprotectionstrings23",378:"informationprotectionstrings24",379:"informationprotectionstrings25",380:"informationprotectionstrings26",381:"informationprotectionstrings27",382:"informationprotectionstrings28",383:"informationprotectionstrings29",384:"informationprotectionstrings3",385:"informationprotectionstrings30",386:"informationprotectionstrings31",387:"informationprotectionstrings32",388:"informationprotectionstrings33",389:"informationprotectionstrings34",390:"informationprotectionstrings35",391:"informationprotectionstrings36",392:"informationprotectionstrings37",393:"informationprotectionstrings38",394:"informationprotectionstrings39",395:"informationprotectionstrings4",396:"informationprotectionstrings40",397:"informationprotectionstrings41",398:"informationprotectionstrings42",399:"informationprotectionstrings43",400:"informationprotectionstrings44",401:"informationprotectionstrings45",402:"informationprotectionstrings46",403:"informationprotectionstrings47",404:"informationprotectionstrings48",405:"informationprotectionstrings49",406:"informationprotectionstrings5",407:"informationprotectionstrings50",408:"informationprotectionstrings51",409:"informationprotectionstrings52",410:"informationprotectionstrings53",411:"informationprotectionstrings54",412:"informationprotectionstrings55",413:"informationprotectionstrings56",414:"informationprotectionstrings57",415:"informationprotectionstrings58",416:"informationprotectionstrings59",417:"informationprotectionstrings6",418:"informationprotectionstrings60",419:"informationprotectionstrings61",420:"informationprotectionstrings62",421:"informationprotectionstrings63",422:"informationprotectionstrings64",423:"informationprotectionstrings65",424:"informationprotectionstrings66",425:"informationprotectionstrings67",426:"informationprotectionstrings68",427:"informationprotectionstrings69",428:"informationprotectionstrings7",429:"informationprotectionstrings70",430:"informationprotectionstrings71",431:"informationprotectionstrings72",432:"informationprotectionstrings73",433:"informationprotectionstrings74",434:"informationprotectionstrings75",435:"informationprotectionstrings76",436:"informationprotectionstrings77",437:"informationprotectionstrings78",438:"informationprotectionstrings79",439:"informationprotectionstrings8",440:"informationprotectionstrings80",441:"informationprotectionstrings81",442:"informationprotectionstrings82",443:"informationprotectionstrings83",444:"informationprotectionstrings84",445:"informationprotectionstrings85",446:"informationprotectionstrings9",447:"initialize-fluent-theme",448:"input-dialog",449:"install",450:"install-wizard",451:"instrumentation-service",452:"itemsview-deferredoperations",453:"leap",454:"left-nav-rc",455:"m365-apps",456:"mc",457:"mfs-storage-provider",458:"midgard-bootstrapper",459:"mobile-app-banner",460:"move-to-folder-control",461:"mru",462:"new-user-shelf",463:"odsp-start-onedrive",464:"odsp-start-sharepoint",465:"office-theme",466:"officeflonedssink",467:"officeforms-group-forms",468:"officeforms-my-forms",469:"places",471:"previewlabelcallout",472:"pull-to-refresh",473:"qa",474:"rec1-rc",475:"renderdiscovermenu",476:"search-page-strings",477:"search-preload",478:"search-results",479:"share-control",480:"sharecallout",481:"sharedialog",482:"showcreatespacesdialog",483:"side-popup-menu",484:"space-cnt",485:"spaces",486:"spaces-storage-service",487:"spaces-tinylicious-client",488:"staying-aware",489:"staying-aware-badge",490:"staying-aware-data-service",491:"staying-aware-rq",492:"support-central-rc",493:"task-dialog-rc",494:"templates",495:"text-encoder-lite",496:"toast-container-rc",497:"upload-button",498:"upload-dialog",500:"vendors~app-host-component",501:"vendors~appbar",502:"vendors~catchupactivityflyout",503:"vendors~cc",504:"vendors~confirmation-dialog-rc",505:"vendors~create-onenote-page-dialog-rc",506:"vendors~create-spaces-dialog-rc",507:"vendors~data-prefetch-service",508:"vendors~deferredcomponents",509:"vendors~edgeworth",510:"vendors~error-dialog-rc",511:"vendors~fl-cnt",512:"vendors~flerrordialog",513:"vendors~fpm",514:"vendors~itemsview",515:"vendors~itemsview-deferredactions",516:"vendors~left-nav-rc",517:"vendors~menu-view-service",518:"vendors~oteljs",519:"vendors~oteljs1ds",520:"vendors~renderdiscovermenu",521:"vendors~search-preload",522:"vendors~search-results",523:"vendors~searchux-logger",524:"vendors~searchux-main",525:"vendors~sideload-m365apps-dialog-control",526:"vendors~space-cnt",527:"vendors~spaces",528:"vendors~spaces-tinylicious-client",529:"vendors~staying-aware-rq",530:"vendors~support-central-rc",531:"vendors~vroom-service",532:"wac-start",533:"web-vitals",534:"workspace-nav"}[e]||e)+"."+{0:"31d6cfe0d16ae931b73c",1:"31d6cfe0d16ae931b73c",2:"31d6cfe0d16ae931b73c",3:"31d6cfe0d16ae931b73c",4:"31d6cfe0d16ae931b73c",5:"ca6658a8f565e91a3036",6:"31d6cfe0d16ae931b73c",7:"31d6cfe0d16ae931b73c",8:"31d6cfe0d16ae931b73c",9:"31d6cfe0d16ae931b73c",10:"31d6cfe0d16ae931b73c",11:"31d6cfe0d16ae931b73c",12:"31d6cfe0d16ae931b73c",13:"31d6cfe0d16ae931b73c",14:"31d6cfe0d16ae931b73c",15:"31d6cfe0d16ae931b73c",16:"31d6cfe0d16ae931b73c",17:"31d6cfe0d16ae931b73c",18:"31d6cfe0d16ae931b73c",19:"31d6cfe0d16ae931b73c",20:"31d6cfe0d16ae931b73c",21:"31d6cfe0d16ae931b73c",22:"31d6cfe0d16ae931b73c",23:"31d6cfe0d16ae931b73c",24:"31d6cfe0d16ae931b73c",25:"31d6cfe0d16ae931b73c",26:"31d6cfe0d16ae931b73c",27:"31d6cfe0d16ae931b73c",28:"31d6cfe0d16ae931b73c",29:"31d6cfe0d16ae931b73c",30:"31d6cfe0d16ae931b73c",31:"31d6cfe0d16ae931b73c",32:"31d6cfe0d16ae931b73c",33:"60a0b66c8f87b7b8ef72",34:"31d6cfe0d16ae931b73c",35:"009764d6f55a3e5d1ba5",36:"8e75658b32ad475a6dd3",37:"31d6cfe0d16ae931b73c",38:"31d6cfe0d16ae931b73c",39:"31d6cfe0d16ae931b73c",40:"31d6cfe0d16ae931b73c",41:"31d6cfe0d16ae931b73c",42:"31d6cfe0d16ae931b73c",43:"31d6cfe0d16ae931b73c",44:"31d6cfe0d16ae931b73c",45:"31d6cfe0d16ae931b73c",46:"2175ec1ddf16305e47c3",47:"31d6cfe0d16ae931b73c",48:"31d6cfe0d16ae931b73c",49:"31d6cfe0d16ae931b73c",50:"31d6cfe0d16ae931b73c",51:"24498a143a28d5b7d7e0",52:"e9526d2a0ac6e2a07c3b",53:"31d6cfe0d16ae931b73c",54:"31d6cfe0d16ae931b73c",55:"6bf03920560bd4a12653",56:"31d6cfe0d16ae931b73c",57:"31d6cfe0d16ae931b73c",58:"31d6cfe0d16ae931b73c",59:"31d6cfe0d16ae931b73c",61:"3a6a766341a6b336455e",62:"31d6cfe0d16ae931b73c",63:"2a90ed6515498ac055eb",64:"31d6cfe0d16ae931b73c",65:"31d6cfe0d16ae931b73c",66:"31d6cfe0d16ae931b73c",67:"21806cf67ecda45b5ecd",68:"31d6cfe0d16ae931b73c",69:"31d6cfe0d16ae931b73c",70:"31d6cfe0d16ae931b73c",71:"31d6cfe0d16ae931b73c",72:"31d6cfe0d16ae931b73c",73:"31d6cfe0d16ae931b73c",74:"31d6cfe0d16ae931b73c",75:"31d6cfe0d16ae931b73c",76:"31d6cfe0d16ae931b73c",77:"31d6cfe0d16ae931b73c",78:"31d6cfe0d16ae931b73c",79:"31d6cfe0d16ae931b73c",80:"31d6cfe0d16ae931b73c",81:"31d6cfe0d16ae931b73c",82:"31d6cfe0d16ae931b73c",83:"31d6cfe0d16ae931b73c",84:"31d6cfe0d16ae931b73c",85:"31d6cfe0d16ae931b73c",86:"31d6cfe0d16ae931b73c",87:"31d6cfe0d16ae931b73c",88:"31d6cfe0d16ae931b73c",89:"31d6cfe0d16ae931b73c",90:"31d6cfe0d16ae931b73c",91:"31d6cfe0d16ae931b73c",92:"31d6cfe0d16ae931b73c",93:"31d6cfe0d16ae931b73c",94:"31d6cfe0d16ae931b73c",95:"31d6cfe0d16ae931b73c",96:"31d6cfe0d16ae931b73c",97:"31d6cfe0d16ae931b73c",98:"31d6cfe0d16ae931b73c",99:"31d6cfe0d16ae931b73c",100:"31d6cfe0d16ae931b73c",101:"31d6cfe0d16ae931b73c",102:"31d6cfe0d16ae931b73c",103:"31d6cfe0d16ae931b73c",104:"31d6cfe0d16ae931b73c",105:"31d6cfe0d16ae931b73c",106:"31d6cfe0d16ae931b73c",107:"31d6cfe0d16ae931b73c",108:"31d6cfe0d16ae931b73c",109:"31d6cfe0d16ae931b73c",110:"31d6cfe0d16ae931b73c",111:"31d6cfe0d16ae931b73c",112:"31d6cfe0d16ae931b73c",113:"31d6cfe0d16ae931b73c",114:"31d6cfe0d16ae931b73c",115:"31d6cfe0d16ae931b73c",116:"31d6cfe0d16ae931b73c",117:"31d6cfe0d16ae931b73c",118:"31d6cfe0d16ae931b73c",119:"31d6cfe0d16ae931b73c",120:"31d6cfe0d16ae931b73c",121:"31d6cfe0d16ae931b73c",122:"31d6cfe0d16ae931b73c",123:"31d6cfe0d16ae931b73c",124:"31d6cfe0d16ae931b73c",125:"31d6cfe0d16ae931b73c",126:"31d6cfe0d16ae931b73c",127:"31d6cfe0d16ae931b73c",128:"31d6cfe0d16ae931b73c",129:"31d6cfe0d16ae931b73c",130:"31d6cfe0d16ae931b73c",131:"31d6cfe0d16ae931b73c",132:"31d6cfe0d16ae931b73c",133:"31d6cfe0d16ae931b73c",134:"31d6cfe0d16ae931b73c",135:"31d6cfe0d16ae931b73c",136:"31d6cfe0d16ae931b73c",137:"31d6cfe0d16ae931b73c",138:"31d6cfe0d16ae931b73c",139:"31d6cfe0d16ae931b73c",140:"31d6cfe0d16ae931b73c",141:"31d6cfe0d16ae931b73c",142:"31d6cfe0d16ae931b73c",143:"31d6cfe0d16ae931b73c",144:"31d6cfe0d16ae931b73c",145:"31d6cfe0d16ae931b73c",146:"31d6cfe0d16ae931b73c",147:"31d6cfe0d16ae931b73c",148:"31d6cfe0d16ae931b73c",149:"31d6cfe0d16ae931b73c",150:"31d6cfe0d16ae931b73c",151:"31d6cfe0d16ae931b73c",152:"31d6cfe0d16ae931b73c",153:"31d6cfe0d16ae931b73c",154:"31d6cfe0d16ae931b73c",155:"31d6cfe0d16ae931b73c",156:"f89bf3b4dfa268afb48e",157:"31d6cfe0d16ae931b73c",158:"31d6cfe0d16ae931b73c",159:"31d6cfe0d16ae931b73c",160:"31d6cfe0d16ae931b73c",161:"31d6cfe0d16ae931b73c",162:"31d6cfe0d16ae931b73c",163:"31d6cfe0d16ae931b73c",164:"31d6cfe0d16ae931b73c",165:"31d6cfe0d16ae931b73c",166:"31d6cfe0d16ae931b73c",167:"31d6cfe0d16ae931b73c",168:"31d6cfe0d16ae931b73c",169:"31d6cfe0d16ae931b73c",170:"31d6cfe0d16ae931b73c",171:"31d6cfe0d16ae931b73c",172:"31d6cfe0d16ae931b73c",173:"e1bd549e9eca4c1417b3",174:"31d6cfe0d16ae931b73c",175:"31d6cfe0d16ae931b73c",176:"4b0585444bdf2d7fcf34",177:"31d6cfe0d16ae931b73c",178:"31d6cfe0d16ae931b73c",179:"361ead896f5279297d27",180:"31d6cfe0d16ae931b73c",181:"31d6cfe0d16ae931b73c",182:"31d6cfe0d16ae931b73c",183:"31d6cfe0d16ae931b73c",184:"31d6cfe0d16ae931b73c",185:"31d6cfe0d16ae931b73c",186:"31d6cfe0d16ae931b73c",187:"31d6cfe0d16ae931b73c",188:"31d6cfe0d16ae931b73c",189:"31d6cfe0d16ae931b73c",190:"31d6cfe0d16ae931b73c",191:"31d6cfe0d16ae931b73c",192:"31d6cfe0d16ae931b73c",193:"31d6cfe0d16ae931b73c",194:"31d6cfe0d16ae931b73c",195:"31d6cfe0d16ae931b73c",196:"31d6cfe0d16ae931b73c",197:"31d6cfe0d16ae931b73c",198:"31d6cfe0d16ae931b73c",199:"31d6cfe0d16ae931b73c",200:"31d6cfe0d16ae931b73c",201:"31d6cfe0d16ae931b73c",202:"31d6cfe0d16ae931b73c",203:"31d6cfe0d16ae931b73c",204:"31d6cfe0d16ae931b73c",205:"31d6cfe0d16ae931b73c",206:"31d6cfe0d16ae931b73c",207:"31d6cfe0d16ae931b73c",208:"31d6cfe0d16ae931b73c",209:"31d6cfe0d16ae931b73c",210:"31d6cfe0d16ae931b73c",211:"31d6cfe0d16ae931b73c",212:"31d6cfe0d16ae931b73c",213:"31d6cfe0d16ae931b73c",214:"31d6cfe0d16ae931b73c",215:"31d6cfe0d16ae931b73c",216:"31d6cfe0d16ae931b73c",217:"31d6cfe0d16ae931b73c",218:"31d6cfe0d16ae931b73c",219:"31d6cfe0d16ae931b73c",220:"31d6cfe0d16ae931b73c",221:"31d6cfe0d16ae931b73c",222:"31d6cfe0d16ae931b73c",223:"31d6cfe0d16ae931b73c",224:"31d6cfe0d16ae931b73c",225:"31d6cfe0d16ae931b73c",226:"31d6cfe0d16ae931b73c",227:"31d6cfe0d16ae931b73c",228:"31d6cfe0d16ae931b73c",229:"31d6cfe0d16ae931b73c",230:"31d6cfe0d16ae931b73c",231:"31d6cfe0d16ae931b73c",232:"31d6cfe0d16ae931b73c",233:"31d6cfe0d16ae931b73c",234:"31d6cfe0d16ae931b73c",235:"31d6cfe0d16ae931b73c",236:"31d6cfe0d16ae931b73c",237:"31d6cfe0d16ae931b73c",238:"31d6cfe0d16ae931b73c",239:"31d6cfe0d16ae931b73c",240:"31d6cfe0d16ae931b73c",241:"31d6cfe0d16ae931b73c",242:"31d6cfe0d16ae931b73c",243:"31d6cfe0d16ae931b73c",244:"31d6cfe0d16ae931b73c",245:"31d6cfe0d16ae931b73c",246:"31d6cfe0d16ae931b73c",247:"31d6cfe0d16ae931b73c",248:"31d6cfe0d16ae931b73c",249:"31d6cfe0d16ae931b73c",250:"31d6cfe0d16ae931b73c",251:"31d6cfe0d16ae931b73c",252:"31d6cfe0d16ae931b73c",253:"31d6cfe0d16ae931b73c",254:"31d6cfe0d16ae931b73c",255:"31d6cfe0d16ae931b73c",256:"31d6cfe0d16ae931b73c",257:"31d6cfe0d16ae931b73c",258:"31d6cfe0d16ae931b73c",259:"31d6cfe0d16ae931b73c",260:"31d6cfe0d16ae931b73c",261:"31d6cfe0d16ae931b73c",262:"31d6cfe0d16ae931b73c",263:"31d6cfe0d16ae931b73c",264:"31d6cfe0d16ae931b73c",265:"31d6cfe0d16ae931b73c",266:"31d6cfe0d16ae931b73c",267:"31d6cfe0d16ae931b73c",268:"31d6cfe0d16ae931b73c",269:"31d6cfe0d16ae931b73c",270:"0db42b78d3452804ec65",271:"31d6cfe0d16ae931b73c",272:"31d6cfe0d16ae931b73c",273:"31d6cfe0d16ae931b73c",274:"31d6cfe0d16ae931b73c",275:"31d6cfe0d16ae931b73c",276:"31d6cfe0d16ae931b73c",277:"31d6cfe0d16ae931b73c",278:"31d6cfe0d16ae931b73c",279:"31d6cfe0d16ae931b73c",280:"31d6cfe0d16ae931b73c",281:"31d6cfe0d16ae931b73c",282:"31d6cfe0d16ae931b73c",283:"31d6cfe0d16ae931b73c",284:"31d6cfe0d16ae931b73c",285:"31d6cfe0d16ae931b73c",286:"31d6cfe0d16ae931b73c",287:"31d6cfe0d16ae931b73c",288:"31d6cfe0d16ae931b73c",289:"31d6cfe0d16ae931b73c",290:"31d6cfe0d16ae931b73c",291:"31d6cfe0d16ae931b73c",292:"31d6cfe0d16ae931b73c",293:"31d6cfe0d16ae931b73c",294:"31d6cfe0d16ae931b73c",295:"31d6cfe0d16ae931b73c",296:"31d6cfe0d16ae931b73c",297:"31d6cfe0d16ae931b73c",298:"31d6cfe0d16ae931b73c",299:"31d6cfe0d16ae931b73c",300:"31d6cfe0d16ae931b73c",301:"31d6cfe0d16ae931b73c",302:"31d6cfe0d16ae931b73c",303:"31d6cfe0d16ae931b73c",304:"31d6cfe0d16ae931b73c",305:"31d6cfe0d16ae931b73c",306:"31d6cfe0d16ae931b73c",307:"31d6cfe0d16ae931b73c",308:"31d6cfe0d16ae931b73c",309:"31d6cfe0d16ae931b73c",310:"31d6cfe0d16ae931b73c",311:"31d6cfe0d16ae931b73c",312:"31d6cfe0d16ae931b73c",313:"31d6cfe0d16ae931b73c",314:"31d6cfe0d16ae931b73c",315:"31d6cfe0d16ae931b73c",316:"31d6cfe0d16ae931b73c",317:"31d6cfe0d16ae931b73c",318:"31d6cfe0d16ae931b73c",319:"31d6cfe0d16ae931b73c",320:"31d6cfe0d16ae931b73c",321:"31d6cfe0d16ae931b73c",322:"31d6cfe0d16ae931b73c",323:"31d6cfe0d16ae931b73c",324:"31d6cfe0d16ae931b73c",325:"31d6cfe0d16ae931b73c",326:"31d6cfe0d16ae931b73c",327:"31d6cfe0d16ae931b73c",328:"31d6cfe0d16ae931b73c",329:"31d6cfe0d16ae931b73c",330:"31d6cfe0d16ae931b73c",331:"31d6cfe0d16ae931b73c",332:"31d6cfe0d16ae931b73c",333:"31d6cfe0d16ae931b73c",334:"31d6cfe0d16ae931b73c",335:"31d6cfe0d16ae931b73c",336:"31d6cfe0d16ae931b73c",337:"31d6cfe0d16ae931b73c",338:"31d6cfe0d16ae931b73c",339:"31d6cfe0d16ae931b73c",340:"31d6cfe0d16ae931b73c",341:"31d6cfe0d16ae931b73c",342:"31d6cfe0d16ae931b73c",343:"31d6cfe0d16ae931b73c",344:"31d6cfe0d16ae931b73c",345:"31d6cfe0d16ae931b73c",346:"31d6cfe0d16ae931b73c",347:"31d6cfe0d16ae931b73c",348:"31d6cfe0d16ae931b73c",349:"31d6cfe0d16ae931b73c",350:"31d6cfe0d16ae931b73c",351:"31d6cfe0d16ae931b73c",352:"31d6cfe0d16ae931b73c",353:"31d6cfe0d16ae931b73c",354:"31d6cfe0d16ae931b73c",355:"31d6cfe0d16ae931b73c",356:"31d6cfe0d16ae931b73c",357:"31d6cfe0d16ae931b73c",358:"31d6cfe0d16ae931b73c",359:"31d6cfe0d16ae931b73c",360:"31d6cfe0d16ae931b73c",361:"31d6cfe0d16ae931b73c",362:"31d6cfe0d16ae931b73c",363:"31d6cfe0d16ae931b73c",364:"31d6cfe0d16ae931b73c",365:"31d6cfe0d16ae931b73c",366:"31d6cfe0d16ae931b73c",367:"31d6cfe0d16ae931b73c",368:"31d6cfe0d16ae931b73c",369:"31d6cfe0d16ae931b73c",370:"31d6cfe0d16ae931b73c",371:"31d6cfe0d16ae931b73c",372:"31d6cfe0d16ae931b73c",373:"31d6cfe0d16ae931b73c",374:"31d6cfe0d16ae931b73c",375:"31d6cfe0d16ae931b73c",376:"31d6cfe0d16ae931b73c",377:"31d6cfe0d16ae931b73c",378:"31d6cfe0d16ae931b73c",379:"31d6cfe0d16ae931b73c",380:"31d6cfe0d16ae931b73c",381:"31d6cfe0d16ae931b73c",382:"31d6cfe0d16ae931b73c",383:"31d6cfe0d16ae931b73c",384:"31d6cfe0d16ae931b73c",385:"31d6cfe0d16ae931b73c",386:"31d6cfe0d16ae931b73c",387:"31d6cfe0d16ae931b73c",388:"31d6cfe0d16ae931b73c",389:"31d6cfe0d16ae931b73c",390:"31d6cfe0d16ae931b73c",391:"31d6cfe0d16ae931b73c",392:"31d6cfe0d16ae931b73c",393:"31d6cfe0d16ae931b73c",394:"31d6cfe0d16ae931b73c",395:"31d6cfe0d16ae931b73c",396:"31d6cfe0d16ae931b73c",397:"31d6cfe0d16ae931b73c",398:"31d6cfe0d16ae931b73c",399:"31d6cfe0d16ae931b73c",400:"31d6cfe0d16ae931b73c",401:"31d6cfe0d16ae931b73c",402:"31d6cfe0d16ae931b73c",403:"31d6cfe0d16ae931b73c",404:"31d6cfe0d16ae931b73c",405:"31d6cfe0d16ae931b73c",406:"31d6cfe0d16ae931b73c",407:"31d6cfe0d16ae931b73c",408:"31d6cfe0d16ae931b73c",409:"31d6cfe0d16ae931b73c",410:"31d6cfe0d16ae931b73c",411:"31d6cfe0d16ae931b73c",412:"31d6cfe0d16ae931b73c",413:"31d6cfe0d16ae931b73c",414:"31d6cfe0d16ae931b73c",415:"31d6cfe0d16ae931b73c",416:"31d6cfe0d16ae931b73c",417:"31d6cfe0d16ae931b73c",418:"31d6cfe0d16ae931b73c",419:"31d6cfe0d16ae931b73c",420:"31d6cfe0d16ae931b73c",421:"31d6cfe0d16ae931b73c",422:"31d6cfe0d16ae931b73c",423:"31d6cfe0d16ae931b73c",424:"31d6cfe0d16ae931b73c",425:"31d6cfe0d16ae931b73c",426:"31d6cfe0d16ae931b73c",427:"31d6cfe0d16ae931b73c",428:"31d6cfe0d16ae931b73c",429:"31d6cfe0d16ae931b73c",430:"31d6cfe0d16ae931b73c",431:"31d6cfe0d16ae931b73c",432:"31d6cfe0d16ae931b73c",433:"31d6cfe0d16ae931b73c",434:"31d6cfe0d16ae931b73c",435:"31d6cfe0d16ae931b73c",436:"31d6cfe0d16ae931b73c",437:"31d6cfe0d16ae931b73c",438:"31d6cfe0d16ae931b73c",439:"31d6cfe0d16ae931b73c",440:"31d6cfe0d16ae931b73c",441:"31d6cfe0d16ae931b73c",442:"31d6cfe0d16ae931b73c",443:"31d6cfe0d16ae931b73c",444:"31d6cfe0d16ae931b73c",445:"31d6cfe0d16ae931b73c",446:"31d6cfe0d16ae931b73c",447:"31d6cfe0d16ae931b73c",448:"31d6cfe0d16ae931b73c",449:"31d6cfe0d16ae931b73c",450:"823e911db178b72be7e1",451:"31d6cfe0d16ae931b73c",452:"31d6cfe0d16ae931b73c",453:"31d6cfe0d16ae931b73c",454:"31d6cfe0d16ae931b73c",455:"31d6cfe0d16ae931b73c",456:"e07118bfe2216a14ac12",457:"31d6cfe0d16ae931b73c",458:"31d6cfe0d16ae931b73c",459:"31d6cfe0d16ae931b73c",460:"31d6cfe0d16ae931b73c",461:"79a516d3608154490c09",462:"31d6cfe0d16ae931b73c",463:"31d6cfe0d16ae931b73c",464:"31d6cfe0d16ae931b73c",465:"31d6cfe0d16ae931b73c",466:"31d6cfe0d16ae931b73c",467:"52d3efd4280e0f27d748",468:"31d6cfe0d16ae931b73c",469:"31d6cfe0d16ae931b73c",471:"31d6cfe0d16ae931b73c",472:"31d6cfe0d16ae931b73c",473:"19365a883f7f9d283c6c",474:"b55de19a113ceb3c5ee8",475:"31d6cfe0d16ae931b73c",476:"31d6cfe0d16ae931b73c",477:"31d6cfe0d16ae931b73c",478:"289c93bbd4f6e9e361e9",479:"31d6cfe0d16ae931b73c",480:"31d6cfe0d16ae931b73c",481:"31d6cfe0d16ae931b73c",482:"31d6cfe0d16ae931b73c",483:"31d6cfe0d16ae931b73c",484:"31d6cfe0d16ae931b73c",485:"31d6cfe0d16ae931b73c",486:"31d6cfe0d16ae931b73c",487:"31d6cfe0d16ae931b73c",488:"31d6cfe0d16ae931b73c",489:"31d6cfe0d16ae931b73c",490:"31d6cfe0d16ae931b73c",491:"31d6cfe0d16ae931b73c",492:"31d6cfe0d16ae931b73c",493:"31d6cfe0d16ae931b73c",494:"3631b7e22c278feed375",495:"31d6cfe0d16ae931b73c",496:"31d6cfe0d16ae931b73c",497:"31d6cfe0d16ae931b73c",498:"31d6cfe0d16ae931b73c",500:"9e5b7d389911cd506858",501:"0f4314283b1911e5ab60",502:"31d6cfe0d16ae931b73c",503:"4bf2e976f827452432e7",504:"de71688b3f7ac29f27f4",505:"ab83bf328a897fca035d",506:"31d6cfe0d16ae931b73c",507:"31d6cfe0d16ae931b73c",508:"31d6cfe0d16ae931b73c",509:"31d6cfe0d16ae931b73c",510:"de71688b3f7ac29f27f4",511:"0a7203fd390c65ccf00a",512:"31d6cfe0d16ae931b73c",513:"31d6cfe0d16ae931b73c",514:"31d6cfe0d16ae931b73c",515:"31d6cfe0d16ae931b73c",516:"5f868262b1ad9e3cd561",517:"31d6cfe0d16ae931b73c",518:"31d6cfe0d16ae931b73c",519:"31d6cfe0d16ae931b73c",520:"31d6cfe0d16ae931b73c",521:"31d6cfe0d16ae931b73c",522:"31d6cfe0d16ae931b73c",523:"31d6cfe0d16ae931b73c",524:"31d6cfe0d16ae931b73c",525:"632e7fe388d262fdcd31",526:"cbd173d161012b84b3b2",527:"54c103d3f5c5a3589e31",528:"31d6cfe0d16ae931b73c",529:"31d6cfe0d16ae931b73c",530:"ff6238a0be18fbde5cbb",531:"31d6cfe0d16ae931b73c",532:"56d1f1871f0f2491ded3",533:"31d6cfe0d16ae931b73c",534:"31d6cfe0d16ae931b73c",535:"e8d8d5738b7fd03b6a0c",536:"31d6cfe0d16ae931b73c",537:"31d6cfe0d16ae931b73c",538:"31d6cfe0d16ae931b73c",539:"31d6cfe0d16ae931b73c",540:"31d6cfe0d16ae931b73c",541:"31d6cfe0d16ae931b73c",542:"31d6cfe0d16ae931b73c",543:"31d6cfe0d16ae931b73c",544:"31d6cfe0d16ae931b73c",545:"31d6cfe0d16ae931b73c",546:"31d6cfe0d16ae931b73c"}[e]+".chunk.v5.css",o=c.p+i,a=document.getElementsByTagName("link"),l=0;l<a.length;l++){var s=(d=a[l]).getAttribute("data-href")||d.getAttribute("href");if("stylesheet"===d.rel&&(s===i||s===o))return t()}var u=document.getElementsByTagName("style");for(l=0;l<u.length;l++){var d;if((s=(d=u[l]).getAttribute("data-href"))===i||s===o)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var i=t&&t.target&&t.target.src||o,a=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=i,delete r[e],p.parentNode.removeChild(p),n(a)},p.href=o,0!==p.href.indexOf(window.location.origin+"/")&&(p.crossOrigin="anonymous"),document.getElementsByTagName("head")[0].appendChild(p)})).then((function(){r[e]=0})));var n=o[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise((function(t,i){n=o[e]=[t,i]}));t.push(n[2]=i);var a,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=s(e),0!==l.src.indexOf(window.location.origin+"/")&&(l.crossOrigin="anonymous");var u=new Error;a=function(t){l.onerror=l.onload=null,clearTimeout(d);var n=o[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",u.name="ChunkLoadError",u.type=i,u.request=r,n[1](u)}o[e]=void 0}};var d=setTimeout((function(){a({type:"timeout",target:l})}),12e4);l.onerror=l.onload=a,document.head.appendChild(l)}return Promise.all(t)},c.m=e,c.c=i,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)c.d(n,i,function(t){return e[t]}.bind(null,i));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="",c.oe=function(e){throw console.error(e),e};var u=window.officehome_webpackJsonp=window.officehome_webpackJsonp||[],d=u.push.bind(u);u.push=t,u=u.slice();for(var p=0;p<u.length;p++)t(u[p]);var h=d;a.push([0,499]),n()}({"+2OL":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("serviceWorkerConfig")||{diskPreloadEnabled:!1,enabled:!1,pilotFlights:[],serviceWorkerAllowedFlights:[],scope:"",scriptUrl:""}}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},"+P5Z":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("p6wn"),r=n("hhzZ"),o=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[{provide:r.a,useClass:i.a}]}},e}()},"+YV+":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("lrJm"),r=n("OWzB"),o=n("4/We"),a=n("keVe"),l=function(){function e(e,t,n){this.createDocumentService=e,this.capabilitiesService=t,this.globalErrorHandler=n,this.init()}return e.prototype.init=function(){var e=this;this.createLinksPromise=this.createDocumentService.getCreateLinks(),this.createButtonEnabledPromise=new Promise((function(t){e.createLinksPromise.then((function(n){t(e.capabilitiesService.capabilities.createDocumentSupported&&n.length>0)})).catch((function(n){e.globalErrorHandler.handleError(n,"wmh4W"),t(!1)}))}))},e.ɵprov=a.cc({factory:function(){return new e(a.dc(r.a),a.dc(o.a),a.dc(i.b))},token:e,providedIn:"root"}),e}()},"+a0u":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"+ucO":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("bb6g"),r=n("dFxn"),o=n("uzn7"),a=n("cgnd"),l=n("/I02"),s=n("keVe"),c=function(){function e(t,n,i,r){this.localStorageService=t,this.contextService=n,this.configParserService=i,this.clientStartupConfig=r,this.config=i.parse("appGalleryConfig")||{numberOfBusinessApps:0,learnMoreLinks:[],resources:null,categoryId:"TipsAndTricks",workspaceBatches:!1},this.config.categoryId="TipsAndTricks",e.appCategoryRefreshLocalStorageDataKey+="_"+this.clientStartupConfig.config.tenantId+"_"+this.clientStartupConfig.config.puid,e.appCategoriesLocalStorageDataKey+="_"+this.clientStartupConfig.config.tenantId+"_"+this.clientStartupConfig.config.puid,e.appCategoriesOfficeMarketLocalStorageDataKey+="_"+this.clientStartupConfig.config.tenantId+"_"+this.clientStartupConfig.config.puid}return e.prototype.getCategory=function(){var t=this;return this.categoriesPromise||(this.categoriesPromise=new Promise((function(n){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t,r,o,a,l,s;return Object(i.__generator)(this,(function(i){return t=this.localStorageService.get(e.appCategoryRefreshLocalStorageDataKey)||0,r=(new Date).getTime()-t,o=this.contextService.sharedContext.officeMarket,a=this.localStorageService.get(e.appCategoriesOfficeMarketLocalStorageDataKey)||"",r<=864e5&&o===a&&(l=this.localStorageService.get(e.appCategoriesLocalStorageDataKey)||{}).Apps?[2,n(l)]:(s=this.configParserService.parse("appCategoryData")||{},this.saveToLocalStorage(o,s),n(s),[2])}))}))}))),this.categoriesPromise},e.prototype.saveToLocalStorage=function(t,n){this.localStorageService.set(e.appCategoryRefreshLocalStorageDataKey,(new Date).getTime()),this.localStorageService.set(e.appCategoriesOfficeMarketLocalStorageDataKey,t),this.localStorageService.set(e.appCategoriesLocalStorageDataKey,n)},e.appCategoryRefreshLocalStorageDataKey=e.appCategoryRefreshDataKey="AppCategoryRefresh",e.appCategoriesLocalStorageDataKey=e.appCategoriesDataKey="AppCategories",e.appCategoriesOfficeMarketLocalStorageDataKey=e.appCategoriesOfficeMarketDataKey="AppCategoryLanguage",e.ɵprov=s.cc({factory:function(){return new e(s.dc(o.a),s.dc(l.a),s.dc(r.a),s.dc(a.b))},token:e,providedIn:"root"}),e}()},"/6za":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("sharePointConfig")}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},"/I02":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("H90i"),r=n("dFxn"),o=n("hZW2"),a=n("Z0U4"),l=n("Ax7d"),s=n("4/We"),c=n("keVe"),u=n("jidT"),d=function(){function e(e,t,n,i,r,o){var a=this;this.capabilitiesService=e,this.cookieService=t,this.documentService=n,this.officeRouteService=i,this.webPwaService=r,this.sharedContext=o.parse("sharedContext")||{abtSignoutPath:null,activityLifetimeInSeconds:0,activityTrackingEnabled:!1,accessTokenMaxRetryAttempts:0,consumerShellServiceEndpoint:null,createButtonTextCompleteStopCount:0,createButtonTextEmptyStopCount:0,createButtonTextTypingSpeed:0,dataUpdateCooldownInSeconds:0,dataUpdateIntervalInSeconds:0,dataUpdateMaxConsecutiveFailures:0,dataUpdateTimeoutInSeconds:0,dateOverride:null,defaultLinkTarget:"_blank",fluentHeroImageUrl:null,graphApiRoot:null,graphMaxBatchSize:1,graphApiRootRefreshIntervalInSeconds:0,heroImageUrl:null,heroTitleGradientImageUrl:null,iceApplicationId:-1,inactivityTimeoutInSeconds:60,inMockMode:!1,metaResourcePath:null,msaAppId:null,msaTokenRedirectUrl:null,msaTokenTimeoutMs:0,officeHomeApiRoot:null,officeMarket:"en-us",officeMarketCountry:"us",officeMarketLcid:"1033",officeStartManifestVersion:null,oneDriveConsumerApi:null,oneDriveResourceId:null,oneDriveUrl:null,oneNoteCreateClassNoteBookUrl:null,outlookServiceRoot:null,portalRoot:null,recommendedIceApplicationId:-1,serviceWorkerIntervalUpdateEnabled:!1,sharePointResourceId:null,signOutRedirectUrl:null,signOutUrlTemplate:null,substrateSearchRoot:null,tokenLoginUrlTemplate:null,updateDataOnViewEnabled:!1,usingOneDriveResourceAsSharePointResource:!1,wacHostAppPrebootTimeout:0,wordPrebootUrl:null};var l=this.documentService.nativeDocument.getElementsByTagName("html");this.isRtl=l&&l[0]&&"rtl"===l[0].getAttribute("dir"),this.defaultLinkTarget=this.sharedContext.defaultLinkTarget,this.webPwaService.isStandalone.subscribe((function(e){a.isStandalone=e,a.sharedContext.defaultLinkTarget=e&&!a.webPwaService.isOfficeApp()?"_self":a.defaultLinkTarget}))}return e.prototype.getCsrfToken=function(){return this.cookieService.get("AjaxSessionKey")},e.prototype.getWdOrigin=function(e){return"OFFICECOM-"+this.getWdOriginApp()+"."+this.getWdOriginPage()+"."+e},e.prototype.getCurrentPageForLogging=function(){return this.officeRouteService.getCurrentPageForLogging()},e.prototype.getWdOriginApp=function(){return this.isStandalone?i.c.PWA:this.capabilitiesService.capabilities.antpLoaded?i.c.NTP:this.capabilitiesService.capabilities.pwaEnabled?i.c.HWA:this.capabilitiesService.capabilities.isEmbedMode?i.c.Embed:i.c.Web},e.prototype.getWdOriginPage=function(){var e=this.officeRouteService.getCurrentRoute();if(e)switch(e.route){case"Start":return i.d.Start;case"Templates":return i.d.Templates;case"Content":return i.d.Content;case"Search":return i.d.Search;default:return i.d.Home}return i.d.Home},e.ɵprov=c.cc({factory:function(){return new e(c.dc(s.a),c.dc(u.a),c.dc(o.a),c.dc(a.a),c.dc(l.a),c.dc(r.a))},token:e,providedIn:"root"}),e}()},0:function(e,t,n){n("xDq8"),e.exports=n("gmml")},"0XE2":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i,r=!1;function o(){return r||(i=!!document.getElementById("AppShellEnabled"),r=!0),i}},"0ZeC":function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.MarkTaskAsDone="MarkTaskAsDone",e.MarkAsNotATask="MarkAsNotATask",e.PromoteTask="PromoteTask",e.DismissAction="DismissAction",e.UndoTask="UndoTask"}(i||(i={}))},"1A1F":function(e,t,n){},"1Bt+":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("pd4Y"),n("uH9+"),n("PBJH");var i=function(){function e(e,t,n){this.dateService=e,this.locService=t,this.timestampFormatService=n}return e.prototype.transform=function(e,t,n,i){return e?(null==n&&(n=e.toDateString()),this.commonFormat(e,t,n,i)):""},e.prototype.commonFormat=function(e,t,n,i){if(!this.locService.supportsLocaleSpecifiers)return n;var r=this.dateService.timespanInSeconds(e);switch(this.timestampFormatService.getTimestampType(e)){case 9:return this.timespanString(r,this.locService.NumberMinutesInShort,-60);case 0:return"";case 1:return i?this.locService.JustNowLowerCase:this.locService.JustNow;case 2:return this.timespanString(r,this.locService.NumberMinutesAgoShort,60);case 3:return this.timespanString(r,this.locService.NumberHoursAgoShort,3600);case 4:return t?i?this.locService.YesterdayLowerCase:this.locService.Yesterday:this.locService.format(i?this.locService.TimeYesterdayLowerCase:this.locService.TimeYesterday,this.locService.formatTimeFromDate(e));case 5:return t?this.locService.localizedWeekday(e):this.locService.format(this.locService.TimeDayOfWeek,this.locService.localizedWeekday(e),this.locService.formatTimeFromDate(e));case 6:return this.locService.localizedMonthDate(e);default:return this.locService.localizedDateStringMedium(e)}},e.prototype.timespanString=function(e,t,n){var i=Math.round(e/n);return this.locService.format(t,this.locService.localizedNumberString(i))},e}()},"1GMS":function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g}));var i=n("keVe"),r=n("TOqr"),o=n("6wOV"),a=n("AY/E"),l=n("pzhl"),s=n("PkQn"),c=n("4/We"),u=n("cAxl"),d=n("3bNC"),p=i.xb({encapsulation:2,styles:[],data:{}});function h(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,"img",[],[[8,"src",4],[8,"title",0]],null,null,null,null)),i.yb(1,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"person-picture-upcoming-meeting__display":0,"person-picture__image":1,"person-picture__image--card":2}),i.yb(3,212992,null,0,o.a,[i.l,a.a],{upn:[0,"upn"]},null)],(function(e,t){var n=t.component,r=i.Gb(1,"person-picture__",n.iconSize,""),o=e(t,2,0,n.isUpcomingMeeting,!n.isUpcomingMeeting,n.personPictureCard);e(t,1,0,r,o),e(t,3,0,null==n.person?null:n.person.email)}),(function(e,t){var n=t.component;e(t,0,0,"data:image/png;base64,"+t.context.ngIf,i.Gb(1,"",null==n.person?null:n.person.fullName,""))}))}function f(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"ohp-icon-font",[["cssClass","upcomingMeeting-card__attendee_status_image"],["size","16"]],null,null,null,l.b,l.a)),i.yb(2,638976,null,0,s.a,[c.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,2,0,"upcomingMeeting-card__attendee_status_image",t.component.status,"16")}),null)}function m(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"div",[["aria-hidden","true"],["class","person-picture-upcoming-meeting__display"]],[[8,"title",0]],null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"div",[["class","person-picture-upcoming-meeting__text"]],null,null,null,null,null)),(e()(),i.Yb(2,null,[" "," "]))],null,(function(e,t){var n=t.component;e(t,0,0,i.Gb(1,"",null==n.person?null:n.person.fullName,"")),e(t,2,0,null==n.person?null:n.person.fullName.slice(0,1))}))}function b(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["aria-hidden","true"],["class","person-picture__image person-picture__image--icon"],["style","font-size: 24px;"]],[[8,"title",0]],null,null,null,null)),i.yb(1,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"person-picture__placeholder--padding--7":0}),(e()(),i.zb(3,0,null,null,1,"ohp-icon-font",[["iconFontName","Person"],["size","16"]],null,null,null,l.b,l.a)),i.yb(4,638976,null,0,s.a,[c.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null)],(function(e,t){var n=e(t,2,0,t.component.hasPadding);e(t,1,0,"person-picture__image person-picture__image--icon",n),e(t,4,0,"Person","16")}),(function(e,t){var n=t.component;e(t,0,0,i.Gb(1,"",null==n.person?null:n.person.fullName,""))}))}function v(e){return i.bc(0,[(e()(),i.ib(16777216,null,null,1,null,m)),i.yb(1,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,b)),i.yb(3,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component;e(t,1,0,n.isUpcomingMeeting),e(t,3,0,!n.isUpcomingMeeting)}),null)}function g(e){return i.bc(0,[(e()(),i.ib(16777216,null,null,2,null,h)),i.yb(1,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),i.Qb(131072,r.b,[i.h]),(e()(),i.ib(16777216,null,null,1,null,f)),i.yb(4,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(0,[["placeholder",2]],null,0,null,v))],(function(e,t){var n=t.component;e(t,1,0,i.Zb(t,1,0,i.Ob(t,2).transform(n.imageBase64Promise)),i.Ob(t,5)),e(t,4,0,"Accepted"===n.status||"Declined"===n.status||"TentativelyAccepted"===n.status)}),null)}i.vb("ohp-person-picture",u.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-person-picture",[],null,null,null,g,p)),i.yb(1,573440,null,0,u.a,[d.a],null,null)],null,null)}),{person:"person",pictureId:"pictureId",fetchImage:"fetchImage",imageBase64:"imageBase64",isUpcomingMeeting:"isUpcomingMeeting",status:"status",iconSize:"iconSize",hasPadding:"hasPadding",personPictureCard:"personPictureCard"},{},[])},"1Hgo":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("edgeworthConfig")}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},"1LNb":function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var i=n("bb6g"),r=n("BMb5"),o=n("hhzZ"),a=n("BaAg"),l=n("4/We"),s=n("cgnd"),c=n("/I02"),u=n("JH4S"),d=n("W3Zz"),p=n("hZW2"),h=n("dFxn"),f=n("keVe"),m=function(){function e(e){this.config=e.parse("feedbackConfig")}return e.ɵprov=f.cc({factory:function(){return new e(f.dc(h.a))},token:e,providedIn:"root"}),e}(),b=n("Z0U4"),v=n("Uqr9"),g=n("casz"),y=n("5aVq"),S=n("OtXi"),w=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p){this.capabilitiesService=e,this.deviceDetector=t,this.documentService=n,this.feedbackConfigService=i,this.instrumentationService=r,this.routeService=o,this.startupConfigService=a,this.userContextService=l,this.scheduler=s,this.windowService=c,this.shellShimService=u,this.contextService=d,this.wrapperVersion=p,this.feedbackScript="feedback-script",this.scriptLoadStarted=!1,this.initialize()}return e.prototype.getOCVTelemetryData=function(e){var t=this.startupConfigService.config.authType===s.a.MSA?this.startupConfigService.config.fixedConsumerTenantId:this.startupConfigService.config.tenantId,n=this.wrapperVersion?this.wrapperVersion.major+"."+this.wrapperVersion.minor+"."+this.wrapperVersion.build+"."+this.wrapperVersion.revision+"|":"";return{applicationGroup:{appData:JSON.stringify({userCategories:this.getUserCategories(),latency:e})},telemetryGroup:{deviceType:this.getDeviceType(),flights:this.startupConfigService.config.sharedClientStartupContext.flights,platform:this.deviceDetector.getDeviceInfo().platform.keyword,audienceGroup:"Production",officeBuild:n+this.startupConfigService.config.sharedClientStartupContext.buildId,tenantId:t},webGroup:{browser:this.deviceDetector.getDeviceInfo().browser.keyword,sourcePageName:this.getSourcePageName()}}},e.prototype.loadOCVFeedback=function(e){var t=this;"undefined"!=typeof OfficeBrowserFeedback&&(OfficeBrowserFeedback.initOptions.appId=this.getOcvAppId(),OfficeBrowserFeedback.initOptions.onDismiss=function(n){t.logDismissOCVFeedback(n),e&&e()},OfficeBrowserFeedback.multiFeedback||this.scriptLoadStarted?this.displayOCVFeedback("0"):this.addOCVScriptToPage((function(e){t.displayOCVFeedback(e.toString())})))},e.prototype.addOCVScriptToPage=function(e){var t=this,n=this.feedbackConfigService.config;return!!n&&(this.scriptLoadStarted||(this.scriptLoadStarted=!0,this.scheduler.scheduleWork((function(){var i=v.a.now();t.documentService.addScriptToPage(n.scriptUrl,(function(){var t=Math.ceil(v.a.now()-i);e(t)}),(function(){}),!0,t.feedbackScript,!0)}),4)),!0)},e.prototype.getOcvAppId=function(){return this.getSourcePageName()===this.feedbackConfigService.config.fluidContentPage?this.feedbackConfigService.config.fluidAppId:this.feedbackConfigService.config.appId},e.prototype.initialize=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r,o=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.currentPageView=this.getCurrentPageView(this.routeService.getCurrentRoute()),this.routeService.subscribeToRouteChangeStart((function(e){return o.currentPageView=o.getCurrentPageView(e.currentRoute)})),"undefined"==typeof OfficeBrowserFeedback||OfficeBrowserFeedback.initOptions||(e=this.feedbackConfigService.config,t=this.startupConfigService.config.sharedClientStartupContext,OfficeBrowserFeedback.initOptions={appId:void 0,stylesUrl:e.stylesUrl,intlUrl:e.intlUrl,environment:e.environment,sessionId:t.correlationId,build:t.buildId,locale:this.contextService.sharedContext.officeMarket,screenshot:e.screenshotEnabled,userEmail:e.autopopulateEmail?this.startupConfigService.config.userPrincipalName:""}),this.capabilitiesService.capabilities.shellFeedbackEnabled?(n=this.getOCVTelemetryData("0"),r=this,[4,this.shellShimService.getShellShim()]):[3,2];case 1:i.sent().NFD.OnFeedbackMetadataRequested((function(e,t){r.windowService.nativeWindow.OfficeBrowserFeedback.html2canvas(o.documentService.nativeDocument.body,{background:"#ffffff"})().then((function(e){t(e.toDataURL("image/jpeg"))}));var i=(e=e||{options:{telemetryGroup:{},webGroup:{}}}).options;i.appId=o.getOcvAppId(),i.userVoiceEnabled=!1,i.applicationGroup.appData=n.applicationGroup.appData,i.disableIncludeScreenshot=!1;var a=i.telemetryGroup;return a.audienceGroup=n.telemetryGroup.audienceGroup,a.featureArea=o.getSourcePageName(),a.flights=n.telemetryGroup.flights,a.processSessionId=r.startupConfigService.config.sharedClientStartupContext.correlationId,a.officeBuild=n.telemetryGroup.officeBuild,i.webGroup.sourcePageName=o.getSourcePageName(),e})),i.label=2;case 2:return[2]}}))}))},e.prototype.logDismissOCVFeedback=function(e){this.instrumentationService.logGenericEvent(e?"Feedback_OCV_Submitted":"Feedback_OCV_Dismissed",{})},e.prototype.displayOCVFeedback=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(t={}).Latency=e,this.capabilitiesService.capabilities.shellFeedbackEnabled?[4,this.shellShimService.getShellShim()]:[3,2];case 1:return i.sent().NFD.OpenFeedback(),[3,3];case 2:n=this.getOCVTelemetryData(e),OfficeBrowserFeedback.multiFeedback(n).then((function(){}),(function(e){t.Error=e,r.instrumentationService.logGenericEvent("Feedback_OCV_Error",t)})),i.label=3;case 3:return this.instrumentationService.logGenericEvent("Feedback_OCV_Click",t),[2]}}))}))},e.prototype.getDeviceType=function(){return this.deviceDetector.isDesktopDevice()?"Desktop":this.deviceDetector.isTabletDevice()?"Tablet":this.deviceDetector.isMobileDevice()?"Phone":"Laptop"},e.prototype.getSourcePageName=function(){return this.currentPageView},e.prototype.getUserCategories=function(){var e=[];return this.startupConfigService.config.authType===s.a.OrgId?e.push("Commercial"):this.startupConfigService.config.authType===s.a.MSA&&e.push("Consumer"),this.userContextService.user.isAdmin&&e.push("Admin"),this.userContextService.user.isEdu&&e.push("Edu"),this.userContextService.user.isEduStudent&&e.push("EduStudent"),this.userContextService.user.isEduFaculty&&e.push("EduFaculty"),this.userContextService.user.isSmb&&e.push("Smb"),this.userContextService.user.isDynamics&&e.push("Dynamics365"),this.userContextService.user.isFirstRelease&&e.push("FirstRelease"),e},e.prototype.getCurrentPageView=function(e){if(!e||!e.route)return"Unknown";switch(e.route){case"OfficeHome":return"Home_PageView";case"AppGallery":return"AppGallery_PageView";case"Search":case"SearchSiteScoped":case"SearchPersonScoped":return"Search_PageView";default:return""+(e.app?a.b[e.app]:"")+e.route}},e.ɵprov=f.cc({factory:function(){return new e(f.dc(l.a),f.dc(d.b),f.dc(p.a),f.dc(m),f.dc(o.a),f.dc(b.a),f.dc(s.b),f.dc(u.a),f.dc(g.a),f.dc(r.b),f.dc(y.a),f.dc(c.a),f.dc(S.a,8))},token:e,providedIn:"root"}),e}()},"1rn/":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("8/lW"),r=n("4CZh");function o(e,t,n,o){void 0===n&&(n={}),void 0===o&&(o=i.a.Security),n.Latency=t.toString(),Object(r.b)(e,"Performance_Dump",o,n,[],!0)}},"24t9":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.getKey=function(t){return e.KeysToKeyboardKeys[t.key]||e.KeyCodesToKeyboardKeys[t.keyCode]||0},e.KeysToKeyboardKeys={Tab:1,Enter:2,Shift:16,Esc:3,Escape:3,Up:4,ArrowUp:4,Down:5,ArrowDown:5,Spacebar:32," ":32,Zero:48,Nine:57,a:65,z:90,A:65,Z:90,"/":191},e.KeyCodesToKeyboardKeys={9:1,13:2,16:16,27:3,32:32,38:4,40:5,48:48,57:57,65:65,90:90,191:191},e}()},"2lMP":function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));var i=n("bb6g"),r=n("keVe"),o=n("RtYo"),a=n("6ib3"),l=n("bvSZ"),s=n("ZcZ3"),c=n("p3Wk"),u=n("zvoD"),d=(n("DQbD"),n("GmnP"),n("kaEK")),p=(n("uNUv"),n("0ZeC")),h=(n("dOgD"),n("OPwp")),f=(n("9gXN"),n("6u39"),n("dx17"),n("M56G"),n("1Bt+"),n("A/um")),m=n("hhzZ"),b=n("BaAg"),v=n("L/Tc"),g=n("QOOv"),y=n("JT1q"),S=(n("7Rc8"),n("fKR7")),w=(n("kpuN"),n("8EWw"),n("pd4Y"),n("W3Zz"),n("hZW2"),n("7Gwk"),n("Bc8L"),n("Z0U4"),n("n826"),n("EqbI"),n("Uqr9"),n("Xc4i"),n("TIi1"),n("Brer"),n("EUVs")),C=(n("BMb5"),n("hoyd"),n("4/We"),n("cgnd")),I=(n("/I02"),n("PBJH"),n("uUrA")),T=n("24t9"),k=n("WFKr"),A=n("ZBli"),P=n("H90i"),E=(n("kfAr"),n("7J/E"),n("bJUw")),_=n("lLc4"),O=n("bMT6"),F=function(){function e(t,n,o,a,l,s,c,u,d,f,m,v,g,y,S,w,I,T,k,A,P,E,_,O,F,D,M,R,x,L,N,U,W,B,z,j,H){var V=this;this.activityDescriptionService=t,this.capabilitiesService=n,this.clientStartupConfigService=o,this.contentActionsService=a,this.contextService=l,this.dateService=s,this.deviceDetector=c,this.documentService=u,this.domSanitizer=d,this.eventService=f,this.instrumentationService=m,this.localAppLauncherService=v,this.locService=g,this.mruConfigService=y,this.mruItemInflationService=S,this.mruItemService=w,this.officeFeedService=I,this.officeRouteService=T,this.oneDriveGraphService=k,this.onenoteService=A,this.performanceService=P,this.renderer=E,this.responsiveRelativeDatePipe=_,this.shareControlService=O,this.spacesService=F,this.thumbnailInstrumentationService=D,this.uploadLocalFileService=M,this.urlLauncherService=R,this.vroomService=x,this.uiHostBootstrapperService=L,this.wacContentService=N,this.windowService=U,this.workloadsService=W,this.mruDataService=B,this.fluidHostContext=z,this.fluidInstrumentationService=j,this.accessTokenService=H,this.leftAlignActionsMenu=!1,this.ShareControlMode=h.a,this.PotentialActionType=p.a,this.shareControlOutputs={dismiss:function(){return V.onShareControlDismiss(!0)}},this.MRU_ITEM_LOADING_STATE=0,this.MYA_ITEM_VIEW_STATE=2,this.MYA_ITEM_ADDED_STATE=0,this.getToDoUrl=function(){return Object(i.__awaiter)(V,void 0,void 0,(function(){var e,t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.workloadsPromise];case 1:return e=n.sent(),[2,null==(t=null==e?void 0:e.find((function(e){return"ShellToDo"===e.Id})))?void 0:t.Url]}}))}))},this.addItem=new r.n,this.deleteItem=new r.n,this.changePinState=new r.n;var q=this.mruConfigService.config;this.activityEnabled=q.activityEnabled,this.mobileMenusEnabled=this.capabilitiesService.capabilities.mobileContextMenusEnabled,this.isConsumer=this.clientStartupConfigService.config.authType===C.a.MSA,this.thumbnailApiEnabled=this.capabilitiesService.capabilities.thumbnailEndpointEnabled,this.actionContextMenuEnabled=this.capabilitiesService.capabilities.contentActionsEnabled&&this.capabilitiesService.capabilities.contentActionsOHomeEnabled,this.downloadActionEnabled=this.capabilitiesService.capabilities.downloadActionEnabled,e.applicationConversionMap||((e.applicationConversionMap=new Map).set(b.b.Word,{iconFontClass:q.wordIconFontClass,iconFontColor:"#185ABD",nativeUriScheme:"ms-word:ofe|u|"}),e.applicationConversionMap.set(b.b.Excel,{iconFontClass:q.excelIconFontClass,iconFontColor:"#107C41",nativeUriScheme:"ms-excel:ofv|ofc|u|"}),e.applicationConversionMap.set(b.b.Visio,{iconFontClass:q.visioIconFontClass,iconFontColor:"#4C68B1",nativeUriScheme:"ms-visio:ofe|u|"}),e.applicationConversionMap.set(b.b.PowerPoint,{iconFontClass:q.powerPointIconFontClass,iconFontColor:"#C43E1C",nativeUriScheme:"ms-powerpoint:ofe|u|"}),e.applicationConversionMap.set(b.b.OneNote,{iconFontClass:q.oneNoteIconFontClass,iconFontColor:"#7719AA",nativeUriScheme:"onenote:"}),e.applicationConversionMap.set(b.b.Sway,{iconFontClass:q.swayIconFontClass,iconFontColor:"#038387"}),e.applicationConversionMap.set(b.b.Forms,{iconFontClass:q.formsIconFontClass,iconFontColor:"#038387"}),e.applicationConversionMap.set(b.b.PowerBI,{iconFontClass:q.powerBIIconFontClass,iconFontColor:"#FFB900"}),e.applicationConversionMap.set(b.b.Stream,{iconFontClass:q.streamIconFontClass,iconFontColor:"#BC1948"}),e.applicationConversionMap.set(b.b.StreamsVideo,{iconFontClass:q.streamIconFontClass,iconFontColor:"#BC1948"}))}return e.prototype.ngOnInit=function(){var e=this;this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh,this.isMicrosoftForms=this.item.fileType===b.b.Forms||this.item.fileType===b.b.FormsQuiz,this.isMicrosoftForms&&this.initializeFormsFeature(),this.isFileCardEnabled=this.capabilitiesService.capabilities.fileHoverCardEnabled&&this.mruConfigService.config.fileCardSupportedFileTypes.includes(b.a.fileTypeNameFromType(this.item.fileType)),this.disableFileNavigation=this.item.isDeleted,this.mruItemStateSubscription=this.eventService.events.withScope(0).pipe(Object(u.a)((function(e){return"mruItemStateChange"===e.name}))).subscribe((function(t){t.args[1].docId===e.item.docId&&(0!==t.args[0]&&1!==t.args[0]||(e.mruItemState=t.args[0]))})),this.myAnalyticsState=2,this.uiCardType=this.isMicrosoftForms?"borderless":"normal",this.isCardCreateByLabel=this.isMicrosoftForms;var t=this.mruConfigService.config;this.shortDate=this.windowService.innerWidth<640,this.locService.supportsLocaleSpecifiers&&(this.dateSubscription=this.eventService.events.withScope(1).pipe(Object(u.a)((function(e){return"contentWidthChanged"===e.name}))).subscribe((function(t){var n;n=Object(i.__read)(t.args,1),e.shortDate=n[0]<640}))),this.thumbnailSWEnabled=t.thumbnailSWEnabled,this.permissionsEnabled=t.permissionsEnabled,this.sharedText=this.locService.SharedText,this.privateText=this.locService.OnlyYouText,this.shareActionTitle=this.locService.ShareActionTitle,this.copyLinkActionTitle=this.locService.CopyLinkActionTitle,this.suggestedActionsReplyTitle=this.locService.SuggestedActionReply,this.suggestedActionsMeetingTitle=this.locService.SuggestedActionJoinMeeting,this.suggestedActionsViewChangesTitle=this.locService.SuggestedActionViewChanges,this.suggestedActionsAddToToDoTitle=this.locService.AddToToDo,this.suggestedActionsViewTaskTitle=this.locService.SuggestedActionViewTask,this.dismissSquareRegular=this.domSanitizer.bypassSecurityTrustHtml(_),this.dismissSquareFilled=this.domSanitizer.bypassSecurityTrustHtml(E),this.checklistIcon=this.domSanitizer.bypassSecurityTrustHtml(O),this.pinActionTitle=this.locService.PinDocumentActionTitle,this.unpinActionTitle=this.locService.UnpinDocumentActionTitle,this.saveAClassNotebook=this.locService.SaveAClassNotebook,this.uploadLocalFileTitle=this.locService.UploadToOneDriveTitle,this.uploadAndOpen=this.locService.PwaUploadAndOpenMenuItem,this.isAntpExperience=this.capabilitiesService.capabilities.antpLoaded,this.isMobile=this.deviceDetector.isMobileDevice(),this.isTouch=this.isMobile||this.deviceDetector.isTabletDevice(),this.showMobileShareAndActivity=this.mruConfigService.config.mobileShareAndActivityEnabled,this.showOnlyMruActivity=this.item.format===S.a.Recent&&this.mruConfigService.config.onlyMruActivityEnabled,this.mruActivity=this.mruConfigService.config.mruActivityEnabled,this.recommendedDeepLinkEnabled=this.capabilitiesService.capabilities.recommendedDeepLinkEnabled,this.recommendedTeamsLinkEnabled=this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled,this.recommendedMotion=t.recommendedMotionEnabled&&!this.fluentRefresh,this.recommendedNewCards=t.recommendedNewCardsEnabled,this.isStreamsVideo=this.item.format===S.a.StreamsVideo,this.leftNavEnabled=this.capabilitiesService.capabilities.leftNavReact,this.spacesEnabled=this.capabilitiesService.capabilities.spacesEnabled,this.wacHostHoverPrebootEnabled=this.capabilitiesService.wacHostEnabledForFileType(this.item.fileType)&&this.capabilitiesService.wacHostHoverPrebootEnabledForFileType(this.item.fileType),this.dismissItemTitle=this.locService.RemoveDocumentActionTitle,this.isNewTitle=this.locService.IsNewTitle,this.addToSpaceLabel=this.locService.AddToSpaceLabel,this.newSpaceLabel=this.locService.NewSpaceLabel,this.mruAppSuffix=this.mruAppType?"-"+b.b[this.mruAppType].toLowerCase():"",this.upcomingMeetingAttendeeDisplayMax=t.upcomingMeetingAttendeeDisplayMax,this.addToToDoText=this.locService.AddToToDo,this.viewInToDoText=this.locService.ViewInToDo,this.doneText=this.locService.Done,this.notATaskText=this.locService.NotATask,this.workloadsPromise=this.workloadsService.getWorkloads(),this.workloadColorPromise=this.workloadsPromise.then((function(t){var n;return(null===(n=null==t?void 0:t.find((function(t){return t.FileType===e.item.fileType})))||void 0===n?void 0:n.Color)||""})),this.initializeItemFeatures()},e.prototype.ngOnChanges=function(e){var t=this;e.hasOwnProperty("item")&&(!e.hasOwnProperty("index")||this.isRecommended||this.isOfficeFeed)&&(this.initializeItemFeatures(),this.isStreamsVideo=this.item.format===S.a.StreamsVideo,this.thumbnailAltText=this.createThumbnailAltText(this.item.fileType)),!e.hasOwnProperty("view")||e.view.firstChange||"Tile"!==e.view.currentValue&&"Card"!==e.view.currentValue||this.isRecommended||this.isOfficeFeed||this.thumbnailLoaded||this.thumbnailUrl||this.mruItemInflationService.inflateThumbnails(this.item).then((function(){t.thumbnailUrl=t.getThumbnailUrl(),t.onThumbnailLoad(),t.thumbnailAltText=t.createThumbnailAltText(t.item.fileType)}))},e.prototype.ngOnDestroy=function(){this.dateSubscription&&this.dateSubscription.unsubscribe(),this.mruItemStateSubscription&&this.mruItemStateSubscription.unsubscribe(),this.removeShareControlListeners()},e.prototype.showAsListItem=function(){return void 0===this.view||"List"===this.view},e.prototype.showAsTile=function(){return"Tile"===this.view&&this.item.format!==S.a.Trending},e.prototype.showAsCard=function(){return"Card"===this.view||"Tile"===this.view&&this.item.format===S.a.Trending},e.prototype.showAsSuggestedAction=function(){return this.capabilitiesService.capabilities.suggestedActionsEnabled&&"SuggestedAction"===this.view},e.prototype.iconFontClass=function(){var t=e.applicationConversionMap.get(this.item.fileType);return t?t.iconFontClass:null},e.prototype.iconFontColor=function(){var t=e.applicationConversionMap.get(this.item.fileType);return t?t.iconFontColor:null},e.prototype.onItemClick=function(t){var r=this;if(this.disableFileNavigation)t.preventDefault();else if(!t.defaultPrevented){this.isOfficeFeed&&this.officeFeedService.logInstrumentation([this.item.feedbackId],["click"],[this.item.fromCache?"cache":"service"]),t.preventDefault();var o=Object(i.__read)(this.getLaunchUrlAndClickId(this.url),2),a=o[0],c=o[1],u=this.getClickData(t),d=u.params.ElementId||"Unknown";c&&(u.params.RequestId=c),u.params.IsEmailAttachment=this.item.isEmailAttachment?"true":"false",u.params.IsOnPremOrVanity=this.item.isOnPremOrVanity?"true":"false";var p=!1,h=function(t,n,i,o){if(!p){p=!0;var a=t?u.params.Referral:"";if(o&&(u.params.ClickDestination="ContentPage"),r.instrumentationService.logClickEvent(u.eventName,d,r.instrumentationArea,a,n,u.params,u.metrics,r.dataSecurityThreshold,i),e.isFirstClick&&!r.isRecommended){var l=r.performanceService.getRecordedMarkerNameBySubstring("Paint_MRU");l&&r.performanceService.mark("MRU_First_ItemClick",l),e.isFirstClick=!1}}};"_blank"!==this.contextService.sharedContext.defaultLinkTarget&&h(!0,"Web");var f=this.capabilitiesService.wacHostEnabledForFileType(this.item.fileType),m=this.capabilitiesService.capabilities.fluidSupportEnabled&&(this.item.fileType===b.b.Fluid||this.item.fileType===b.b.Spaces),v=b.b.Forms===this.item.fileType?"_self":"_blank",g=function(){if(r.capabilitiesService.capabilities.contentLauncherEnabled){var e="Recommended",i="Recommended_Click",o={app:r.item.application,attribution:r.item.attribution,docId:r.item.docId,driveId:r.item.driveId,extension:r.item.extension,id:r.item.id,title:r.item.title,url:r.item.url,webUrl:r.item.webUrl},c=Object(l.a)(o,i,0,"Click",e);Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(n){n.launchDocument(o,"REC",{area:e,eventName:i,elementId:r.item.id,linkTarget:t&&t.ctrlKey?"_blank":"_self",referral:Object(s.a)(r.item.fileType),clickParams:c})}))}else!function(){var e=(!r.item.isOnPremOrVanity||r.isConsumer)&&r.accessTokenService.hasOneDriveToken()||r.contextService.sharedContext.inMockMode;if(f&&e||m)if(t.ctrlKey){var i="/"+"launch/:app/content".replace(":app",b.b[r.item.fileType]),o=A.a.replacePathAndAddParams(r.windowService.nativeWindow.location.href,i,w.a.getParamsForMruFileItem(r.item,m?{siteUrl:r.item.sharepointIds.siteUrl}:{}));r.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(o,{action:"OpenMruItem",linkTarget:b.b.Forms===r.item.fileType?"_self":"_blank"}).then((function(){h(!0,"Web")}),(function(){h(!1)}))})):r.urlLauncherService.openUrl(o,"OpenMruItem",v).then((function(){h(!0,"Web")}),(function(){h(!1)}))}else{var l=Date.now();m&&(r.fluidInstrumentationService.logPerformanceBootStart(r.fluidHostContext.getBootId()),r.fluidHostContext.hostScenarioName="DocumentClick",r.fluidHostContext.hostScenarioStartTime=l),h(!0,"Web",!0,!0),f?r.wacContentService.bootstrapAndRouteMruFileItem(r.item,r.getWdOrigin(!1),void 0,l,r.inflationPromise):r.officeRouteService.navigateTo({route:"Content",app:r.item.fileType},!1,w.a.getParamsForMruFileItem(r.item,m?{siteUrl:r.item.sharepointIds.siteUrl}:{}))}else{if(r.item.fileType===b.b.Pdf&&!r.item.isEmailAttachment){var s=Object(y.i)(r.item);r.isRecommended&&(s.Application="PdfViewer",s.MruV2Type="DocumentUrl"),r.mruDataService.writeMruDocument(s)}var c=a||r.item.webUrl;r.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(c,{action:"OpenMruItem",linkTarget:r.isMicrosoftForms?"_self":void 0}).then((function(){h(!0,"Web")}),(function(){h(!1)}))})):r.urlLauncherService.openUrl(c,"OpenMruItem",r.isMicrosoftForms?"_self":null).then((function(){h(!0,"Web")}),(function(){h(!1)}))}}()};if(this.item.isEmailAttachment)g();else if(this.capabilitiesService.capabilities.contentLauncherEnabled){var S="Recommended",C="Recommended_Click",I={app:this.item.application,attribution:this.item.attribution,docId:this.item.docId,driveId:this.item.driveId,extension:this.item.extension,id:this.item.id,title:this.item.title,url:this.item.url,webUrl:this.item.webUrl},T=Object(l.a)(I,C,0,"Click",S);Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchDocument(I,"REC",{area:S,eventName:C,elementId:r.item.id,linkTarget:t&&t.ctrlKey?"_blank":"_self",referral:Object(s.a)(r.item.fileType),clickParams:T})}))}else this.localAppLauncherService.launchOfficeApp(this.item.application,this.item.canonicalUrl,null).then((function(e){return e||r.item.isLocal?e:(g(),!0)})).then((function(e){e?h(!0,"Native"):(r.openUploadLocalModal(1),h(!1))})).catch((function(){g()}))}},e.prototype.onPathClick=function(e){e.preventDefault(),this.openFolder();var t=this.getAttributionClickData();this.instrumentationService.logClickEvent(t.eventName,t.params.ElementId||"Unknown",this.instrumentationArea,t.params.Referral,this.item.isLocal?"Native":"Web",t.params,t.metrics,this.dataSecurityThreshold)},e.prototype.onMyAnalyticsClick=function(e,t){var n,i;e.preventDefault();var r=this.getClickData(e);this.instrumentationService.logClickEvent(r.eventName,r.params.ElementId||"Unknown",this.instrumentationArea);var o=e.target;this.officeFeedService.performAction(this.item.feedbackId,t,this.getActionPayLoadByName(t)),o===(null===(n=this.myAnalyticsAddToDoElement)||void 0===n?void 0:n.nativeElement)?(this.myAnalyticsState=0,this.actionContextMenuEnabled?(this.addToContextMenuReact(this.createViewInToDoActionItemReact()),this.removeFromContextMenuReact(this.addToToDoText)):(this.addToContextMenu(this.createViewInToDoActionItem()),this.removeFromContextMenu(this.addToToDoText)),this.showAsSuggestedAction&&this.setViewInToDoAsPrimaryAction()):o===(null===(i=this.myAnalyticsTaskDoneElement)||void 0===i?void 0:i.nativeElement)&&this.removeItem()},e.prototype.onViewToDoClick=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,r,o;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.getToDoUrl()];case 1:return t=i.sent(),r=new URL(t),o=""+r.origin+r.pathname+"/inbox"+r.search,this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(o,{action:"OpenToDoLink"})})):this.urlLauncherService.openUrl(o,"OpenToDoLink"),this.instrumentAction("open",e),[2]}}))}))},e.prototype.disableClick=function(){event.preventDefault()},e.prototype.onShareClick=function(e,t,n){var i=this;if(e&&e.preventDefault(),this.item.isLocal)this.openUploadLocalModal(2);else{if(this.shareControlMode=n,this.showDesktopShareControl=!this.mobileMenusEnabled,this.shareControlLoading=!0,this.currentShareSource=t,this.showDesktopShareControl){var r=function(e){if(!i.shareControlLoading&&i.showDesktopShareControl&&!(e instanceof MouseEvent&&2===e.button)){if(i.shareControl.nativeElement.contains(e.target))return;i.onShareControlDismiss(!1)}};this.shareControlClickListener=this.renderer.listen(this.documentService.nativeDocument,"click",r),this.shareControlTouchListener=this.renderer.listen(this.documentService.nativeDocument,"touchend",r),this.shareControlKeyListener=this.renderer.listen(this.documentService.nativeDocument,"keyup",(function(e){var t=T.a.getKey(e);i.showDesktopShareControl&&3===t&&i.onShareControlDismiss(!0)})),setTimeout((function(){return i.shareControlLoading=!1}),0)}this.mobileMenusEnabled&&(this.shareControlKeyboardFocus=e instanceof KeyboardEvent,this.shareControlService.showControl({file:this.item,index:this.index,mode:this.shareControlMode}),this.shareControlService.subscribeToCloseEvents((function(e){i.item===e.file&&i.index===e.index&&i.onShareControlDismiss(i.shareControlKeyboardFocus)}))),this.instrumentAction(h.a[n].toLowerCase()+"_"+t)}},e.prototype.onShareControlDismiss=function(e){this.showDesktopShareControl=!1,this.removeShareControlListeners(),e&&this.focusOnShareAction(),this.currentShareSource=""},e.prototype.pinItem=function(e,t){if(this.item.isLocal)return e&&e.preventDefault(),void this.openUploadLocalModal(0);this.updatePinnedState(!0,e,t)},e.prototype.unpinItem=function(e,t){this.updatePinnedState(!1,e,t)},e.prototype.onThumbnailLoad=function(){var e=this;setTimeout((function(){e.isStreamsVideo?(e.streamsThumbnailLoaded=!0,e.thumbnailLoaded=!1):(e.thumbnailLoaded=!0,e.streamsThumbnailLoaded=!1)})),this.thumbnailInstrumentationService.instrumentThumbnailLoad(!0,this.thumbnailUrl,this.listId,this.index,this.item.fileType)},e.prototype.onThumbnailError=function(){var e=this;setTimeout((function(){e.item.thumbnails=null,e.streamsThumbnailLoaded=!1,e.thumbnailLoaded=!1})),this.thumbnailInstrumentationService.instrumentThumbnailLoad(!1,this.thumbnailUrl,this.listId,this.index,this.item.fileType)},e.prototype.onActionsMenuToggle=function(e){this.actionsMenuOpen=e,this.recommendedMotion&&(this.isHovered="unhovered")},e.prototype.onFocus=function(){this.itemFocused=!0},e.prototype.onBlur=function(){this.itemFocused=!1},e.prototype.onAnalyticsDescriptionChanged=function(e){this.analyticsDescriptiveAriaLabel=e,this.setDescriptiveAriaLabel()},e.prototype.uploadLocal=function(e){var t=this;e&&e.preventDefault(),this.uploadLocalFileService.getLocalFileInfo(this.item.url,this.item.fileName).then((function(e){t.uploadLocalFileService.uploadFile(e,"upload-local-file-commanding")}))},e.prototype.recommendedHover=function(e){!this.actionsMenuOpen&&this.recommendedMotion&&(this.isHovered=e)},e.prototype.dismissHover=function(e){this.dismissIsHover=e},e.prototype.getWdOriginTaskForClick=function(e){return void 0===e&&(e=!1),this.isRecommended||this.isOfficeFeed?e?"REC-OIB":"REC":this.listId===g.a.unpinnedListId?e?"MRU-OIB":"MRU":"OTHER"},e.prototype.onSelectASpace=function(e){var t=e.item,i=""===t.getId(),r=this.createSpaceItemToAddToSpace();i?(Promise.all([n.e(6),n.e(0),n.e(1),n.e(7),n.e(8),n.e(9),n.e(10),n.e(11),n.e(14),n.e(17),n.e(20),n.e(21),n.e(24),n.e(36),n.e(482)]).then(n.bind(null,"2zXp")).then((function(e){e.showCreateSpacesDialog({item:r})})),this.instrumentAction("NewSpaceButton")):(this.spacesService.getSpacesStorageProvider().then((function(e){e.createAndAddItemToContainer(r,t.getId(),"Untitled")})),this.instrumentAction("AddToSpace"))},e.prototype.onCloseSpacesSubMenu=function(){this.collectionsSubMenuModel=null},e.prototype.onSelectPrimaryAction=function(e){e&&(e.preventDefault(),"id"in this.primaryAction?this.primaryAction.executeAction():this.primaryAction.executeAction(e))},e.prototype.removeItem=function(e){e&&e.preventDefault(),this.deleteItem.emit({item:this.item,index:this.index}),this.instrumentAction("remove")},e.prototype.suggestedActionsIcon=function(){return b.a.documentIconFromType(this.item.fileType,"20x20")},e.prototype.onSuggestedActionsClick=function(e,t,i,r,o){var a=this;void 0===o&&(o=!1);var l=function(){a.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(n){n.launchUrl(e||a.url,{action:t.toString()})})):a.urlLauncherService.openUrl(e||a.url,t),a.instrumentAction(i,r)};o?(this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(t){return t.launchApp(a.item.application,e||a.item.canonicalUrl,{action:"OpenDocument"})})):this.localAppLauncherService.launchOfficeApp(this.item.application,e||this.item.canonicalUrl,null)).then((function(e){e?a.instrumentAction("openInApp",r):l()})).catch((function(){l()})):l()},e.prototype.addToContextMenu=function(e,t){this.contextMenu&&-1===this.contextMenu.items.findIndex((function(t){return t.getId()===e.getId()}))&&(void 0!==t&&t>=0&&t<this.contextMenu.items.length?this.contextMenu.items.splice(t,0,e):this.contextMenu.items.push(e))},e.prototype.removeFromContextMenu=function(e){var t,n,i=this.contextMenu.items.findIndex((function(t){return t.title===e}));-1!==i&&(null===(n=null===(t=this.contextMenu)||void 0===t?void 0:t.items)||void 0===n||n.splice(i,1))},e.prototype.addToContextMenuReact=function(e,t){if(this.actionContextMenu){var n=this.actionContextMenu.actions.findIndex((function(t){return t.id===e.id}));-1===n&&(this.actionContextMenu.actions=void 0!==t&&t>=0&&t<this.contextMenu.items.length?this.actionContextMenu.actions.slice(0,n).concat(e,this.actionContextMenu.actions.slice(n,this.actionContextMenu.actions.length)):this.actionContextMenu.actions.concat(e))}},e.prototype.removeFromContextMenuReact=function(e){var t=this.actionContextMenu.actions.findIndex((function(t){return t.title===e}));-1!==t&&(this.actionContextMenu.actions=this.actionContextMenu.actions.slice(0,t).concat(this.actionContextMenu.actions.slice(t+1,this.actionContextMenu.actions.length)))},e.prototype.getDisplayTime=function(){return this.item.format===S.a.Shared||this.item.format===S.a.SharedForm?this.item.sharedTime>new Date("1980-01-01T00:00:00Z")?this.item.sharedTime:null:this.item.format===S.a.Trending||this.item.format===S.a.ClassNoteBook||this.item.format===S.a.NoteBook||this.item.format===S.a.Form||this.item.format===S.a.MyAnalytics?this.item.lastModifiedTime:this.item.lastViewedTime},e.prototype.openUploadLocalModal=function(e){this.uploadLocalFileService.showModal(this.item.url,this.item.fileName,e)},e.prototype.onAddToDoCallback=function(e,t,n){var i=this;void 0===e&&(e=!1),void 0===t&&(t=!0),t&&(this.capabilitiesService.capabilities.contentActionsEnabled&&(e?this.contentActionsService.createToDoSuccessNotification((function(){i.onViewToDoClick(n)})):this.contentActionsService.createToDoErrorNotification()),this.maybeAddViewTodo(e))},e.prototype.maybeAddViewTodo=function(e){e&&(this.myAnalyticsState=0,this.actionContextMenuEnabled?(this.addToContextMenuReact(this.createViewInToDoActionItemReact()),this.removeFromContextMenuReact(this.addToToDoText)):(this.addToContextMenu(this.createViewInToDoActionItem()),this.removeFromContextMenu(this.addToToDoText)),this.showAsSuggestedAction&&this.setViewInToDoAsPrimaryAction())},e.prototype.initializeItemFeatures=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return t=this.mruConfigService.config,this.showSharing=this.showSharing&&!(this.mruAppType===b.b.OneNote&&(S.a.Shared===this.item.format||S.a.ClassNoteBook===this.item.format||S.a.NoteBook===this.item.format))&&!(this.isMicrosoftForms&&this.item.format===S.a.Shared),this.isRecommended=this.item.format===S.a.Recommended,this.isOfficeFeed=this.item.format===S.a.News||this.item.format===S.a.OfficeFeedDocument||this.item.format===S.a.StreamsVideo||this.item.format===S.a.UpcomingMeeting||this.item.format===S.a.MyAnalytics,this.isNewsArticle=this.item.format===S.a.News,this.isUpcomingMeeting=this.item.format===S.a.UpcomingMeeting,this.isMyAnalytics=this.item.format===S.a.MyAnalytics,this.instrumentationArea=this.showAsSuggestedAction()?m.b.SuggestedActions:this.isRecommended||this.isOfficeFeed?m.b.Recommended:m.b.Documents,this.url=t.webUrlMruConsumerEnabled&&this.isConsumer&&this.item.webUrl?this.item.webUrl:this.item.url,n=this.item.fileType!==b.b.Sway&&this.item.fileType!==b.b.Project&&this.item.fileType!==b.b.ProjectOperations,r=k.a.Format(this.item.isEmailAttachment&&this.item.emailReference&&this.item.emailReference.Subject?[this.item.emailReference.Subject]:this.item.isEmailAttachment?[this.locService.OpenFileLocationActionTitle]:this.item.pathArray,this.contextService.isRtl,e.shortPathCharacterLimit),this.shortPath=n?r[1]:null,this.plainTextPath=n?r[0]:null,this.openFolderAriaLabel=this.item.isEmailAttachment?this.locService.OpenFileLocationActionTitle:this.locService.format(this.locService.OpenFileLocationActionWithLocationTitle,this.plainTextPath),this.displayTime=this.getDisplayTime(),this.displayTimeString=this.displayTime?this.locService.localizedDateString(this.displayTime):null,this.shareControlEnabled=t.shareControlEnabled&&this.item.fileType!==b.b.PowerBI&&this.item.fileType!==b.b.Project&&this.item.fileType!==b.b.ProjectOperations&&this.item.fileType!==b.b.Portfolio&&this.item.fileType!==b.b.Sway&&this.item.fileType!==b.b.Forms&&this.item.fileType!==b.b.StreamsVideo&&!(this.item.format===S.a.Shared&&this.item.isEmailAttachment)&&this.item.format!==S.a.UpcomingMeeting&&this.item.fileType!==b.b.MyAnalytics,this.copyLinkEnabled=t.copyLinkEnabled&&this.shareControlEnabled,this.mruPinEnabled=t.mruPinEnabled&&this.item.format===S.a.Recent,this.clickableFolderEnabled=t.clickableFolderEnabled&&!!this.item.attributionUrl,this.actionContextMenuEnabled?[4,this.setupActionsMenuReact()]:[3,2];case 1:return i.sent(),[3,3];case 2:this.setupActionsMenu(),i.label=3;case 3:return this.updateAnimation(this.item),this.setDescriptiveAriaLabel(),this.thumbnailLoaded=this.thumbnailUrl&&this.thumbnailUrl===this.getThumbnailUrl(),this.dataSecurityThreshold=this.item.isLocal?2:0,this.activityDeepLink=this.recommendedDeepLinkEnabled&&this.item.navigationId?this.addLoginHint(this.url+"&nav="+this.item.navigationId):void 0,this.teamsDeepLink=this.recommendedTeamsLinkEnabled&&this.item.teamsDeepLink,this.inflationPromise=this.mruItemInflationService.inflateItem(this.item,"Card"===this.view||"Tile"===this.view,this.showAnalytics,this.mruAppType),this.inflationPromise.then((function(e){o.updateAnimation(e),o.thumbnailUrl=o.getThumbnailUrl(),o.thumbnailLoaded=!!o.thumbnailUrl,o.setBorderlessCardDetail1(),o.setDescriptiveAriaLabel(),o.capabilitiesService.wacHostEnabledForFileType(o.item.fileType)&&o.item.wopiData&&o.item.wopiData.wac&&o.item.wopiData.wac.bootstrapperUrl&&o.uiHostBootstrapperService.loadBootstrapper(o.item.wopiData.wac.bootstrapperUrl,o.item.wopiData.wac.applicationUrl,o.item.fileType,!0).then((function(){"Start"===o.officeRouteService.getCurrentRoute().route&&o.wacContentService.prebootApplication(o.item.fileType,o.contextService.getWdOrigin("PREBOOT"))})),o.updateActionItemsOnInflated()})),[2]}}))}))},e.prototype.initializeFormsFeature=function(){this.isFormResponsesEnabled=this.mruAppType===b.b.Forms,this.formEnumType=this.item.getFormEnumType(),this.categoryIcon={},"poll"===this.formEnumType?(this.categoryIcon.categoryFontIcon=f.a.PollResults,this.categoryIcon.categoryTooltip=this.locService.FormsPoll):"assignments"===this.formEnumType&&(this.categoryIcon.categoryFontIcon=f.a.AccountActivity,this.categoryIcon.categoryTooltip=this.locService.FormsAssignment)},e.prototype.updateActionItemsOnInflated=function(){var e=this;this.mruItemService.updateActionItemsOnInflated(this.index,this.item,this.isConsumer).forEach((function(t){e.contextMenu.items=e.contextMenu.items.filter((function(e){return e.getId()!==t.item.id})),e.contextMenu.items.splice(t.start,t.deleteCount,e.wrapAdditionalAction(t.item))}))},e.prototype.setBorderlessCardDetail1=function(){this.isMicrosoftForms&&(this.borderlessCardDetail1=this.item.metaData&&null!=this.item.metaData.formsResponseCount?this.locService.format(this.locService.ResponsesText,this.item.metaData.formsResponseCount.toString()):"")},e.prototype.setDescriptiveAriaLabel=function(){var e=[this.locService.format(this.locService.DocumentDescriptiveAriaLabelTitle,this.item.title)];this.showSharing&&this.item.sharing&&e.push(this.locService.format(this.item.sharing.shared?this.locService.DocumentDescriptiveAriaLabelShared:this.locService.DocumentDescriptiveAriaLabelPrivate,this.item.fileTypeName));var t=this.buildDescriptiveDate();if(t&&e.push(t),this.showActivity&&!this.isRecommended&&!this.isOfficeFeed){var n=this.activityDescriptionService.activityDescription(this.item.activities,this.item.lastViewedTime,!1);e.push(n&&n.plainText?this.locService.format(this.locService.DocumentDescriptiveAriaLabelActivity,n.plainText):this.locService.DocumentDescriptiveAriaLabelNoActivity)}this.showAnalytics&&this.analyticsDescriptiveAriaLabel&&e.push(this.analyticsDescriptiveAriaLabel),this.isCardCreateByLabel&&(this.item.createdBy&&e.push(this.locService.format(this.locService.DocumentDescriptiveAriaLabelCreatedBy,this.item.createdBy)),this.item.metaData&&null!=this.item.metaData.formsResponseCount&&e.push(this.locService.format(this.locService.DocumentDescriptiveAriaLabelNumResponses,this.item.metaData.formsResponseCount.toString()))),this.descriptiveAriaLabel=e.join(" ")},e.prototype.buildDescriptiveDate=function(){var e=this.responsiveRelativeDatePipe.transform(this.displayTime,!1,this.displayTimeString,!1),t=e;if(e)switch(this.item.format){case S.a.Trending:t=this.locService.format(this.locService.DocumentDescriptiveAriaLabelLastModified,e);break;case S.a.Shared:t=this.locService.format(this.locService.DocumentDescriptiveAriaLabelDateShared,e);break;case S.a.Recommended:case S.a.News:case S.a.OfficeFeedDocument:t=this.item.activity&&this.item.activity.plainText?this.item.activity.plainText+e:"";break;default:t=this.locService.format(this.locService.DocumentDescriptiveAriaLabelLastOpened,e)}return t},e.prototype.focusOnShareAction=function(){"topLevel"===this.currentShareSource?this.shareTopLevelElement.nativeElement.focus():this.actionsMenuElement.dropdownMenu.dropdownLink.nativeElement.focus()},e.prototype.removeShareControlListeners=function(){this.shareControlClickListener&&this.shareControlClickListener(),this.shareControlTouchListener&&this.shareControlTouchListener(),this.shareControlKeyListener&&this.shareControlKeyListener()},e.prototype.updateAnimation=function(e){this.isNew=e.isNew,this.isNewAnimationState=this.isNew?"active":"inactive"},e.prototype.updatePinnedState=function(e,t,n){if(t&&t.preventDefault(),this.item.lastViewedTime=this.dateService.getCurrentDate(),this.displayTime=this.getDisplayTime(),this.displayTimeString=this.displayTime?this.locService.localizedDateString(this.displayTime):null,this.changePinState.emit({item:this.item,isPinned:e,element:this.mruListItem,index:this.index}),this.actionContextMenuEnabled){if(!("id"in this.pinAction)||!("id"in this.unpinAction))return;if(-1===(i=this.actionContextMenu.actions.findIndex((function(t){return t.id===(e?"pin":"unpin")}))))return;this.actionContextMenu.actions=this.actionContextMenu.actions.slice(0,i).concat(e?this.unpinAction:this.pinAction,this.actionContextMenu.actions.slice(i+1,this.actionContextMenu.actions.length))}else{if(!("getId"in this.pinAction)||!("getId"in this.unpinAction))return;var i;if(-1===(i=this.contextMenu.items.findIndex((function(t){return t.getId()===(e?"pin":"unpin")}))))return;this.contextMenu.items[i]=e?this.unpinAction:this.pinAction}this.instrumentAction((e?"pin":"unpin")+"_"+n),this.itemFocused=!1},e.prototype.setupActionsMenuReact=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r,o,a,l,s=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return e=this.mruConfigService.config,this.item.downloadUrl=this.item.documentUrl,t=this.showAsSuggestedAction()?"SuggestedActions":this.isRecommended||this.isOfficeFeed?"Recommended":"Documents",[4,this.contentActionsService.createDocumentActions(this.item,this.listId+"-"+this.item.id,t,this.listId)];case 1:return n=i.sent(),r=this.contentActionsService.getContentActionsGroupInfo(),this.item.isLocal&&(n=n.concat(this.createUploadActionItemReact())),this.spacesEnabled&&(o=this.createAddToSpacesActionItemReact(),this.capabilitiesService.capabilities.edgeworthReactEnabled?(a=n.length,this.getAllSpacesAsync().then((function(){s.addToContextMenuReact(o,a+(e.newMruActions?1:0))}))):n=n.concat(o)),this.item.format===S.a.Recent&&this.mruPinEnabled&&(this.createPinUnpinActionItemsReact(),n=n.concat(this.item.isPinned?this.unpinAction:this.pinAction)),!this.item.isLocal&&(this.item.format===S.a.Recent||(this.isRecommended||this.isOfficeFeed&&!this.isMyAnalytics)&&e.recommendedRemoveItemEnabled)&&(l=this.createRemoveActionItemReact(),n=n.concat(l)),this.item.format===S.a.ClassNoteBook&&(n=n.concat(this.createCopyClassNoteBookActionItemReact())),this.mruItemService.generateAdditionalActionsMenuItems(this.index,this.item,this.isConsumer).forEach((function(e){n=n.concat(s.wrapAdditionalActionReact(e))})),this.item.fileType===b.b.MyAnalytics&&this.item.potentialAction.forEach((function(e){var t=e.name,i=s.getTextByActionType(t);n=n.concat({id:t,title:i,ariaLabel:i,contentActionOptions:{icon:s.getIconReactByActionType(t)},executeAction:function(){s.officeFeedService.performAction(s.item.feedbackId,t,e.actionPayload).then((function(e){s.onAddToDoCallback(e,t===p.a.PromoteTask)})).catch((function(e){s.onAddToDoCallback(!1,t===p.a.PromoteTask)})),t!==p.a.DismissAction&&t!==p.a.MarkAsNotATask&&t!==p.a.MarkTaskAsDone||s.removeItem(),s.instrumentAction(t)},disabled:!1})})),this.actionContextMenu={id:this.getContextMenuId(),itemIndex:this.index,actions:n,groupInfo:r,mouseEvent:void 0,targetElement:void 0},this.showActionsMenu=n.length>0,this.contextMenu={id:this.getContextMenuId(),items:[]},this.showAsSuggestedAction()&&this.item.activity&&this.item.activity.reasonType&&this.setupPrimaryAction(),[2]}}))}))},e.prototype.setupActionsMenu=function(){var t,r,o=this,a=this.mruConfigService.config,l=e.applicationConversionMap.get(this.item.fileType),s=a.newMruActions&&l;if(this.item.isEmailAttachment){var c=this.item.format===S.a.OfficeFeedDocument||1===this.item.emailReference.AttachmentType?this.locService.OpenInOutlookActionTitle:this.locService.format(this.locService.OpenOnlineActionTitle,this.item.application);return r=[{getId:function(){return"open"},title:c,ariaLabel:c,iconCssClass:s?l.iconFontClass:"",icon:s?null:f.a.FolderOpen,iconColor:s?l.iconFontColor:null,executeAction:function(){o.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(o.url,{action:"OpenAttachment"})})):o.urlLauncherService.openUrl(o.url,"OpenAttachment"),o.instrumentAction("open")}}],this.shareControlEnabled&&1!==(null===(t=this.item.emailReference)||void 0===t?void 0:t.AttachmentType)&&this.getShareControlElements(r),(this.isRecommended||this.isOfficeFeed&&!this.isMyAnalytics)&&a.recommendedRemoveItemEnabled&&r.push(this.createRemoveActionItem()),this.showActionsMenu=!0,this.contextMenu={id:this.getContextMenuId(),items:r,customLogging:!0,cssClass:e.actionsMenuCssClass},this.primaryAction=r[0],void(this.primaryActionIconFont=f.a.FolderOpen)}if(r=[],this.disableFileNavigation||this.item.fileType===b.b.MyAnalytics||r.push({getId:function(){return"open"},title:this.isUpcomingMeeting?this.locService.OpenInCalendar:this.locService.OpenInBrowser,ariaLabel:this.isUpcomingMeeting?this.locService.OpenInCalendar:this.locService.OpenInBrowser,iconCssClass:s?l.iconFontClass:"",icon:s?null:this.isUpcomingMeeting?f.a.Calendar:f.a.FolderOpen,iconColor:s?l.iconFontColor:null,executeAction:this.item.isLocal?function(){return o.openUploadLocalModal(1)}:function(){var e,t=Object(i.__read)(o.getLaunchUrlAndClickId(null!==(e=o.item.webUrl)&&void 0!==e?e:o.url,!0),1)[0];o.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(t,{action:"OpenFile"})})):o.urlLauncherService.openUrl(t,"OpenFile"),o.instrumentAction("open")},disabled:this.item.isLocal}),this.item.isLocal&&r.push(this.createUploadActionItem()),this.spacesEnabled){var u=this.createAddToSpacesActionItem();if(this.capabilitiesService.capabilities.edgeworthReactEnabled){var d=r.length;this.getAllSpacesAsync().then((function(){o.addToContextMenu(u,d+(a.newMruActions?1:0))}))}else r.push(u)}this.shareControlEnabled&&(this.showDesktopShareControl=!1,this.getShareControlElements(r));var h,m=this.item.fileType!==b.b.PowerBI&&this.item.fileType!==b.b.Sway&&this.item.fileType!==b.b.OneNote&&this.item.fileType!==b.b.Forms&&this.item.fileType!==b.b.Project&&this.item.fileType!==b.b.ProjectOperations&&this.item.fileType!==b.b.Portfolio&&this.item.fileType!==b.b.StreamsVideo&&this.item.format!==S.a.UpcomingMeeting&&this.item.format!==S.a.MyAnalytics;if(a.newMruActions){if(l&&l.nativeUriScheme){var v=this.deviceDetector.isDesktopDevice()?this.locService.OpenInDesktopApp:this.deviceDetector.isMobileDevice()||this.deviceDetector.isTabletDevice()?this.locService.OpenInApp:this.locService.OpenActionTitle;r.splice(1,0,{getId:function(){return"openInApp"},title:v,ariaLabel:v,iconCssClass:s?l.iconFontClass:"",icon:s?null:f.a.FolderOpen,iconColor:s?l.iconFontColor:null,executeAction:function(){o.localAppLauncherService.launchOfficeApp(o.item.application,o.item.canonicalUrl).then((function(e){if(!e){if(!o.item.isLocal)throw new Error("fallback to protocol handler");var t=""+l.nativeUriScheme+o.item.canonicalUrl;o.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(t,{action:"OpenInApp",linkTarget:"_self"}).catch((function(){o.openUploadLocalModal(1)}))})):o.urlLauncherService.openUrl(t,"OpenInApp","_self").catch((function(){o.openUploadLocalModal(1)}))}})).catch((function(){var e=o.item.canonicalUrl.lastIndexOf("?"),t=o.item.canonicalUrl;e>0&&(t=t.substring(0,e));var i=""+l.nativeUriScheme+t;o.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(i,{action:"OpenInApp",linkTarget:"_self"})})):o.urlLauncherService.openUrl(i,"OpenInApp","_self")})),o.instrumentAction("openInApp")}})}this.downloadActionEnabled&&m&&a.showDownloadAction&&!this.item.isLocal&&this.item.format!==S.a.News&&this.item.fileType!==b.b.Fluid&&r.push({getId:function(){return"download"},title:this.locService.DownloadMruItemActionTitle,ariaLabel:this.locService.DownloadMruItemActionTitle,icon:f.a.Download,executeAction:function(){o.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(o.item.documentUrl,{action:"Download"})})):o.urlLauncherService.openUrl(o.item.documentUrl,"Download"),o.instrumentAction("download")}}),m&&r.push({getId:function(){return"openFileLocation"},title:this.locService.OpenFileLocationActionTitle,ariaLabel:this.openFolderAriaLabel,icon:f.a.Folder,executeAction:function(){o.openFolder(),o.instrumentAction("openFileLocation")}})}this.item.format===S.a.Recent&&this.mruPinEnabled&&(this.createPinUnpinActionItems(),h=this.item.isPinned?this.unpinAction:this.pinAction,a.newMruActions&&m?r.splice(r.length-(this.item.isLocal?1:2),0,h):r.push(h));if(!this.item.isLocal&&(this.item.format===S.a.Recent||(this.isRecommended||this.isOfficeFeed&&!this.isMyAnalytics)&&a.recommendedRemoveItemEnabled)){var g=this.createRemoveActionItem();a.newMruActions&&m?r.splice(r.length-1,0,g):r.push(g)}this.item.format===S.a.ClassNoteBook&&r.push(this.createCopyClassNoteBookActionItem()),this.mruItemService.generateAdditionalActionsMenuItems(this.index,this.item,this.isConsumer).forEach((function(e){return r.push(o.wrapAdditionalAction(e))})),this.item.fileType===b.b.MyAnalytics&&(r.push({getId:function(){return"open"},title:this.locService.OpenInOutlookActionTitle,ariaLabel:this.locService.OpenInOutlookActionTitle,icon:f.a.Outlook,executeAction:function(){var e,t=Object(i.__read)(o.getLaunchUrlAndClickId(null!==(e=o.item.webUrl)&&void 0!==e?e:o.url,!0),1)[0];o.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(t,{action:"OpenFile"})})):o.urlLauncherService.openUrl(t,"OpenFile"),o.instrumentAction("open")},disabled:!1}),this.item.potentialAction.forEach((function(e){var t=o.getTextByActionType(e.name),n=e.name;r.push({getId:function(){return n},title:t,ariaLabel:t,icon:o.getIconByActionType(e.name),executeAction:function(){o.officeFeedService.performAction(o.item.feedbackId,n,e.actionPayload).then((function(e){o.onAddToDoCallback(e,n===p.a.PromoteTask)})).catch((function(e){o.onAddToDoCallback(!1,n===p.a.PromoteTask)})),n!==p.a.DismissAction&&n!==p.a.MarkAsNotATask&&n!==p.a.MarkTaskAsDone||o.removeItem(),o.instrumentAction(n)},disabled:!1})}))),this.showActionsMenu=!(1===r.length&&"open"===r[0].getId()),this.contextMenu={id:this.getContextMenuId(),items:r,customLogging:!0,cssClass:(this.leftNavEnabled?"actions-menu--left-nav ":"")+e.actionsMenuCssClass+(this.isTouch&&(this.isRecommended||this.isOfficeFeed)?" actions-menu--mobile":"")},this.showAsSuggestedAction()&&this.item.activity&&this.item.activity.reasonType&&this.setupPrimaryAction()},e.prototype.setupPrimaryAction=function(){var e=this;switch(this.item.activity.reasonType){case d.a.MyAnalytics:this.primaryAction={title:this.addToToDoText,ariaLabel:this.addToToDoText,getId:function(){return"suggestedActionsAddToToDo"},executeAction:function(){e.officeFeedService.performAction(e.item.feedbackId,p.a.PromoteTask,e.getActionPayLoadByName(p.a.PromoteTask)).then((function(t){e.onAddToDoCallback(t,!0,"add_todo")})).catch((function(t){e.onAddToDoCallback(!1,!0,"add_todo")}))}},this.primaryActionIconFont=f.a.ToDo;break;case d.a.Task:this.primaryAction={title:this.suggestedActionsViewTaskTitle,ariaLabel:this.suggestedActionsViewTaskTitle,getId:function(){return"suggestedActionsViewTask"},executeAction:function(){return Object(i.__awaiter)(e,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return this.onSuggestedActionsClick(this.activityDeepLink,"OpenFile","open","view_task",!0),[2]}))}))}},this.showListSvg=!0;break;case d.a.Comment:case d.a.Mention:this.primaryAction={title:this.suggestedActionsReplyTitle,ariaLabel:this.suggestedActionsReplyTitle,getId:function(){return"suggestedActionsReply"},executeAction:function(){e.onSuggestedActionsClick(e.activityDeepLink,"OpenFile","open","reply",!0)}},this.primaryActionIconFont=f.a.Comment;break;case d.a.Edit:case d.a.Trending:this.primaryAction={title:this.suggestedActionsViewChangesTitle,ariaLabel:this.suggestedActionsViewChangesTitle,getId:function(){return"suggestedActionsViewChanges"},executeAction:function(){e.onSuggestedActionsClick(e.activityDeepLink,"OpenFile","open","view_changes",!0)}},this.primaryActionIconFont=f.a.Pencil;break;case d.a.Meeting:this.primaryAction={title:this.suggestedActionsMeetingTitle,ariaLabel:this.suggestedActionsMeetingTitle,getId:function(){return"suggestedActionsMeeting"},executeAction:function(){e.onSuggestedActionsClick(e.item.joinUrl,"OpenTeamsMeeting","join_meeting","upcoming_meeting")}},this.primaryActionIconFont=f.a.Calendar;break;default:this.primaryAction=this.actionContextMenuEnabled?this.actionContextMenu.actions[0]:this.contextMenu.items[0],this.primaryActionIconFont=f.a.Compass}},e.prototype.getTextByActionType=function(e){var t="";switch(e){case p.a.DismissAction:t=this.locService.RemoveDocumentActionTitle;break;case p.a.PromoteTask:t=this.addToToDoText;break;case p.a.MarkAsNotATask:t=this.notATaskText;break;case p.a.MarkTaskAsDone:t=this.doneText;break;default:t=""}return t},e.prototype.getIconByActionType=function(e){var t=f.a.ToDo;switch(e){case p.a.DismissAction:t=f.a.Minus;break;case p.a.PromoteTask:t=f.a.ToDo;break;case p.a.MarkAsNotATask:t=f.a.X;break;case p.a.MarkTaskAsDone:t=f.a.CheckMark;break;default:t=f.a.ToDo}return t},e.prototype.getIconReactByActionType=function(e){switch(e){case p.a.DismissAction:return{type:o.a.ActionContextMenuIcon,iconName:"SubtractIcon"};case p.a.PromoteTask:return{type:o.a.Svg,iconName:"ToDoSvgIcon"};case p.a.MarkAsNotATask:return{type:o.a.ActionContextMenuIcon,iconName:"DismissIcon"};case p.a.MarkTaskAsDone:return{type:o.a.ActionContextMenuIcon,iconName:"CheckmarkIcon"};default:return{type:o.a.Svg,iconName:"ToDoSvgIcon"}}},e.prototype.getIconReactByIconFontType=function(e){switch(e){case f.a.Copy:return{type:o.a.ActionContextMenuIcon,iconName:"CopyIcon"};case f.a.Delete:return{type:o.a.ActionContextMenuIcon,iconName:"DeleteIcon"};case f.a.Move:return{type:o.a.ActionContextMenuIcon,iconName:"MoveIcon"};case f.a.Restore:return{type:o.a.ActionContextMenuIcon,iconName:"RestoreIcon"};default:return{type:o.a.ActionContextMenuIcon,iconName:"DocumentIcon"}}},e.prototype.getShareControlElements=function(e){var t=this;e.push({getId:function(){return"share"},title:this.shareActionTitle,ariaLabel:this.shareActionTitle,icon:f.a.Share2,executeAction:function(e){t.onShareClick(e,"menu",h.a.Share)},disabled:this.item.isLocal}),this.copyLinkEnabled&&e.push({getId:function(){return"copylink"},title:this.copyLinkActionTitle,ariaLabel:this.copyLinkActionTitle,icon:f.a.Link,executeAction:function(e){t.onShareClick(e,"menu",h.a.CopyLink)},disabled:this.item.isLocal}),this.isAntpExperience||this.item.isOnPremOrVanity||this.shareControlService.getToken(this.item.documentUrl,!1,this.item.fileType)},e.prototype.createAddToSpacesActionItem=function(){var e=this;return{getId:function(){return"addToSpaces"},title:this.addToSpaceLabel,ariaLabel:this.addToSpaceLabel,icon:f.a.AddTo,executeAction:function(){e.instrumentAction("addTo_menu"),e.createCollectionsSubMenuModel()},disabled:!1}},e.prototype.createAddToSpacesActionItemReact=function(){var e=this;return{id:"addToSpaces",title:this.addToSpaceLabel,ariaLabel:this.addToSpaceLabel,contentActionOptions:{icon:{type:o.a.ActionContextMenuIcon,iconName:"AddIcon"}},executeAction:function(){e.instrumentAction("addTo_menu"),e.createCollectionsSubMenuModel()},disabled:!1}},e.prototype.createCopyClassNoteBookActionItem=function(){var e=this;return{getId:function(){return"copyClassNoteBook"},title:this.locService.SaveAClassNotebook,ariaLabel:this.saveAClassNotebook,icon:f.a.Save,executeAction:function(){e.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(t){t.launchUrl(e.onenoteService.generateSaveCopyClassNotebookLink(e.item.docId,e.item.fileName,e.url),{action:"CopyNotebook",linkTarget:"_NewSaveCopyWindow",width:500,height:500})})):e.urlLauncherService.openUrl(e.onenoteService.generateSaveCopyClassNotebookLink(e.item.docId,e.item.fileName,e.url),"CopyNotebook","_NewSaveCopyWindow",500,500),e.instrumentAction("copyClassNoteBook")}}},e.prototype.createCopyClassNoteBookActionItemReact=function(){var e=this;return{id:"copyClassNoteBook",title:this.locService.SaveAClassNotebook,ariaLabel:this.saveAClassNotebook,contentActionOptions:{icon:{type:o.a.ActionContextMenuIcon,iconName:"SaveIcon"}},executeAction:function(){e.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(t){t.launchUrl(e.onenoteService.generateSaveCopyClassNotebookLink(e.item.docId,e.item.fileName,e.url),{action:"CopyNotebook",linkTarget:"_NewSaveCopyWindow",width:500,height:500})})):e.urlLauncherService.openUrl(e.onenoteService.generateSaveCopyClassNotebookLink(e.item.docId,e.item.fileName,e.url),"CopyNotebook","_NewSaveCopyWindow",500,500),e.instrumentAction("copyClassNoteBook")},disabled:!1}},e.prototype.createPinUnpinActionItems=function(){var e=this;this.pinAction={getId:function(){return"pin"},title:this.pinActionTitle,ariaLabel:this.pinActionTitle,icon:f.a.PinDown,executeAction:function(){return e.pinItem(null,"menu")},disabled:this.item.isLocal},this.unpinAction={getId:function(){return"unpin"},title:this.unpinActionTitle,ariaLabel:this.unpinActionTitle,icon:f.a.Unpin,executeAction:function(){return e.unpinItem(null,"menu")},disabled:this.item.isLocal}},e.prototype.createPinUnpinActionItemsReact=function(){var e=this;this.pinAction={id:"pin",title:this.pinActionTitle,ariaLabel:this.pinActionTitle,contentActionOptions:{icon:{type:o.a.ActionContextMenuIcon,iconName:"PinIcon"}},executeAction:function(){return e.pinItem(null,"menu")},disabled:this.item.isLocal},this.unpinAction={id:"unpin",title:this.unpinActionTitle,ariaLabel:this.unpinActionTitle,contentActionOptions:{icon:{type:o.a.ActionContextMenuIcon,iconName:"UnpinIcon"}},executeAction:function(){return e.unpinItem(null,"menu")},disabled:this.item.isLocal}},e.prototype.createRemoveActionItem=function(){var e=this;return{getId:function(){return"remove"},title:this.locService.RemoveDocumentActionTitle,ariaLabel:this.locService.RemoveDocumentActionTitle,icon:f.a.Minus,executeAction:function(){return e.removeItem()}}},e.prototype.createRemoveActionItemReact=function(){var e=this;return{id:"remove",title:this.locService.RemoveDocumentActionTitle,ariaLabel:this.locService.RemoveDocumentActionTitle,contentActionOptions:{icon:{type:o.a.ActionContextMenuIcon,iconName:"SubtractIcon"}},executeAction:function(){return e.removeItem()},disabled:!1}},e.prototype.createUploadActionItem=function(){var e=this;return{getId:function(){return"upload"},title:this.uploadAndOpen,ariaLabel:this.uploadAndOpen,icon:f.a.Upload,executeAction:function(){e.uploadLocal()}}},e.prototype.createUploadActionItemReact=function(){var e=this;return{id:"upload",title:this.uploadAndOpen,ariaLabel:this.uploadAndOpen,contentActionOptions:{icon:{type:o.a.ActionContextMenuIcon,iconName:"UploadIcon"}},executeAction:function(){e.uploadLocal()},disabled:!1}},e.prototype.createViewInToDoActionItem=function(e){var t=this;return{getId:function(){return"todo"},title:this.viewInToDoText,ariaLabel:this.viewInToDoText,icon:f.a.ToDo,executeAction:function(){t.onViewToDoClick(e)},disabled:!1}},e.prototype.createViewInToDoActionItemReact=function(e){var t=this;return{id:"todo",title:this.viewInToDoText,ariaLabel:this.viewInToDoText,contentActionOptions:{icon:{type:o.a.Svg,iconName:"ToDoSvgIcon"}},executeAction:function(){t.onViewToDoClick(e)},disabled:!1}},e.prototype.setViewInToDoAsPrimaryAction=function(){this.primaryAction=this.createViewInToDoActionItem("view_todo"),this.primaryActionIconFont=f.a.ToDo},e.prototype.getContextMenuId=function(){return this.listId+"-"+this.item.id},e.prototype.getClickData=function(e){var t=this.showAsSuggestedAction()?"Suggested_Action_Click":this.isRecommended||this.isOfficeFeed?"Recommended_Click":"Mru_Click",n=this.item.getClickData(t,"Click",this.index),i=e.target;if(n.params.ItemId=this.titleElement&&i===this.titleElement.nativeElement?"title":this.fileIconElement&&i===this.fileIconElement.nativeElement?"icon":this.attributionElement&&i===this.attributionElement.nativeElement?"attribution":this.timestampElement&&i===this.timestampElement.nativeElement?"timestamp":this.myAnalyticsTaskDoneElement&&i===this.myAnalyticsTaskDoneElement.nativeElement?"taskDoneLink":this.myAnalyticsAddToDoElement&&i===this.myAnalyticsAddToDoElement.nativeElement?"addToDoLink":"item",void 0!==this.relativeIndex&&(n.params.RelativeIndex=this.relativeIndex.toString()),n.params.ItemCategory=this.listId,n.params.State=this.view,n.params.ResourceId=this.item.resourceId,this.activityEnabled){var r=this.item.activities||[],o=this.activityDescriptionService.filterActivities(r,this.item.lastViewedTime)||[];n.params.ActivityCommentsCount=o.filter((function(e){return e.action.type===v.a.Comment})).length.toString(),n.params.ActivityEditsCount=o.filter((function(e){return e.action.type===v.a.Edit})).length.toString(),n.params.ActivityMentionsCount=o.filter((function(e){return e.action.type===v.a.Mention})).length.toString(),n.params.ActivityTotalCount=r.length.toString(),n.params.ActivityCountSinceLastOpened=o.length.toString(),n.params.ActivityCollaboration=this.getActivityCollab(),n.params.ActivityDisplayed=v.a[this.activityDescriptionService.displayedActivityType(o,this.item.lastViewedTime,!1)]}return n.params.ClickDestination="ExternalPage",n},e.prototype.getAttributionClickData=function(){var e=this.item.getClickDataForPath("Mru_Path_Click","Click",this.index);return e.params.ItemCategory=this.listId,e.params.ResourceId=this.item.resourceId,e},e.prototype.instrumentAction=function(e,t){var n={};n.RenderSize=this.contextMenu.items.length.toString(),n.Index=this.index.toString(),n.DocumentType=this.item.fileTypeName,n.ItemCategory=this.listId,n.Pinned=this.item.isPinned.toString(),n.State=this.view,n.ResourceId=this.item.resourceId,n.ActivityCollaboration=this.getActivityCollab(),n.SuggestedActionType=t,void 0!==this.relativeIndex&&(n.RelativeIndex=this.relativeIndex.toString());var i,r=null;if("open"===e||"openInApp"===e?(r=S.b.referralFromFileType(this.item.fileType),i="open"===e?"Web":"Native"):"openFileLocation"===e&&(r=S.b.referralFromFileLocation(this.url),i=this.item.isLocal?"Native":"Web"),this.item.format===S.a.OfficeFeedDocument||this.item.format===S.a.News||this.item.format===S.a.UpcomingMeeting){var o="click";switch(e){case"copylink_menu":o="copyLink";break;case"share_menu":o="share"}"join_meeting"===e?this.officeFeedService.logInstrumentation([this.item.feedbackId],[o],[this.item.fromCache?"cache":"service"],["joinMeeting"]):"remove"!==e&&"myAnalyticsInsight"!==this.item.mruV2Category&&this.officeFeedService.logInstrumentation([this.item.feedbackId],[o],[this.item.fromCache?"cache":"service"])}this.instrumentationService.logClickEvent("Actions_Menu_Item_Click",e,this.instrumentationArea,r,i,n,[],this.dataSecurityThreshold)},e.prototype.getActivityCollab=function(){var e=this;return(this.isRecommended||this.isOfficeFeed)&&this.item.isCollab?"true":(this.item.activities||[]).some((function(t){return!e.activityDescriptionService.isCurrentUser(t.actor.user)})).toString()},e.prototype.getThumbnailUrl=function(){var t=this;if(!this.item.thumbnails)return null;if(this.isMicrosoftForms)return this.item.thumbnails.large;var n=e.acceptedThumbnailExtensions.includes(this.item.extension);return n&&this.item.format===S.a.StreamsVideo?(this.streamsVideoThumbnail=this.officeFeedService.getStreamsThumbnail(this.item.thumbnails.recommendedThumbnail),this.streamsVideoThumbnail.then((function(e){t.thumbnailUrlForSpace=e,t.onThumbnailLoad()})).catch((function(){t.onThumbnailError()})),null):n&&this.thumbnailApiEnabled&&!this.isNewsArticle?(this.thumbnail=(this.item.isMsftDogfood?this.vroomService:this.oneDriveGraphService).getThumbnailString(this.item.thumbnails.recommendedThumbnail),this.thumbnail.then((function(e){t.thumbnailUrlForSpace=e,t.onThumbnailLoad()})).catch((function(e){t.onThumbnailError()})),null):this.item.thumbnails?(this.onThumbnailLoad(),this.isRecommended||this.isOfficeFeed||this.item.format===S.a.Trending?this.item.thumbnails.recommendedThumbnail||this.item.thumbnails.large:this.item.thumbnails.medium):void this.onThumbnailError()},e.prototype.openFolder=function(){if(this.item.isLocal)this.localAppLauncherService.openPathInExplorer(this.item.attributionUrl);else{var e=this.isUpcomingMeeting?this.item.joinUrl:this.item.isEmailAttachment?this.url:this.item.attributionUrl;e=this.addLoginHint(e),this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(t){t.launchUrl(e,{action:"OpenFileLocation"})})):this.urlLauncherService.openUrl(e,"OpenFileLocation"),this.isUpcomingMeeting&&this.instrumentAction("join_meeting")}},e.prototype.getWdOrigin=function(e){return void 0===e&&(e=!1),this.contextService.getWdOrigin(this.getWdOriginTaskForClick(e))},e.prototype.addLoginHint=function(e){return this.item.shouldAddLoginHint()&&(e=A.a.appendLoginHint(e,this.clientStartupConfigService.config.loginHint,this.capabilitiesService.capabilities.outgoingLoginHintEnabled)),e},e.prototype.getLaunchUrlAndClickId=function(e,t){if(void 0===t&&(t=!1),e=this.addLoginHint(e),this.mruConfigService.config.addWacParams&&this.item.fileType!==b.b.Sway&&this.item.fileType!==b.b.Forms&&this.item.fileType!==b.b.Pdf&&this.item.fileType!==b.b.Fluid&&this.item.fileType!==b.b.PowerBI&&!this.item.isLocal&&!this.item.isOnPremOrVanity&&!this.item.isEmailAttachment&&this.item.format!==S.a.News){var n=Date.now(),r=I.a.createGuid(),o=this.capabilitiesService.capabilities.scenarioId,a=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({ct:n,wdOrigin:this.getWdOrigin(t)},this.isConsumer?{}:{cid:r}),this.item.fileType===b.b.Stream?{web:1}:{}),this.wacContentService.getWacHostControlQueryParams(this.item.fileType)),o?{wdscenarioid:o}:{});return[A.a.appendAndReplaceQueryParams(e,a,!0),r]}if(this.isMicrosoftForms){var l=this.officeRouteService.getCurrentRoute(),s=this.clientStartupConfigService.config.sharedClientStartupContext;return[A.a.appendAndReplaceQueryParams(e,{lang:this.contextService.sharedContext.officeMarket,origin:"prodprv"===s.deploymentEnvironment&&"scu"===s.geoName?P.b:P.a,route:l&&l.route?l.route:void 0,sessionId:this.clientStartupConfigService.config.sharedClientStartupContext.sessionId},!0),void 0]}return this.item.fileType===b.b.Stream?[A.a.appendQueryParam(e,"web","1"),void 0]:[e,void 0]},e.prototype.createThumbnailAltText=function(e){var t=this.locService.ThumbnailImageAltText;switch(e){case b.b.Word:return this.locService.format(t,this.locService.ThumbnailWordType);case b.b.Excel:return this.locService.format(t,this.locService.ThumbnailExcelType);case b.b.PowerPoint:return this.locService.format(t,this.locService.ThumbnailPowerPointType);case b.b.OneNote:case b.b.OneNoteClassNoteBook:return this.locService.format(t,this.locService.ThumbnailOneNoteType);case b.b.Pdf:return this.locService.format(t,this.locService.ThumbnailPdfType);case b.b.Visio:return this.locService.format(t,this.locService.ThumbnailVisioType);case b.b.Text:return this.locService.format(t,this.locService.ThumbnailTextType);case b.b.Sway:return this.locService.format(t,this.locService.ThumbnailSwayType);case b.b.Forms:return this.locService.format(t,this.locService.ThumbnailFormsType);case b.b.Project:case b.b.ProjectOperations:return this.locService.format(t,this.locService.ThumbnailProjectType);case b.b.Portfolio:return this.locService.format(t,this.locService.ThumbnailProjectPortfolioType);case b.b.NewsArticle:return this.locService.format(t,this.locService.ThumbnailNewsType);case b.b.PowerBI:return this.locService.format(t,this.locService.ThumbnailPowerBIType);default:return""}},e.prototype.createSpaceItemToAddToSpace=function(){var e,t,n,i,r,o,l,s;return{name:this.item.title,thumbnailUrl:this.isNewsArticle?null:null!==(e=this.thumbnailUrlForSpace)&&void 0!==e?e:this.thumbnailUrl,dataType:c.a.Document,fileType:null!==(t=a.a[b.b[this.item.fileType].toString()])&&void 0!==t?t:a.a.Word,documentProperties:{url:this.item.url,webUrl:null!==(n=this.item.webUrl)&&void 0!==n?n:"",attribution:this.plainTextPath,externalReference:{externalId:this.item.id,sharepointInfo:{sitePath:null===(i=this.item.sharepointIds)||void 0===i?void 0:i.siteUrl,uniqueId:null===(r=this.item.sharepointIds)||void 0===r?void 0:r.listItemUniqueId,siteId:null===(o=this.item.sharepointIds)||void 0===o?void 0:o.siteId,webId:null===(l=this.item.sharepointIds)||void 0===l?void 0:l.webId,listId:null===(s=this.item.sharepointIds)||void 0===s?void 0:s.listId},oneDriveInfo:{driveId:this.item.driveId,itemId:this.item.docId}},extension:b.a.getFileExtensionFromUrl(this.item.url)}}},e.prototype.createCollectionsSubMenuModel=function(){var e=this;this.getAllSpacesAsync().then((function(t){var n=[];n.push({title:e.newSpaceLabel,ariaLabel:e.newSpaceLabel,getId:function(){return""},icon:f.a.Add,executeAction:function(){console.log("New Space")}}),t.map((function(e){return n.push({title:e.name,ariaLabel:e.name,getId:function(){return e.id},executeAction:function(){console.log(e.name)}})})),e.collectionsSubMenuModel={id:"collections-sub-menu",items:n,rightAligned:!0}}))},e.prototype.getAllSpacesAsync=function(){return this.spacesService.getSpacesStorageProvider().then((function(e){return e.getAllSpacesAsync()}))},e.prototype.getActionPayLoadByName=function(e){var t;return null===(t=this.item.potentialAction.filter((function(t){return t.name===e}))[0])||void 0===t?void 0:t.actionPayload},e.prototype.wrapAdditionalAction=function(e){var t=this;return Object(i.__assign)(Object(i.__assign)({},e),{getId:function(){return e.id},executeAction:function(){t.instrumentAction(e.id),e.executeAction().then((function(e){e.forEach((function(e){switch(e.key){case"add":t.addItem.emit(e.props);break;case"delete":t.deleteItem.emit(e.props);break;case"disableAction":t.contextMenu.items=t.contextMenu.items.filter((function(t){return t.getId()!==e.props.id}))}}))}))}})},e.prototype.wrapAdditionalActionReact=function(e){var t=this;return{id:e.id,title:e.title,ariaLabel:e.ariaLabel,contentActionOptions:{icon:this.getIconReactByIconFontType(e.icon)},executeAction:function(){t.instrumentAction(e.id),e.executeAction().then((function(e){e.forEach((function(e){switch(e.key){case"add":t.addItem.emit(e.props);break;case"delete":t.deleteItem.emit(e.props);break;case"disableAction":t.contextMenu.items=t.contextMenu.items.filter((function(t){return t.getId()!==e.props.id}))}}))}))},disabled:e.disabled}},e.shortPathCharacterLimit=25,e.actionsMenuCssClass="actions-menu",e.acceptedThumbnailExtensions=["flac","m4a","mp3","opus","wma","dwg","cool","fbx","glb","obj","ply","stl","3mf","dcm","dcm30","dic","dicm","dicom","epub","htm","html","eml","msg","md","markdown","cur","ico","icon","mat","pict","psb","psd","webp","xbm","xcf","xpm","txt","bas","bash","bat","c","cbl","cfg","cmd","cpp","cs","css","csv","h","java","js","json","log","php","pl","ps1","py","rb","sh","sql","vb","xaml","yaml","yml","key","numbers","pages","sketch","xd","doc","docx","dot","dotx","dotm","odt","rtf","ods","xls","xlsb","xlsm","xlsx","xltx","odp","ppt","pptx","pptm","pot","potx","potm","pps","ppsx","ppsxm","pano","fppx","hcp","ai","epdf","pdf","pdfa","mts","m2ts","ts","3g2","3gp","3gp2","3gpp","asf","wmv","avi","m4v","mov","mp4","mp4v","ogg","webm","movie","mkv","mpg","mpeg","bmp","dib","rle","gif","jpeg","jpe","jpg","jfif","exif","png","tiff","tif","dng","wdp","jxr","hdp","dds","heic","heif","avci","heics","heifs","avcs","arw","cr2","crw","erf","kdc","mrw","nef","nrw","orf","pef","raf","raw","rw2","rwl","sr2","srw","3fr","ari","bay","cap","cr3","dcs","dcr","drf","eip","fff","iiq","k25","mef","mos","ori","ptx","pxn","srf","x3f"],e}()},"32VK":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"3GGT":function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Unknown=0]="Unknown",e[e.OK=200]="OK",e[e.Created=201]="Created",e[e.NoContent=204]="NoContent",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.RequestTimeout=408]="RequestTimeout",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RangeNotSatisfiable=416]="RangeNotSatisfiable",e[e.Locked=423]="Locked",e[e.Throttled=429]="Throttled",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.InsufficientStorage=507]="InsufficientStorage",e[e.UnexpectedResponse=700]="UnexpectedResponse",e[e.TokenRefreshFailed=701]="TokenRefreshFailed",e[e.TokenUnavailable=702]="TokenUnavailable",e[e.RetryFailed=703]="RetryFailed",e[e.AlternateResponse=704]="AlternateResponse",e[e.Cancelled=705]="Cancelled",e[e.Offline=706]="Offline",e[e.Timeout=707]="Timeout",e[e.DecryptionError=708]="DecryptionError",e[e.CacheMiss=709]="CacheMiss",e[e.EmptyResponse=710]="EmptyResponse"}(i||(i={}))},"3XMr":function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var i=n("bb6g"),r=n("2dXW"),o=n("SQAW"),a=n("1zhX"),l=n("3GGT"),s=n("hhzZ"),c=n("R7NL"),u=n("7ma0"),d=n("kpuN"),p=n("1Hgo"),h=n("uzn7"),f=n("wwmn"),m=n("Uqr9"),b=n("casz"),v=n("BMb5"),g=n("pOWU"),y=n("cgnd"),S=n("/I02"),w=n("uUrA"),C=n("ksTh"),I=n("IA5y"),T=n("keVe"),k=n("TOqr"),A=function(e){function t(t,n,i,o,a,l,s,c,u,d,p,h){var f=e.call(this,o,i,l,"Substrate",a,s,c,d)||this;f.localStorageService=t,f.windowService=n,f.instrumentationService=i,f.aadAppId=p,f.syncTimestampStorageKey=C.d+"."+f.windowService.nativeWindow.ewDbVersion,f._syncTimestampUpdated=new r.a,f.initialFullSyncCompleted=!1,f.startupConfig=u.config;var m=h.config;if(m){var b=0===m.substrateApiEndpoint.indexOf("/")?""+f.windowService.nativeWindow.location.origin+m.substrateApiEndpoint:m.substrateApiEndpoint;f.endpoint=""+b+m.edgeworthApiRootPath+m.deltaSyncApiPath+"?"+C.c+f.contextService.sharedContext.officeMarket}return f}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"syncTimestampUpdated",{get:function(){return this._syncTimestampUpdated.asObservable()},enumerable:!0,configurable:!0}),t.prototype.syncDocuments=function(){var e=this;return this.serverSyncTimestamp=null,new o.a((function(t){!function(){Object(i.__awaiter)(e,void 0,void 0,(function(){var e,n,r,o,a,s,c,u,d,p,h,f,b,v,g,y,S,C;return Object(i.__generator)(this,(function(I){switch(I.label){case 0:e=m.a.now(),n=new URL(this.endpoint),r=this.readLastSyncTimestamp(),o=w.a.createGuid(),r&&n.searchParams.append("startDateTime",r),a=n.toString(),s=1,c=0,I.label=1;case 1:u=void 0,I.label=2;case 2:return I.trys.push([2,4,,5]),[4,this.getPage(a,s,o)];case 3:return u=I.sent(),[3,5];case 4:return d=I.sent(),t.error(d),[2];case 5:return h=u.nextPageLink,f=u.hasFailures,b=u.version,(null==(p=u.items)?void 0:p.length)&&!this.serverSyncTimestamp&&(c+=p.length,v=Object(i.__read)(p,1),g=v[0],this.serverSyncTimestamp=2===b?g.last_store_modified_datetime:g.last_recommended_modified_datetime),t.next({items:p,hasPluginFailures:f}),!(y=h?this.endpoint+"&"+h:void 0)||a===y||s>40?[3,6]:(++s,a=y,[3,1]);case 6:return this.initialFullSyncCompleted||(S=m.a.now(),this.instrumentationService.logRequestEvent("EdgeworthFullSyncRequest",l.a.OK,S-e,null,!1,((C={}).ActualSize=c.toString(),C.ItemId=o,C.ItemCount=s.toFixed(),C)),this.initialFullSyncCompleted=!0),t.complete(),[2]}}))}))}()})).pipe(Object(a.a)(1))},t.prototype.markSyncCompleted=function(){if(this.serverSyncTimestamp){var e=this.getStorageKey();this.localStorageService.set(e,this.serverSyncTimestamp),this._syncTimestampUpdated.next(),this.serverSyncTimestamp=null}},t.prototype.resetTimestamp=function(){this.serverSyncTimestamp=null,this.localStorageService.remove(this.getStorageKey())},t.prototype.handleQueryParam=function(e,t,n){"mockmru"===e&&this.mockRequestHeader&&n.headers.set(this.mockRequestHeader,t)},t.prototype.readLastSyncTimestamp=function(){var e=this.getStorageKey();return this.localStorageService.get(e)},t.prototype.getPage=function(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r=this;return Object(i.__generator)(this,(function(i){return[2,new Promise((function(i,o){r.get("EdgeworthSubstrateDeltaSyncPageRequest",e,(function(e){e.instrument((function(e,i){var o;i.params.ActualSize=((null===(o=null==e?void 0:e.data)||void 0===o?void 0:o.files)?e.data.files.length:-1).toString(),i.params.RequestId=r.getRequestIdFromResponse(e),i.params.Index=t.toFixed(),i.params.ImpressionId=n,i.params.DebugInfo=Object(I.f)(e)})).then((function(e){var t,n,o,a,l=!(null===(t=e.data)||void 0===t?void 0:t.is_complete);i({items:r.parse(e.data.files||[]),nextPageLink:e.data.next_page_link,hasFailures:l,version:parseInt(null===(a=null===(o=null===(n=e.data)||void 0===n?void 0:n.diagnostics_data)||void 0===o?void 0:o.extended_info)||void 0===a?void 0:a.Version)||0}),r.scheduler.scheduleWork((function(){var t,n=(null===(t=e.data.files)||void 0===t?void 0:t.filter((function(e){return e.is_deleted})).map((function(e){return new Promise((function(t,n){r.scheduler.scheduleWork((function(){var i;null===(i=r.windowService.nativeWindow.ewIdb)||void 0===i||i.deleteItem(e.id).then(t).catch(n)}),4)}))})))||[];Promise.all(n).catch((function(e){var t,n;r.instrumentationService.logGenericEvent("Edgeworth_Cache_Delete_Error",((t={}).Error=(null===(n=null==e?void 0:e.toString)||void 0===n?void 0:n.call(e))||"",t))}))}),4)}))}),o,Object(I.a)(r.startupConfig.objectId+"@"+r.startupConfig.tenantId,r.contextService.sharedContext.recommendedIceApplicationId.toString(),r.startupConfig.objectId,r.aadAppId,w.a.createGuid(),r.contextService.getCurrentPageForLogging()),"network-only")}))]}))}))},t.prototype.parse=function(e){return e.map((function(e){var t=e.user_relationship,n=e.activities?e.activities.map((function(e){var t;try{t=JSON.parse(e.a)}catch(t){console.log("Error parsing activity: "+e.a)}return Object(i.__assign)(Object(i.__assign)({},e),{t:new Date(e.t),da:Object(i.__assign)(Object(i.__assign)({},e.da),{t:new Date(e.da.t)}),a:t})})):[],r=e.activity_badge?Object(i.__assign)(Object(i.__assign)({},e.activity_badge),{timestamp:e.activity_badge.timestamp?new Date(e.activity_badge.timestamp):void 0}):void 0;return Object(i.__assign)(Object(i.__assign)({},e),{last_recommended_modified_datetime:e.last_recommended_modified_datetime,last_store_modified_datetime:e.last_store_modified_datetime,user_relationship:Object(I.i)(t),activities:n,activity_badge:r,created_datetime:Object(I.j)(e.created_datetime),creation_info:e.creation_info?Object(i.__assign)(Object(i.__assign)({},e.creation_info),{timestamp:Object(I.j)(e.creation_info.timestamp)}):null,indexed:!1})}))},t.prototype.getStorageKey=function(){return this.syncTimestampStorageKey},t.ɵprov=T.cc({factory:function(){return new t(T.dc(h.a),T.dc(v.b),T.dc(s.a),T.dc(d.b),T.dc(S.a),T.dc(c.a),T.dc(f.a),T.dc(k.q),T.dc(y.b),T.dc(b.a),T.dc(u.a),T.dc(p.a))},token:t,providedIn:"root"}),t}(g.a)},"3anA":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("A/um"),r=function(){function e(){}return e.getCssClass=function(t,n){return e.getCssClassFromGlyphName(i.a[t],n)},e.getCssClassFromGlyphName=function(t,n){var i=e.iconTypeToCssClass[t];return n&&(i=i+" "+e.SvgIconCssClass),i||"ms-Icon--placeholder"},e.FluentIconCssClass="ms-ohp-Icon",e.SvgIconCssClass="ms-ohp-svg-Icon",e.iconTypeToCssClass={Accepted:"ms-ohp-Icon--accepted",Access:"ms-ohp-Icon--accessLogo",AccountActivity:"ms-ohp-Icon--accountActivity",Add:"ms-ohp-Icon--add",AddTo:"ms-ohp-Icon--addTo",Alert:"ms-ohp-Icon--alert",ArrowLeft:"ms-ohp-Icon--back",ArrowRight:"ms-ohp-Icon--forward",At:"ms-ohp-Icon--accounts",Attach:"ms-ohp-Icon--attach",Calendar:"ms-ohp-Icon--calendar",ContactCardSettings:"ms-ohp-Icon--contactCardSettings",Chat:"ms-ohp-Icon--chatSolid",CheckMark:"ms-ohp-Icon--checkMark",ChevronDown:"ms-ohp-Icon--chevronDown",ChevronLeft:"ms-ohp-Icon--chevronLeft",ChevronRight:"ms-ohp-Icon--chevronRight",ChevronUp:"ms-ohp-Icon--chevronUp",CircleFill:"ms-ohp-Icon--circleFill",CircleInfo:"ms-ohp-Icon--circleInfo",Comment:"ms-ohp-Icon--chat",Compass:"ms-ohp-Icon--compassNW",Copy:"ms-ohp-Icon--copy",Declined:"ms-ohp-Icon--declined",Delete:"ms-ohp-Icon--delete",Devices3:"ms-ohp-Icon--devices3",Diamond:"ms-ohp-Icon--diamond",Document:"ms-ohp-Icon--page",Download:"ms-ohp-Icon--download",Ellipsis:"ms-ohp-Icon--moreVertical",Excel:"ms-ohp-Icon--excelLogo",FavoriteStar:"ms-ohp-Icon--favoriteStar",Filter:"ms-ohp-Icon--filter",FilterSolid:"ms-ohp-Icon--filterSolid",Folder:"ms-ohp-Icon--folder",FolderOpen:"ms-ohp-Icon--openFolderHorizontal",GiftCard:"ms-ohp-Icon--giftCard",Glimmer:"ms-ohp-Icon--glimmer",Group:"ms-ohp-Icon--group",Hide:"ms-ohp-Icon--hide",HighLander:"ms-ohp-Icon--highLanderLogo",Home:"ms-ohp-Icon--home",Link:"ms-ohp-Icon--link",ListBullets:"ms-ohp-Icon--list",Location:"ms-ohp-Icon--location",Mail:"ms-ohp-Icon--mail",Minus:"ms-ohp-Icon--remove",Move:"ms-ohp-Icon--moveToFolder",News:"ms-ohp-Icon--newsfeedLogo",OfficeForms:"ms-ohp-Icon--formsLogo",Office:"ms-ohp-Icon--officeLogo",Office2:"ms-ohp-Icon--officeLogo2",OfficeStore:"ms-ohp-Icon--officeStore",OfficeThreshold:"ms-Icon--officeThreshold",OneDrive:"ms-ohp-Icon--oneDriveLogo",Outlook:"ms-ohp-Icon--outlookLogo",Onenote2:"ms-ohp-Icon--onenoteLogo",Page:"ms-ohp-Icon--page",Pencil:"ms-ohp-Icon--edit",PencilSolid:"ms-ohp-Icon--editSolid",People2:"ms-ohp-Icon--people",Permissions:"ms-ohp-Icon--permissions",Person:"ms-ohp-Icon--person",PhotoVideoMedia:"ms-ohp-Icon--photoVideoMedia",PinDown:"ms-ohp-Icon--pinned",PlayerSettings:"ms-ohp-Icon--playerSettings",PollResults:"ms-ohp-Icon--pollResults",PowerBI:"ms-ohp-Icon--powerBILogo",PowerPoint:"ms-ohp-Icon--powerpointLogo",Preview:"ms-ohp-Icon--preview",PreviewLink:"ms-ohp-Icon--previewLink",Project:"ms-ohp-Icon--projectLogo",Publisher:"ms-ohp-Icon--publisherLogo",Question:"ms-ohp-Icon--question",Restore:"ms-ohp-Icon--revToggleKey",Save:"ms-ohp-Icon--save",Search:"ms-ohp-Icon--search",Settings:"ms-ohp-Icon--settings",Share2:"ms-ohp-Icon--share",SharePoint:"ms-ohp-Icon--sharepointLogo",SkypeForBusiness:"ms-ohp-Icon--skypeForBusinessLogo",SortDown:"ms-ohp-Icon--sortDown",SortUp:"ms-ohp-Icon--sortUp",Stream:"ms-ohp-Icon--streamLogo",Sync:"ms-ohp-Icon--sync",Sway:"ms-ohp-Icon--swayLogo",Task:"ms-ohp-Icon--tasksLogo",Teams:"ms-ohp-Icon--teamsLogo",TentativelyAccepted:"ms-ohp-Icon--tentativelyAccepted",TextDocument:"ms-ohp-Icon--textDocument",ToDo:"ms-ohp-Icon--toDoLogoInverse",TileView:"ms-ohp-Icon--viewAll",Trending:"ms-ohp-Icon--trending12",Unfavorite:"ms-ohp-Icon--unfavorite",Unpin:"ms-ohp-Icon--unpin",Upload:"ms-ohp-Icon--upload",Video:"ms-ohp-Icon--video",Visio:"ms-ohp-Icon--visioLogo",Waffle:"ms-ohp-Icon--waffle",Word:"ms-ohp-Icon--wordLogo",X:"ms-ohp-Icon--cancel",X2:"ms-ohp-Icon--cancel"},e}()},"3bNC":function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var i=n("bb6g"),r=n("lrJm"),o=n("hhzZ"),a=n("R7NL"),l=n("4/We"),s=n("/I02"),c=n("kpuN"),u=n("aQ3G"),d=n("wwmn"),p=n("casz"),h=n("keVe"),f=n("TOqr"),m=function(e){function t(t,n,i,r,o,a,l,s,c){var u=e.call(this,n,i,r,o,a,l,s,c)||this;return u.cache=new Map,u.batchEnabled=t.capabilities.batchGraphEnabled,u}return Object(i.__extends)(t,e),t.prototype.getPeoplePictures=function(e){var t=this;if(this.batchEnabled)return new Promise((function(n,i){var r=e.map((function(e){return{eventName:"OneDrive_Graph_People_Picture_Request",endpoint:"users/"+e+"/photo/$value",method:"GET",cacheResult:!0}}));t.batchGraph(r,"OneDrive_Graph_Batch_People_Pictures_Request").then((function(e){n((e||[]).map((function(e){return e&&e.ok?e.data:null})))}),i)}));for(var n=[],r=0;r<e.length;r++)n.push(this.getPeoplePicture(e[r]));return Promise.all(n).then((function(e){return[].concat.apply([],Object(i.__spread)(e))}))},t.prototype.getPeoplePicture=function(e,t){var n=this;if(void 0===t&&(t=void 0),this.cache.has(e))return this.cache.get(e);var i=void 0===t?"users/"+e+"/photo/$value":"users/"+e+"/photos/"+t+"/$value",r=new FileReader,o=new Promise((function(e){n.getGraph("OneDrive_Graph_People_Picture_Request",i,"network-only",null,!0,null,null,null,n.batchEnabled,"blob").then((function(t){t&&t.ok?(r.onloadend=function(){var t=r.result&&"string"==typeof r.result&&r.result.split(",")||[];e(t.length>1?t[1]:null)},r.onerror=function(){return e(null)},r.onabort=function(){return e(null)},r.readAsDataURL(t.data)):e(null)})).catch((function(t){n.globalErrorHandler.handleError(t,"H5HgW"),e(null)}))}));return this.cache.set(e,o),o},t.ɵprov=h.cc({factory:function(){return new t(h.dc(l.a),h.dc(c.b),h.dc(o.a),h.dc(a.a),h.dc(s.a),h.dc(d.a),h.dc(f.q),h.dc(r.b),h.dc(p.a))},token:t,providedIn:"root"}),t}(u.a)},"3g20":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("searchConfig"),this.config&&(this.config.searchInHeaderEnabled=this.config.searchInHeaderEnabled)}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},"3iMk":function(e,t,n){"use strict";function i(e,t,n){for(var i=0;i<e.length;i+=t){for(var r=[],o=[],a=0;a<t&&i+a<e.length;++a){var l=i+a;r.push(e[l]),o.push(l)}n(r,o)}}n.d(t,"a",(function(){return i}))},"4/We":function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var i=n("bb6g"),r=n("f0qX"),o=n("0XE2"),a=n("BaAg"),l=n("dFxn"),s=n("W3Zz"),c=n("uzn7"),u=n("5aVq"),d=n("keVe"),p=function(){function e(e,t){this.localStorageService=e,this.shellShimService=t}return e.parseBooleanFlagsAndFilter=function(e,t){return void 0===t&&(t=new Set),Object.keys(e).filter((function(n){return"boolean"==typeof e[n]&&!t.has(n)})).reduce((function(t,n){return t[n]=e[n],t}),{})},e.prototype.registerFlagsAndGetConfig=function(e){return this.registerFeatures(e),this.mergeConfigWithOverrides(e)},e.prototype.mergeConfigWithOverrides=function(e){var t=this.getOverrides();return Object.keys(e).reduce((function(n,i){var r;return n[i]=null!==(r=t[i])&&void 0!==r?r:e[i],n}),{})},e.prototype.getOverrides=function(){var t;return null!==(t=this.localStorageService.getGlobal(e.localStorageKey))&&void 0!==t?t:{}},e.prototype.registerFeatures=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.shellShimService.getShellShim()];case 1:return t.sent().FeatureFlags.AddFeatureFlags(e),[2]}}))}))},e.localStorageKey="ShellFeatureFlags",e.ɵprov=d.cc({factory:function(){return new e(d.dc(c.a),d.dc(u.a))},token:e,providedIn:"root"}),e}(),h=n("Ax7d"),f=n("BMb5"),m=function(){function e(e,t,n,i,l){var c=this;if(this.featureManagerService=n,this.defaultFluidAudience="TBD",this.shouldOpenWithUIHost=!1,this.capabilities=t.parse("capabilities")||{accountSwitchingEnabled:!1,activityBasedTimeoutEnabled:!1,addToDoEnabled:!1,antpLoaded:!1,appBarEnabled:!1,appManifestEnabled:!1,appsInHero:!1,altaBrandingChangesEnabled:!1,batchGraphEnabled:!1,bottomTrayEnabled:!1,calendarEnabled:!1,capPopupEnabled:!1,capturingIntentEnabled:!1,clientTokenFetchEnabled:!1,contentActionsEnabled:!1,contentActionsOHomeEnabled:!1,contentLauncherEnabled:!1,spacesEnabled:!1,consumerThemesCalloutEnabled:!1,contextMenu20Enabled:!1,convertToPdfEnabled:!1,createButtonWithAnimationEnabled:!1,createCenterEnabled:!1,createCenterReactEnabled:!1,createDocAspxExcelEnabled:!1,createDocAspxPowerPointEnabled:!1,createDocAspxVisioEnabled:!1,createDocAspxWordEnabled:!1,createDocumentSupported:!1,createOneDriveDocApiEnabled:!1,createOneNotePageEnabled:!1,createPaneSvgsEnabled:!1,createSharingLinkApiEnabled:!1,createStreamPlaylistEnabled:!1,createStreamRecorderEnabled:!1,createVisioEnabled:!1,clientPwasEnabled:!1,darkModeEnabled:!1,darkModeOverride:!1,delayedServiceWorkerInit:!1,detailedConsumerHeadersEnabled:!1,downloadActionEnabled:!1,disableAnimation:!1,edgeworthEnabled:!1,edgeworthReactEnabled:!1,eduPageTourFreEnabled:!1,embedAppCachingEnabled:!1,embedHost:"",embedModeEnabled:!1,errorDialogEnabled:!1,favoriteTemplatesEnabled:!1,featureFlagsEnabled:!1,filePicker:!1,filterPillsEnabled:!1,fluentRefresh:!1,fluentIconFontEnabled:!1,fluidAudience:this.defaultFluidAudience,fluidCapPopupEnabled:!1,fluidCreateAbpEnabled:!1,fluidCreateNewEnabled:!1,fluidDevBuildEnabled:!1,fluidFirst:!1,fluidMipEnabled:!1,fluidSourcelessIframeEnabled:!1,fluidSupportEnabled:!1,fluidUseServiceDeliveredDriver:!1,fluidVersionHistoryEnabled:!1,freNewCalloutsEnabled:!1,freV2UiEnabled:!1,freV2DimeEnabled:!1,hasCalendarWorkload:!1,hasExchangeLicense:!1,highResRecThumbnailsEnabled:!1,hoverPreloadTelemetryEnabled:!1,heroBackgroundOptimizationEnabled:!0,heroGradient:!0,incrementalCalloutEnabled:!1,isConsumerUser:!1,isEmbedMode:!1,isPwaInUwp:!1,isPwaInWebView2:!1,leftNavCalloutEnabled:!1,leftNavReact:!1,leftNavEmptyImage:"",limitNetworkRequests:!1,listsCreateEnabled:!1,maxInitialPlaces:0,maxTotalPlaces:0,memoryProfilingEnabled:!1,metaExtensionsFetchEnabled:!1,mobileContextMenusEnabled:!1,modalFreCalloutEnabled:!1,msaClientTokensEnabled:!1,m365AppsEnabled:!1,m365TestAppEnabled:!1,myContentEnabled:!1,m365AppsPageRootPath:null,m365AppsSecondTab:!1,nativeSearchInHeaderEnabled:!1,newUserShelfEnabled:!1,newUserShelfOverride:!1,officeHomeFloodgate:!1,oneDriveApisEnabled:!1,oneDriveUploadEnabled:!1,otherFlights:"",outgoingLoginHintEnabled:!1,paidConsumerFreFloodgateEnabled:!1,parkEnabled:!1,peopleCardsEnabled:!1,powerBiCreateEnabled:!1,prefetchDataEnabled:!1,pwaCommercialNonEduFreEnabled:!1,pwaEnabled:!1,pwaFreeConsumerFreEnabled:!1,pullToRefreshEnabled:!1,quickAccessV1Enabled:!1,quickAccessV1GridViewEnabled:!1,quickAccessV1CustomPivotEnabled:!1,recentCreationsEnabled:!1,recommendedDeepLinkEnabled:!1,recommendedFloodgate:!1,recommendedReact:!1,recommendedTeamsLinkEnabled:!1,redirectWhenSignedOutFromWorkloads:!0,reloadWhenAuthExpired:!0,reloadWhenPolicyCheckFailed:!0,reloadWhenReauthRequired:!0,renderSpaceAsFluid:!0,scheduleEnabled:!1,secondaryTokensEnabled:!1,sharePointEnabled:!1,shareToTeamsEnabled:!1,shellDocumentTitleEnabledInFluid:!1,shellFeedbackEnabled:!1,shellPinEnabled:!1,showA2HSPrompt:!1,showBusinessApps:!1,showFeedback:!1,showFloodgate:!1,showFolders:!1,showPwaFeelingsSurvey:!1,showSearch:!1,showThemingCallout:!1,sideloadAppButtonEnabled:!1,storeAppEnabled:!1,spNewsShadowCallEnabled:!1,startPageAppsArray:new Array,startPageRootPath:null,stayingAwareEnabled:!1,stayingAwareRQEnabled:!1,suggestedActionsEnabled:!1,supportCentralEnabled:!1,svgAppIconsEnabled:!1,swayCreateNewEnabled:!1,templatePageRootPath:null,templatesEnabled:!1,themingCalloutEnabled:!1,thirdPartyCreateEnabled:!1,thumbnailEndpointEnabled:!1,toDoM365AppEnabled:!1,unifiedHostEnabled:!1,unifiedHostPath:"",universalMeControlPWAEnabled:!1,useOdbUrlForVroom:!1,userConsentCallEnabled:!1,useVroomForOneDriveApis:!1,visioWacHostCreateNewEnabled:!1,wacExcelJsApiV2Enabled:!1,wacHostAppsArray:new Array,wacHostPrebootAppsArray:new Array,wacHostCreateNewEnabled:!1,wacHostDeferredTeardownEnabled:!1,wacHostTimeoutTeardownEnabled:!1,wacHostDocRebootEnabled:!1,wacHostEnabled:!1,wacHostControlFlight:!1,wacHostHoverPreloadEnabled:!1,wacHeaderDisabled:!1,wacHostPagePath:"",wacSharingLinkEnabled:!1,wacStartPageEnabled:!1,fileHoverCardEnabled:!1,wacHostOrgTemplatesEnabled:!1,wacHostGetAuthTokenEnabled:!1,wacHostGetCustomAuthConfigEnabled:!1,wacWordJsApiV2Enabled:!1,wacHostExternalLinkEnabled:!1,wacHostMoveToFolderEnabled:!1,wacHostUploadEnabled:!1,webVitalsEnabled:!1,formsCalloutEnabled:!1,scenarioId:null,wacHostDialogContentEnabled:!1,wacHostHoverPrebootAppsArray:new Array,wacHostHoverPrebootControlFlight:!1,yammerCreateEnabled:!1,yammerM365AppEnabled:!1,whiteboardCreateEnabled:!1,graphApiForV2ConsumerEnabled:!1},this.capabilities.featureFlagsEnabled&&this.updateWithOverrides(),this.capabilities.oneDriveUploadEnabled=this.capabilities.oneDriveUploadEnabled&&e.isDesktopDevice(),this.capabilities.createDocumentSupported=!e.isMobileDevice()&&!e.isTabletDevice(s.d.AndroidTablet),this.capabilities.isPwaInUwp=this.capabilities.pwaEnabled&&e.isUwp(),this.capabilities.isPwaInWebView2=this.capabilities.pwaEnabled&&e.isWebView2(),this.capabilities.disableAnimation=this.capabilities.pwaEnabled||this.capabilities.antpLoaded,this.capabilities.mobileContextMenusEnabled=e.isMobileDevice(),this.capabilities.leftNavReact=this.capabilities.leftNavReact&&!e.isMobileDevice(),this.capabilities.appBarEnabled=this.capabilities.appBarEnabled&&!e.isMobileDevice(),this.capabilities.wacSharingLinkEnabled=!1,this.capabilities.wacHostDeferredTeardownEnabled=!1,this.capabilities.suggestedActionsEnabled=this.capabilities.suggestedActionsEnabled&&!e.isMobileDevice(),this.capabilities.contentActionsEnabled||(this.capabilities.addToDoEnabled=!1,this.capabilities.contextMenu20Enabled=!1,this.capabilities.convertToPdfEnabled=!1,this.capabilities.scheduleEnabled=!1,this.capabilities.shareToTeamsEnabled=!1,this.capabilities.createSharingLinkApiEnabled=!1,this.capabilities.contentActionsOHomeEnabled=!1),this.capabilities.m365AppsEnabled||(this.capabilities.m365TestAppEnabled=!1,this.capabilities.parkEnabled=!1,this.capabilities.storeAppEnabled=!1,this.capabilities.toDoM365AppEnabled=!1,this.capabilities.yammerM365AppEnabled=!1),Object(o.a)()&&(this.capabilities.clientTokenFetchEnabled=!0),this.capabilities.wacHostAppsArray&&(this.capabilities.wacHostApps=new Set(this.capabilities.wacHostAppsArray.map((function(e){return a.a.fileTypeNameToFileType(e)})))),this.capabilities.startPageAppsArray&&(this.capabilities.startPageApps=new Set(this.capabilities.startPageAppsArray.map((function(e){return a.a.fileTypeNameToFileType(e)})))),this.capabilities.wacHostPrebootAppsArray&&(this.capabilities.wacHostPrebootApps=new Set(this.capabilities.wacHostPrebootAppsArray.map((function(e){return a.a.fileTypeNameToFileType(e)})))),this.capabilities.wacHostHoverPrebootAppsArray&&(this.capabilities.wacHostHoverPrebootApps=new Set(this.capabilities.wacHostHoverPrebootAppsArray.map((function(e){return a.a.fileTypeNameToFileType(e)})))),this.openWithUIHost=i.isStandalone.pipe(Object(r.a)((function(e){return c.capabilities.wacHostEnabled||c.capabilities.clientPwasEnabled&&e}))),this.openWithUIHost.subscribe((function(e){return c.shouldOpenWithUIHost=e})),void 0===this.capabilities.templatesEnabled){var u=l.nativeWindow.location.hostname;this.capabilities.templatesEnabled=u&&u.lastIndexOf(".com")===u.length-4}this.capabilities.edgeworthEnabled=this.capabilities.edgeworthEnabled&&"Proxy"in l.nativeWindow&&(!this.capabilities.isPwaInUwp||this.capabilities.isPwaInWebView2)}return e.prototype.wacHostHoverPrebootEnabledForFileType=function(e){var t=this.capabilities.wacHostHoverPrebootApps;return!!t&&t.has(e)},e.prototype.wacHostEnabledForFileType=function(e){var t=this.capabilities.wacHostApps;return this.wacHostEnabled()&&!!t&&t.has(e)},e.prototype.wacHostEnabled=function(){return this.shouldOpenWithUIHost},e.prototype.getDefaultFluidAudience=function(){return this.defaultFluidAudience},e.prototype.getWorkload=function(){return this.capabilities.pwaEnabled?"pwa":this.capabilities.isEmbedMode?"embed":"officehome"},e.prototype.updateWithOverrides=function(){var e,t,n=new Set(["featureFlagsEnabled","disableAnimation","createDocumentSupported"]),r=this.featureManagerService.registerFlagsAndGetConfig(p.parseBooleanFlagsAndFilter(this.capabilities,n)),o=Object.keys(r);try{for(var a=Object(i.__values)(o),l=a.next();!l.done;l=a.next()){var s=l.value;this.capabilities[s]=r[s]}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}},e.ɵprov=d.cc({factory:function(){return new e(d.dc(s.b),d.dc(l.a),d.dc(p),d.dc(h.a),d.dc(f.b))},token:e,providedIn:"root"}),e}()},"4CZh":function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return v}));var i=n("tjsK"),r=n("8/lW"),o=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,63}","g"),a=new RegExp("file(:|%3A|%253A).*","gi");function l(e){return e?e.replace(o,"email_removed").replace(a,"file_removed"):e}var s,c=[],u=[],d=!1,p=r.a.Full;function h(e,t,n,i,r,o){void 0===i&&(i={}),void 0===r&&(r=[]),void 0===o&&(o=!1),i.EventName=e,s&&s(i,t);var a={params:i,metrics:r,record:function(){return function(e,t,n,i){var r=n&&(n.EventName&&n.EventName.indexOf("Error")>-1||n.Error&&"OK"!==n.Error);if(!(p<t||d&&!r)){!function(e,t){Object.keys(e).forEach((function(n){var i=e[n];(function(e){return!!e&&e.hasOwnProperty("securityThreshold")})(i)&&(e[n]=t>=i.securityThreshold?i.defaultValue:i.fallbackValue)}))}(n,p);var o=n&&n.Error;o&&"string"==typeof o&&(n.Error=l(o));var a=n&&n.DebugInfo;a&&"string"==typeof a&&(n.DebugInfo=l(a)),u.length>0?u.forEach((function(t){t.logEvent(e,n,i)})):function(e){c.push(e)}({streamName:e,eventName:n.EventName,eventParams:n,metrics:i,securityThreshold:t})}}(t,n,i,r)}};return o&&a.record(),a}function f(){(function(){return c.splice(0,c.length)})().forEach((function(e){h(e.eventName,e.streamName,e.securityThreshold,e.eventParams||{},e.metrics,!0)}))}function m(e,t,n,r){if(void 0===r&&(r=!1),u.length>0)throw new i.a("initializeInstrumentationService is not allowed to be called more than once");if(!e||0===e.length)throw new i.a("Must specify at least one event factory when calling initializeInstrumentation");u=e.slice(),s=t,"number"==typeof n&&(p=n),d=r,f()}function b(){f(),u.forEach((function(e){e.flush()}))}function v(){return p}},"4ach":function(e,t,n){"use strict";var i,r;n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e.Users="users",e.Groups="groups"}(i||(i={})),function(e){e[e.Good=0]="Good",e[e.Normal=1]="Normal",e[e.Suspicious=2]="Suspicious",e[e.Bad=3]="Bad",e[e.Evil=4]="Evil"}(r||(r={}));var o=function(){function e(){}return e.getOwnerPrincipalTypeToFormType=function(e){return"user"===e.toLowerCase()?i.Users:"group"===e.toLowerCase()?i.Groups:void 0},e.getExtensionToFormType=function(e){return"form"===e.toLowerCase()?i.Users:"groupform"===e.toLowerCase()?i.Groups:void 0},e}()},"511z":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=new(n("keVe").q)("SERVICE_WORKER_API_AVAILABLE")},"55A9":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("AlWG"),r=n("keVe"),o=function(){function e(){this.sidePopupMenuEmitter=new i.a(null)}return e.ɵprov=r.cc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},"5FMq":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("2dXW"),r=n("zvoD"),o=n("f0qX"),a=n("keVe"),l=function(){function e(){this.contextMenu=new i.a}return e.prototype.showMenu=function(e){this.updateNext(e,0)},e.prototype.closeMenu=function(e){this.updateNext(e,1)},e.prototype.subscribeToOpenEvents=function(e){return this.contextMenu.asObservable().pipe(Object(r.a)((function(e){return e&&0===e.type})),Object(o.a)((function(e){return{menu:e.menu,position:e.position,focusFirstItem:e.focusFirstItem}}))).subscribe(e)},e.prototype.subscribeToCloseEvents=function(e){return this.contextMenu.asObservable().pipe(Object(r.a)((function(e){return e&&1===e.type})),Object(o.a)((function(e){return{menu:e.menu,position:e.position}}))).subscribe(e)},e.prototype.updateNext=function(e,t){e&&e.menu&&e.position&&this.contextMenu.next({type:t,menu:e.menu,position:e.position,focusFirstItem:e.focusFirstItem})},e.ɵprov=a.cc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},"5MEU":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=new(n("keVe").q)("WorkloadQueryParameter")},"5ZNw":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p){void 0===o&&(o=!1),this.announcementType=e,this.title=t,this.subTitle=n,this.iconClass=i,this.dismissCookieName=r,this.alignBottom=o,this.cssClass=a,this.fontCssClass=l,this.dismissObservable=s,this.dismissible=c,this.titleRedirectionSuggestion=u,this.dismissTimeoutInSecond=d,this.titleUseSubtitleStyle=p,this.importance=1,this.index=0}return e.prototype.isValid=function(){return this.title&&this.title.length>0},e}()},"5aVq":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("bb6g"),r=n("zvoD"),o=n("3Vsh"),a=n("7Gwk"),l=n("BMb5"),s=n("keVe"),c=function(){function e(e,t){this.windowService=e,this.eventService=t,this.afterShellRendered=this.onEventFired("shellRendered"),this.afterShellPlusLoaded=this.onEventFired("shellPlusLoaded")}return e.prototype.getShellShim=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.afterShellRendered];case 1:return e.sent(),[2,this.windowService.nativeWindow.O365Shell]}}))}))},e.prototype.onEventFired=function(e){return this.eventService.events.withScope(0).pipe(Object(r.a)((function(t){return t.name===e})),Object(o.a)(1)).toPromise()},e.ɵprov=s.cc({factory:function(){return new e(s.dc(l.b),s.dc(a.a))},token:e,providedIn:"root"}),e}()},"6GOa":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("swayConfig")||{analyticsBatchSize:1,apiUrl:null,myEndpoint:null,thumbnailsEnabled:!1,uploadMaxFileSize:0,uploadSupportedExtensions:[]}}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},"6Po3":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("keVe"),r=function(){function e(e){this.ngZone=e,this.inRAF=!1}return e.prototype.runAfterPaint=function(e,t){var n=this;return void 0===t&&(t=!0),t?this.afterPaint(e):this.ngZone.runOutsideAngular((function(){return n.afterPaint(e)}))},e.prototype.runBeforeLayout=function(e,t){var n=this;return void 0===t&&(t=!0),t?this.beforeLayout(e):this.ngZone.runOutsideAngular((function(){return n.beforeLayout(e)}))},e.prototype.cancel=function(e){e&&cancelAnimationFrame(e)},e.prototype.afterPaint=function(e){return this.beforeLayout((function(){setTimeout(e,0)}))},e.prototype.beforeLayout=function(e){var t=this;if(!this.inRAF)return requestAnimationFrame((function(){t.inRAF=!0,e(),Promise.resolve().then((function(){t.inRAF=!1}))}));e()},e.ɵprov=i.cc({factory:function(){return new e(i.dc(i.z))},token:e,providedIn:"root"}),e}()},"6cfW":function(e,t,n){"use strict";function i(e){return e instanceof Error&&e.message&&"the operation is insecure."===e.message.toLowerCase()}n.d(t,"a",(function(){return i}))},"6ib3":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return e.Audio="Audio",e.Excel="Excel",e.Fluid="Fluid",e.FluidActivityBlueprint="FluidActivityBlueprint",e.Forms="Forms",e.FormsQuiz="FormsQuiz",e.Image="Image",e.List="List",e.Media="Media",e.MeetingNotes="MeetingNotes",e.MeetingObject="MeetingObject",e.MindMeister="MindMeister",e.Monday="Monday",e.MyAnalytics="MyAnalytics",e.NewsArticle="NewsArticle",e.None="None",e.OneDrive="OneDrive",e.OneNote="OneNote",e.OneNoteClassNoteBook="OneNoteClassNoteBook",e.OneNotePage="OneNotePage",e.Outlook="Outlook",e.Pdf="Pdf",e.Photos="Photos",e.Platform="Platform",e.PlayLists="PlayLists",e.Portfolio="Portfolio",e.PowerBI="PowerBI",e.PowerPoint="PowerPoint",e.Project="Project",e.ProjectOperations="ProjectOperations",e.SharePoint="SharePoint",e.Spaces="Spaces",e.Stream="Stream",e.StreamsVideo="StreamsVideo",e.Sway="Sway",e.Text="Text",e.ThirdParty="ThirdParty",e.Todo="Todo",e.Trello="Trello",e.Unknown="Unknown",e.UpcomingMeeting="UpcomingMeeting",e.Video="Video",e.Visio="Visio",e.VisioBusinessWac="VisioBusinessWac",e.VisioFlowChartWac="VisioFlowChartWac",e.VisioGeneralWac="VisioGeneralWac",e.VisioNetworkWac="VisioNetworkWac",e.VisioSoftwareWac="VisioSoftwareWac",e.VisioStartWac="VisioStartWac",e.Whiteboard="Whiteboard",e.Word="Word",e.Yammer="Yammer",e}({})},"6nG3":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),function(e){e[e.O365Home=0]="O365Home",e[e.O365Personal=1]="O365Personal",e[e.O365Solo=2]="O365Solo",e[e.OtherSubscription=3]="OtherSubscription",e[e.Perpetual=4]="Perpetual",e[e.Perpetual2019=5]="Perpetual2019",e[e.O365HomeTrial=6]="O365HomeTrial",e[e.NonActive=7]="NonActive",e[e.NotSubscribed=8]="NotSubscribed",e[e.NotDetected=9]="NotDetected"}(i||(i={}));var r=function(){return function(){}}()},"6u39":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("AlWG"),r=n("dFxn"),o=n("keVe"),a=function(){function e(e){this.config=e.parse("pwaConfig")||{bridgeTimeoutInSeconds:0,diagnosticsTimeoutInSeconds:30,enablePwaIdleCallback:!1,getWpkidApiPath:null,installedAppsToLookFor:null,lumosHost:null,oobToWeb:!1,pwaJumpListEnabled:!1,PwaStartPageEnabled:!1,resourceUrlMap:null,rfmToWeb:!1,shellAndConfigApiEndpoint:null,splashScreenTimeoutInMilliseconds:2e3,officeAfoRedemptionEnabled:!1,officeUriProtocolEnabled:!1,viewCacheEnabled:!1},this.config.mock&&(window.appsLaunched=new Array,this.config.mock.appsLaunched=window.appsLaunched)}return e.ɵprov=o.cc({factory:function(){return new e(o.dc(r.a))},token:e,providedIn:"root"}),e}(),l=n("hhzZ"),s=n("7Gwk"),c=n("uUrA"),u=n("k+kJ"),d=n("vHlr"),p=function(){function e(e,t,n,r){this.eventService=e,this.pwaConfigService=t,this.uploadButtonService=n,this.instrumentationService=r,this._modalInfo=new i.a(null),this.updateNextSessionId()}return e.prototype.showModal=function(e,t,n){this._modalInfo.next({filePath:e,fileName:t,type:n})},Object.defineProperty(e.prototype,"modalInfo",{get:function(){return this._modalInfo.asObservable()},enumerable:!0,configurable:!0}),e.prototype.uploadFile=function(e,t){this.currentUploadSessionId=this.nextUploadSessionId,this.updateNextSessionId(),this.uploadButtonService.uploadFile(e,null,this.currentUploadSessionId,t,u.d.Button)},e.prototype.getLocalFileInfo=function(e,t){var n=this;return new Promise((function(i){n.pwaConfigService.config.mock?i(new File([],t)):Windows.Storage.StorageFile.getFileFromPathAsync(e).then((function(e){if(!e)throw new Error("Null file returned for path");return Windows.Storage.FileIO.readBufferAsync(e).then((function(e){return e}),(function(){throw new Error("Unable to create buffer")}))}),(function(){throw n.eventService.broadcastEvent({name:"needAccessToFileSystem",args:["allow-file-system-access-upload"]}),new Error("Unable to access local file")})).then((function(e){if(!e)throw new Error("Null buffer");try{for(var n=Windows.Storage.Streams.DataReader.fromBuffer(e),r=n.unconsumedBufferLength,o=new Uint8Array(r),a=0;a<r;a++)o[a]=n.readByte();var l=new Blob([o]);l.lastModifiedDate=new Date,l.name=t,i(l)}catch(e){throw new Error("Error reading from buffer")}})).then(null,(function(e){var t={};t.Error=e?e.message:"",t.ItemCategory=u.d[u.d.Button],n.instrumentationService.logGenericEvent("Upload_Local_Error",t,[],2)}))}))},e.prototype.updateNextSessionId=function(){this.nextUploadSessionId=c.a.createGuid()},e.ɵprov=o.cc({factory:function(){return new e(o.dc(s.a),o.dc(a),o.dc(d.a),o.dc(l.a))},token:e,providedIn:"root"}),e}()},"6wOV":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("AY/E");var i=function(){function e(e,t){this.elementRef=e,this.peopleCardService=t}return e.prototype.ngOnInit=function(){this.upn&&(this.renderPromise=this.peopleCardService.addPersonaCard(this.elementRef.nativeElement,this.upn))},e.prototype.ngOnDestroy=function(){var e=this;this.renderPromise&&this.renderPromise.then((function(){e.peopleCardService.removePersonaCard(e.elementRef.nativeElement,e.upn)}))},e}()},"72nV":function(e,t,n){},"7Gwk":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("zvoD"),r=n("3Vsh"),o=n("MFXD"),a=n("BMb5"),l=n("keVe"),s=function(){function e(e){this.windowService=e,this._events=new o.a,this.mutateGlobalWindowState()}return e.prototype.broadcastEvent=function(e){this._events.next(e)},Object.defineProperty(e.prototype,"events",{get:function(){return this._events.asScopableObservable()},enumerable:!0,configurable:!0}),e.prototype.whenEventFired=function(e,t){return this.events.withScope(t).pipe(Object(i.a)((function(t){return t.name===e})),Object(r.a)(1)).toPromise()},e.prototype.mutateGlobalWindowState=function(){this.windowService.nativeWindow.ng2EventService=this},e.ɵprov=l.cc({factory:function(){return new e(l.dc(a.b))},token:e,providedIn:"root"}),e}()},"7IJ8":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("bb6g"),r=n("keVe"),o=(n("lrJm"),n("6Po3"),n("WLAd"),n("casz"),n("cgnd"),n("QhWD"),n("RsrG"),function(){function e(e,t,n,i,o,a,l,s,c){this.lazyViewLoaderService=e,this.viewRef=t,this.globalErrorHandler=n,this.clientStartupConfigService=i,this.scheduler=o,this.modulePriorityService=a,this.browserPaintService=l,this.ngZone=s,this.pageVisibilityService=c,this.componentLoaded=new r.n,this.outputsSubscriptionMap=new Map}return e.prototype.ngOnInit=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:if(!this.ngModulePath)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.loadComponent()];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),this.globalErrorHandler.handleError(e,"ehPAl"),[3,4];case 4:return[2]}}))}))},e.prototype.ngDoCheck=function(){this.setInputsOutputs()},e.prototype.ngOnDestroy=function(){this.creationHandle&&this.browserPaintService.cancel(this.creationHandle),this.outputsSubscriptionMap.forEach((function(e){return e.unsubscribe()})),this.viewRef.clear()},e.prototype.setInputsOutputs=function(){if(this.lazyComponentRef){for(var e in this.inputs)this.lazyComponentRef.instance[e]=this.inputs[e];for(var t in this.outputs)if(!this.outputsSubscriptionMap.has(t)){var n=this.lazyComponentRef.instance[t];if(n&&n instanceof r.n){var i=n.subscribe(this.outputs[t]);this.outputsSubscriptionMap.set(t,i)}}}},e.prototype.loadComponent=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.lazyViewLoaderService.loadLazyViewFromModule(this.ngModulePath)];case 1:return e=i.sent(),t=function(){r.lazyComponentRef=r.viewRef.createComponent(e),r.componentLoaded.emit(r.lazyComponentRef)},"idle-callback"===this.clientStartupConfigService.config.chunkLoadStrategy&&this.pageVisibilityService.isVisible()?(n=this.modulePriorityService.getSchedulePriority(this.ngModulePath),this.scheduler.scheduleWork((function(){r.ngZone.run((function(){r.creationHandle=r.browserPaintService.runBeforeLayout((function(){r.creationHandle=null,t(),r.setInputsOutputs()}))}))}),n)):t(),[2]}}))}))},e}())},"7J/E":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("bb6g"),r=n("A/um"),o=n("BaAg"),a=n("4ach"),l=n("JT1q"),s=n("fKR7"),c=(n("EYcb"),n("7Gwk"),n("TDzr"),n("55A9"),n("cgnd"),n("/I02"),n("PBJH"),n("IBRu")),u=function(){function e(e,t,n,i,r,o,a){this.locService=e,this.contextService=t,this.sidePopupMenuService=n,this.formsService=i,this.eventService=r,this.errorDialog=o,this.clientStartupConfigService=a}return e.prototype.sendMruItemState=function(e,t){this.eventService.broadcastEvent({name:"mruItemStateChange",args:[e,t]})},e.prototype.generateAdditionalActionsMenuItems=function(e,t,n){var i=this,l=[],c=t.format,u=t.isDeleted,d=t.isLocal;switch(t.fileType){case o.b.Forms:case o.b.FormsQuiz:var p=t.getFormEnumType();c===s.a.SharedForm&&l.push({id:"formsSharedUnpin",title:this.locService.RemoveFromSharedWithMe,ariaLabel:this.locService.RemoveFromSharedWithMe,icon:r.a.Unpin,executeAction:function(){return Promise.resolve([{key:"delete",props:{index:e,item:t,deleteOption:5}}])},disabled:d}),c!==s.a.Form||u||t.ownerType===a.a.Groups||"poll"===p||"assignments"===p||n||l.push(this.generateFormsMoveAction(t,e)),c!==s.a.Form&&c!==s.a.SharedForm||u||"poll"===p||"assignments"===p||l.push(this.generateFormsCopyAction(t,n)),c===s.a.Form&&u&&!d&&l.push({id:"restore",title:this.locService.RestoreActionMenuLabel,ariaLabel:this.locService.RestoreActionMenuLabel,icon:r.a.Restore,executeAction:function(){return i.sendMruItemState(0,t),i.attachFormsErrorHandler(i.formsService.setFormsRecycleState(t.docId,t.ownerId,t.ownerType,!1).then((function(){return i.formsService.pushFormsAnnouncements("FormsRestored",t.fileName)})).then((function(){return[{key:"delete",props:{index:e,item:t,deleteOption:4}}]})).finally((function(){i.sendMruItemState(1,t)})))},disabled:!1}),c!==s.a.Form||d||l.push({id:"delete",title:this.locService.DeleteActionMenuLabel,ariaLabel:this.locService.DeleteActionMenuLabel,icon:r.a.Delete,executeAction:function(){var n;return i.sendMruItemState(0,t),n=u?i.formsService.hardDeleteForm(t.docId,t.ownerId,t.ownerType).then((function(){return i.formsService.pushFormsAnnouncements("FormsPermanentlyDeleted",t.fileName)})):i.formsService.setFormsRecycleState(t.docId,t.ownerId,t.ownerType,!0).then((function(){return i.formsService.pushFormsAnnouncements("FormsMoveToRecycleBin")})),i.attachFormsErrorHandler(n.then((function(){return[{key:"delete",props:{index:e,item:t,deleteOption:u?2:1}}]})).finally((function(){i.sendMruItemState(1,t)})))},disabled:!1})}return l},e.prototype.updateActionItemsOnInflated=function(e,t,n){var i,r,l=[];switch(t.fileType){case o.b.Forms:case o.b.FormsQuiz:t.format===s.a.Recent&&"poll"!==t.getFormEnumType()&&"assignments"!==t.getFormEnumType()&&void 0!==(null===(i=t.metaData)||void 0===i?void 0:i.formsResponseCount)&&null!==(null===(r=t.metaData)||void 0===r?void 0:r.formsResponseCount)&&(t.ownerType===a.a.Groups||n||l.push({start:1,deleteCount:0,item:this.generateFormsMoveAction(t,e)}),l.push({start:1,deleteCount:0,item:this.generateFormsCopyAction(t,n)}))}return l},e.prototype.generateFormsCopyAction=function(e,t){var n=this;return{id:"copy",title:this.locService.CopyActionMenuLabel,ariaLabel:this.locService.CopyActionMenuLabel,icon:r.a.Copy,executeAction:function(){var i;n.sendMruItemState(0,e);var r=e.ownerType;return e.ownerType===a.a.Users?i=t?e.ownerId:n.clientStartupConfigService.config.objectId:e.ownerType===a.a.Groups&&(i=e.ownerId),n.attachFormsErrorHandler(n.formsService.postCopyForm(e.docId,e.title,e.ownerTenantId,e.ownerId,i,e.ownerType,r).then((function(t){return n.formsService.setFormsCopySuccessAnnouncement(t.title,r,e.format!==s.a.Form,i,e.createdBy),[{key:"add",props:{addOption:1,addedItem:Object(l.b)(t,o.a.fileTypeNameFromType(o.b.Forms)+"_item_"+t.id,o.a.fileTypeNameFromType(o.b.Forms)+"Impression",n.contextService.isRtl,n.clientStartupConfigService.config.authType,!1,null,e.ownerType)}}]})).finally((function(){n.sendMruItemState(1,e)})))},disabled:e.isLocal}},e.prototype.generateFormsMoveAction=function(e,t){var n=this;return{id:"move",title:this.locService.MoveActionMenuLabel,ariaLabel:this.locService.MoveActionMenuLabel,icon:r.a.Move,executeAction:function(){var r=Object(i.__read)(Object(c.a)(),2),o=r[0];return n.sidePopupMenuService.sidePopupMenuEmitter.next({isShown:!0,type:0,movingFileItem:e,index:t,resolveMoveModel:r[1]}),o.then((function(i){var r=e;n.sendMruItemState(0,r);var o=i.moveTargetId,l=i.moveTargetName;return n.attachFormsErrorHandler(n.formsService.postMoveForms(r.docId,r.ownerType,r.ownerId,a.a.Groups,o).then((function(i){return n.formsService.setFormsMoveToGroupSuccessAnnouncement(r.fileName,o,l),e.createdBy=l,e.ownerType=a.a.Groups,e.ownerId=o,e.docId=i.id,[{key:"delete",props:{index:t,item:e,deleteOption:3}},{key:"disableAction",props:{id:"move"}}]})).finally((function(){n.sendMruItemState(1,r)})))}))},disabled:e.isLocal}},e.prototype.attachFormsErrorHandler=function(e){var t=this;return e.catch((function(e){var n,i,r,o;switch(null===(r=null===(i=null===(n=e.httpResponse)||void 0===n?void 0:n.data)||void 0===i?void 0:i.error)||void 0===r?void 0:r.code){case"6102":o="AutoBlockedForm";break;case"6100":o="TakenDownForm";break;default:o="Generic"}throw t.errorDialog.showErrorDialog({category:"ActionMenu",error:o}),e}))},e}()},"7Rc8":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return A}));var i,r=n("lrJm"),o=n("hhzZ"),a=n("R7NL"),l=n("BaAg"),s=n("kpuN"),c=n("W3Zz"),u=n("Z0U4"),d=n("wwmn"),p=n("Uqr9"),h=n("casz"),f=n("ZtId"),m=n("BJbw"),b=n("BMb5"),v=n("4/We"),g=n("cgnd"),y=n("/I02"),S=n("JH4S"),w=n("QOOv"),C=n("RR/o"),I=n("keVe"),T=n("TOqr"),k=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,h,f,m,b,v){var g=this;this.mruService=new C.b(e,n,t,i,r,o,a,l,s,c,u,p,h,f,m,b,v),m.capabilities.edgeworthEnabled||d.subscribeToRouteChangeStart((function(e){e.currentRoute&&g.warmDocumentCache(e.currentRoute)}))}return e.prototype.getMruService=function(){return this.mruService},e.prototype.warmDocumentCache=function(e){switch(e.route){case"OfficeHome":case"Pwa":this.mruService.getMruDocuments();break;case"Start":e.app!==l.b.SharePoint&&e.app!==l.b.OneDrive&&this.mruService.getMruDocuments(new Set([e.app]))}},e.ɵprov=I.cc({factory:function(){return new e(I.dc(s.b),I.dc(a.a),I.dc(o.a),I.dc(y.a),I.dc(d.a),I.dc(S.a),I.dc(w.a),I.dc(T.q),I.dc(r.b),I.dc(g.b),I.dc(p.b),I.dc(u.a),I.dc(f.a),I.dc(h.a),I.dc(b.b),I.dc(v.a),I.dc(m.a),I.dc(c.b))},token:e,providedIn:"root"}),e}();!function(e){e[e.Unknown=0]="Unknown",e[e.SkyDrive=1]="SkyDrive",e[e.SkyDrivePro=2]="SkyDrivePro",e[e.SharePointOnline=3]="SharePointOnline"}(i||(i={}));var A=function(){function e(){}return e.ɵprov=I.cc({factory:function(){return function(e){return e.getMruService()}(I.dc(k))},token:e,providedIn:"root"}),e}()},"7ma0":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("keVe"),r=n("4/We"),o=new i.q("AAD_APP_ID",{providedIn:"root",factory:function(){var e=Object(i.V)(r.a);return e.capabilities.antpLoaded||e.capabilities.pwaEnabled?"0ec893e0-5785-4de6-99da-4ed124e5296c":"4345a7b9-9a63-4910-a426-35363201d503"}})},"7uC2":function(e,t,n){},"7wk3":function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var i=n("TOqr"),r=n("BaAg"),o=n("6Po3"),a=n("Z0U4"),l=n("WLAd"),s=n("Uqr9"),c=n("hhzZ"),u=n("4/We"),d=n("7Gwk"),p=n("R4AA"),h=n("BMb5"),f=n("keVe"),m=function(){function e(e,t,n,i,r,o,a){var l=this;this.capabilitiesService=e,this.windowService=t,this.performanceService=n,this.eventService=i,this.ntpService=r,this.instrumentationService=o,this.pageVisibilityService=a,this.paintRecordings=new Set(["SharePoint","MRU","Recommended"]),this.eventService.whenEventFired("sharePointFailed",0).then((function(){l.mark("SharePoint")})),this.eventService.whenEventFired("mruFailed",0).then((function(){l.mark("MRU")})),this.eventService.whenEventFired("recommendedFailed",0).then((function(){l.mark("Recommended")}))}return e.prototype.mark=function(e){this.paintRecordings.delete(e)&&this.capabilitiesService.capabilities.antpLoaded&&(0===this.paintRecordings.size&&(!this.windowService.nativeWindow.antpTtvrLogged&&this.ntpService.logHistogram(62)&&(this.windowService.nativeWindow.antpTtvrLogged=!0),this.pageVisibilityService.isVisible()&&(this.performanceService.mark("Paint_Antp",2,0,window.getCommonParamsAntp()),this.instrumentationService.logGenericEvent("Antp_View",window.getCommonParamsAntp())),this.eventService.broadcastEvent({name:"antpReady",args:[]})),this.paintMinAntpRecorded||(this.pageVisibilityService.isVisible()&&(this.performanceService.mark("Paint_AntpMin",2,0,window.getCommonParamsAntp()),this.instrumentationService.logGenericEvent("Antp_MinView",window.getCommonParamsAntp())),this.paintMinAntpRecorded=!0))},e.ɵprov=f.cc({factory:function(){return new e(f.dc(u.a),f.dc(h.b),f.dc(s.b),f.dc(d.a),f.dc(p.a),f.dc(c.a),f.dc(l.a))},token:e,providedIn:"root"}),e}(),b=function(){function e(e,t,n,i,r,o){var a=this;this.performanceService=e,this.platformId=t,this.pageVisibilityService=n,this.browserPaintService=i,this.visuallyReadyService=o,this.queuedEvents=new Set,this.markedEvents=new Set,this.setupOnHiddenListener(),r.subscribeToRouteChangeStart((function(e){return a.currentRoute=e.currentRoute}))}return e.prototype.recordWhenPainted=function(e){var t=this,n=e+(this.currentRoute&&this.currentRoute.route?"_"+this.currentRoute.route+(this.currentRoute.app?r.b[this.currentRoute.app]:""):"");Object(i.t)(this.platformId)&&!this.markedEvents.has(n)&&this.pageVisibilityService.isVisible()&&(this.queuedEvents.add(e),this.markedEvents.add(n),this.paintListenerHandle||(this.paintListenerHandle=this.browserPaintService.runAfterPaint((function(){t.pageVisibilityService.isVisible()&&t.queuedEvents.forEach((function(e){t.performanceService.mark("Paint_"+e),t.visuallyReadyService&&t.visuallyReadyService.mark(e)})),t.resetListener()}),!1)))},e.prototype.setupOnHiddenListener=function(){var e=this;this.pageVisibilityService.addOnVisibilityChanged((function(t){"hidden"===t&&e.cancelPaintListener()}))},e.prototype.cancelPaintListener=function(){this.paintListenerHandle&&this.browserPaintService.cancel(this.paintListenerHandle),this.resetListener()},e.prototype.resetListener=function(){this.queuedEvents.clear(),this.paintListenerHandle=null},e.ɵprov=f.cc({factory:function(){return new e(f.dc(s.b),f.dc(f.B),f.dc(l.a),f.dc(o.a),f.dc(a.a),f.dc(m,8))},token:e,providedIn:"root"}),e}()},"8/lW":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return e[e.Security=0]="Security",e[e.Basic=1]="Basic",e[e.Enhanced=2]="Enhanced",e[e.Full=3]="Full",e}({})},"8EWw":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("bb6g"),r=n("uReB"),o=n("6ib3"),a=n("BaAg"),l=n("p6Zr"),s=n("9WrL"),c=n("4/We"),u=n("w1PR"),d=n("keVe"),p=function(){function e(e,t,n){var i=this;this.capabilitiesService=e,this.themingService=t,this.officeStartBootstrapperService=n,this.loadDocumentActionsCreatorPromise=null,this.contentActionsEnabled=this.capabilitiesService.capabilities.contentActionsEnabled&&this.capabilitiesService.capabilities.contentActionsOHomeEnabled,this.capabilitiesService.capabilities.darkModeEnabled&&(this.darkModeSubscription=this.themingService.darkModeSubscription.subscribe((function(e){i.contentActionsEnabled&&i.documentActionsCreator&&void 0!==e&&i.documentActionsCreator.updateActionControl(e)})))}return e.prototype.ngOnDestroy=function(){var e;this.actionManager&&this.actionManager.removeListener(r.b.ActionsUpdated,this.actionsUpdatedCallback),null===(e=this.darkModeSubscription)||void 0===e||e.unsubscribe()},e.prototype.createToDoSuccessNotification=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.loadActionService()];case 1:return n.sent(),[2,this.createSuccessNotification(this.addedToToDo,{onClick:e,label:null!=t?t:this.openButtonText})]}}))}))},e.prototype.createToDoErrorNotification=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.loadActionService()];case 1:return t.sent(),[2,this.createErrorNotification(null!=e?e:this.addedToToDoFailed)]}}))}))},e.prototype.createDocumentActions=function(e,t,n,r){var s;return Object(i.__awaiter)(this,void 0,void 0,(function(){var c,u;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.contentActionsEnabled&&e?this.documentActionsCreator&&this.actionManager&&this.contentActions?[3,2]:[4,this.loadActionService()]:[2,[]];case 1:if(!i.sent())return[2,[]];i.label=2;case 2:return c=a.a.referralFromFileLocation(e.url),u={app:e.application,attribution:e.attribution,attributionUrl:e.attributionUrl,canonicalUrl:e.canonicalUrl,docId:e.docId,downloadUrl:e.downloadUrl,driveId:e.driveId,extension:e.extension,fileName:e.fileName,fileType:e.fileTypeName?o.a[e.fileTypeName]:void 0,id:e.id,isDeleted:e.isDeleted,isEmailAttachment:e.isEmailAttachment,isHidden:e.isHidden,isLocalFile:e.isLocal,isOneDriveForBusinessFile:c===l.a.OneDrive,isSharePointFile:c===l.a.SharePoint,isOnPremOrVanity:e.isOnPremOrVanity,isPinned:e.isPinned,isRedeemed:null===(s=e.isRedeemed)||void 0===s||s,sharepointIds:e.sharepointIds,title:e.title,url:e.url,webUrl:e.webUrl},[2,this.documentActionsCreator.createDocumentActions(this.contentActions,u,t,n,r)]}}))}))},e.prototype.getContentActionsGroupInfo=function(){if(this.contentActionsEnabled&&this.documentActionsCreator)return this.documentActionsCreator.getContentActionsGroupInfo()},e.prototype.actionsUpdatedCallback=function(){this.actionManager&&(this.contentActions=this.actionManager.getContentActionsMetadata())},e.prototype.loadActionService=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(i.__generator)(this,(function(t){return null===this.loadDocumentActionsCreatorPromise&&(this.officeStartBootstrapperService.bootstrapOfficeStart(),this.loadDocumentActionsCreatorPromise=new Promise((function(t){Promise.all([n.e(6),n.e(0),n.e(1),n.e(7),n.e(12),n.e(11),n.e(13),n.e(2),n.e(18),n.e(3),n.e(22),n.e(535)]).then(n.bind(null,"pbSZ")).then((function(n){return Object(i.__awaiter)(e,void 0,void 0,(function(){var e,o;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,n.getNotificationStrings()];case 1:return e=i.sent(),this.addedToToDo=e.addedToToDo,this.addedToToDoFailed=e.addedToToDoFailed,this.openButtonText=e.openButtonText,this.createSuccessNotification=n.createSuccessNotification,this.createErrorNotification=n.createErrorNotification,this.documentActionsCreator=n.getDocumentActionsCreator(),o=this,[4,this.documentActionsCreator.getActionConfig()];case 2:return o.actionManager=i.sent(),this.actionManager||t(!1),this.actionManager.on(r.b.ActionsUpdated,this.actionsUpdatedCallback),this.actionsUpdatedCallback(),t(!!this.contentActions),[2]}}))}))}))}))),[2,this.loadDocumentActionsCreatorPromise]}))}))},e.ɵprov=d.cc({factory:function(){return new e(d.dc(c.a),d.dc(u.b),d.dc(s.a))},token:e,providedIn:"root"}),e}()},"8q3P":function(e,t,n){},"8wW2":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i,r=n("cenr"),o=n("V9hE"),a="UnknownError";function l(){if(!i){var e=new Map,t=function(t,n){var i="",l="";t=t||new Error(a);var s=!1;try{var c=t.filename;c?i="Error location: "+(c=c.replace(/^.*[\\\/]/,""))+", line: "+t.lineno+", col: "+t.colno:t.id?i="Error id: "+t.id:(i="Error location: unknown",s=!0);var u=t.error||t;u.originalError?(i+="\nHandled error is a wrapper with message: "+u.message,l="Wrapper call stack: "+(u.stack||"Call stack trace is not available"),l+="\nOriginal call stack: "+((u=u.originalError).stack||"Call stack trace is not available")):l="Call stack: "+(u.stack||"Call stack trace is not available"),u.message&&(i+="\nError message: "+u.message)}catch(e){i="Error caught inside error logger: "+(e&&e.message||a),l="Call stack: "+(e&&e.stack||"Call stack trace is not available"),n="React",console.log(e)}finally{(function(t,n,i,a){var l;void 0===a&&(a=!1);try{var s=function(t){return 1+(e.get(t)||0)}(t);if(e.set(t,s),function(e){var t=e.toString().length,n=Math.pow(10,t-1);return n<2||e%n==0}(s)){var c=((l={}).Error=t,l.DebugInfo={value:n,kind:2},l.ItemCategory=i,l.ItemCount=s.toString(),l);Object(r.a)("Unhandled_Exception",c),a&&(c.DebugInfo=n,Object(o.a)("Unhandled_Exception",c))}}catch(e){console.log(e)}})(i,l,n,s),console.log(t)}},n=function(e,n){(function(e){if(e&&e.stack&&!e.promise)return!1;if(e&&e.promise&&e.rejection){var t=e.rejection;if(t.stack&&"Error"!==t.name)return!1}return!0})(e)||(function(e,t){e&&"object"==typeof e&&t&&(e.id=t)}(e,n),t(e,"React"))};!function(){var e=window.onerror;window.onerror=function(i,r,o,l,s){var c=null;if("object"==typeof i&&i.type&&"error"===i.type.toLowerCase()?c=i:s?((c=s).message=s.message||i,Object.assign&&Object.assign(c,{filename:r,lineno:o,colno:l})):"string"==typeof i?(c=new Error(i||a),Object.assign&&Object.assign(c,{filename:r,lineno:o,colno:l})):(c=new Error(a),Object.assign&&Object.assign(c,{filename:r,lineno:o,colno:l})),t(c,"Global"),e)try{e.apply(window,[i,r,o,l,s])}catch(e){n(e)}}}(),i={handleError:n,handleCacheObservableError:function(e,t,i){e&&(e.networkError&&n(e.networkError,i),e.cacheError&&n(e.cacheError,t))}}}return i}},9260:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("bb6g"),r=(n("lrJm"),n("hhzZ"),n("R7NL"),n("BaAg")),o=(n("QOOv"),n("RR/o")),a=(n("7ma0"),n("kpuN"),n("wwmn"),n("casz"),n("ZtId"),n("BMb5"),n("pOWU")),l=(n("4/We"),n("cgnd"),n("/I02"),n("uUrA")),s=n("oAX+"),c=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p,h,f){var m=e.call(this,t,r,o,"Substrate",i,l,s,p)||this;m.capabilitiesService=n,m.mruConfigService=a,m.globalErrorHandler=c,m.startupConfigService=u,m.updateContentService=d,m.windowService=h,m.aadAppId=f,m.fetchRequestIndex=0;var b=m.mruConfigService.config;return m.allApps=["Word","Excel","PowerPoint","OneNote","Video"],b.recommendedPdfEnabled&&m.allApps.push("Pdf"),b.recommendedVisioEnabled&&m.allApps.push("Visio"),b.recommendedFluidEnabled&&m.allApps.push("Fluid","Bohemia","Loop"),m.sources=["EmailAttachment","OneDrive","Sharepoint"],m.capabilitiesService.capabilities.isPwaInUwp&&m.sources.push("LocalFile"),m.baseUrl=(m.inMockMode?m.contextService.sharedContext.officeHomeApiRoot:b.substrateApiEndpoint)+"/"+b.recommendedB2ApiRootPath+"/",m.recommendedDataStreams=new Map,m}return Object(i.__extends)(t,e),t.prototype.getRecommendedDocs=function(e){var t=this,n=this.getUrl(e);if(this.recommendedDataStreams.has(n))return this.recommendedDataStreams.get(n);var i=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchRecommendedDocs(n):this.fetchRecommendedDocs("network-first",n,e),r=this.updateContentService.getOrAddUpdateStream(this.getUpdateStreamKey(n),(function(){return t.fetchRecommendedDocs("network-first",n,e)})),o=s.a.createResultsWithCacheObservable(this.fetchRecommendedDocs("cache-only",n,e),i,r,(function(e){return t.recommendedDataStreams.delete(n)}));return this.recommendedDataStreams.set(n,o),o},t.prototype.updateRecommendedDocs=function(e){return this.updateContentService.pushUpdate(this.getUpdateStreamKey(this.getUrl(e)))},t.prototype.removeDocument=function(e,t){var n=this,i=l.a.createGuid(),r=this.createRequestConfig(i);return new Promise((function(i,o){n.post("Recommended_Delete_Request",n.baseUrl+n.mruConfigService.config.recommendedApiDismissedDocumentsPath,{id:e,until:t},(function(e){e.then((function(){return i(null)}))}),o,r)}))},t.prototype.fetchRecommendedDocs=function(e,n,i){var r=this;return new Promise((function(o,a){var s=l.a.createGuid(),c=r.createRequestConfig(s);r.get("Recommended_Request",n,(function(n){n.instrument((function(e,n){if(n.params.RequestId=r.getRequestIdFromResponse(e),n.params.DebugInfo=r.getServerDebugInfo(e),n.params.Index=(r.fetchRequestIndex++).toString(),n.params.ImpressionId=!!e.headers&&e.headers.get(t.clientRequestIdHeader)||s,n.params.DocumentType=i?r.getTypesParam(i):"All",e.ok&&e.data){var o=0;e.data.documents_group&&e.data.documents_group.documents&&(o=e.data.documents_group.documents.length,n.params.ResourceIdDistribution=e.data.documents_group.documents.map((function(e){return e.resource_id})).toString()),n.params.ActualSize=o.toString()}})).then((function(n){return r.processLocalRecommendedData(n.data).then((function(i){o({items:i||[],impressionId:!!n.headers&&n.headers.get(t.clientRequestIdHeader)||s,fromCache:"cache-only"===e})}))})).catch((function(e){r.globalErrorHandler.handleError(e,"QG6EV")}))}),a,c,e)}))},t.prototype.prefetchRecommendedDocs=function(e){var t=this;return this.windowService.nativeWindow.prefetchRecommendedDataPromise?this.windowService.nativeWindow.prefetchRecommendedDataPromise.then((function(e){return e?t.processLocalRecommendedData(e).then((function(t){return{items:t,impressionId:e.recommendedRequestId||"",fromCache:!1}})):Promise.reject("Prefetch failed")})):this.fetchRecommendedDocs("network-first",e)},t.prototype.handleQueryParam=function(e,t,n){"mockrecommended"===e&&this.mockRequestHeader&&n.headers.set(this.mockRequestHeader,t)},t.fileType=function(e){var n,i=r.a.fileTypeFromExtension(e.extension);return i===r.b.Fluid&&(null===(n=e.url)||void 0===n?void 0:n.includes("Office%20Spaces"))?r.b.Spaces:(i&&i!==r.b.None||(i=t.fileTypeFromAppName(e.app)||r.b.Unknown),i)},t.fileTypeFromAppName=function(e){return e?r.a.fileTypeNameToFileType(e):null},t.prototype.createRequestConfig=function(e){var n=this.startupConfigService.config;return{headers:new Map([["X-AnchorMailbox",n.objectId+"@"+n.tenantId],["X-Office-Application",this.contextService.sharedContext.recommendedIceApplicationId.toString()],["X-Office-Scenario",this.contextService.getCurrentPageForLogging()],["X-RoutingParameter-SessionKey",n.objectId],["X-Ms-ClientAppId",this.aadAppId],[t.clientRequestIdHeader,e]])}},t.prototype.getUrl=function(e){var n=this.getTypesParam(e),i=this.sources.join(",");return""+this.baseUrl+this.mruConfigService.config.recommendedB2ApiFilesPath+"?"+t.countParam+this.mruConfigService.config.numRecommendedToRequest+"&"+t.skipCacheParam+"&"+t.appsParam+n+"&"+t.locParam+this.contextService.sharedContext.officeMarket+"&"+t.sourcesParam+i},t.prototype.getTypesParam=function(e){return(e&&e.size?this.allApps.filter((function(t){return e.has(r.a.fileTypeNameToFileType(t))})):this.allApps).join(",")},t.prototype.getUpdateStreamKey=function(e){return"recommended-"+e},t.prototype.convertToMruDataItem=function(e,n){var i;void 0===n&&(n=!1);var a=e.activity_info?e.activity_info.badge:void 0,l=a&&a.timestamp?new Date(a.timestamp):null,s="EmailAttachment"===e.service_info.service_id||"FP_EXCHANGE_ORGID"===e.service_info.service_id,c=null;s&&(c={AttachmentType:1,ConversationId:"",Subject:a&&a.conversation_info?a.conversation_info.subject:""});var u=void 0;return this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled&&a&&a.sharing_action&&1===a.sharing_action.medium&&(u=a.sharing_action.web_url),{Application:e.app,Category:"Document",DocId:e.onedrive_info&&e.onedrive_info.item_id,DriveId:e.onedrive_info&&e.onedrive_info.drive_id,Extension:e.extension||r.a.getFileExtensionFromUrl(e.url),FileName:e.title,Title:e.title,Url:s||n?e.web_url:e.url,WebUrl:e.web_url,LastAccessedTime:l,FileType:r.b[t.fileType(e)],PathArray:null,Provenance:r.c[r.c.Substrate],ResourceId:e.resource_id,UrlAlreadyEncoded:!0,Activity:e.activity_info?o.b.convertMruActivityToActivityDescription(e.activity_info):void 0,IsCollab:!!e.activity_info&&e.activity_info.is_collab,IsEmailAttachment:s,IsLocal:n,OneDriveInfo:e.onedrive_info,SharepointInfo:e.sharepoint_info,SPOId:e.id,EmailReference:c,NavigationId:e.activity_info&&e.activity_info.badge&&e.activity_info.badge.navigation_info?e.activity_info.badge.navigation_info.id:null,TeamsDeepLink:u,IconUrl:null===(i=e.app_info)||void 0===i?void 0:i.icon_url}},t.prototype.processLocalRecommendedData=function(e){var t;return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return Object(i.__generator)(this,(function(i){return n=(null===(t=null==e?void 0:e.documents_group)||void 0===t?void 0:t.documents)||[],[2,Promise.all(n.map((function(e){return r.checkLocalFileAndProcess(e)}))).then((function(e){return e.filter((function(e){return null!==e&&e.Activity&&e.Activity.formatString}))}))]}))}))},t.prototype.getServerDebugInfo=function(e){if(!e||!e.headers)return"";var t=e.headers;return"BE: "+(t.get("X-CalculatedBETarget")||"")+". FE: "+(t.get("X-FEServer")||"")+"."},t.prototype.checkLocalFileAndProcess=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(n){return[2,new Promise((function(n){var i;if("LocalFile"!==(null===(i=e.service_info)||void 0===i?void 0:i.service_id))n(t.convertToMruDataItem(e));else if(t.capabilitiesService.capabilities.isPwaInUwp){var r=e.web_url;try{Windows.Storage.StorageFile.getFileFromPathAsync(r).then((function(i){n(i?t.convertToMruDataItem(e,!0):null)}),(function(){n(null)}))}catch(e){n(null)}}else n(null)}))]}))}))},t.clientRequestIdHeader="client-request-id",t.countParam="show=",t.skipCacheParam="skipCache=false",t.appsParam="apps=",t.locParam="rs=",t.sourcesParam="sources=",t}(a.a)},"94Ef":function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y}));var i=n("keVe"),r=n("pzhl"),o=n("PkQn"),a=n("4/We"),l=n("TOqr"),s=n("tuJr"),c=n("s+Eq"),u=n("5FMq"),d=n("M56G"),p=n("jrGV"),h=n("W3Zz"),f=n("hhzZ"),m=n("PBJH"),b=i.xb({encapsulation:2,styles:[],data:{}});function v(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,6,"div",[["class","actions-menu-item__flex-content"],["role","menuitem"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,r.b,r.a)),i.yb(2,638976,null,0,o.a,[a.a],{color:[0,"color"],cssClass:[1,"cssClass"],iconFontCssClass:[2,"iconFontCssClass"],iconFontType:[3,"iconFontType"],size:[4,"size"]},null),(e()(),i.zb(3,0,null,null,3,"div",[["class","list-item__title menu-item__title ms-fcl-bl"]],null,null,null,null,null)),i.yb(4,278528,null,0,l.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(5,{"menu-item__title--disabled":0}),(e()(),i.Yb(6,null,["",""]))],(function(e,t){e(t,2,0,t.context.item.iconColor,i.Gb(1,"actions-menu-item__icon ms-fcl-bl ",t.context.item.disabled?" menu-item__icon--disabled":"",""),t.context.item.iconCssClass,t.context.item.icon,"16");var n=e(t,5,0,t.context.item.disabled);e(t,4,0,"list-item__title menu-item__title ms-fcl-bl",n)}),(function(e,t){e(t,6,0,t.context.item.title)}))}function g(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,8,"ohp-dropdown-menu",[],null,[[null,"toggleMenu"],[null,"selectItem"],[null,"focusLink"]],(function(e,t,n){var i=!0,r=e.component;return"toggleMenu"===t&&(i=!1!==r.onToggleMenu(n)&&i),"selectItem"===t&&(i=!1!==r.onSelectItem(n)&&i),"focusLink"===t&&(i=!1!==r.onFocusLink(n)&&i),i}),s.b,s.a)),i.yb(1,4440064,[[1,4]],1,c.a,[i.h,u.a],{menuModel:[0,"menuModel"],mobileContextMenu:[1,"mobileContextMenu"],leftAlignedCard:[2,"leftAlignedCard"],hideContent:[3,"hideContent"]},{toggleMenu:"toggleMenu",selectItem:"selectItem",focusLink:"focusLink"}),i.Ub(603979776,2,{menuItems:1}),(e()(),i.zb(3,0,null,0,3,"div",[["ohpMenuLinkContent",""]],null,null,null,null,null)),i.yb(4,16384,null,0,c.c,[],null,null),(e()(),i.zb(5,0,null,null,1,"ohp-icon-font",[["iconFontName","Ellipsis"],["size","16"]],null,null,null,r.b,r.a)),i.yb(6,638976,null,0,o.a,[a.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null),(e()(),i.ib(0,null,null,1,null,v)),i.yb(8,16384,[[2,4]],0,c.b,[i.L],null,null)],(function(e,t){var n=t.component;e(t,1,0,n.dropdownMenuModel,n.mobileMenusEnabled,n.leftAlignedCard,n.actionContextMenuEnabled),e(t,6,0,(n.iconClass?n.iconClass+" ":"")+(n.fluentRefresh?"actions-menu__icon--fluent"+(n.isOpen?" ms-fcl-tp":""):"actions-menu__icon ms-fcl-ns ms-fcl-nd-h ms-fcl-nd-f"),"Ellipsis","16",!0)}),null)}function y(e){return i.bc(0,[i.Ub(671088640,1,{dropdownMenu:0}),(e()(),i.ib(16777216,null,null,1,null,g)),i.yb(2,16384,null,0,l.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,(null==n.dropdownMenuModel||null==n.dropdownMenuModel.items?null:n.dropdownMenuModel.items.length)||n.actionContextMenuEnabled)}),null)}i.vb("ohp-actions-menu",d.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-actions-menu",[],null,null,null,y,b)),i.yb(1,638976,null,0,d.a,[p.a,a.a,h.b,f.a,m.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{menuModel:"menuModel",listItemIndex:"listItemIndex",iconClass:"iconClass",area:"area",dataSecurity:"dataSecurity",leftAlignedCard:"leftAlignedCard",documentName:"documentName",horizontalEllipsis:"horizontalEllipsis",actionContextMenuEnabled:"actionContextMenuEnabled",actionContextMenu:"actionContextMenu"},{menuToggled:"menuToggled",menuFocused:"menuFocused"},[])},"9InZ":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"9MHL":function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var i=n("AlWG"),r=n("lrJm"),o=n("3GGT"),a=n("hhzZ"),l=n("BaAg"),s=n("p6Zr"),c=n("Dpxn"),u=n("TIi1"),d=n("BMb5"),p=n("4/We"),h=n("cgnd"),f=n("/I02"),m=n("PBJH"),b=function(){function e(){}return e.resolveGraphError=function(e,t){var n=e.httpResponse||e;if(n&&"number"==typeof n.status){var i=n.status,r=n.data;if(r&&r.error){for(var o=[],a=r.error;a;)o.push(a),a=a.innererror;for(a=o.pop();a;){var l=t(a.code);if(void 0!==l)return l;a=o.pop()}}return t(i)}},e}(),v=n("ZBli"),g=n("k+kJ"),y=n("JScD"),S=n("bb6g"),w=n("Uqr9"),C=function(){function e(e,t){this.totalBytes=t,this.startTime=w.a.now(),this.expirationTime=this.startTime+e,this.progressPoints=0}return e.prototype.doesActivityHaveRemainingCapacity=function(e){var t=this.getRateRatio(e);return void 0===t||t<=1},e.prototype.didActivityHaveExtraCapacity=function(){var e=w.a.now();return this.expirationTime-e>e-this.startTime},e.prototype.getRateRatio=function(e){this.progressPoints++;var t,n=w.a.now(),i=n-this.startTime,r=this.expirationTime-n;return this.progressPoints>=4&&i>=4e3&&r>0&&i>0&&(t=(this.totalBytes-e)/r/(e/i)),t},e}(),I=n("IAGz"),T=function(){function e(e,t,n){this.oneDriveService=e,this.windowService=n,this.uploadConfig=t.config}return e.prototype.advanceState=function(e,t,n){var i=this;return(t.sessionUrl?t.nextExpectedRanges?this.uploadItemState(e,t,n):this.getStatusState(e,t,n):this.createSessionState(e,t,n)).then((function(e){return e.error?i.handleGeneralErrorState(e,n):i.getState(e,{waitDuration:void 0,clientAttemptsRemaining:void 0,serverAttemptsRemaining:void 0})}))},e.prototype.createSessionState=function(e,t,n){var i=this;return this.oneDriveService.createUploadSession(e.file,e.sessionId,null,null,n).then((function(e){return i.getState(t,{nextExpectedRanges:e.nextExpectedRanges,sessionUrl:e.uploadUrl})}),(function(e){return i.getState(t,{error:e})}))},e.prototype.getStatusState=function(e,t,n){var i=this;return this.oneDriveService.getUploadSessionStatus(t.sessionUrl,e.sessionId,n).then((function(e){return i.getState(t,{nextExpectedRanges:e.nextExpectedRanges})}),(function(e){return i.getState(t,{error:e})}))},e.prototype.uploadItemState=function(e,t,n){var i=this,r=e.file.size,o=this.getNextRange(r,t.nextExpectedRanges);return(o&&o.start<r?this.uploadFragmentState(o,e,t,n):this.cancelSessionState(e,t,n)).then((function(e){return e.error?i.handleUploadItemErrorState(e,n):e}))},e.prototype.uploadFragmentState=function(e,t,n,i){var r=this,o=n.sessionUrl,a=n.speed,l=void 0===a?this.uploadConfig.initialSpeed:a,s=e.start,c=e.end;t.updateProgress(s);var u=this.getFragmentSize(l),d=Math.min(s+u,c),p=l>this.uploadConfig.minSpeed?this.uploadConfig.fragmentTimeoutInMs:this.uploadConfig.fragmentTimeoutInMs*this.uploadConfig.slowFragmentTimeoutMultiplier,h=new C(p,d-s),f=t.file,m=new I.a;return i.onCancel((function(){m.cancel()})),new Promise((function(e){r.oneDriveService.uploadFragment(o,s,d,f.size,f.slice(s,d),t.sessionId,(function(i){var o=s+i.loaded;l>r.uploadConfig.minSpeed&&!h.doesActivityHaveRemainingCapacity(o-s)&&(m.cancel(),e(r.getState(n,{speed:Math.max(l*r.uploadConfig.slowSpeedDowngradeRatio,r.uploadConfig.minSpeed),nextExpectedRanges:void 0}))),t.updateProgress(o)}),m,p).then((function(i){t.updateProgress(d),n=r.isDriveItem(i)?r.getState(n,{item:i}):r.getState(n,{nextExpectedRanges:i.nextExpectedRanges,speed:Math.min(h.didActivityHaveExtraCapacity()?l*r.uploadConfig.speedUpgradeRatio:l,1)}),e(n)}),(function(t){e(r.getState(n,{error:t}))}))}))},e.prototype.cancelSessionState=function(e,t,n){var i=this;return this.oneDriveService.cancelUploadSession(t.sessionUrl,e.sessionId,n).then((function(){return i.getState(t,{sessionUrl:void 0})}),(function(){return i.getState(t,{sessionUrl:void 0})}))},e.prototype.handleUploadItemErrorState=function(e,t){var n=this,i=e.speed,r=void 0===i?1:i;return e=this.getState(e,{nextExpectedRanges:void 0}),this.handleErrorState(e,(function(i){switch(i){case o.a.Offline:case o.a.Unknown:return n.windowService.nativeWindow.navigator.onLine?Promise.resolve(n.getState(e,{speed:Math.max(r*n.uploadConfig.speedDowngradeRatio,n.uploadConfig.minSpeed)})):void 0;case"uploadSessionFailed":case"uploadSessionNotFound":case o.a.NotFound:return Promise.resolve(n.getState(e,{error:void 0,sessionUrl:void 0}));case"invalidRange":case o.a.RangeNotSatisfiable:return n.wait(n.uploadConfig.standardWaitDurationInMs,t).then((function(){return n.getState(e,{error:void 0})}))}}))},e.prototype.handleGeneralErrorState=function(e,t){var n=this,i=e.waitDuration,r=void 0===i?this.uploadConfig.initialWaitDurationInMs:i,a=e.clientAttemptsRemaining,l=void 0===a?this.uploadConfig.numClientAttempts:a,s=e.serverAttemptsRemaining,c=void 0===s?this.uploadConfig.numServerAttempts:s;return this.handleErrorState(e,(function(i){switch(i){case"unauthenticated":case o.a.Unauthorized:case"lockMismatch":case o.a.Locked:case o.a.NotImplemented:case"quotaLimitReached":case o.a.InsufficientStorage:case o.a.Offline:return}if("number"==typeof i){if(i>=400&&i<500)return;if(0===i||i>=500&&i<600){if(!c)return;return n.wait(r,t,!0).then((function(){return n.getState(e,{error:void 0,waitDuration:Math.min(2*r,n.uploadConfig.maxWaitDurationInMs),serverAttemptsRemaining:Math.max(c-1,0)})}))}if(!l)return;return n.wait(n.uploadConfig.standardWaitDurationInMs,t).then((function(){return n.getState(e,{error:void 0,waitDuration:void 0,clientAttemptsRemaining:Math.max(l-1,0)})}))}}))},e.prototype.handleErrorState=function(e,t){var n=b.resolveGraphError(e.error,t);return void 0===n&&(n=Promise.resolve(e)),n},e.prototype.getState=function(e,t){return Object(S.__assign)(Object(S.__assign)({},e),t)},e.prototype.getNextRange=function(e,t){return void 0===t&&(t=[]),t.reduce((function(t,n){var i=Object(S.__read)(n.split("-",2),2),r=i[1],o=parseInt(i[0],10);return!t||o<t.start&&o<e?{start:o,end:""===r?e:Math.min(parseInt(r,10)+1,e)}:t}),void 0)},e.prototype.isDriveItem=function(e){return!!e.id},e.prototype.getFragmentSize=function(e){var t=e*this.uploadConfig.maxFragmentSize;return Math.min(Math.max(t>this.uploadConfig.discreteChunkSize?t-t%this.uploadConfig.discreteChunkSize:t-t%this.uploadConfig.minFragmentSize,this.uploadConfig.minFragmentSize),this.uploadConfig.maxFragmentSize)},e.prototype.wait=function(e,t,n){var i,r=this;void 0===n&&(n=!1);var o,a=new Promise((function(t){i=setTimeout((function(){t()}),e)})),l=new Promise((function(e){r.windowService.nativeWindow.addEventListener("online",o=function(){n&&e()})})),s=t?t.onCancel((function(){return Promise.reject(null)})):new Promise((function(){}));return new Promise((function(e){Promise.race([a,l,s]).then((function(){e()}),(function(){})).then((function(){r.windowService.nativeWindow.removeEventListener("online",o),clearTimeout(i)}))}))},e}(),k=n("keVe"),A=function(){function e(e,t,n,i,r,o,a,l,s){this.contextService=e,this.locService=t,this.oneDriveService=n,this.uploadConfigService=i,this.urlLauncherService=r,this.windowService=o,this.capabilitiesService=a,this.globalErrorHandler=l,this.clientStartupConfigService=s,this.setupUploadPromise(),this.uploadConfigService.config&&(this.stateMachine=new T(this.oneDriveService,this.uploadConfigService,this.windowService))}return e.prototype.upload=function(e,t,n){var r=this,o=this.uploadConfigService.config;if(!o)return null;var a=new g.b(t,e,n),l=new i.a(a);return a.cancellationToken.onCancel((function(){a.sessionUrl&&!a.finished()&&r.oneDriveService.cancelUploadSession(a.sessionUrl,a.sessionId),a.state=g.c.Cancelled,l.next(a)})),a.markCompletedAndOpenedInOfficeHome=function(){a.state=g.c.CompletedAndOpened,l.next(a)},this.isValidFileType(e)?this.startUpload(a,l):(a.error=this.suggestOneDriveErrorWithText(o.oneDriveResources.errorTitle,this.locService.format(o.oneDriveResources.unsupportedFile,this.locService.OpenOneDrive),g.a.InvalidFileType,a),a.state=g.c.Failed,l.next(a)),l.asObservable()},e.prototype.setupUploadPromise=function(){var e=this;return this.uploadEnabledPromise=new Promise((function(t){e.capabilitiesService.capabilities.oneDriveUploadEnabled&&e.uploadConfigService.config?e.oneDriveService.getMyDriveRootUrl().then((function(e){t(!!e)})).catch((function(n){var i;e.globalErrorHandler.handleError(n,"IRW0y");var r=null===(i=null==n?void 0:n.networkError)||void 0===i?void 0:i.httpResponse,a=e.clientStartupConfigService.config.authType===h.a.MSA;t(!(e.capabilitiesService.capabilities.isPwaInUwp||!a&&!e.uploadConfigService.config.capPopupEnabled||(null==r?void 0:r.status)!==o.a.TokenUnavailable||!a&&"CAP_Error"!==(null==r?void 0:r.data)))})):t(!1)})),this.uploadEnabledPromise},e.prototype.startUpload=function(e,t){var n=this;e.state=g.c.Started,t.next(e),this.uploadToOneDrive(e).then((function(n){-1!==e.file.type.indexOf("video")&&(n.webUrl=v.a.appendQueryParam(n.webUrl,"web","1")),e.result=n,e.state=g.c.Completed,t.next(e)}),(function(i){e.error=n.getUploadSessionError(i,e,t),e.state=g.c.Failed,t.next(e)}))},e.prototype.isValidFileType=function(e){var t=l.a.fileTypeFromFileName(e.name);return this.uploadConfigService.config.uploadFileTypes.has(t)},e.prototype.uploadToOneDrive=function(e){var t=this;return(e.file.size<this.uploadConfigService.config.simpleUploadMaxSize?this.uploadSmall(e):this.uploadLarge(e)).then((function(n){var i={};n.webDavUrl&&(i.canonicalUrl=n.webDavUrl);var r=n.webUrl,o=l.a.fileTypeFromFileName(e.file.name);if(t.uploadConfigService.config.editableFileTypes.has(o)){var a="action=edit";-1===(r=r.replace(new RegExp("([?&])action[^&]*"),"$1action=edit")).lastIndexOf(a)&&(r=v.a.appendQuery(r,a))}return i.webUrl=r,i}))},e.prototype.uploadSmall=function(e){return this.oneDriveService.uploadFile(e.file,e.sessionId,null,null,(function(t){return e.updateProgress(t.loaded)}),e.cancellationToken)},e.prototype.uploadLarge=function(e){return this.uploadState(e,{})},e.prototype.uploadState=function(e,t){var n=this,i=t.sessionUrl,r=t.item,o=t.error;return e.sessionUrl=i,new Promise((function(a,l){r?a(r):o&&!i?l(o):o?n.oneDriveService.cancelUploadSession(i,e.sessionId,e.cancellationToken).catch((function(){})).then((function(){return l(o)})):n.stateMachine.advanceState(e,t,e.cancellationToken).then((function(t){n.uploadState(e,t).then(a,l)}),l)}))},e.prototype.getUploadSessionError=function(e,t,n){var i=this,r=this.uploadConfigService.config.oneDriveResources;if(!e.httpResponse||e.clientError)return{title:r.errorTitle,type:g.a.Unknown,message:""};var a=this.uploadConfigService.config.commonResources;return b.resolveGraphError(e,(function(e){switch(e){case"quotaLimitReached":case o.a.InsufficientStorage:return i.suggestOneDriveErrorWithText(r.errorTitle,r.outOfSpace,g.a.OutOfSpace,t);case"maxFileSizeExceeded":case o.a.RequestEntityTooLarge:return{title:r.errorTitle,type:g.a.FileTooLarge,message:r.largeFile};case o.a.Offline:return i.retryErrorWithText(r.errorTitle,a.checkConnection,g.a.BadConnection,t,n);case o.a.TokenUnavailable:case o.a.TokenRefreshFailed:return{title:r.errorTitle,type:g.a.Auth,message:""}}}))||{title:r.errorTitle,type:g.a.Unknown,message:""}},e.prototype.retryErrorWithText=function(e,t,n,i,r){var o=this,a=this.uploadConfigService.config.commonResources;return{title:e,type:n,message:t,recourseAction:{text:a.retryButtonTitle,ariaLabel:a.retryButtonAriaLabel,action:function(){o.startUpload(i,r)},clickData:this.recourseClickDataWithId("upload-retry",i.sessionId,i.uploadSource)}}},e.prototype.suggestOneDriveErrorWithText=function(e,t,i,r){var o=this;return this.contextService.sharedContext.oneDriveUrl?{title:e,type:i,message:t,recourseAction:{text:this.locService.OpenOneDrive,ariaLabel:this.locService.OpenOneDrive,action:function(){o.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(o.contextService.sharedContext.oneDriveUrl,{action:"OpenOneDriveUploadAction"})})):o.urlLauncherService.openUrl(o.contextService.sharedContext.oneDriveUrl,"OpenOneDriveUploadAction")},clickData:this.recourseClickDataWithId("upload-open-onedrive",r.sessionId,r.uploadSource,s.a.OneDrive)}}:{title:e,type:g.a.Unknown,message:""}},e.prototype.recourseClickDataWithId=function(e,t,n,i){var r={};return r.UploadSessionId=t,r.ElementId=e,r.Referral=i,r.Area=a.b.UploadDialog,r.ItemCategory=g.d[n],{eventName:"Upload_Click",params:r,metrics:[]}},e.ɵprov=k.cc({factory:function(){return new e(k.dc(f.a),k.dc(m.a),k.dc(c.a),k.dc(y.a),k.dc(u.a),k.dc(d.b),k.dc(p.a),k.dc(r.b),k.dc(h.b))},token:e,providedIn:"root"}),e}()},"9WrL":function(e,t,n){"use strict";n.d(t,"a",(function(){return be}));var i,r,o,a=n("DQbD"),l=n("GmnP"),s=n("FHrx"),c=n("JWB6"),u=n("fpaX"),d=n("Vwd8"),p=n("7ma0"),h=n("kpuN"),f=n("AXqk"),m=n("W3Zz"),b=n("Z0U4"),v=n("wwmn"),g=n("Uqr9"),y=n("casz"),S=n("w1PR"),w=n("EUVs"),C=n("cgnd"),I=n("/I02"),T=n("JH4S"),k=n("ConB"),A=function(e){return e.Slow2g="Slow2g",e.Standard2g="Standard2g",e.Standard3g="Standard3g",e.Standard4g="Standard4g",e.Unknown="Unknown",e}({}),P=n("zPZ9"),E=n("8/lW"),_=n("V9hE"),O=n("bb6g"),F=n("gB6C"),D=n("pdjy"),M=n("ZBSS"),R=n("zGJG"),x=n("Y22C"),L=n("uqr+");function N(e){return/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(e)}var U,W,B,z,j,H,V,q,G,Z,Q=!1,K=!1,Y="",J=new x.a,X=new x.a;function $(){return new Promise((function(e,t){Object(F.a)((function(){n.e(518).then(n.bind(null,"1vIE")).then((function(t){i=t.App,r=t.Session,o=t.User,B=t.makeBooleanDataField,z=t.makeInt64DataField,j=t.makeStringDataField,W=t.TelemetryLogger,Z=t.SuppressNexus,e()})).catch((function(e){t(e)}))}),D.a)}))}function ee(){return new Promise((function(e,t){Object(F.a)((function(){Promise.all([n.e(29),n.e(519)]).then(n.bind(null,"csY4")).then((function(t){H=t.OneDSSink,V=t.OneDSEndpoint,e()})).catch((function(e){t(e)}))}),D.a)}))}function te(e,t){ne(e,t,!1)}function ne(e,t,n){if(!n&&Q)if(!n&&K){var i=[Y,e].join("."),r=function(e){return Object.keys(e).filter((function(t){return"number"==typeof e[t]||"boolean"==typeof e[t]||"string"==typeof e[t]})).map((function(t){var n=e[t];switch(typeof n){case"number":return z(t,n);case"boolean":return B(t,n);case"string":return j(t,n)}}))}(t);!function(e,t,n,i,r){e.sendTelemetryEvent({eventName:t,dataFields:n,eventFlags:{dataCategories:2,diagnosticLevel:110}})}(n?void 0:U,i,r)}else{var o={eventName:e,params:t};n?X.queueEvent(o):J.queueEvent(o)}}function ie(e){switch(e){case"pfprod":return V.USGOV_DOD;case"tbprod":return V.USGOV_DOJ;default:return V.PUBLIC}}function re(e,t,n){if(n)return"Automation";switch(e){case"dev":case"ppe":case"prodprv":return"Automation";case"prod":case"bfprod":case"pfprod":case"tbprod":case"unprod":case"usprod":return t?"Microsoft":"Production";default:return"Automation"}}var oe=n("uV9m");function ae(e,t,n,a,l,s,c,u,d,p,h,f,m,b,v,g,y,S,w,C,I){(function(e,t,n,a,l,s,c,u,d,p,h,f,m,b,v,g,y,S,w){return m&&b&&function(e,t,n){return n?N(e)&&N(t)&&N(n):N(e)&&N(t)}(s,g,p.tenantId)&&!K?(Q=!0,Y=v,Promise.all([$(),ee()]).then((function(){(U=new W).setTenantToken(v,b,Z),G=function(e,t,n,a,l,s,c,u,d,p,h,f,m,b,v,g,y,S){var w=[a.split(" ")[0].split("-").join(""),"0"].join("."),C=Object(O.__spread)(i.getFields({platform:t,name:e,version:w}),r.getFields({id:s}),[j(Object(L.a)([M.B,M.g]),re(c,p,h)),j(M.i,c)]),I=null==g?void 0:g.puid,T="";I&&(T=(null==g?void 0:g.isMsa)?"MsaPuid":"OrgIdPuid"),C.push.apply(C,Object(O.__spread)(o.getFields({primaryIdentityHash:I,primaryIdentitySpace:T,tenantId:null==g?void 0:g.tenantId,tenantGroup:(null==g?void 0:g.isMsa)?"Consumer":"Commercial",isAnonymous:!1})));var k=[j(M.l,R.b),j(M.C,b),j(M.h,f),j(M.e,n),j(M.D,m),j(M.j,u)];return(null==y?void 0:y.isAdmin)&&k.push(B(Object(L.a)([M.F,M.o]),y.isAdmin)),(null==y?void 0:y.isDynamics)&&k.push(B(Object(L.a)([M.F,M.p]),y.isDynamics)),(null==y?void 0:y.isEdu)&&k.push(B(Object(L.a)([M.F,M.q]),y.isEdu)),(null==y?void 0:y.isEduFaculty)&&k.push(B(Object(L.a)([M.F,M.r]),y.isEduFaculty)),(null==y?void 0:y.isEduStudent)&&k.push(B(Object(L.a)([M.F,M.s]),y.isEduStudent)),(null==y?void 0:y.isFirstVisit)&&k.push(B(Object(L.a)([M.F,M.t]),y.isFirstVisit)),(null==y?void 0:y.isIw)&&k.push(B(Object(L.a)([M.F,M.v]),y.isIw)),(null==y?void 0:y.isSmb)&&k.push(B(Object(L.a)([M.F,M.w]),y.isSmb)),d&&k.push(j(M.m,d)),Object(O.__spread)(C,k)}(e,t,n,a,0,s,c,u,d,h,f,g,y,S,0,p,w),q=new H(G,{endpointUrl:ie(c)}),U.addSink(q),K=!0,function(e){e?X.drainQueue().forEach((function(e){e.eventName&&function(e,t){ne(e,t,!0)}(e.eventName,e.params||{})})):J.drainQueue().forEach((function(e){e.eventName&&te(e.eventName,e.params||{})}))}(!1)})).catch((function(){Q=!1}))):Promise.resolve()})(e,t,n,a,0,s,c,u,p,h,f,m,b,v,g,y,S,w,C).then((function(){Object(oe.b)([{logEvent:te,flush:function(){}}],I,d)})).catch((function(e){var t,n,i=((t={}).Error=(null===(n=null==e?void 0:e.toString)||void 0===n?void 0:n.call(e))||"",t);Object(_.a)("OTEL_Initialization_Error",i)}))}var le=n("f0qX"),se=n("BaAg"),ce=n("H90i"),ue=n("jCfB"),de=!1;function pe(e){if(e.route){var t=e.route;switch(t){case"M365Apps":if(e)return{route:t,appId:e.appId,entityId:e.entityId,subEntityId:e.subEntityId};break;case"SpaceContent":case"SpaceGallery":if(e)return{route:t,spaceId:e.spaceId};break;default:return{route:t,app:se.b[e.app]}}}}function he(e){var t=e.route;switch(e.route){case"M365Apps":return{route:"M365Apps",app:e.appId,entityId:e.entityId,subEntityId:e.subEntityId};case"SpaceContent":return{route:"SpaceContent",spaceId:e.spaceId};case"SpaceGallery":return{route:"SpaceGallery",spaceId:e.spaceId};default:return{route:t,app:se.b[e.app]}}}var fe=n("keVe"),me=n("5MEU"),be=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,h,f,m,b,v,g,y,S){this.clientStartupConfigService=e,this.aadAppId=t,this.accessTokenService=n,this.contextService=i,this.fluidHostContext=r,this.fluidInstrumentationService=o,this.officeHomeApiConfigService=a,this.officeRouteService=l,this.performanceService=s,this.ariaEventFactoryService=c,this.scheduler=u,this.serviceWorkerStateService=d,this.dataSecurityService=p,this.deviceDetector=h,this.ngZone=f,this.themingService=m,this.wacContentService=b,this.workloadQueryParam=v,this.userContextService=g,this.userProfileService=y,this.encryptionConfigService=S}return e.prototype.bootstrapOfficeStart=function(){return function(e,t,i,r,o,a,l,s,c,u,d,p,h,f,b,v,g,y,S,I,T){var _={aadAppId:e,buildVersion:"afcd95b4-8bb2-7c2b-6e99-d62061642275",cdnDomain:s.config.officeStartCdnDomain,correlationId:s.config.sharedClientStartupContext.correlationId,defaultLinkTarget:i.sharedContext.defaultLinkTarget,deploymentEnvironment:s.config.sharedClientStartupContext.deploymentEnvironment,geoName:s.config.sharedClientStartupContext.geoName,getAccessToken:function(e,n,i,r){return t.getAccessToken(e,n,i,void 0,void 0,void 0,r).then((function(e){return{success:e.success,token:e.token,format:e.format,source:e.source,expiryMs:e.expiryMs,error:e.error,clientId:e.clientId,scope:e.scope}}))},getIdentity:function(){return Promise.resolve({isMsa:s.config.authType===C.a.MSA,objectId:s.config.objectId,puid:s.config.puid,tenantId:s.config.tenantId,encryptionConfig:null==T?void 0:T.config,userPrincipalName:s.config.userPrincipalName})},inMockMode:i.sharedContext.inMockMode,isCorpNet:s.config.sharedClientStartupContext.corpNet,jwtAuthEnabled:a.config.jwtAuthEnabled,officeHomeApiRoot:i.sharedContext.officeHomeApiRoot,officeStartManifestVersion:i.sharedContext.officeStartManifestVersion,preferredCulture:i.sharedContext.officeMarket,requestOrigin:s.config.sharedClientStartupContext.requestOrigin,router:{getCurrentRoute:function(){return he(l.getCurrentRoute())},getCurrentPageForLogging:function(){return l.getCurrentPageForLogging()},getRouteObservable:function(){return l.getRouteChangeEndObservable().pipe(Object(le.a)((function(e){return he(e.currentRoute)})))},getUrlForRoute:function(e,t){return l.getUrlForRoute(pe(e),t)},navigateTo:function(e,t,n,i,r){return b.runTask((function(){return"M365Apps"===e.route?l.navigateToPath("m365apps",e.app):l.navigateTo(pe(e),t,n,i,r)}))},openHostedDocument:function(e,t,n,i,a,s){var c;if(i)return o.logPerformanceBootStart(r.getBootId()),r.hostScenarioName=a,r.hostScenarioStartTime=t,l.navigateTo({route:"Content",app:se.b.Fluid},!1,w.a.getWacParams(e.driveId,e.docId,e.canonicalUrl,e.sharepointIds?{siteUrl:e.sharepointIds.siteUrl}:void 0));var u=null==s?void 0:s.actnavid,d=g.bootstrapAndRoute(function(e,t,n){return{docId:e.docId,docUrl:e.canonicalUrl,driveId:e.driveId,fileType:se.b[e.fileType],fileName:e.fileName,wdOrigin:t,applicationUrlParams:n}}(e,n,s),u?((c={})[ue.a.Nav]=u,c):void 0,t);return Promise.resolve(!!d)}},sessionId:s.config.sharedClientStartupContext.sessionId,stringsContainerName:"officestartstrings",darkModeSubscription:v.darkModeSubscription,workload:y,oneDriveUrl:i.sharedContext.oneDriveUrl,oneDriveResourceId:i.sharedContext.oneDriveResourceId,sharePointResourceId:i.sharedContext.sharePointResourceId};return de||(de=!0,n.e(451).then(n.bind(null,"kje2")).then((function(e){e.initializeInstrumentation([{logEvent:function(e,t,n){return u.createEvent(e,t,n).record()},flush:function(){u.flush()}}],(function(t){e.applyCommonStateParams(t,l.getInitialRoute()?l.getInitialRoute().route:"OfficeHome",l.getCurrentRoute()?l.getCurrentRoute().route:"OfficeHome",k.a[d.currentState],E.a[h.securityLevel.toString()],A[f.getNetworkInfo()])}))})),Object(P.b)(_),p.scheduleWork((function(){ae(s.config.sharedClientStartupContext.oTelAppName,function(e){switch(e.getWdOriginApp()){case ce.c.HWA:case ce.c.PWA:return"Universal";default:return"Web"}}(i),function(e){switch(e.getWdOriginApp()){case ce.c.Web:return"Web";case ce.c.HWA:case ce.c.PWA:return"HWA";case ce.c.NTP:return"Edge";case ce.c.Embed:return"Embed";default:return"Web"}}(i),s.config.sharedClientStartupContext.buildDateUtc,0,_.correlationId,_.deploymentEnvironment,function(e){switch(e.getDeviceInfo().platform.platformType){case m.d.AndroidPhone:return"AndroidPhone";case m.d.AndroidTablet:return"AndroidTablet";case m.d.Chromebook:return"Chromebook";case m.d.Linux:return"Linux";case m.d.Mac:return"Mac";case m.d.PC:return"PC";case m.d.WindowsPhone:return"WindowsPhone";case m.d.iPad:return"iPad";case m.d.iPhone:return"iPhone";default:return"Other"}}(f),{pageViewEnabled:s.config.sharedClientStartupContext.oTelPageViewEnabled,actionEnabled:s.config.sharedClientStartupContext.oTelClickEnabled},s.config.sharedClientStartupContext.flights,{isMsa:s.config.authType===C.a.MSA,objectId:s.config.objectId,puid:s.config.puid,tenantId:s.config.tenantId,encryptionConfig:null==T?void 0:T.config,userPrincipalName:s.config.userPrincipalName},s.config.sharedClientStartupContext.corpNet,i.sharedContext.inMockMode,s.config.sharedClientStartupContext.oTelEnabled,s.config.sharedClientStartupContext.oTelAriaTenant,s.config.sharedClientStartupContext.oTelNameSpace,_.sessionId,s.config.sharedClientStartupContext.geoName.toLowerCase(),_.requestOrigin,function(e,t){var n,i,r,o,a,l,s;return{isAdmin:null===(n=null==e?void 0:e.user)||void 0===n?void 0:n.isAdmin,isDynamics:null===(i=null==e?void 0:e.user)||void 0===i?void 0:i.isDynamics,isEdu:null===(r=null==e?void 0:e.user)||void 0===r?void 0:r.isEdu,isEduFaculty:null===(o=null==e?void 0:e.user)||void 0===o?void 0:o.isEduFaculty,isEduStudent:null===(a=null==e?void 0:e.user)||void 0===a?void 0:a.isEduStudent,isFirstVisit:null==t?void 0:t.isFirstVisit(),isIw:null===(l=null==e?void 0:e.user)||void 0===l?void 0:l.isIw,isSmb:null===(s=null==e?void 0:e.user)||void 0===s?void 0:s.isSmb}}(S,I),(function(){return he(l.getCurrentRoute())})),c.mark("OTEL_Ready")}),3)),_}(this.aadAppId,this.accessTokenService,this.contextService,this.fluidHostContext,this.fluidInstrumentationService,this.officeHomeApiConfigService,this.officeRouteService,this.clientStartupConfigService,this.performanceService,this.ariaEventFactoryService,this.serviceWorkerStateService,this.scheduler,this.dataSecurityService,this.deviceDetector,this.ngZone,this.themingService,this.wacContentService,this.workloadQueryParam,this.userContextService,this.userProfileService,this.encryptionConfigService)},e.ɵprov=fe.cc({factory:function(){return new e(fe.dc(C.b),fe.dc(p.a),fe.dc(h.b),fe.dc(I.a),fe.dc(a.a),fe.dc(l.a),fe.dc(v.a),fe.dc(b.a),fe.dc(g.b),fe.dc(u.a),fe.dc(y.a),fe.dc(c.a),fe.dc(f.a),fe.dc(m.b),fe.dc(fe.z),fe.dc(S.b),fe.dc(w.a),fe.dc(me.a),fe.dc(T.a),fe.dc(d.b),fe.dc(s.a,8))},token:e,providedIn:"root"}),e}()},"9c4X":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("iXzu"),r=n("keVe"),o=function(){function e(e){this.ngZone=e}return e.prototype.createAndObserve=function(e,t){var n=new i.default(e);return this.ngZone.runOutsideAngular((function(){n.observe(t)})),n},e.ɵprov=r.cc({factory:function(){return new e(r.dc(r.z))},token:e,providedIn:"root"}),e}()},"9gXN":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("bb6g"),r=n("kpuN"),o=n("cgnd"),a=n("/I02"),l=n("keVe"),s=function(){function e(e,t,n){this.accessTokenService=e,this.clientStartupConfigService=t,this.contextService=n}return e.prototype.getSpacesStorageProvider=function(){var e=this;return this._spacesStorageProvider||(this._spacesStorageProvider=Promise.all([n.e(0),n.e(1),n.e(11),n.e(14),n.e(20),n.e(24),n.e(486)]).then(n.bind(null,"rF6F")).then((function(t){return t.MfsStorageProvider.getOrCreateAsync({getToken:function(){return Object(i.__awaiter)(e,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.accessTokenService.getAccessToken("MfsService")];case 1:return[2,(null==(e=t.sent())?void 0:e.token)||""]}}))}))},tenantId:e.clientStartupConfigService.config.tenantId,userObjectId:e.clientStartupConfigService.config.objectId,userPuid:e.clientStartupConfigService.config.puid,useTinylicious:e.contextService.sharedContext.inMockMode})}))),this._spacesStorageProvider},e.ɵprov=l.cc({factory:function(){return new e(l.dc(r.b),l.dc(o.b),l.dc(a.a))},token:e,providedIn:"root"}),e}()},"9gjh":function(e,t,n){"use strict";n.d(t,"a",(function(){return Le})),n.d(t,"b",(function(){return ai}));var i=n("keVe"),r=n("7IJ8"),o=n("QhWD"),a=n("lrJm"),l=n("cgnd"),s=n("casz"),c=n("RsrG"),u=n("6Po3"),d=n("WLAd"),p=n("EVbV"),h=n("Jn4Q"),f=n("dx17"),m=n("4/We"),b=n("hZW2"),v=n("y1jW"),g=n("7Gwk"),y=n("hhzZ"),S=n("PBJH"),w=n("kfAr"),C=n("AY/E"),I=n("1Bt+"),T=n("TIi1"),k=n("EUVs"),A=n("BMb5"),P=n("TOqr"),E=n("6wOV"),_=n("pzhl"),O=n("PkQn"),F=n("NdOS"),D=n("94Ef"),M=n("M56G"),R=n("jrGV"),x=n("W3Zz"),L=n("u51t"),N=n("g0MB"),U=n("w1PR"),W=function(){function e(e){this.locService=e,this.updateAriaLabel=new i.n}return e.prototype.ngOnChanges=function(){if(this.state=this.analytics?"active":"inactive",this.analytics){var e=this.formatSingularOrPluralString(this.analytics.viewCount,this.locService.DocumentAnalyticsSingleTotalView,this.locService.DocumentAnalyticsMultipleTotalViews),t=this.locService.format(this.locService.DocumentAnalyticsAvgTimeSpent,this.getAvgTimeSpent(this.analytics.averageTimeSpentMs)),n=this.locService.format(this.locService.DocumentAnalyticsAvgCompletion,this.locService.localizedNumberString(Math.floor(100*this.analytics.averageCompletionRatio))),i=this.locService.format(this.locService.DocumentAnalyticsGlancedViews,this.locService.localizedNumberString(this.analytics.glancedReads)),r=this.formatSingularOrPluralString(this.analytics.quickReads,this.locService.DocumentAnalyticsSingleQuickRead,this.locService.DocumentAnalyticsMultipleQuickReads),o=this.formatSingularOrPluralString(this.analytics.deepReads,this.locService.DocumentAnalyticsSingleDeepRead,this.locService.DocumentAnalyticsMultipleDeepReads);this.generalInfo=this.locService.format(this.locService.DocumentAnalyticsTotalViewsAvgTimeSpentAndAvgCompletionFormat,e,t,n),this.detailedViewInfo=this.locService.format(this.locService.DocumentAnalyticsDetailedViewsInfoFormat,i,r,o),this.updateDescription()}},e.prototype.getAvgTimeSpent=function(t){var n=t/6e4;return n<e.spentTimeLessThanStringThreshold?this.locService.format(this.locService.DocumentAnalyticsLessThanAvgTimeSpent,this.locService.localizedNumberString(e.spentTimeLessThanStringThreshold)):this.locService.format(this.locService.DocumentAnalyticsAvgTimeSpentMinutes,this.locService.localizedNumberString(Math.round(n)))},e.prototype.formatSingularOrPluralString=function(e,t,n){return this.locService.format(1===e?t:n,this.locService.localizedNumberString(e))},e.prototype.updateDescription=function(){var e=this.locService.format(this.locService.DocumentDescriptiveAriaLabelAnalytics,this.generalInfo,this.detailedViewInfo);this.updateAriaLabel.emit(e)},e.spentTimeLessThanStringThreshold=1,e}(),B=i.xb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeIn",definitions:[{type:1,expr:"inactive => active",animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"500ms 0ms linear"}],options:null}],options:{}}]}});function z(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"div",[["class","analytics-description__data-piece-label ms-fcl-np"]],null,null,null,null,null)),(e()(),i.Yb(2,null,["",""])),(e()(),i.zb(3,0,null,null,1,"div",[["class","analytics-description__data-piece-label ms-fcl-np"]],null,null,null,null,null)),(e()(),i.Yb(4,null,["",""]))],null,(function(e,t){var n=t.component;e(t,2,0,n.generalInfo),e(t,4,0,n.detailedViewInfo)}))}function j(e){return i.bc(2,[(e()(),i.zb(0,0,null,null,2,"div",[],[[24,"@fadeIn",0]],null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,z)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,2,0,t.component.analytics)}),(function(e,t){e(t,0,0,t.component.state)}))}i.vb("ohp-analytics-description",W,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-analytics-description",[],null,null,null,j,B)),i.yb(1,573440,null,0,W,[S.a],null,null)],null,null)}),{analytics:"analytics"},{updateAriaLabel:"updateAriaLabel"},[]);var H=n("RitX"),V=n("mu6k"),q=n("1GMS"),G=n("cAxl"),Z=n("3bNC"),Q=n("POe7"),K=n("bb6g"),Y=n("+2OL"),J=n("JWB6"),X=n("R7NL"),$=n("oAX+"),ee=function(){function e(e,t,n,i){this.instrumentedHttp=e,this.domSanitizer=t,this.serviceWorkerStateService=n,this.serviceWorkerConfigService=i}return e.prototype.transform=function(e){return $.a.createResultsWithCacheObservable(this.getData(e,"cache-only"),this.getData(e,"network-first")).results},e.prototype.getData=function(e,t){return Object(K.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(K.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.instrumentedHttp.get("Thumbnail_Cache_Pipe_Load",e,{headers:"Controlled"===this.serviceWorkerStateService.currentState&&this.serviceWorkerConfigService.config.enabled?new Map([["X-SW-OHP-ThumbnailCacheable","ODSP_THUMBNAIL_CACHEABLE"]]):null,responseType:"blob"},t)];case 1:return n=r.sent(),i=URL.createObjectURL(n.data),[2,this.domSanitizer.bypassSecurityTrustUrl(i)]}}))}))},e}(),te=n("pd4Y"),ne=n("uH9+"),ie=function(){function e(){}return e.prototype.transform=function(e){return{email:e.address,fullName:e.name}},e}(),re=function(){function e(e,t){this.actionContextMenuService=e,this.deviceDetector=t}return e.prototype.ngOnInit=function(){this.desktop=this.deviceDetector.isDesktopDevice()},e.prototype.onContextMenu=function(e){this.desktop&&this.model&&e&&!this.disabled&&(e.preventDefault(),this.actionContextMenuService.openMenu({id:this.model.id,itemIndex:this.model.itemIndex,actions:this.model.actions,groupInfo:this.model.groupInfo,mouseEvent:e,targetElement:void 0}))},e}(),oe=n("ttrr"),ae=n("5FMq"),le=n("R0N1"),se=n("/I02"),ce=n("xSeq"),ue=n("rbdM"),de=n("kq70"),pe=n("7J/E"),he=n("55A9"),fe=n("TDzr"),me=n("EYcb"),be=n("2lMP"),ve=n("8EWw"),ge=n("Bc8L"),ye=n("QOOv"),Se=n("dOgD"),we=n("Z0U4"),Ce=n("n826"),Ie=n("EqbI"),Te=n("Uqr9"),ke=n("OPwp"),Ae=n("9gXN"),Pe=n("uNUv"),Ee=n("6u39"),_e=n("Brer"),Oe=n("Xc4i"),Fe=n("hoyd"),De=n("7Rc8"),Me=n("DQbD"),Re=n("GmnP"),xe=n("kpuN"),Le=i.xb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeInIsNew",definitions:[{type:1,expr:"inactive => active",animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"500ms 0ms linear"}],options:null}],options:{}},{type:7,name:"recommendedCardHover",definitions:[{type:0,name:"hovered",styles:{type:6,styles:{transform:"scale(1.05)"},offset:null},options:void 0},{type:1,expr:"* => hovered",animation:{type:4,styles:null,timings:"100ms linear"},options:null}],options:{}}]}});function Ne(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,r.a,[o.a,i.O,a.b,l.b,s.a,c.a,u.a,i.z,d.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{listId:0,item:1,hoverZone:2}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component,r=e(t,2,0,n.listId,n.item,i.Ob(t.parent,18));e(t,1,0,"file-card#FileCardModule",r)}),null)}function Ue(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"div",[["class","mru-list-item-overlay"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"div",[["class","spinner-container spinner-container--wh-100"]],null,null,null,null,null)),(e()(),i.zb(2,0,null,null,0,"div",[["class","ms-Spinner-circle ms-Spinner--large"]],null,null,null,null,null))],null,null)}function We(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,p.b,p.a)),i.yb(1,5226496,null,0,h.a,[f.a,m.a,i.h,b.a,v.b,g.a,y.a,S.a,w.a,C.a,I.a,T.a,k.a,A.b],{activities:[0,"activities"],activityDeepLink:[1,"activityDeepLink"],docId:[2,"docId"],index:[3,"index"],fileType:[4,"fileType"],navId:[5,"navId"],numLines:[6,"numLines"],teamsDeepLink:[7,"teamsDeepLink"],area:[8,"area"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.item.lastModifiedActivity,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.item.docId,n.index,n.item.fileType,n.item.navigationId,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea)}),null)}function Be(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,6,"div",[["class","document-card__header"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-card__header--fluent":0}),(e()(),i.zb(3,0,null,null,3,"ohp-activity-description",[],null,null,null,p.b,p.a)),i.yb(4,5226496,null,0,h.a,[f.a,m.a,i.h,b.a,v.b,g.a,y.a,S.a,w.a,C.a,I.a,T.a,k.a,A.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],activityDeepLink:[2,"activityDeepLink"],docId:[3,"docId"],activityDescriptionInput:[4,"activityDescriptionInput"],index:[5,"index"],fileType:[6,"fileType"],navId:[7,"navId"],numLines:[8,"numLines"],teamsDeepLink:[9,"teamsDeepLink"],area:[10,"area"]},null),(e()(),i.ib(16777216,null,0,1,null,We)),i.yb(6,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.fluentRefresh);e(t,1,0,"document-card__header",i),e(t,4,1,[n.item.activities,n.item.lastViewedTime,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.item.docId,n.item.activity,n.index,n.item.fileType,n.item.navigationId,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea]),e(t,6,0,n.item.lastModifiedActivity&&!n.item.activity)}),null)}function ze(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,p.b,p.a)),i.yb(1,5226496,null,0,h.a,[f.a,m.a,i.h,b.a,v.b,g.a,y.a,S.a,w.a,C.a,I.a,T.a,k.a,A.b],{activities:[0,"activities"],activityDeepLink:[1,"activityDeepLink"],docId:[2,"docId"],index:[3,"index"],fileType:[4,"fileType"],navId:[5,"navId"],numLines:[6,"numLines"],teamsDeepLink:[7,"teamsDeepLink"],area:[8,"area"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.item.lastModifiedActivity,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.item.docId,n.index,n.item.fileType,n.item.navigationId,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea)}),null)}function je(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,8,"div",[["class","document-card__header"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-card__header--fluent":0}),i.yb(3,212992,null,0,E.a,[i.l,C.a],{upn:[0,"upn"]},null),(e()(),i.zb(4,0,null,null,4,"ohp-activity-description",[],null,null,null,p.b,p.a)),i.yb(5,5226496,null,0,h.a,[f.a,m.a,i.h,b.a,v.b,g.a,y.a,S.a,w.a,C.a,I.a,T.a,k.a,A.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],showIcon:[2,"showIcon"],person:[3,"person"],activityDeepLink:[4,"activityDeepLink"],docId:[5,"docId"],activityDescriptionInput:[6,"activityDescriptionInput"],index:[7,"index"],fileType:[8,"fileType"],navId:[9,"navId"],numLines:[10,"numLines"],teamsDeepLink:[11,"teamsDeepLink"],area:[12,"area"]},null),i.Sb(6,1),(e()(),i.ib(16777216,null,0,1,null,ze)),i.yb(8,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,r=e(t,2,0,n.fluentRefresh);e(t,1,0,"document-card__header",r),e(t,3,0,n.item.activityUser.email);var o=n.item.activities,a=n.item.lastViewedTime,l=i.Zb(t,5,3,e(t,6,0,i.Ob(t.parent.parent,0),null==n.item.activity?null:n.item.activity.people[0]));e(t,5,1,[o,a,!1,l,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.item.docId,n.item.activity,n.index,n.item.fileType,n.item.navigationId,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea]),e(t,8,0,n.item.lastModifiedActivity&&!n.item.activity)}),null)}function He(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function Ve(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.context.ngIf,i.Gb(1,"",t.component.thumbnailAltText,""))}))}function qe(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"div",[["class","video-duration"]],null,null,null,null,null)),(e()(),i.Yb(1,null,[" "," "]))],null,(function(e,t){e(t,1,0,t.component.item.mediaDuration)}))}function Ge(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,8,"div",[],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,He)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(3,0,null,null,3,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),(e()(),i.ib(16777216,null,null,2,null,Ve)),i.yb(5,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),i.Qb(131072,P.b,[i.h]),(e()(),i.ib(16777216,null,null,1,null,qe)),i.yb(8,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.streamsThumbnailLoaded),e(t,5,0,i.Zb(t,5,0,i.Ob(t,6).transform(n.streamsVideoThumbnail))),e(t,8,0,n.item.mediaDuration)}),(function(e,t){e(t,3,0,!t.component.streamsThumbnailLoaded)}))}function Ze(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function Qe(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.context.ngIf,i.Gb(1,"",t.component.thumbnailAltText,""))}))}function Ke(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,6,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Ze)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(3,0,null,null,3,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),(e()(),i.ib(16777216,null,null,2,null,Qe)),i.yb(5,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),i.Qb(131072,P.b,[i.h])],(function(e,t){var n=t.component;e(t,2,0,n.thumbnailLoaded),e(t,5,0,i.Zb(t,5,0,i.Ob(t,6).transform(n.thumbnail)))}),(function(e,t){e(t,3,0,!t.component.thumbnailLoaded)}))}function Ye(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function Je(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,n){var i=!0,r=e.component;return"load"===t&&(i=!1!==r.onThumbnailLoad()&&i),"error"===t&&(i=!1!==r.onThumbnailError()&&i),i}),null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-card__thumbnail-officefeed-news":0}),i.Sb(3,1),i.Qb(131072,P.b,[i.h])],(function(e,t){var n=e(t,2,0,t.component.isNewsArticle);e(t,1,0,"document-card__thumbnail",n)}),(function(e,t){var n=t.component,r=i.Zb(t,0,0,i.Ob(t,4).transform(i.Zb(t,0,0,e(t,3,0,i.Ob(t.parent.parent.parent.parent,1),n.thumbnailUrl))));e(t,0,0,r,i.Gb(1,"",n.thumbnailAltText,""))}))}function Xe(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,n){var i=!0,r=e.component;return"load"===t&&(i=!1!==r.onThumbnailLoad()&&i),"error"===t&&(i=!1!==r.onThumbnailError()&&i),i}),null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-card__thumbnail-officefeed-news":0})],(function(e,t){var n=e(t,2,0,t.component.isNewsArticle);e(t,1,0,"document-card__thumbnail",n)}),(function(e,t){var n=t.component;e(t,0,0,n.thumbnailUrl,i.Gb(1,"",n.thumbnailAltText,""))}))}function $e(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,9,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Ye)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(3,0,null,null,6,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),i.yb(4,278528,null,0,P.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.Rb(5,{"background-color":0}),(e()(),i.ib(16777216,null,null,1,null,Je)),i.yb(7,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Xe)),i.yb(9,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.thumbnailLoaded);var i=e(t,5,0,n.item.thumbnails&&n.item.thumbnails.backgroundColor?n.item.thumbnails.backgroundColor:"transparent");e(t,4,0,i),e(t,7,0,n.thumbnailSWEnabled),e(t,9,0,!n.thumbnailSWEnabled)}),(function(e,t){e(t,3,0,!t.component.thumbnailLoaded)}))}function et(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"div",[],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null)],(function(e,t){e(t,1,0,t.component.item.documentIconWithSize("64x64"))}),null)}function tt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"img",[["class","document-icon--64x64"]],[[8,"src",4]],null,null,null,null))],null,(function(e,t){e(t,0,0,i.Gb(1,"",t.component.item.iconUrl,""))}))}function nt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","document-card__thumbnail-placeholder"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,et)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,tt)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,!n.item.iconUrl),e(t,4,0,n.item.iconUrl)}),null)}function it(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","mru-list-item__icon-in-preview"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.Rb(2,{color:0}),(e()(),i.zb(3,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,_.b,_.a)),i.yb(4,638976,[[3,4],["fileIconElement",4]],0,O.a,[m.a],{iconFontCssClass:[0,"iconFontCssClass"],size:[1,"size"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.iconFontColor());e(t,1,0,i),e(t,4,0,n.iconFontClass(),"16")}),null)}function rt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"div",[["class","mru-list-item__icon-in-preview mru-list-item__document-icon-in-preview"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(function(e,t){e(t,1,0,"mru-list-item__icon-in-preview mru-list-item__document-icon-in-preview",t.component.item.documentIconWithSize("20x20"))}),null)}function ot(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,it)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,rt)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.iconFontClass()),e(t,4,0,!n.iconFontClass())}),null)}function at(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,nt)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,ot)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,!n.thumbnailLoaded&&!n.isStreamsVideo||!n.streamsThumbnailLoaded&&n.isStreamsVideo),e(t,4,0,!n.recommendedNewCards&&(n.thumbnailLoaded||n.streamsThumbnailLoaded&&n.isStreamsVideo)&&!n.isNewsArticle&&"borderless"!==n.uiCardType&&!n.fluentRefresh)}),null)}function lt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"div",[],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null)],(function(e,t){e(t,1,0,t.component.item.documentIconWithSize("64x64"))}),null)}function st(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"img",[["class","document-icon--64x64"]],[[8,"src",4]],null,null,null,null))],null,(function(e,t){e(t,0,0,i.Gb(1,"",t.component.item.iconUrl,""))}))}function ct(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","document-card__thumbnail-placeholder"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,lt)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,st)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,!n.item.iconUrl),e(t,4,0,n.item.iconUrl)}),null)}function ut(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","mru-list-item__icon-in-preview"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.Rb(2,{color:0}),(e()(),i.zb(3,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,_.b,_.a)),i.yb(4,638976,[[3,4],["fileIconElement",4]],0,O.a,[m.a],{iconFontCssClass:[0,"iconFontCssClass"],size:[1,"size"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.iconFontColor());e(t,1,0,i),e(t,4,0,n.iconFontClass(),"16")}),null)}function dt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"div",[["class","mru-list-item__icon-in-preview mru-list-item__document-icon-in-preview"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(function(e,t){e(t,1,0,"mru-list-item__icon-in-preview mru-list-item__document-icon-in-preview",t.component.item.documentIconWithSize("20x20"))}),null)}function pt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,ut)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,dt)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.iconFontClass()),e(t,4,0,!n.iconFontClass())}),null)}function ht(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,ct)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,pt)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,(!n.thumbnailLoaded||!n.thumbnailUrl)&&!n.isStreamsVideo||!n.streamsThumbnailLoaded&&n.isStreamsVideo),e(t,4,0,!n.recommendedNewCards&&(n.thumbnailUrl&&n.thumbnailLoaded||n.streamsThumbnailLoaded&&n.isStreamsVideo)&&!n.isNewsArticle&&"borderless"!==n.uiCardType&&!n.fluentRefresh)}),null)}function ft(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,13,"div",[["class","document-card__thumbnail-container"],["ohpViewCacheOperation","use-card-placeholder-image"]],[[1,"data-view-cache-operation",0],[1,"data-view-cache-parameters",0]],null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-card__thumbnail-container--recommended":0,"document-card_thumbnail-container--rounded document-card__thumbnail-container--borderless":1,"document-card__thumbnail-container--rounded-card":2,"document-card__thumbnail-container--fluent":3}),i.yb(3,16384,null,0,F.a,[],{viewCacheOperation:[0,"viewCacheOperation"],viewCacheParameters:[1,"viewCacheParameters"]},null),(e()(),i.ib(16777216,null,null,1,null,Ge)),i.yb(5,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Ke)),i.yb(7,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,$e)),i.yb(9,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,at)),i.yb(11,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,ht)),i.yb(13,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.isRecommended||n.isOfficeFeed,"borderless"===n.uiCardType,(n.isRecommended||n.isOfficeFeed)&&n.recommendedNewCards,n.fluentRefresh);e(t,1,0,"document-card__thumbnail-container",i),e(t,3,0,"use-card-placeholder-image",n.item.documentIconWithSize("64x64")),e(t,5,0,n.isStreamsVideo),e(t,7,0,n.thumbnailApiEnabled&&!n.isStreamsVideo&&!n.isNewsArticle&&!n.isMicrosoftForms),e(t,9,0,(!n.thumbnailApiEnabled||n.isNewsArticle||n.isMicrosoftForms)&&n.thumbnailUrl&&!n.isStreamsVideo),e(t,11,0,n.thumbnailApiEnabled),e(t,13,0,!n.thumbnailApiEnabled)}),(function(e,t){e(t,0,0,i.Ob(t,3).viewCacheOperation,i.Ob(t,3).viewCacheParameters)}))}function mt(e){return i.bc(0,[(e()(),i.ib(0,null,null,0))],null,null)}function bt(e){return i.bc(0,[(e()(),i.ib(16777216,null,null,1,null,mt)),i.yb(1,540672,null,0,P.o,[i.O],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,i.Ob(t.parent.parent,44))}),null)}function vt(e){return i.bc(0,[(e()(),i.ib(0,null,null,0))],null,null)}function gt(e){return i.bc(0,[(e()(),i.ib(16777216,null,null,1,null,vt)),i.yb(1,540672,null,0,P.o,[i.O],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,i.Ob(t.parent.parent,45))}),null)}function yt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,p.b,p.a)),i.yb(1,5226496,null,0,h.a,[f.a,m.a,i.h,b.a,v.b,g.a,y.a,S.a,w.a,C.a,I.a,T.a,k.a,A.b],{activities:[0,"activities"],iconSize:[1,"iconSize"],activityDeepLink:[2,"activityDeepLink"],title:[3,"title"],docId:[4,"docId"],index:[5,"index"],fileType:[6,"fileType"],navId:[7,"navId"],numLines:[8,"numLines"],teamsDeepLink:[9,"teamsDeepLink"],area:[10,"area"]},null)],(function(e,t){var n=t.component;e(t,1,1,[n.item.lastModifiedActivity,20,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.recommendedNewCards&&n.item.title,n.item.docId,n.index,n.item.fileType,n.item.navigationId,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea])}),null)}function St(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","list-item__flex-grow"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,3,"ohp-activity-description",[],null,null,null,p.b,p.a)),i.yb(2,5226496,null,0,h.a,[f.a,m.a,i.h,b.a,v.b,g.a,y.a,S.a,w.a,C.a,I.a,T.a,k.a,A.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],iconSize:[2,"iconSize"],activityDeepLink:[3,"activityDeepLink"],title:[4,"title"],docId:[5,"docId"],activityDescriptionInput:[6,"activityDescriptionInput"],index:[7,"index"],fileType:[8,"fileType"],numLines:[9,"numLines"],teamsDeepLink:[10,"teamsDeepLink"],area:[11,"area"]},null),(e()(),i.ib(16777216,null,0,1,null,yt)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,1,[n.item.activities,n.item.lastViewedTime,20,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.recommendedNewCards&&n.item.title,n.item.docId,n.item.activity,n.index,n.item.fileType,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea]),e(t,4,0,n.item.lastModifiedActivity&&!n.item.activity)}),null)}function wt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","document-card__menu"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-card__menu--hidden":0}),(e()(),i.zb(3,0,null,null,1,"ohp-actions-menu",[],null,[[null,"menuToggled"],[null,"menuFocused"]],(function(e,t,n){var i=!0,r=e.component;return"menuToggled"===t&&(i=!1!==r.onActionsMenuToggle(n)&&i),"menuFocused"===t&&(i=!1!==(n?r.onFocus():r.onBlur())&&i),i}),D.b,D.a)),i.yb(4,638976,[[12,4]],0,M.a,[R.a,m.a,x.b,y.a,S.a],{menuModel:[0,"menuModel"],listItemIndex:[1,"listItemIndex"],iconClass:[2,"iconClass"],area:[3,"area"],dataSecurity:[4,"dataSecurity"],leftAlignedCard:[5,"leftAlignedCard"],documentName:[6,"documentName"],actionContextMenuEnabled:[7,"actionContextMenuEnabled"],actionContextMenu:[8,"actionContextMenu"]},{menuToggled:"menuToggled",menuFocused:"menuFocused"})],(function(e,t){var n=t.component,i=e(t,2,0,!n.isTouch);e(t,1,0,"document-card__menu",i),e(t,4,0,n.contextMenu,n.index,n.fluentRefresh?"":"commanding-item__icon ms-fcl-nd",n.instrumentationArea,n.dataSecurityThreshold,n.leftAlignActionsMenu,n.item.fileName,n.actionContextMenuEnabled,n.actionContextMenu)}),null)}function Ct(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,6,"div",[["class","document-card__info centered-flex-container"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-card__info--expanded":0,"document-card__info--fluent":1}),(e()(),i.ib(16777216,null,null,1,null,St)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,wt)),i.yb(6,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,"borderless"===n.uiCardType,n.fluentRefresh);e(t,1,0,"document-card__info centered-flex-container",i),e(t,4,0,n.showActivity),e(t,6,0,n.showActionsMenu)}),null)}function It(e){return i.bc(0,[(e()(),i.zb(0,0,[[1,0],["titleElement",1]],null,4,"span",[],[[8,"title",0]],[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,n){var r=!0;return"mouseenter"===t&&(r=!1!==i.Ob(e,3).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==i.Ob(e,3).onMouseLeave()&&r),"click"===t&&(r=!1!==i.Ob(e,3).onClick()&&r),r}),null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(2,{"ms-fcl-tp-h ms-fcl-tdr-f ms-fcl-tdr-a mru-list-item__title--themed":0}),i.yb(3,16384,null,0,L.a,[m.a,y.a],{area:[0,"area"]},null),(e()(),i.Yb(4,null,["",""]))],(function(e,t){var n=t.component,i=e(t,2,0,n.clickableFolderEnabled);e(t,1,0,i),e(t,3,0,n.instrumentationArea)}),(function(e,t){var n=t.component;e(t,0,0,n.item.title),e(t,4,0,n.item.title)}))}function Tt(e){return i.bc(0,[(e()(),i.zb(0,0,[[1,0],["titleElement",1]],null,4,"h4",[],[[8,"title",0]],[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,n){var r=!0;return"mouseenter"===t&&(r=!1!==i.Ob(e,3).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==i.Ob(e,3).onMouseLeave()&&r),"click"===t&&(r=!1!==i.Ob(e,3).onClick()&&r),r}),null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(2,{"ms-fcl-tp-h ms-fcl-tdr-f ms-fcl-tdr-a mru-list-item__title--themed":0}),i.yb(3,16384,null,0,L.a,[m.a,y.a],{area:[0,"area"]},null),(e()(),i.Yb(4,null,["",""]))],(function(e,t){var n=t.component,i=e(t,2,0,n.clickableFolderEnabled);e(t,1,0,i),e(t,3,0,n.instrumentationArea)}),(function(e,t){var n=t.component;e(t,0,0,n.item.title),e(t,4,0,n.item.title)}))}function kt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"span",[["class","ms-fcl-tp-h ms-fcl-tdr-f ms-fcl-tdr-a attribution-link"],["role","link"],["tabindex","0"]],[[1,"data-href",0],[1,"aria-label",0],[8,"title",0],[8,"innerHTML",1]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.onPathClick(n)&&i),"keyup.enter"===t&&(i=!1!==r.onPathClick(n)&&i),"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),i}),null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"ms-fcl-npa":0,"ms-fcl-ns":1})],(function(e,t){var n=t.component,i=e(t,2,0,n.fluentRefresh,!n.fluentRefresh);e(t,1,0,"ms-fcl-tp-h ms-fcl-tdr-f ms-fcl-tdr-a attribution-link",i)}),(function(e,t){var n=t.component;e(t,0,0,i.Gb(1,"",n.item.isEmailAttachment?n.url:n.item.attributionUrl,""),n.openFolderAriaLabel,i.Gb(1,"",n.openFolderAriaLabel,""),n.shortPath)}))}function At(e){return i.bc(0,[(e()(),i.zb(0,0,[[4,0],["attributionElement",1]],null,0,"span",[],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.shortPath)}))}function Pt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","list-item__text--small list-item__secondary ms-fcl-ns"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,kt)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,At)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.clickableFolderEnabled&&(n.item.isEmailAttachment?n.url:n.item.attributionUrl)),e(t,4,0,!n.clickableFolderEnabled)}),null)}function Et(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"span",[["class","list-item__text--small list-item__title ms-fcl-ns"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-card__text--small":0}),(e()(),i.zb(3,0,null,null,1,"span",[],[[8,"title",0]],null,null,null,null)),(e()(),i.Yb(4,null,["",""]))],(function(e,t){var n=e(t,2,0,t.component.fluentRefresh);e(t,1,0,"list-item__text--small list-item__title ms-fcl-ns",n)}),(function(e,t){var n=t.component;e(t,3,0,n.item.createdBy),e(t,4,0,n.item.createdBy)}))}function _t(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-icon-font",[["class","categories-card--center"],["size","16"]],[[1,"aria-label",0]],null,null,_.b,_.a)),i.yb(1,638976,null,0,O.a,[m.a],{color:[0,"color"],cssClass:[1,"cssClass"],iconFontType:[2,"iconFontType"],size:[3,"size"],title:[4,"title"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.categoryIcon.categoryFontIconColor,"categories-card--center"+(n.isCardCreateByLabel&&null!=n.item&&n.item.createdBy?" categories--padding-left":""),n.categoryIcon&&n.categoryIcon.categoryFontIcon,"16",n.categoryIcon.categoryTooltip)}),(function(e,t){e(t,0,0,t.component.categoryIcon.categoryAriaLabel)}))}function Ot(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","list-item__text--small list-item__tertiary ms-fcl-nd list-item--bottom"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-card__text--small":0}),(e()(),i.zb(3,0,[[1,0],["titleElement",1]],null,1,"span",[],[[8,"title",0]],null,null,null,null)),(e()(),i.Yb(4,null,["",""]))],(function(e,t){var n=e(t,2,0,t.component.fluentRefresh);e(t,1,0,"list-item__text--small list-item__tertiary ms-fcl-nd list-item--bottom",n)}),(function(e,t){var n=t.component;e(t,3,0,n.borderlessCardDetail1),e(t,4,0,n.borderlessCardDetail1)}))}function Ft(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,18,"div",[["class","list-item__flex-grow"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"list-item--h-100":0}),(e()(),i.zb(3,0,null,null,6,"div",[["class","list-item__title ms-fcl-nd"]],null,null,null,null,null)),i.yb(4,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(5,{"list-item__title--double-line":0,"list-item__text--large":1,"list-item__text--large--fluent":2}),(e()(),i.ib(16777216,null,null,1,null,It)),i.yb(7,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Tt)),i.yb(9,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Pt)),i.yb(11,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(12,0,null,null,4,"div",[["style","display:flex;"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Et)),i.yb(14,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,_t)),i.yb(16,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Ot)),i.yb(18,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,"borderless"===n.uiCardType);e(t,1,0,"list-item__flex-grow",i);var r=e(t,5,0,"borderless"===n.uiCardType,!n.fluentRefresh,n.fluentRefresh);e(t,4,0,"list-item__title ms-fcl-nd",r),e(t,7,0,"borderless"!==n.uiCardType),e(t,9,0,"borderless"===n.uiCardType),e(t,11,0,!!n.shortPath&&!n.isAntpExperience&&"borderless"!==n.uiCardType),e(t,14,0,n.isCardCreateByLabel&&(null==n.item?null:n.item.createdBy)),e(t,16,0,n.categoryIcon&&n.categoryIcon.categoryFontIcon),e(t,18,0,n.isFormResponsesEnabled&&n.borderlessCardDetail1)}),null)}function Dt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,7,"div",[["class","list-item__flex-grow"]],null,[[null,"click"],[null,"keyup.enter"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.onPathClick(n)&&i),"keyup.enter"===t&&(i=!1!==r.onPathClick(n)&&i),i}),null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"list-item--h-100":0}),(e()(),i.zb(3,0,null,null,4,"div",[["class","upcomingMeeting-card__join_text"]],null,null,null,null,null)),(e()(),i.zb(4,0,null,null,1,"ohp-icon-font",[["iconFontName","Teams"],["size","16"]],null,null,null,_.b,_.a)),i.yb(5,638976,null,0,O.a,[m.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null),(e()(),i.zb(6,0,null,null,1,"span",[["role","link"],["tabindex","0"]],[[1,"data-href",0],[1,"aria-label",0],[8,"title",0]],[[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),i}),null,null)),(e()(),i.Yb(7,null,[""," "]))],(function(e,t){var n=t.component,i=e(t,2,0,"borderless"===n.uiCardType);e(t,1,0,"list-item__flex-grow",i),e(t,5,0,"upcomingMeeting-card_logo"+(n.fluentRefresh?" upcomingMeeting-card_logo--fluent":""),"Teams","16")}),(function(e,t){var n=t.component;e(t,6,0,null==n.item?null:n.item.joinUrl,null==n.item?null:n.item.joinMeetingText,null==n.item?null:n.item.joinMeetingText),e(t,7,0,n.item.joinMeetingText)}))}function Mt(e){return i.bc(0,[(e()(),i.zb(0,0,[[10,0],["myAnalyticsAddToDoLink",1]],null,1,"span",[["class","myAnalytics-card_action_AddToTODo"],["role","link"],["tabindex","0"]],[[8,"title",0]],[[null,"focus"],[null,"blur"],[null,"click"],[null,"keyup.enter"]],(function(e,t,n){var i=!0,r=e.component;return"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),"click"===t&&(i=!1!==r.onMyAnalyticsClick(n,r.PotentialActionType.PromoteTask)&&i),"keyup.enter"===t&&(i=!1!==r.onMyAnalyticsClick(n,r.PotentialActionType.PromoteTask)&&i),i}),null,null)),(e()(),i.Yb(1,null,[""," "]))],null,(function(e,t){var n=t.component;e(t,0,0,n.addToToDoText),e(t,1,0,n.addToToDoText)}))}function Rt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"span",[["class","myAnalytics-card_viewInTodoIcon"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"ohp-icon-font",[["cssClass","is-new-icon is-new-icon--tile ms-fcl-tp"],["iconFontName","ToDo"],["size","24"]],[[1,"aria-label",0]],null,null,_.b,_.a)),i.yb(2,638976,null,0,O.a,[m.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],title:[3,"title"]},null)],(function(e,t){e(t,2,0,"is-new-icon is-new-icon--tile ms-fcl-tp","ToDo","24",t.component.viewInToDoText)}),(function(e,t){e(t,1,0,t.component.viewInToDoText)}))}function xt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"span",[["class","myAnalytics-card_action_ViewInToDo"],["role","link"],["tabindex","0"]],[[8,"title",0]],[[null,"focus"],[null,"blur"],[null,"click"],[null,"keyup.enter"]],(function(e,t,n){var i=!0,r=e.component;return"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),"click"===t&&(i=!1!==r.onViewToDoClick()&&i),"keyup.enter"===t&&(i=!1!==r.onViewToDoClick()&&i),i}),null,null)),(e()(),i.Yb(1,null,[""," "]))],null,(function(e,t){var n=t.component;e(t,0,0,n.viewInToDoText),e(t,1,0,n.viewInToDoText)}))}function Lt(e){return i.bc(0,[(e()(),i.zb(0,0,[[11,0],["myAnalyticsTaskDoneLink",1]],null,1,"span",[["class","myAnalytics-card_action_Done"],["role","link"],["tabindex","0"]],[[8,"title",0]],[[null,"focus"],[null,"blur"],[null,"click"],[null,"keyup.enter"]],(function(e,t,n){var i=!0,r=e.component;return"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),"click"===t&&(i=!1!==r.onMyAnalyticsClick(n,r.PotentialActionType.MarkTaskAsDone)&&i),"keyup.enter"===t&&(i=!1!==r.onMyAnalyticsClick(n,r.PotentialActionType.MarkTaskAsDone)&&i),i}),null,null)),(e()(),i.Yb(1,null,[""," "]))],null,(function(e,t){var n=t.component;e(t,0,0,n.doneText),e(t,1,0,n.doneText)}))}function Nt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,11,"div",[["class","list-item__flex-grow"]],null,[[null,"click"],[null,"keyup.enter"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.disableClick()&&i),"keyup.enter"===t&&(i=!1!==r.disableClick()&&i),i}),null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"list-item--h-100":0}),(e()(),i.zb(3,0,null,null,8,"div",[["class","myAnalytics-card_action ms-fcl-tp"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Mt)),i.yb(5,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Rt)),i.yb(7,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,xt)),i.yb(9,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Lt)),i.yb(11,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,"borderless"===n.uiCardType);e(t,1,0,"list-item__flex-grow",i),e(t,5,0,n.myAnalyticsState===n.MYA_ITEM_VIEW_STATE),e(t,7,0,n.myAnalyticsState===n.MYA_ITEM_ADDED_STATE),e(t,9,0,n.myAnalyticsState===n.MYA_ITEM_ADDED_STATE),e(t,11,0,n.myAnalyticsState===n.MYA_ITEM_VIEW_STATE)}),null)}function Ut(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","document-card__menu"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-card__menu--hidden":0}),(e()(),i.zb(3,0,null,null,1,"ohp-actions-menu",[],null,[[null,"menuToggled"],[null,"menuFocused"]],(function(e,t,n){var i=!0,r=e.component;return"menuToggled"===t&&(i=!1!==r.onActionsMenuToggle(n)&&i),"menuFocused"===t&&(i=!1!==(n?r.onFocus():r.onBlur())&&i),i}),D.b,D.a)),i.yb(4,638976,[[12,4]],0,M.a,[R.a,m.a,x.b,y.a,S.a],{menuModel:[0,"menuModel"],listItemIndex:[1,"listItemIndex"],iconClass:[2,"iconClass"],area:[3,"area"],dataSecurity:[4,"dataSecurity"],leftAlignedCard:[5,"leftAlignedCard"],documentName:[6,"documentName"],actionContextMenuEnabled:[7,"actionContextMenuEnabled"],actionContextMenu:[8,"actionContextMenu"]},{menuToggled:"menuToggled",menuFocused:"menuFocused"})],(function(e,t){var n=t.component,i=e(t,2,0,!n.isTouch);e(t,1,0,"document-card__menu",i),e(t,4,0,n.contextMenu,n.index,n.fluentRefresh?"":"commanding-item__icon ms-fcl-nd",n.instrumentationArea,n.dataSecurityThreshold,n.leftAlignActionsMenu,n.item.fileName,n.actionContextMenuEnabled,n.actionContextMenu)}),null)}function Wt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,10,"div",[["class","document-card__info centered-flex-container"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-card__info--expanded":0,"document-card__info--fluent":1}),(e()(),i.ib(16777216,null,null,1,null,Ft)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Dt)),i.yb(6,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Nt)),i.yb(8,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Ut)),i.yb(10,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,"borderless"===n.uiCardType,n.fluentRefresh);e(t,1,0,"document-card__info centered-flex-container",i),e(t,4,0,!n.isUpcomingMeeting&&!n.isMyAnalytics),e(t,6,0,n.isUpcomingMeeting),e(t,8,0,n.isMyAnalytics),e(t,10,0,n.showActionsMenu)}),null)}function Bt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,16,"div",[["class","document-card ms-bgc-w"]],[[24,"@recommendedCardHover",0]],[[null,"mouseover"],[null,"mouseleave"]],(function(e,t,n){var i=!0,r=e.component;return"mouseover"===t&&(i=!1!==r.recommendedHover("hovered")&&i),"mouseleave"===t&&(i=!1!==r.recommendedHover("unhovered")&&i),i}),null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"carousel-card":0,"document-card--no-padding":1,"document-card--motion":2,"document-card--fluent":3}),(e()(),i.ib(16777216,null,null,1,null,Be)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,je)),i.yb(6,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,ft)),i.yb(8,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,bt)),i.yb(10,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,gt)),i.yb(12,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Ct)),i.yb(14,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Wt)),i.yb(16,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.isRecommended||n.isOfficeFeed,"borderless"===n.uiCardType||n.fluentRefresh,n.recommendedNewCards,n.fluentRefresh);e(t,1,0,"document-card ms-bgc-w",i),e(t,4,0,n.showActivity&&!n.recommendedNewCards&&!n.isMyAnalytics),e(t,6,0,n.showActivity&&!n.recommendedNewCards&&n.isMyAnalytics),e(t,8,0,!n.isUpcomingMeeting&&!n.isMyAnalytics),e(t,10,0,n.isUpcomingMeeting),e(t,12,0,n.isMyAnalytics),e(t,14,0,n.recommendedNewCards),e(t,16,0,!n.recommendedNewCards)}),(function(e,t){e(t,0,0,t.component.isHovered)}))}function zt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,p.b,p.a)),i.yb(1,5226496,null,0,h.a,[f.a,m.a,i.h,b.a,v.b,g.a,y.a,S.a,w.a,C.a,I.a,T.a,k.a,A.b],{activities:[0,"activities"],activityDeepLink:[1,"activityDeepLink"],docId:[2,"docId"],index:[3,"index"],fileType:[4,"fileType"],navId:[5,"navId"],numLines:[6,"numLines"],teamsDeepLink:[7,"teamsDeepLink"],area:[8,"area"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.item.lastModifiedActivity,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.item.docId,n.index,n.item.fileType,n.item.navigationId,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea)}),null)}function jt(e){return i.bc(0,[(e()(),i.ib(0,null,null,0))],null,null)}function Ht(e){return i.bc(0,[(e()(),i.ib(16777216,null,null,1,null,jt)),i.yb(1,540672,null,0,P.o,[i.O],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,i.Ob(t.parent.parent,44))}),null)}function Vt(e){return i.bc(0,[(e()(),i.ib(0,null,null,0))],null,null)}function qt(e){return i.bc(0,[(e()(),i.ib(16777216,null,null,1,null,Vt)),i.yb(1,540672,null,0,P.o,[i.O],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,i.Ob(t.parent.parent,45))}),null)}function Gt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function Zt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,"div",[["class","document-card--suggested-actions--fallback-background"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.Qb(131072,P.b,[i.h]),i.Rb(3,{"background-color":0})],(function(e,t){var n=t.component,r=e(t,3,0,i.Zb(t,1,0,i.Ob(t,2).transform(n.workloadColorPromise)));e(t,1,0,r)}),null)}function Qt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.context.ngIf,i.Gb(1,"",t.component.thumbnailAltText,""))}))}function Kt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"div",[],[[8,"className",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,i.Gb(1,"icon--suggested-actions--fallback ",t.component.suggestedActionsIcon(),""))}))}function Yt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,13,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Gt)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Zt)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(5,0,null,null,3,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),(e()(),i.ib(16777216,null,null,2,null,Qt)),i.yb(7,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),i.Qb(131072,P.b,[i.h]),(e()(),i.zb(9,0,null,null,2,"div",[["class","document-card__icon-container ms-bgc-w"]],null,null,null,null,null)),(e()(),i.zb(10,0,null,null,1,"div",[["class","mru-list-item__icon-in-preview icon--suggested-actions"]],null,null,null,null,null)),(e()(),i.zb(11,0,null,null,0,"div",[],[[8,"className",0]],null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Kt)),i.yb(13,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,n.thumbnailLoaded),e(t,4,0,!n.thumbnailLoaded),e(t,7,0,i.Zb(t,7,0,i.Ob(t,8).transform(n.thumbnail))),e(t,13,0,!n.thumbnailLoaded)}),(function(e,t){var n=t.component;e(t,5,0,!n.thumbnailLoaded),e(t,11,0,i.Gb(1,"icon--suggested-actions--inner ",n.suggestedActionsIcon(),""))}))}function Jt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function Xt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"div",[],[[8,"className",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,i.Gb(1,"icon--suggested-actions--fallback ",t.component.suggestedActionsIcon(),""))}))}function $t(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,15,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Jt)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(3,0,null,null,7,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),i.yb(4,278528,null,0,P.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.Rb(5,{"background-color":0}),(e()(),i.zb(6,0,null,null,4,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,n){var i=!0,r=e.component;return"load"===t&&(i=!1!==r.onThumbnailLoad()&&i),"error"===t&&(i=!1!==r.onThumbnailError()&&i),i}),null,null)),i.yb(7,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(8,{"document-card__thumbnail-officefeed-news":0}),i.Sb(9,1),i.Qb(131072,P.b,[i.h]),(e()(),i.zb(11,0,null,null,2,"div",[["class","document-card__icon-container ms-bgc-w"]],null,null,null,null,null)),(e()(),i.zb(12,0,null,null,1,"div",[["class","mru-list-item__icon-in-preview icon--suggested-actions"]],null,null,null,null,null)),(e()(),i.zb(13,0,null,null,0,"div",[],[[8,"className",0]],null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Xt)),i.yb(15,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,n.thumbnailLoaded);var i=e(t,5,0,n.item.thumbnails&&n.item.thumbnails.backgroundColor?n.item.thumbnails.backgroundColor:"transparent");e(t,4,0,i);var r=e(t,8,0,n.isNewsArticle);e(t,7,0,"document-card__thumbnail",r),e(t,15,0,!n.thumbnailLoaded)}),(function(e,t){var n=t.component;e(t,3,0,!n.thumbnailLoaded);var r=n.thumbnailSWEnabled?i.Zb(t,6,0,i.Ob(t,10).transform(i.Zb(t,6,0,e(t,9,0,i.Ob(t.parent.parent.parent,1),n.thumbnailUrl)))):n.thumbnailUrl;e(t,6,0,r,i.Gb(1,"",n.thumbnailAltText,"")),e(t,13,0,i.Gb(1,"icon--suggested-actions--inner ",n.suggestedActionsIcon(),""))}))}function en(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,7,"div",[["class","document-card__thumbnail-container document-card__thumbnail-container--suggested-actions"],["ohpViewCacheOperation","use-card-placeholder-image"]],[[1,"data-view-cache-operation",0],[1,"data-view-cache-parameters",0]],null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-card__thumbnail-container--recommended":0,"document-card_thumbnail-container--rounded document-card__thumbnail-container--borderless":1}),i.yb(3,16384,null,0,F.a,[],{viewCacheOperation:[0,"viewCacheOperation"],viewCacheParameters:[1,"viewCacheParameters"]},null),(e()(),i.ib(16777216,null,null,1,null,Yt)),i.yb(5,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,$t)),i.yb(7,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.isRecommended||n.isOfficeFeed,"borderless"===n.uiCardType);e(t,1,0,"document-card__thumbnail-container document-card__thumbnail-container--suggested-actions",i),e(t,3,0,"use-card-placeholder-image",n.item.documentIconWithSize("64x64")),e(t,5,0,n.thumbnailApiEnabled),e(t,7,0,!n.thumbnailApiEnabled&&n.thumbnailUrl)}),(function(e,t){e(t,0,0,i.Ob(t,3).viewCacheOperation,i.Ob(t,3).viewCacheParameters)}))}function tn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-icon-font",[["cssClass","icon--primary-action ms-fcl-bl"]],null,null,null,_.b,_.a)),i.yb(1,638976,null,0,O.a,[m.a],{cssClass:[0,"cssClass"],iconFontType:[1,"iconFontType"],size:[2,"size"]},null)],(function(e,t){e(t,1,0,"icon--primary-action ms-fcl-bl",t.component.primaryActionIconFont,16)}),null)}function nn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"div",[["class","suggested-action--svg-icon ms-fcl-bl"]],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.checklistIcon)}))}function rn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"div",[["class","list-item-column column--commanding"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"ohp-actions-menu",[],null,[[null,"menuToggled"],[null,"menuFocused"]],(function(e,t,n){var i=!0,r=e.component;return"menuToggled"===t&&(i=!1!==r.onActionsMenuToggle(n)&&i),"menuFocused"===t&&(i=!1!==(n?r.onFocus():r.onBlur())&&i),i}),D.b,D.a)),i.yb(2,638976,[[12,4]],0,M.a,[R.a,m.a,x.b,y.a,S.a],{menuModel:[0,"menuModel"],listItemIndex:[1,"listItemIndex"],iconClass:[2,"iconClass"],dataSecurity:[3,"dataSecurity"],documentName:[4,"documentName"],horizontalEllipsis:[5,"horizontalEllipsis"],actionContextMenuEnabled:[6,"actionContextMenuEnabled"],actionContextMenu:[7,"actionContextMenu"]},{menuToggled:"menuToggled",menuFocused:"menuFocused"})],(function(e,t){var n=t.component;e(t,2,0,n.contextMenu,n.index,n.fluentRefresh?"":"commanding-item__icon ms-fcl-nd",n.dataSecurityThreshold,n.item.fileName,!0,n.actionContextMenuEnabled,n.actionContextMenu)}),null)}function on(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,24,"div",[["class","document-card document-card--suggested-action ms-bgc-w"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,6,"div",[["class","document-card__header document-card__header--fluent"]],null,null,null,null,null)),(e()(),i.zb(2,0,null,null,4,"ohp-activity-description",[],null,null,null,p.b,p.a)),i.yb(3,5226496,null,0,h.a,[f.a,m.a,i.h,b.a,v.b,g.a,y.a,S.a,w.a,C.a,I.a,T.a,k.a,A.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],showIcon:[2,"showIcon"],person:[3,"person"],activityDeepLink:[4,"activityDeepLink"],title:[5,"title"],docId:[6,"docId"],activityDescriptionInput:[7,"activityDescriptionInput"],index:[8,"index"],fileType:[9,"fileType"],navId:[10,"navId"],numLines:[11,"numLines"],teamsDeepLink:[12,"teamsDeepLink"],area:[13,"area"],timestampAndTitleInSameLine:[14,"timestampAndTitleInSameLine"]},null),i.Sb(4,1),(e()(),i.ib(16777216,null,0,1,null,zt)),i.yb(6,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(7,0,null,null,0,"div",[["class","suggested-action--dismiss ms-fcl-bl"],["tabindex","0"]],[[8,"innerHTML",1],[8,"title",0],[1,"aria-label",0]],[[null,"click"],[null,"mouseover"],[null,"mouseleave"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.removeItem(n)&&i),"mouseover"===t&&(i=!1!==r.dismissHover(!0)&&i),"mouseleave"===t&&(i=!1!==r.dismissHover(!1)&&i),i}),null,null)),(e()(),i.ib(16777216,null,null,1,null,Ht)),i.yb(9,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,qt)),i.yb(11,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,en)),i.yb(13,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(14,0,null,null,10,"div",[["class","suggested-actions-buttons-container centered-flex-container"]],null,null,null,null,null)),(e()(),i.zb(15,0,null,null,7,"div",[["class","section__buttons-container suggested-actions-buttons-container__cta"]],null,null,null,null,null)),(e()(),i.zb(16,0,null,null,6,"button",[["class","generic-button document-card__button--suggested-actions generic-button--fluentvnext--default"]],null,[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.onSelectPrimaryAction(n)&&i),i}),null,null)),(e()(),i.ib(16777216,null,null,1,null,tn)),i.yb(18,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,nn)),i.yb(20,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(21,0,null,null,1,"span",[["class","generic-button__text ms-fcl-bl"]],null,null,null,null,null)),(e()(),i.Yb(22,null,["",""])),(e()(),i.ib(16777216,null,null,1,null,rn)),i.yb(24,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,r=n.item.activities,o=n.item.lastViewedTime,a=!((null==n.item.activity||null==n.item.activity.people?null:n.item.activity.people.length)>0),l=i.Zb(t,3,3,e(t,4,0,i.Ob(t.parent,0),(null==n.item.activity||null==n.item.activity.people?null:n.item.activity.people.length)>0&&(null==n.item.activity?null:n.item.activity.people[0])));e(t,3,1,[r,o,a,l,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.item.title,n.item.docId,n.item.activity,n.index,n.item.fileType,n.item.navigationId,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea,!0]),e(t,6,0,n.item.lastModifiedActivity&&!n.item.activity),e(t,9,0,n.isUpcomingMeeting),e(t,11,0,n.isMyAnalytics),e(t,13,0,!n.isUpcomingMeeting&&!n.isMyAnalytics),e(t,18,0,n.primaryActionIconFont),e(t,20,0,!n.primaryActionIconFont&&n.showListSvg),e(t,24,0,n.showActionsMenu)}),(function(e,t){var n=t.component;e(t,7,0,n.dismissIsHover?n.dismissSquareFilled:n.dismissSquareRegular,n.dismissItemTitle,n.dismissItemTitle),e(t,22,0,n.primaryAction.title)}))}function an(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,5,"img",[["class","generic-tile__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,n){var i=!0,r=e.component;return"load"===t&&(i=!1!==r.onThumbnailLoad()&&i),"error"===t&&(i=!1!==r.onThumbnailError()&&i),i}),null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.yb(2,278528,null,0,P.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.Rb(3,{"background-color":0}),i.Sb(4,1),i.Qb(131072,P.b,[i.h])],(function(e,t){var n=t.component;e(t,1,0,"generic-tile__thumbnail","generic-tile__thumbnail--"+n.item.fileTypeName.toLowerCase());var i=e(t,3,0,n.item.thumbnails&&n.item.thumbnails.backgroundColor?n.item.thumbnails.backgroundColor:"transparent");e(t,2,0,i)}),(function(e,t){var n=t.component,r=i.Zb(t,0,0,i.Ob(t,5).transform(i.Zb(t,0,0,e(t,4,0,i.Ob(t.parent.parent.parent,1),n.thumbnailUrl))));e(t,0,0,r,i.Gb(1,"",n.thumbnailAltText,""))}))}function ln(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,"img",[["class","generic-tile__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,n){var i=!0,r=e.component;return"load"===t&&(i=!1!==r.onThumbnailLoad()&&i),"error"===t&&(i=!1!==r.onThumbnailError()&&i),i}),null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.yb(2,278528,null,0,P.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.Rb(3,{"background-color":0})],(function(e,t){var n=t.component;e(t,1,0,"generic-tile__thumbnail","generic-tile__thumbnail--"+n.item.fileTypeName.toLowerCase());var i=e(t,3,0,n.item.thumbnails&&n.item.thumbnails.backgroundColor?n.item.thumbnails.backgroundColor:"transparent");e(t,2,0,i)}),(function(e,t){var n=t.component;e(t,0,0,n.thumbnailUrl,i.Gb(1,"",n.thumbnailAltText,""))}))}function sn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","document-tile__icon"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.Rb(2,{color:0}),(e()(),i.zb(3,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,_.b,_.a)),i.yb(4,638976,null,0,O.a,[m.a],{iconFontCssClass:[0,"iconFontCssClass"],size:[1,"size"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.iconFontColor());e(t,1,0,i),e(t,4,0,n.iconFontClass(),"16")}),null)}function cn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"div",[["class","document-tile__icon mru-list-item__document-icon-in-preview"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(function(e,t){e(t,1,0,"document-tile__icon mru-list-item__document-icon-in-preview",t.component.item.documentIconWithSize("20x20"))}),null)}function un(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,10,"div",[],[[8,"hidden",0]],null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(2,{"generic-tile__images":0}),(e()(),i.ib(16777216,null,null,1,null,an)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,ln)),i.yb(6,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,sn)),i.yb(8,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,cn)),i.yb(10,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.thumbnailLoaded);e(t,1,0,i),e(t,4,0,n.thumbnailSWEnabled),e(t,6,0,!n.thumbnailSWEnabled),e(t,8,0,n.iconFontClass()),e(t,10,0,!n.iconFontClass())}),(function(e,t){e(t,0,0,!t.component.thumbnailLoaded)}))}function dn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"div",[],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null)],(function(e,t){e(t,1,0,t.component.item.documentIconWithSize("64x64"))}),null)}function pn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"img",[["class","document-icon--64x64"]],[[8,"src",4]],null,null,null,null))],null,(function(e,t){e(t,0,0,i.Gb(1,"",t.component.item.iconUrl,""))}))}function hn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,5,"div",[["class","generic-tile__fallback-image-container document-tile__fallback-image-container"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,4,"div",[["class","document-tile__fallback-image"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,dn)),i.yb(3,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,pn)),i.yb(5,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,3,0,!n.item.iconUrl),e(t,5,0,n.item.iconUrl)}),null)}function fn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-icon-font",[["cssClass","is-new-icon is-new-icon--tile ms-fcl-tp"],["iconFontName","Glimmer"],["size","12"]],[[1,"aria-label",0]],null,null,_.b,_.a)),i.yb(1,638976,null,0,O.a,[m.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],title:[3,"title"]},null)],(function(e,t){e(t,1,0,"is-new-icon is-new-icon--tile ms-fcl-tp","Glimmer","12",t.component.isNewTitle)}),(function(e,t){e(t,0,0,t.component.isNewTitle)}))}function mn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-icon-font",[["cssClass","document-tile__sharing document-tile__description__icon ms-fcl-np"],["iconFontName","People2"],["size","12"]],[[1,"aria-label",0]],null,null,_.b,_.a)),i.yb(1,638976,null,0,O.a,[m.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,1,0,"document-tile__sharing document-tile__description__icon ms-fcl-np","People2","12")}),(function(e,t){e(t,0,0,t.component.sharedText)}))}function bn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"span",[["class","ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a ms-fcl-ns attribution-link document-tile__attribution"],["role","link"],["tabindex","0"]],[[1,"aria-label",0],[1,"data-href",0],[8,"title",0],[8,"innerHTML",1]],[[null,"click"],[null,"keyup.enter"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.onPathClick(n)&&i),"keyup.enter"===t&&(i=!1!==r.onPathClick(n)&&i),i}),null,null))],null,(function(e,t){var n=t.component;e(t,0,0,n.openFolderAriaLabel,i.Gb(1,"",n.item.isEmailAttachment?n.url:n.item.attributionUrl,""),i.Gb(1,"",n.openFolderAriaLabel,""),n.shortPath)}))}function vn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"span",[["class","document-tile__attribution list-item__text--small ms-fcl-ns"]],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.shortPath)}))}function gn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,6,"div",[["class","document-tile__description"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,mn)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,bn)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,vn)),i.yb(6,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.showSharing&&(null==n.item.sharing?null:n.item.sharing.shared)),e(t,4,0,n.clickableFolderEnabled&&!!n.shortPath),e(t,6,0,!n.clickableFolderEnabled&&!!n.shortPath)}),null)}function yn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,21,"div",[["class","generic-tile"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,4,"div",[["class","generic-tile__images_container"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,un)),i.yb(3,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,hn)),i.yb(5,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(6,0,null,null,9,"div",[["class","document-tile__title-and-icons"]],null,null,null,null,null)),(e()(),i.zb(7,0,null,null,2,"span",[],[[24,"@fadeInIsNew",0]],null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,fn)),i.yb(9,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(10,0,null,null,5,"div",[["class","document-tile__title list-item__text--medium ms-fcl-np"]],null,null,null,null,null)),(e()(),i.zb(11,0,[[1,0],["titleElement",1]],null,4,"span",[],null,[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,n){var r=!0;return"mouseenter"===t&&(r=!1!==i.Ob(e,14).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==i.Ob(e,14).onMouseLeave()&&r),"click"===t&&(r=!1!==i.Ob(e,14).onClick()&&r),r}),null,null)),i.yb(12,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(13,{"ms-fcl-tda-h mru-list-item__title--hover":0}),i.yb(14,16384,null,0,L.a,[m.a,y.a],{area:[0,"area"]},null),(e()(),i.Yb(15,null,["",""])),(e()(),i.zb(16,0,null,null,5,"div",[["class","document-tile__description-wrapper"]],null,null,null,null,null)),(e()(),i.zb(17,0,null,null,4,"div",[["class","document-tile__description-container"]],null,null,null,null,null)),(e()(),i.zb(18,0,null,null,3,"ohp-activity-description",[["iconCssClass","document-tile__description__icon"],["iconSize","12"]],null,null,null,p.b,p.a)),i.yb(19,5226496,null,0,h.a,[f.a,m.a,i.h,b.a,v.b,g.a,y.a,S.a,w.a,C.a,I.a,T.a,k.a,A.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],iconCssClass:[2,"iconCssClass"],iconSize:[3,"iconSize"],activityDescriptionInput:[4,"activityDescriptionInput"],numLines:[5,"numLines"],useSolidIcon:[6,"useSolidIcon"]},null),(e()(),i.ib(16777216,null,0,1,null,gn)),i.yb(21,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,3,0,n.thumbnailUrl),e(t,5,0,!n.thumbnailUrl||!n.thumbnailLoaded),e(t,9,0,n.isNew);var r=e(t,13,0,n.clickableFolderEnabled);e(t,12,0,r),e(t,14,0,n.instrumentationArea),e(t,19,0,n.showOnlyMruActivity?i.bb:n.item.activities,n.item.lastViewedTime,"document-tile__description__icon","12",n.mruActivity&&n.item.activity,1,!0),e(t,21,0,n.showSharing&&(null==n.item.sharing?null:n.item.sharing.shared)||!!n.shortPath)}),(function(e,t){var n=t.component;e(t,7,0,n.isNewAnimationState),e(t,15,0,n.item.title)}))}function Sn(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,r.a,[o.a,i.O,a.b,l.b,s.a,c.a,u.a,i.z,d.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{listId:0,item:1,hoverZone:2}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component,r=e(t,2,0,n.listId,n.item,i.Ob(t.parent,3));e(t,1,0,"file-card#FileCardModule",r)}),null)}function wn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-icon-font",[["cssClass","is-new-icon ms-fcl-tp"],["iconFontName","Glimmer"],["size","12"]],[[1,"aria-label",0]],null,null,_.b,_.a)),i.yb(1,638976,null,0,O.a,[m.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],title:[3,"title"]},null)],(function(e,t){e(t,1,0,"is-new-icon ms-fcl-tp","Glimmer","12",t.component.isNewTitle)}),(function(e,t){e(t,0,0,t.component.isNewTitle)}))}function Cn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-icon-font",[["iconFontName","People2"],["size","14"]],[[1,"aria-label",0]],null,null,_.b,_.a)),i.yb(1,638976,null,0,O.a,[m.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],title:[3,"title"]},null)],(function(e,t){var n=t.component;e(t,1,0,"ms-fcl-np document-column--name__share-icon"+(n.showMobileShareAndActivity?" document-column--name__share-icon--mobile":""),"People2","14",n.sharedText)}),(function(e,t){e(t,0,0,t.component.sharedText)}))}function In(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"span",[],[[8,"title",0]],null,null,null,null)),(e()(),i.Yb(2,null,["",""]))],null,(function(e,t){var n=t.component;e(t,1,0,n.item.createdBy),e(t,2,0,n.item.createdBy)}))}function Tn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-icon-font",[["class","categories-card--center"],["size","16"]],[[1,"aria-label",0]],null,null,_.b,_.a)),i.yb(1,638976,null,0,O.a,[m.a],{color:[0,"color"],cssClass:[1,"cssClass"],iconFontCssClass:[2,"iconFontCssClass"],iconFontType:[3,"iconFontType"],size:[4,"size"],title:[5,"title"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.categoryIcon.categoryFontIconColor,"categories-card--center categories-listview"+(n.isCardCreateByLabel&&null!=n.item&&n.item.createdBy?" categories--padding-left":""),n.categoryIcon.categoryFontIconCssClass?n.categoryIcon.categoryFontIconCssClass:"",n.categoryIcon&&n.categoryIcon.categoryFontIcon,"16",n.categoryIcon.categoryTooltip)}),(function(e,t){e(t,0,0,t.component.categoryIcon.categoryAriaLabel)}))}function kn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,null,null,null,null,null,null,null))],null,null)}function An(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,"ohp-activity-description",[],null,null,null,p.b,p.a)),i.yb(1,5226496,null,0,h.a,[f.a,m.a,i.h,b.a,v.b,g.a,y.a,S.a,w.a,C.a,I.a,T.a,k.a,A.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],iconSize:[2,"iconSize"],activityDescriptionInput:[3,"activityDescriptionInput"],numLines:[4,"numLines"],mobileListItem:[5,"mobileListItem"],useSolidIcon:[6,"useSolidIcon"]},null),(e()(),i.ib(16777216,null,0,1,null,kn)),i.yb(3,540672,null,0,P.o,[i.O],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.showOnlyMruActivity?i.bb:n.item.activities,n.item.lastViewedTime,12,n.mruActivity&&n.item.activity,1,!0,!0),e(t,3,0,i.Ob(t.parent,28))}),null)}function Pn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"span",[["class","ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a ms-fcl-ns attribution-link"],["role","link"],["tabindex","0"]],[[1,"aria-label",0],[1,"data-href",0],[8,"title",0],[8,"innerHTML",1]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.onPathClick(n)&&i),"keyup.enter"===t&&(i=!1!==r.onPathClick(n)&&i),"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),i}),null,null))],null,(function(e,t){var n=t.component;e(t,0,0,n.openFolderAriaLabel,i.Gb(1,"",n.item.isEmailAttachment?n.url:n.item.attributionUrl,""),i.Gb(1,"",n.openFolderAriaLabel,""),n.item.attribution)}))}function En(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),i.Yb(1,null,[" "," "]))],null,(function(e,t){var n=t.component;e(t,1,0,null==n.item.emailReference?null:n.item.emailReference.Subject)}))}function _n(e){return i.bc(0,[(e()(),i.zb(0,0,[[4,0],["attributionElement",1]],null,0,"span",[],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.item.attribution)}))}function On(e){return i.bc(0,[(e()(),i.ib(16777216,null,null,1,null,Pn)),i.yb(1,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,En)),i.yb(3,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,_n)),i.yb(5,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component;e(t,1,0,n.clickableFolderEnabled&&!n.item.isEmailAttachment&&n.item.attribution),e(t,3,0,n.item.isEmailAttachment),e(t,5,0,!n.clickableFolderEnabled&&n.item.attribution)}),null)}function Fn(e){return i.bc(0,[(e()(),i.zb(0,0,[[7,0],["shareTopLevel",1]],null,5,"span",[["aria-haspopup","true"],["class","commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.onShareClick(n,"topLevel",r.ShareControlMode.Share)&&i),"keyup.enter"===t&&(i=!1!==r.onShareClick(n,"topLevel",r.ShareControlMode.Share)&&i),"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),i}),null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"commanding-item--responsive":0,"commanding-item--disabled":1,"column--commanding-mobile":2}),i.yb(3,4210688,null,0,N.a,[i.l,i.D,U.b],null,null),(e()(),i.zb(4,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["iconFontName","Share2"],["size","16"]],null,null,null,_.b,_.a)),i.yb(5,638976,null,0,O.a,[m.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,!n.showMobileShareAndActivity,n.item.isLocal,n.showMobileShareAndActivity);e(t,1,0,"commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a",i),e(t,5,0,"commanding-item__icon ms-fcl-nd","Share2","16",!0)}),(function(e,t){var n=t.component;e(t,0,0,n.shareActionTitle,n.shareActionTitle)}))}function Dn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,"span",[["aria-haspopup","true"],["class","commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.uploadLocal(n)&&i),"keyup.enter"===t&&(i=!1!==r.uploadLocal(n)&&i),"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),i}),null,null)),i.yb(1,4210688,null,0,N.a,[i.l,i.D,U.b],null,null),(e()(),i.zb(2,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["iconFontName","Upload"],["size","16"]],null,null,null,_.b,_.a)),i.yb(3,638976,null,0,O.a,[m.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){e(t,3,0,"commanding-item__icon ms-fcl-nd","Upload","16",!0)}),(function(e,t){var n=t.component;e(t,0,0,n.uploadLocalFileTitle,n.uploadLocalFileTitle)}))}function Mn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,5,"span",[["class","commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.pinItem(n,"topLevel")&&i),"keyup.enter"===t&&(i=!1!==r.pinItem(n,"topLevel")&&i),"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),i}),null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"commanding-item--disabled":0}),i.yb(3,4210688,null,0,N.a,[i.l,i.D,U.b],null,null),(e()(),i.zb(4,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["iconFontName","PinDown"],["size","16"]],null,null,null,_.b,_.a)),i.yb(5,638976,null,0,O.a,[m.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){var n=e(t,2,0,t.component.item.isLocal);e(t,1,0,"commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a",n),e(t,5,0,"commanding-item__icon ms-fcl-nd","PinDown","16",!0)}),(function(e,t){var n=t.component;e(t,0,0,n.pinActionTitle,n.pinActionTitle)}))}function Rn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,"span",[["class","commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.unpinItem(n,"topLevel")&&i),"keyup.enter"===t&&(i=!1!==r.unpinItem(n,"topLevel")&&i),"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),i}),null,null)),i.yb(1,4210688,null,0,N.a,[i.l,i.D,U.b],null,null),(e()(),i.zb(2,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["iconFontName","Unpin"],["size","16"]],null,null,null,_.b,_.a)),i.yb(3,638976,null,0,O.a,[m.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){e(t,3,0,"commanding-item__icon ms-fcl-nd","Unpin","16",!0)}),(function(e,t){var n=t.component;e(t,0,0,n.unpinActionTitle,n.unpinActionTitle)}))}function xn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,12,"div",[["class","list-item-column column--commanding"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"column--commanding--hidden":0}),(e()(),i.ib(16777216,null,null,1,null,Fn)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Dn)),i.yb(6,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Mn)),i.yb(8,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Rn)),i.yb(10,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(11,0,null,null,1,"ohp-actions-menu",[],null,[[null,"menuToggled"],[null,"menuFocused"]],(function(e,t,n){var i=!0,r=e.component;return"menuToggled"===t&&(i=!1!==r.onActionsMenuToggle(n)&&i),"menuFocused"===t&&(i=!1!==(n?r.onFocus():r.onBlur())&&i),i}),D.b,D.a)),i.yb(12,638976,[[12,4]],0,M.a,[R.a,m.a,x.b,y.a,S.a],{menuModel:[0,"menuModel"],listItemIndex:[1,"listItemIndex"],iconClass:[2,"iconClass"],dataSecurity:[3,"dataSecurity"],documentName:[4,"documentName"],actionContextMenuEnabled:[5,"actionContextMenuEnabled"],actionContextMenu:[6,"actionContextMenu"]},{menuToggled:"menuToggled",menuFocused:"menuFocused"})],(function(e,t){var n=t.component,i=e(t,2,0,!n.isTouch);e(t,1,0,"list-item-column column--commanding",i),e(t,4,0,n.shareControlEnabled),e(t,6,0,n.item.isLocal),e(t,8,0,!n.item.isPinned&&n.mruPinEnabled),e(t,10,0,n.item.isPinned&&n.mruPinEnabled),e(t,12,0,n.contextMenu,n.index,n.fluentRefresh?"":"commanding-item__icon ms-fcl-nd",n.dataSecurityThreshold,n.item.fileName,n.actionContextMenuEnabled,n.actionContextMenu)}),null)}function Ln(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"div",[["class","list-item-column column--commanding"]],null,null,null,null,null))],null,null)}function Nn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","list-item-column document-column--responses-forms"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,3,"div",[["class","list-item__text--small ms-fcl-ns"]],null,null,null,null,null)),i.yb(2,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(3,{"list-item__last-accessed":0}),(e()(),i.Yb(4,null,[" "," "]))],(function(e,t){var n=e(t,3,0,t.component.showActionsMenu);e(t,2,0,"list-item__text--small ms-fcl-ns",n)}),(function(e,t){e(t,4,0,t.component.borderlessCardDetail1)}))}function Un(e){return i.bc(0,[(e()(),i.zb(0,0,[[5,0],["timestampElement",1]],null,4,"div",[["class","list-item__text--small ms-fcl-ns"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"list-item__last-accessed":0}),(e()(),i.Yb(3,null,[" "," "])),i.Sb(4,4)],(function(e,t){var n=e(t,2,0,t.component.showActionsMenu);e(t,1,0,"list-item__text--small ms-fcl-ns",n)}),(function(e,t){var n=t.component,r=i.Zb(t,3,0,e(t,4,0,i.Ob(t.parent.parent,2),n.displayTime,n.shortDate,n.displayTimeString,!1));e(t,3,0,r)}))}function Wn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"div",[["class","activity-user-name sharing-column-name ms-fcl-nd"]],[[8,"title",0]],null,null,null,null)),i.yb(1,212992,null,0,E.a,[i.l,C.a],{upn:[0,"upn"]},null),(e()(),i.Yb(2,null,[" "," "]))],(function(e,t){e(t,1,0,t.component.item.sharedByEmail)}),(function(e,t){var n=t.component;e(t,0,0,i.Gb(1,"",n.item.sharedByUsername,"")),e(t,2,0,n.item.sharedByUsername)}))}function Bn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-icon-font",[["aria-hidden","true"],["cssClass","document-column--sharing__share-icon ms-fcl-np"],["iconFontName","People2"],["size","14"]],null,null,null,_.b,_.a)),i.yb(1,638976,null,0,O.a,[m.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,1,0,"document-column--sharing__share-icon ms-fcl-np","People2","14")}),null)}function zn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,6,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Bn)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(3,0,null,null,3,"div",[["class","list-item__text--small sharing-column--text ms-fcl-ns"]],[[8,"title",0]],null,null,null,null)),i.yb(4,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(5,{"sharing-column--text-shared":0}),(e()(),i.Yb(6,null,[" "," "]))],(function(e,t){var n=t.component;e(t,2,0,null==n.item.sharing?null:n.item.sharing.shared);var i=e(t,5,0,null==n.item.sharing?null:n.item.sharing.shared);e(t,4,0,"list-item__text--small sharing-column--text ms-fcl-ns",i)}),(function(e,t){var n=t.component;e(t,3,0,i.Gb(1,"",n.item.sharing?n.item.sharing.shared?n.sharedText:n.privateText:"","")),e(t,6,0,n.item.sharing?n.item.sharing.shared?n.sharedText:n.privateText:"")}))}function jn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,6,"div",[["class","list-item-column"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-column--sharing":0,"document-column--sharing--right":1}),(e()(),i.ib(16777216,null,null,1,null,Wn)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,zn)),i.yb(6,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.showActivity,!n.showActivity);e(t,1,0,"list-item-column",i),e(t,4,0,"shared-mru"===n.listId),e(t,6,0,"shared-mru"!==n.listId)}),null)}function Hn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,p.b,p.a)),i.yb(1,5226496,null,0,h.a,[f.a,m.a,i.h,b.a,v.b,g.a,y.a,S.a,w.a,C.a,I.a,T.a,k.a,A.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],activityDescriptionInput:[2,"activityDescriptionInput"],numLines:[3,"numLines"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.showOnlyMruActivity?i.bb:n.item.activities,n.item.lastViewedTime,n.mruActivity&&n.item.activity,n.mruActivity&&n.item.activity?2:void 0)}),null)}function Vn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","list-item-column document-column--activity"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-column--activity-hidden":0}),(e()(),i.ib(16777216,null,null,1,null,Hn)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.showMobileShareAndActivity);e(t,1,0,"list-item-column document-column--activity",i),e(t,4,0,n.activityEnabled)}),null)}function qn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"div",[["class","list-item-column document-column--analytics document-analytics-container"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"ohp-analytics-description",[],null,[[null,"updateAriaLabel"]],(function(e,t,n){var i=!0;return"updateAriaLabel"===t&&(i=!1!==e.component.onAnalyticsDescriptionChanged(n)&&i),i}),j,B)),i.yb(2,573440,null,0,W,[S.a],{analytics:[0,"analytics"]},{updateAriaLabel:"updateAriaLabel"})],(function(e,t){e(t,2,0,t.component.item.analytics)}),null)}function Gn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,45,"div",[["class","centered-flex-container list-item__height-restrictor"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Sn)),i.yb(2,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(3,0,[[9,0],["mruHoverZone",1]],null,25,"div",[["class","list-item-column"]],null,null,null,null,null)),i.yb(4,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Pb(5,3),(e()(),i.zb(6,0,[[3,0],["fileIconElement",1]],null,0,"div",[],[[8,"className",0],[1,"title",0]],null,null,null,null)),(e()(),i.zb(7,0,null,null,21,"div",[["class","clip"]],null,null,null,null,null)),(e()(),i.zb(8,0,null,null,11,"div",[["class","centered-flex-container"]],null,null,null,null,null)),(e()(),i.zb(9,0,null,null,5,"div",[["class","list-item__text--large list-item__title ms-fcl-nd"]],null,null,null,null,null)),(e()(),i.zb(10,0,[[1,0],["titleElement",1]],null,4,"span",[],[[8,"title",0]],[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,n){var r=!0;return"mouseenter"===t&&(r=!1!==i.Ob(e,13).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==i.Ob(e,13).onMouseLeave()&&r),"click"===t&&(r=!1!==i.Ob(e,13).onClick()&&r),r}),null,null)),i.yb(11,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(12,{"ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a mru-list-item__title--themed":0}),i.yb(13,16384,null,0,L.a,[m.a,y.a],{area:[0,"area"]},null),(e()(),i.Yb(14,null,["",""])),(e()(),i.zb(15,0,null,null,2,"span",[],[[24,"@fadeInIsNew",0]],null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,wn)),i.yb(17,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Cn)),i.yb(19,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(20,0,null,null,8,"div",[["class","list-item__text--small list-item__secondary ms-fcl-ns"]],null,null,null,null,null)),(e()(),i.zb(21,0,null,null,4,"div",[["style","display: flex"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,In)),i.yb(23,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Tn)),i.yb(25,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,An)),i.yb(27,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(e()(),i.ib(0,[["showPath",2]],null,0,null,On)),(e()(),i.ib(16777216,null,null,1,null,xn)),i.yb(30,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Ln)),i.yb(32,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Nn)),i.yb(34,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(35,0,null,null,4,"div",[["class","list-item-column"]],null,null,null,null,null)),i.yb(36,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(37,{"document-column--last-opened":0,"document-column--last-opened--right":1,"document-column--last-opened--subset":2}),(e()(),i.ib(16777216,null,null,1,null,Un)),i.yb(39,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,jn)),i.yb(41,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Vn)),i.yb(43,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,qn)),i.yb(45,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.isFileCardEnabled);var r=e(t,5,0,"document-column--name"+(n.showActivity||n.showAnalytics?"":"--subset"),n.mruAppSuffix?"document-column--name"+n.mruAppSuffix:"",n.showMobileShareAndActivity?"document-column--name-mobile":"");e(t,4,0,"list-item-column",r);var o=e(t,12,0,n.clickableFolderEnabled);e(t,11,0,o),e(t,13,0,n.instrumentationArea),e(t,17,0,n.isNew),e(t,19,0,n.showSharing&&(null==n.item.sharing?null:n.item.sharing.shared)),e(t,23,0,n.isCardCreateByLabel&&(null==n.item?null:n.item.createdBy)),e(t,25,0,n.categoryIcon&&n.categoryIcon.categoryFontIcon),e(t,27,0,n.showMobileShareAndActivity,i.Ob(t,28)),e(t,30,0,n.showActionsMenu),e(t,32,0,!n.showActionsMenu),e(t,34,0,n.isFormResponsesEnabled);var a=e(t,37,0,n.showActivity||n.showAnalytics,!n.showSharing&&!n.showActivity&&!n.showAnalytics,n.showSharing&&!n.showActivity&&!n.showAnalytics);e(t,36,0,"list-item-column",a),e(t,39,0,n.displayTime),e(t,41,0,n.showSharing),e(t,43,0,n.showActivity),e(t,45,0,n.showAnalytics)}),(function(e,t){var n=t.component;e(t,6,0,i.Gb(1,"list-item__icon ",n.item.documentIcon,""),n.item.fileTypeName),e(t,10,0,n.item.title),e(t,14,0,n.item.title),e(t,15,0,n.isNewAnimationState)}))}function Zn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,6,null,null,null,null,null,null,null)),(e()(),i.zb(1,0,[[6,0],["shareControl",1]],null,5,"div",[["class","share-control"]],null,null,null,null,null)),i.yb(2,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(3,{"mru-list-item__share-control mru-list-item__share-control--columns":0}),(e()(),i.zb(4,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(5,475136,null,0,r.a,[o.a,i.O,a.b,l.b,s.a,c.a,u.a,i.z,d.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"],outputs:[2,"outputs"]},null),i.Rb(6,{file:0,index:1,mode:2})],(function(e,t){var n=t.component,i=e(t,3,0,n.showAsListItem());e(t,2,0,"share-control",i);var r=e(t,6,0,n.item,n.index,n.shareControlMode);e(t,5,0,"share-control#ShareControlModule",r,n.shareControlOutputs)}),null)}function Qn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,5,null,null,null,null,null,null,null)),(e()(),i.zb(1,0,null,null,4,"div",[["class","actions-menu-item__flex-content"],["role","menuitem"]],null,null,null,null,null)),(e()(),i.zb(2,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,_.b,_.a)),i.yb(3,638976,null,0,O.a,[m.a],{cssClass:[0,"cssClass"],iconFontType:[1,"iconFontType"],size:[2,"size"]},null),(e()(),i.zb(4,0,null,null,1,"div",[],[[8,"className",0]],null,null,null,null)),(e()(),i.Yb(5,null,["",""]))],(function(e,t){e(t,3,0,i.Gb(1,"actions-menu-item__icon ms-fcl-bl ",t.context.item.disabled?"menu-item__icon--disabled":"",""),t.context.item.icon,"16")}),(function(e,t){e(t,4,0,i.Gb(1,"list-item__title menu-item__title ms-fcl-bl ",t.context.item.disabled?"menu-item__title--disabled":"","")),e(t,5,0,t.context.item.title)}))}function Kn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,5,null,null,null,null,null,null,null)),(e()(),i.zb(1,0,null,null,4,"ohp-menu",[],null,[[null,"selectItem"],[null,"closeMenu"]],(function(e,t,n){var i=!0,r=e.component;return"selectItem"===t&&(i=!1!==r.onSelectASpace(n)&&i),"closeMenu"===t&&(i=!1!==r.onCloseSpacesSubMenu()&&i),i}),H.b,H.a)),i.yb(2,4440064,null,1,V.a,[x.b,b.a,i.h,S.a,i.D,i.l,A.b],{menuModel:[0,"menuModel"]},{selectItem:"selectItem",closeMenu:"closeMenu"}),i.Ub(603979776,13,{menuItems:1}),(e()(),i.ib(0,null,null,1,null,Qn)),i.yb(5,16384,[[13,4]],0,V.b,[i.L],null,null)],(function(e,t){e(t,2,0,t.component.collectionsSubMenuModel)}),null)}function Yn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"div",[["class","upcomingMeeting-card__default upcomingMeeting-card__title"]],[[8,"title",0]],null,null,null,null)),(e()(),i.Yb(1,null,[" "," "]))],null,(function(e,t){var n=t.component;e(t,0,0,n.item.title),e(t,1,0,n.item.title)}))}function Jn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,"div",[["class","upcomingMeeting-card__default upcomingMeeting-card__location"]],[[8,"title",0]],null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"ohp-icon-font",[["cssClass","upcomingMeeting-card__location__icon"],["iconFontName","Location"],["size","16"]],null,null,null,_.b,_.a)),i.yb(2,638976,null,0,O.a,[m.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null),(e()(),i.Yb(3,null,[" "," "]))],(function(e,t){e(t,2,0,"upcomingMeeting-card__location__icon","Location","16")}),(function(e,t){var n=t.component;e(t,0,0,n.item.location),e(t,3,0,n.item.location)}))}function Xn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"ohp-person-picture",[],null,null,null,q.b,q.a)),i.yb(1,573440,null,0,G.a,[Z.a],{person:[0,"person"],isUpcomingMeeting:[1,"isUpcomingMeeting"],status:[2,"status"]},null),i.Sb(2,1)],(function(e,t){var n=i.Zb(t,1,0,e(t,2,0,i.Ob(t.parent.parent.parent,3),null==t.parent.context.$implicit?null:t.parent.context.$implicit.emailAddress));e(t,1,0,n,!0,null==t.parent.context.$implicit||null==t.parent.context.$implicit.status?null:t.parent.context.$implicit.status.response)}),null)}function $n(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,"div",[["class","upcomingMeeting-card__attendees__position"]],null,null,null,null,null)),i.yb(1,212992,null,0,E.a,[i.l,C.a],{upn:[0,"upn"]},null),(e()(),i.ib(16777216,null,null,1,null,Xn)),i.yb(3,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,1,0,t.context.$implicit.emailAddress.address),e(t,3,0,null==t.context.$implicit?null:t.context.$implicit.emailAddress)}),null)}function ei(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"div",[["aria-hidden","true"],["class","person-picture-upcoming-meeting__display "]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"div",[["class","person-picture-upcoming-meeting__text person-picture-upcoming-meeting__placeholder__text"]],null,null,null,null,null)),(e()(),i.Yb(2,null,[" +"," "]))],null,(function(e,t){var n=t.component;e(t,2,0,(null==n.item.attendees?null:n.item.attendees.length)-n.upcomingMeetingAttendeeDisplayMax)}))}function ti(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,14,"div",[["class","document-card__thumbnail-container upcomingMeeting-card__details"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-card__thumbnail-container--suggested-actions":0,"document-card__thumbnail-container--fluent":1}),(e()(),i.zb(3,0,null,null,0,"div",[["class","upcomingMeeting-card__left_rectangle"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Yn)),i.yb(5,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(6,0,null,null,1,"div",[["class","upcomingMeeting-card__default upcomingMeeting-card__time"]],null,null,null,null,null)),(e()(),i.Yb(7,null,[" "," - "," "])),(e()(),i.ib(16777216,null,null,1,null,Jn)),i.yb(9,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(10,0,null,null,4,"div",[["class","upcomingMeeting-card__attendees"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,$n)),i.yb(12,278528,null,0,P.j,[i.O,i.L,i.s],{ngForOf:[0,"ngForOf"]},null),(e()(),i.ib(16777216,null,null,1,null,ei)),i.yb(14,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.showAsSuggestedAction(),!n.showAsSuggestedAction()&&n.fluentRefresh);e(t,1,0,"document-card__thumbnail-container upcomingMeeting-card__details",i),e(t,5,0,n.item.title),e(t,9,0,n.item.location),e(t,12,0,null==n.item.attendees?null:n.item.attendees.slice(0,n.upcomingMeetingAttendeeDisplayMax)),e(t,14,0,n.upcomingMeetingAttendeeDisplayMax<(null==n.item.attendees?null:n.item.attendees.length))}),(function(e,t){var n=t.component;e(t,7,0,n.item.startTime,n.item.endTime)}))}function ni(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-icon-font",[["class","myAnalytics-card_icon"],["iconFontName","Outlook"],["size","24"]],null,null,null,_.b,_.a)),i.yb(1,638976,null,0,O.a,[m.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null)],(function(e,t){e(t,1,0,"Outlook","24")}),null)}function ii(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"span",[["class","myAnalytics-card_title ms-fcl-bl"]],[[8,"title",0]],null,null,null,null)),(e()(),i.Yb(1,null,["",""]))],null,(function(e,t){var n=t.component;e(t,0,0,n.item.title),e(t,1,0,n.item.title)}))}function ri(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"div",[["class","document-card__icon-container ms-bgc-w"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"ohp-icon-font",[["iconFontName","Outlook"],["size","20"]],null,null,null,_.b,_.a)),i.yb(2,638976,null,0,O.a,[m.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null)],(function(e,t){e(t,2,0,"Outlook","20")}),null)}function oi(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,15,"div",[["class","document-card__thumbnail-container"]],null,null,null,null,null)),i.yb(1,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"document-card__thumbnail-container--suggested-actions ms-bgc-nla":0,"document-card__thumbnail-container--fluent":1}),(e()(),i.ib(16777216,null,null,1,null,ni)),i.yb(4,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,ii)),i.yb(6,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(7,0,null,null,6,"div",[],null,null,null,null,null)),(e()(),i.zb(8,0,null,null,5,"span",[["class","myAnalytics-card_text__messageBy ms-fcl-bl"]],null,null,null,null,null)),i.yb(9,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(10,{"myAnalytics-card_text__messageBy--suggested-action":0}),(e()(),i.Yb(11,null,[" ",", "])),(e()(),i.zb(12,0,null,null,1,"span",[["class","myAnalytics-card_text ms-fcl-bl"]],[[8,"title",0]],null,null,null,null)),(e()(),i.Yb(13,null,["",""])),(e()(),i.ib(16777216,null,null,1,null,ri)),i.yb(15,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.showAsSuggestedAction(),!n.showAsSuggestedAction()&&n.fluentRefresh);e(t,1,0,"document-card__thumbnail-container",i),e(t,4,0,!n.showAsSuggestedAction()),e(t,6,0,!n.showAsSuggestedAction());var r=e(t,10,0,n.showAsSuggestedAction());e(t,9,0,"myAnalytics-card_text__messageBy ms-fcl-bl",r),e(t,15,0,n.showAsSuggestedAction())}),(function(e,t){var n=t.component;e(t,11,0,n.item.insightDescriptionPrefix),e(t,12,0,n.item.insightDescription),e(t,13,0,n.item.insightDescription)}))}function ai(e){return i.bc(0,[i.Qb(0,Q.a,[]),i.Qb(0,ee,[X.a,v.b,J.a,Y.a]),i.Qb(0,I.a,[te.a,S.a,ne.a]),i.Qb(0,ie,[]),i.Ub(671088640,1,{titleElement:0}),i.Ub(671088640,2,{mruListItem:0}),i.Ub(671088640,3,{fileIconElement:0}),i.Ub(671088640,4,{attributionElement:0}),i.Ub(671088640,5,{timestampElement:0}),i.Ub(671088640,6,{shareControl:0}),i.Ub(671088640,7,{shareTopLevelElement:0}),i.Ub(671088640,8,{recommendedHoverZone:0}),i.Ub(671088640,9,{mruHoverZone:0}),i.Ub(671088640,10,{myAnalyticsAddToDoElement:0}),i.Ub(671088640,11,{myAnalyticsTaskDoneElement:0}),i.Ub(671088640,12,{actionsMenuElement:0}),(e()(),i.ib(16777216,null,null,1,null,Ne)),i.yb(17,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(18,0,[[8,0],["recommendedHoverZone",1]],null,25,"div",[["class","list-item__body mru-item__body"]],null,[[null,"contextmenu"]],(function(e,t,n){var r=!0;return"contextmenu"===t&&(r=!1!==i.Ob(e,19).onContextMenu(n)&&r),"contextmenu"===t&&(r=!1!==i.Ob(e,20).onContextMenu(n)&&r),r}),null,null)),i.yb(19,81920,null,0,re,[R.a,x.b],{model:[0,"model"],disabled:[1,"disabled"]},null),i.yb(20,81920,null,0,oe.a,[ae.a,x.b],{model:[0,"model"],disabled:[1,"disabled"]},null),(e()(),i.ib(16777216,null,null,1,null,Ue)),i.yb(22,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(23,0,[[2,0],["mruListItem",1]],null,16,"a",[["class","mru-list-item"],["data-clicklog","custom"],["ohpDefaultLinkTarget",""],["rel","noopener"]],[[8,"id",0],[8,"href",4],[1,"aria-label",0],[8,"target",0]],[[null,"click"],[null,"focus"],[null,"blur"],[null,"mouseenter"],[null,"mouseleave"]],(function(e,t,n){var r=!0,o=e.component;return"mouseenter"===t&&(r=!1!==i.Ob(e,28).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==i.Ob(e,28).onMouseLeave()&&r),"mouseenter"===t&&(r=!1!==i.Ob(e,30).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==i.Ob(e,30).onMouseLeave()&&r),"click"===t&&(r=!1!==o.onItemClick(n)&&r),"focus"===t&&(r=!1!==o.onFocus()&&r),"blur"===t&&(r=!1!==o.onBlur()&&r),r}),null,null)),i.yb(24,278528,null,0,P.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(25,{"list-item__focused":0,"mru-list-item__padding":1,"mru-list-item__padding--mobile":2,"mru-list-item--local":3}),i.yb(26,81920,null,0,le.a,[se.a],null,null),i.yb(27,4210688,null,0,ce.a,[i.l,i.h],{focusOnLoad:[0,"focusOnLoad"]},null),i.yb(28,16384,null,0,ue.a,[m.a,k.a],{hoverDelay:[0,"hoverDelay"],itemInfo:[1,"itemInfo"]},null),i.Rb(29,{item:0,wdOriginType:1}),i.yb(30,16384,null,0,de.a,[m.a,k.a],{hoverDelay:[0,"hoverDelay"],itemInfo:[1,"itemInfo"]},null),i.Rb(31,{item:0,wdOriginType:1}),(e()(),i.ib(16777216,null,null,1,null,Bt)),i.yb(33,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,on)),i.yb(35,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,yn)),i.yb(37,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Gn)),i.yb(39,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Zn)),i.yb(41,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Kn)),i.yb(43,16384,null,0,P.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(0,[["upcomingMeetingTitle",2]],null,0,null,ti)),(e()(),i.ib(0,[["myAnalyticsTitle",2]],null,0,null,oi))],(function(e,t){var n=t.component;e(t,17,0,n.isFileCardEnabled&&n.showAsCard()),e(t,19,0,n.actionContextMenu,!n.actionContextMenuEnabled),e(t,20,0,n.contextMenu,n.actionsMenuOpen||n.actionContextMenuEnabled),e(t,22,0,n.mruItemState===n.MRU_ITEM_LOADING_STATE);var i=e(t,25,0,n.itemFocused||n.actionsMenuOpen,n.showAsListItem(),n.showAsListItem()&&n.showMobileShareAndActivity,n.item.isLocal);e(t,24,0,"mru-list-item",i),e(t,26,0),e(t,27,0,n.focusOnLoad);var r=n.wacHostHoverPrebootEnabled?500:n.showAsCard()?200:150,o=e(t,29,0,n.item,n.getWdOriginTaskForClick());e(t,28,0,r,o);var a=n.wacHostHoverPrebootEnabled?500:n.showAsCard()?200:150,l=e(t,31,0,n.item,n.getWdOriginTaskForClick());e(t,30,0,a,l),e(t,33,0,n.showAsCard()),e(t,35,0,n.showAsSuggestedAction()&&n.primaryAction),e(t,37,0,n.showAsTile()),e(t,39,0,n.showAsListItem()),e(t,41,0,n.showDesktopShareControl),e(t,43,0,n.collectionsSubMenuModel)}),(function(e,t){var n=t.component;e(t,23,0,n.listId+"-"+n.item.id,i.Gb(1,"",n.url,""),n.descriptiveAriaLabel,i.Ob(t,26).target)}))}i.vb("ohp-mru-item",be.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"ohp-mru-item",[],null,null,null,ai,Le)),i.Tb(512,null,pe.a,pe.a,[S.a,se.a,he.a,fe.a,g.a,me.a,l.b]),i.yb(2,770048,null,0,be.a,[f.a,m.a,l.b,ve.a,se.a,te.a,x.b,b.a,v.b,g.a,y.a,ge.a,S.a,ye.a,w.a,pe.a,Se.a,we.a,Ce.a,Ie.a,Te.b,i.D,I.a,ke.b,Ae.a,Pe.a,Ee.a,T.a,_e.a,Oe.a,k.a,A.b,Fe.a,De.a,Me.a,Re.a,xe.b],null,null)],(function(e,t){e(t,2,0)}),null)}),{item:"item",index:"index",relativeIndex:"relativeIndex",view:"view",listId:"listId",focusOnLoad:"focusOnLoad",showActivity:"showActivity",showSharing:"showSharing",showAnalytics:"showAnalytics",mruAppType:"mruAppType",leftAlignActionsMenu:"leftAlignActionsMenu"},{addItem:"addItem",deleteItem:"deleteItem",changePinState:"changePinState"},[])},"A/um":function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Accepted=1]="Accepted",e[e.Access=2]="Access",e[e.AccountActivity=3]="AccountActivity",e[e.Add=4]="Add",e[e.AddTo=5]="AddTo",e[e.Alert=6]="Alert",e[e.ArrowLeft=7]="ArrowLeft",e[e.ArrowRight=8]="ArrowRight",e[e.At=9]="At",e[e.Attach=10]="Attach",e[e.Calendar=11]="Calendar",e[e.Chat=12]="Chat",e[e.CheckMark=13]="CheckMark",e[e.ChevronDown=14]="ChevronDown",e[e.ChevronLeft=15]="ChevronLeft",e[e.ChevronRight=16]="ChevronRight",e[e.ChevronUp=17]="ChevronUp",e[e.CircleEmpty=18]="CircleEmpty",e[e.CircleInfo=19]="CircleInfo",e[e.Comment=20]="Comment",e[e.Compass=21]="Compass",e[e.ContactCardSettings=22]="ContactCardSettings",e[e.Copy=23]="Copy",e[e.Declined=24]="Declined",e[e.Delete=25]="Delete",e[e.Devices3=26]="Devices3",e[e.Diamond=27]="Diamond",e[e.Document=28]="Document",e[e.Download=29]="Download",e[e.Ellipsis=30]="Ellipsis",e[e.Excel=31]="Excel",e[e.FavoriteStar=32]="FavoriteStar",e[e.Filter=33]="Filter",e[e.FilterSolid=34]="FilterSolid",e[e.Folder=35]="Folder",e[e.FolderOpen=36]="FolderOpen",e[e.GiftCard=37]="GiftCard",e[e.Group=38]="Group",e[e.Hide=39]="Hide",e[e.HighLander=40]="HighLander",e[e.Link=41]="Link",e[e.ListBullets=42]="ListBullets",e[e.Location=43]="Location",e[e.Mail=44]="Mail",e[e.Minus=45]="Minus",e[e.Move=46]="Move",e[e.News=47]="News",e[e.Office2=48]="Office2",e[e.OfficeForms=49]="OfficeForms",e[e.OfficeStore=50]="OfficeStore",e[e.OfficeThreshold=51]="OfficeThreshold",e[e.OneDrive=52]="OneDrive",e[e.Onenote2=53]="Onenote2",e[e.Outlook=54]="Outlook",e[e.Page=55]="Page",e[e.Pencil=56]="Pencil",e[e.PencilSolid=57]="PencilSolid",e[e.People2=58]="People2",e[e.Permissions=59]="Permissions",e[e.SharePoint=60]="SharePoint",e[e.Person=61]="Person",e[e.PhotoVideoMedia=62]="PhotoVideoMedia",e[e.PinDown=63]="PinDown",e[e.PlayerSettings=64]="PlayerSettings",e[e.Placeholder=65]="Placeholder",e[e.PollResults=66]="PollResults",e[e.PowerBI=67]="PowerBI",e[e.PowerPoint=68]="PowerPoint",e[e.Preview=69]="Preview",e[e.PreviewLink=70]="PreviewLink",e[e.Project=71]="Project",e[e.Publisher=72]="Publisher",e[e.Question=73]="Question",e[e.Restore=74]="Restore",e[e.Save=75]="Save",e[e.Search=76]="Search",e[e.Settings=77]="Settings",e[e.Share2=78]="Share2",e[e.SkypeForBusiness=79]="SkypeForBusiness",e[e.SortDown=80]="SortDown",e[e.SortUp=81]="SortUp",e[e.Stream=82]="Stream",e[e.Sway=83]="Sway",e[e.Sync=84]="Sync",e[e.Task=85]="Task",e[e.Teams=86]="Teams",e[e.TentativelyAccepted=87]="TentativelyAccepted",e[e.TextDocument=88]="TextDocument",e[e.TileView=89]="TileView",e[e.ToDo=90]="ToDo",e[e.Trending=91]="Trending",e[e.Unfavorite=92]="Unfavorite",e[e.Unpin=93]="Unpin",e[e.Video=94]="Video",e[e.Visio=95]="Visio",e[e.Upload=96]="Upload",e[e.Waffle=97]="Waffle",e[e.Word=98]="Word",e[e.X=99]="X",e[e.X2=100]="X2"}(i||(i={}))},AGMK:function(e,t,n){"use strict";function i(){return document.visibilityState}function r(){return"visible"===i()}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}))},AXM8:function(e,t,n){},AXqk:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"AY/E":function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var i=n("31lE"),r=n("mXGw"),o=n("xARA"),a=n("hhzZ"),l=n("4/We"),s=n("cgnd"),c=n("/I02"),u=n("JH4S"),d=n("kpuN"),p=n("Bc8L"),h=n("dFxn"),f=n("keVe"),m=function(){function e(e){this.config=e.parse("peopleCardConfig")}return e.ɵprov=f.cc({factory:function(){return new e(f.dc(h.a))},token:e,providedIn:"root"}),e}(),b=n("Uqr9"),v=n("casz"),g=n("w1PR"),y=n("TIi1"),S=n("BMb5"),w=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p){var h=this;if(this.accessTokenService=e,this.capabilitiesService=t,this.contextService=n,this.startupConfigService=i,this.instrumentationService=r,this.peopleCardConfigService=o,this.localAppLauncherService=a,this.urlLauncherService=l,this.windowService=s,this.scheduler=c,this.ngZone=u,this.themingService=d,this.userContextService=p,this.peopleCount=0,this.capabilitiesService.capabilities.darkModeEnabled){var f="rgba(255,255,255,0.75)";this.darkTheme={palette:{themeDarker:f,themeDark:f,themeDarkAlt:f,themePrimary:f,themeSecondary:f,themeTertiary:f,themeLight:f,themeLighter:f,themeLighterAlt:f,black:"#ffffff",blackTranslucent40:"rgba(255, 255, 255, 0.40)",neutralDark:"#ffffff",neutralPrimary:"#f8f8f8",neutralPrimaryAlt:"#f4f4f4",neutralSecondary:"#eaeaea",neutralTertiary:"#a6a6a6",neutralTertiaryAlt:"#767676",neutralQuaternary:"#6b6b6b",neutralQuaternaryAlt:"#707070",neutralLight:"#666666",neutralLighter:"#333333",neutralLighterAlt:"#212121",accent:f,white:"#333333",whiteTranslucent40:"rgba(0, 0, 0, 0.40)"}},this.darkModeSubscription=this.themingService.darkModeSubscription.subscribe((function(e){h.isDarkMode=e,h.lpc&&h.lpc.loadTheme(h.isDarkMode?h.darkTheme:void 0)}))}}return e.prototype.addPersonaCard=function(e,t){var n=this;return this.capabilitiesService.capabilities.peopleCardsEnabled?this.peopleCardConfigService.config?this.ngZone.runOutsideAngular((function(){return n.bootstrap().then((function(){n.lpc&&(n.lpc.addedPersonaToPageV2(e,{personaInfo:{identifiers:{Smtp:t,PersonaType:"User"}},externalAppSessionCorrelationId:n.startupConfigService.config.sharedClientStartupContext.correlationId,behavior:{onCardOpen:function(){var r={};r.ElementId=e.id,r.ItemId=new a.d(t,i.AWTPiiKind.SmtpAddress),n.instrumentationService.logImpressionEvent("People_Card_Impression",r)},onCardClose:null,disableHover:!1}}),n.peopleCount++)}))})):Promise.reject("peopleCardConfigService.config is not defined"):Promise.reject("People cards disabled")},e.prototype.addPersonaCardElement=function(e,t,n,l){var s=this;return void 0===n&&(n=""),void 0===l&&(l=!0),this.capabilitiesService.capabilities.peopleCardsEnabled?this.peopleCardConfigService.config?this.ngZone.runOutsideAngular((function(){return s.bootstrap().then((function(){if(s.lpc){var c={cardParameters:{personaInfo:{identifiers:{AadObjectId:t,PersonaType:"User",Smtp:n}},externalAppSessionCorrelationId:s.startupConfigService.config.sharedClientStartupContext.correlationId,behavior:{onCardOpen:function(){var n={};n.ElementId=e.id,n.ItemId=new a.d(t,i.AWTPiiKind.Identity),s.instrumentationService.logImpressionEvent("People_Card_Impression",n)},locationToOpen:l?"ExpandedView":"Card"}}};o.render(r.createElement(s.windowService.nativeWindow.LivePersonaCardHoverTargetV2,c,r.createElement("div",{id:"personCardClickElement"})),e)}}))})):Promise.reject("peopleCardConfigService.config is not defined"):Promise.reject("People cards disabled")},e.prototype.removePersonaCard=function(e,t){var n=this;return this.capabilitiesService.capabilities.peopleCardsEnabled?this.peopleCardConfigService.config?this.initPromise?this.ngZone.runOutsideAngular((function(){return n.initPromise.then((function(){n.lpc&&(n.lpc.removedPersonaFromPage(e,t),n.peopleCount--)}))})):Promise.reject("removePersonaCard is called without calling addPersonaCard first"):Promise.reject("peopleCardConfigService.config is not defined"):Promise.reject("People cards disabled")},e.prototype.bootstrap=function(){var e=this;if(!this.initPromise)if(this.peopleCardConfigService.config){this.startTime=b.a.now();var t={actionCallbacks:this.capabilitiesService.capabilities.pwaEnabled?{openDocument:function(t){e.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchApp(t.Type,t.DownloadUrl,{action:"OpenDocument"}).then((function(e){if(!e.success)throw new Error("fallback to browser")})).catch((function(){e.launchUrl(t.WebUrl,{action:"OpenDocFromPeopleCard"})}))})):e.localAppLauncherService.launchOfficeApp(t.Type,t.DownloadUrl).then((function(e){if(!e)throw new Error("fallback to browser")})).catch((function(){e.urlLauncherService.openUrl(t.WebUrl,"OpenDocFromPeopleCard")}))},composeMail:function(t){e.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl("mailto:"+t,{action:"EmailFromPeopleCard"})})):e.urlLauncherService.openUrl("mailto:"+t,"EmailFromPeopleCard")},startChat:function(t){e.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(t.imAddressUrl,{action:"OpenChatFromPeopleCard"})})):e.urlLauncherService.openUrl(t.imAddressUrl,"OpenChatFromPeopleCard")},handleContactNumber:function(t){e.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl("tel:"+t,{action:"HandleNumberFromPeopleCard"})})):e.urlLauncherService.openUrl("tel:"+t,"HandleNumberFromPeopleCard")}}:void 0,culture:this.contextService.sharedContext.officeMarket,region:this.peopleCardConfigService.config.region,clientType:this.peopleCardConfigService.config.clientType,clientContextType:this.peopleCardConfigService.config.clientContextType,clientCorrelationId:this.startupConfigService.config.sharedClientStartupContext.correlationId,logMessage:function(e,t,n){},getAuthToken:function(t,n){e.getAuthToken((function(i,r){i?t(i,e.startupConfigService.config.sharedClientStartupContext.correlationId):n(r,e.startupConfigService.config.sharedClientStartupContext.correlationId)}))},isConsumer:this.startupConfigService.config.authType===s.a.MSA,complianceEnvironment:this.getLpcEnvironment(),theme:this.isDarkMode?this.darkTheme:void 0},i=new Promise((function(t){e.scheduler.scheduleWork((function(){e.importBootstrapper().then(t)}),4)}));this.initPromise=i.then((function(n){var i=n.initializeLivePersonaCardAsync;return new Promise((function(n,r){e.scheduler.scheduleWork((function(){i(t).then((function(){return n(null)})).catch(r)}),4)}))})).then((function(){e.windowService.ensureZoneJs(),e.lpc=e.windowService.nativeWindow.LPC;var t=b.a.now()-e.startTime;e.instrumentInitialization("Start",t)}),(function(t){e.windowService.ensureZoneJs();var n=b.a.now()-e.startTime;e.instrumentInitialization("Error",n,t)}))}else this.initPromise=Promise.reject("peopleCardConfigService.config is not defined");return this.initPromise},e.prototype.population=function(){return this.peopleCount},e.prototype.ngOnDestroy=function(){var e;null===(e=this.darkModeSubscription)||void 0===e||e.unsubscribe()},e.prototype.instrumentInitialization=function(t,n,i){var r={};r.State=t,r.Latency=Math.ceil(n).toString(),i&&(r.Error="string"==typeof i&&0===i.indexOf(e.errorPrefix)?i:new a.d(i)),this.instrumentationService.logGenericEvent("People_Card_Initialization",r)},e.prototype.getAuthToken=function(e){this.accessTokenService.getAccessToken("Loki").then((function(t){e(t.token,t.error?"Error : "+t.error:"")}))},e.prototype.importBootstrapper=function(){return n.e(458).then(n.t.bind(null,"48C2",7))},e.prototype.getLpcEnvironment=function(){var e=this.peopleCardConfigService.config.complianceEnvironment;return this.userContextService.user.isGcc&&"Prod"===e?"GccModerate":e},e.errorPrefix="LPCError: ",e.ɵprov=f.cc({factory:function(){return new e(f.dc(d.b),f.dc(l.a),f.dc(c.a),f.dc(s.b),f.dc(a.a),f.dc(m),f.dc(p.a),f.dc(y.a),f.dc(S.b),f.dc(v.a),f.dc(f.z),f.dc(g.b),f.dc(u.a))},token:e,providedIn:"root"}),e}()},Ax7d:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("f0qX"),r=n("BaAg"),o=n("dFxn"),a=n("keVe"),l=n("RuSG"),s=function(){function e(e,t){this.breakpointObserver=t,this.manifestData=e.parse("webManifestConfig")||{name:null,short_name:null,start_url:null,scope:null,display:null,orientation:null,icons:[],background_color:null,theme_color:null},this.isStandalone=this.breakpointObserver.observe("(display-mode: standalone)").pipe(Object(i.a)((function(e){return e.matches})))}return e.prototype.getManifestFileType=function(){return r.a.fileTypeNameToFileType(this.manifestData.short_name)},e.prototype.isOfficeApp=function(){return"Office"===this.manifestData.name},e.prototype.hasManifest=function(){return!!this.manifestData.name},e.ɵprov=a.cc({factory:function(){return new e(a.dc(o.a),a.dc(l.a))},token:e,providedIn:"root"}),e}()},BJFG:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("Bc8L"),r=n("Z0U4"),o=n("TIi1"),a=n("keVe"),l=function(){function e(e,t,n){this.localAppLauncherService=e,this.urlLauncherService=t,this.officeRouteService=n}return e.prototype.launchApp=function(e,t,n,i){var r=this;return void 0===i&&(i=!1),this.localAppLauncherService.launchOfficeApp(e.Text,"",!t||t.defaultPrevented||i?null:function(){return t.preventDefault()}).then((function(i){return i?"Native":r.launchOfficeWebApp(e,t,!0,n)})).catch((function(){return r.launchOfficeWebApp(e,t,i,n)}))},e.prototype.launchOfficeWebApp=function(e,t,n,i){return e.InAppNav&&e.FileType?(!t||t.defaultPrevented||n||t.preventDefault(),this.officeRouteService.navigateTo({route:"Start",app:e.FileType}),Promise.resolve("StartPage")):n||!t||t.defaultPrevented?this.urlLauncherService.openUrl(e.Url,i).then((function(){return"Web"}),(function(){})):Promise.resolve("Web")},e.ɵprov=a.cc({factory:function(){return new e(a.dc(i.a),a.dc(o.a),a.dc(r.a))},token:e,providedIn:"root"}),e}()},BJbw:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("cgnd"),r=n("ZBli"),o=n("pjz5"),a=n("keVe"),l=function(){function e(t){var n=t.config.userPrincipalName,o=t.config.authType;if(n&&o!==i.a.Unknown){var a={};a[e.pvrQueryName]=o===i.a.OrgId?"OrgId":"WindowsLiveId",a[e.upnQueryName]=n,this.authParams=r.a.buildQueryPath(a)}}return e.prototype.appendPvrAndUpnAuthParams=function(t){if(!t||!this.authParams)return t;var n=o.a.getLocation(t),i=o.a.getQueryParams(n.search);return i[e.pvrQueryName]||i[e.upnQueryName]?t:r.a.appendQuery(t,this.authParams)},e.pvrQueryName="auth_pvr",e.upnQueryName="auth_upn",e.ɵprov=a.cc({factory:function(){return new e(a.dc(i.b))},token:e,providedIn:"root"}),e}()},BMb5:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c}));var i,r=n("qSxk"),o=n("f0qX"),a=n("Q3dK"),l=n("Q6ee"),s=n("keVe");!function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage"}(i||(i={}));var c=function(){function e(){this._innerWidth=this.getWindow().innerWidth,this.getWindow().shellTokenRequestDictionary={},this.setupInnerWidthListener(),this._sameOriginRegex=new RegExp("^"+this.nativeWindow.location.origin.replace(/\./g,"\\."),"i")}return Object.defineProperty(e.prototype,"innerWidth",{get:function(){return this._innerWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nativeWindow",{get:function(){return this.getWindow()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sameOriginRegex",{get:function(){return this._sameOriginRegex},enumerable:!0,configurable:!0}),e.prototype.ensureZoneJs=function(){try{Zone.assertZonePatched()}catch(e){window.Promise=window.ZoneJSBackupPromise}},e.prototype.isStandalonePwa=function(){return Object(r.a)(this.getWindow(),"appinstalled").pipe(Object(o.a)((function(e){return!0})),Object(a.a)(this.nativeWindow.matchMedia("(display-mode: standalone)").matches))},e.prototype.getStorage=function(e){if(!this.isStorageAvailable(e))return null;switch(e){case i.LocalStorage:return this.nativeWindow.localStorage;case i.SessionStorage:return this.nativeWindow.sessionStorage;default:return null}},e.prototype.isStorageAvailable=function(e){try{return!!window[e]}catch(e){return!1}},e.prototype.getWindow=function(){return window},e.prototype.setupInnerWidthListener=function(){var e=this;Object(r.a)(this.getWindow(),"resize").pipe(Object(l.a)(10)).subscribe((function(){return e._innerWidth=e.getWindow().innerWidth}))},e.ɵprov=s.cc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},BaAg:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return c}));var i,r,o=n("WFKr"),a=n("lwM0"),l=n("pjz5"),s=n("p6Zr");!function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.Word=2]="Word",e[e.Excel=3]="Excel",e[e.PowerPoint=4]="PowerPoint",e[e.Pdf=5]="Pdf",e[e.Audio=6]="Audio",e[e.Video=7]="Video",e[e.OneNote=8]="OneNote",e[e.OneNotePage=9]="OneNotePage",e[e.Visio=10]="Visio",e[e.Photos=11]="Photos",e[e.Text=12]="Text",e[e.Outlook=13]="Outlook",e[e.Sway=14]="Sway",e[e.OneNoteClassNoteBook=15]="OneNoteClassNoteBook",e[e.Forms=16]="Forms",e[e.FormsQuiz=17]="FormsQuiz",e[e.Project=18]="Project",e[e.ProjectOperations=19]="ProjectOperations",e[e.Portfolio=20]="Portfolio",e[e.NewsArticle=21]="NewsArticle",e[e.OneDrive=22]="OneDrive",e[e.SharePoint=23]="SharePoint",e[e.Fluid=24]="Fluid",e[e.FluidActivityBlueprint=25]="FluidActivityBlueprint",e[e.PowerBI=26]="PowerBI",e[e.StreamsVideo=27]="StreamsVideo",e[e.List=28]="List",e[e.UpcomingMeeting=29]="UpcomingMeeting",e[e.Yammer=30]="Yammer",e[e.VisioBusinessWac=31]="VisioBusinessWac",e[e.VisioFlowChartWac=32]="VisioFlowChartWac",e[e.VisioGeneralWac=33]="VisioGeneralWac",e[e.VisioNetworkWac=34]="VisioNetworkWac",e[e.VisioSoftwareWac=35]="VisioSoftwareWac",e[e.Spaces=36]="Spaces",e[e.ThirdParty=37]="ThirdParty",e[e.Trello=38]="Trello",e[e.VisioStartWac=39]="VisioStartWac",e[e.Stream=40]="Stream",e[e.MindMeister=41]="MindMeister",e[e.Monday=42]="Monday",e[e.Platform=43]="Platform",e[e.Whiteboard=44]="Whiteboard",e[e.MeetingNotes=45]="MeetingNotes",e[e.MyAnalytics=46]="MyAnalytics",e[e.MeetingObject=47]="MeetingObject",e[e.PlayLists=48]="PlayLists"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.OfficeGraph=1]="OfficeGraph",e[e.SharePoint=2]="SharePoint",e[e.Exchange=3]="Exchange",e[e.OfficeMru=4]="OfficeMru",e[e.AADGraph=5]="AADGraph",e[e.OneDriveBusiness=6]="OneDriveBusiness",e[e.Substrate=7]="Substrate"}(r||(r={}));var c=function(){function e(t,n,r,o,a,l,s,c,u,d,p,h,f,m,b,v,g,y,S,w,C,I,T){if(void 0===g&&(g=!0),void 0===y&&(y=null),void 0===S&&(S=null),void 0===w&&(w=!1),void 0===C&&(C=0),void 0===I&&(I=!1),void 0===T&&(T=!1),this.id=t,this.impressionId=n,this.docId=r,this.driveId=o,this.fileName=a,this.title=l,this.url=s,this.webUrl=c,this.downloadUrl=u,this.lastModifiedTime=d,this.lastViewedTime=p,this.sharedTime=h,this.fileType=f,this.provenance=m,this.pathArray=b,this.lastModifiedBy=y,this.isLocal=I,this.isSafeLink=T,this.fileTypeName=e.fileTypeNameFromType(this.fileType),this.provenanceName=e.provenanceNameFromType(this.provenance),this.documentIcon=e.documentIconFromType(this.fileType),s&&!T){var k=s;if(!I&&(!w||w&&2===C)&&(f===i.Word||f===i.Excel||f===i.OneNote||f===i.PowerPoint||f===i.Visio||f===i.Fluid)){var A=-1===s.indexOf("?")?"?":"&";k=s+A+"web=1"}this.url=w||I?k:this.encodeUrl(k,g,this.fileType===i.Forms||this.fileType===i.Portfolio||this.fileType===i.Project||this.fileType===i.ProjectOperations)}this.downloadUrl&&(this.downloadUrl=this.encodeUrl(this.downloadUrl,g)),this.setupAttribution(S,v)}return e.setStreamExtensions=function(t){t.length>0&&(e.fileTypeStringToExtensions[i[i.Stream]]=e.StreamExtensions=t,e.createExtensionToFileTypeValues())},e.fileTypeToApp=function(e){return e===i.Forms||e===i.FormsQuiz?i.Forms:e},e.fileTypeFromExtension=function(t){return e.extensionToFileType||e.createExtensionToFileTypeValues(),t?e.extensionToFileType[t.toLowerCase()]||i.Unknown:i.None},e.fileExtensionsForType=function(t){return t&&t!==i.None?(e.fileTypeStringToExtensions||e.createFileTypeStringToExtensionsValues(),e.fileTypeStringToExtensions[i[t]]||[]):[]},e.distributionFromFileTypes=function(t){return t?t.reduce((function(t,n,i){return t+(0===i?"":";")+e.fileTypeNameFromType(n)}),""):""},e.distributionFromFileItems=function(t){return t?e.distributionFromFileTypes(t.map((function(e){return e.fileType}))):""},e.fileIconNameFromType=function(e){switch(e){case i.Word:return"Word";case i.Excel:return"Excel";case i.PowerPoint:return"PowerPoint";case i.OneNote:return"OneNote";case i.Pdf:return"PDF";case i.Visio:return"Visio";case i.Sway:return"Sway";case i.Forms:return"Forms";case i.Project:return"Project";case i.ProjectOperations:return"ProjectOperations";case i.Portfolio:return"Portfolio";case i.Fluid:case i.FluidActivityBlueprint:return"Fluid";case i.Spaces:return"Spaces";case i.PowerBI:return"PowerBI";case i.StreamsVideo:case i.Stream:return"StreamsVideo";case i.Video:return"Video";case i.List:return"List";case i.PlayLists:return"PlayLists";case i.Trello:return"Trello";case i.NewsArticle:return"NewsArticle";case i.Whiteboard:return"Whiteboard";case i.MeetingNotes:return"MeetingNotes";case i.Photos:return"Photos";case i.MeetingObject:return"MeetingObject";default:return"Document"}},e.fileTypeNameFromType=function(e){switch(e){case i.Word:return"Word";case i.Excel:return"Excel";case i.PowerPoint:return"PowerPoint";case i.OneNote:case i.OneNoteClassNoteBook:case i.MeetingNotes:return"OneNote";case i.Pdf:return"PDF";case i.Visio:return"Visio";case i.Audio:return"Audio";case i.Video:return"Video";case i.Photos:return"Photos";case i.Outlook:return"Outlook";case i.Text:return"Text";case i.Sway:return"Sway";case i.Forms:case i.FormsQuiz:return"Forms";case i.Project:return"Project";case i.ProjectOperations:return"ProjectOperations";case i.Portfolio:return"Portfolio";case i.NewsArticle:return"NewsArticle";case i.Fluid:return"Loop components";case i.PowerBI:return"PowerBI";case i.StreamsVideo:return"Streams";case i.Stream:return"Stream";case i.UpcomingMeeting:return"UpcomingMeeting";case i.List:return"List";case i.PlayLists:return"PlayLists";case i.Spaces:return"Spaces";case i.MindMeister:return"MindMeister";case i.Monday:return"monday.com";case i.Trello:return"Trello";case i.Platform:return"Platform";case i.Whiteboard:return"Whiteboard";case i.MeetingObject:return"Meeting Object";case i.MyAnalytics:return"MyAnalytics";default:return"Document"}},e.fileTypeNameToFileType=function(t){return t?"Custom"===t?i.ThirdParty:e.NameToFileType[t.toLowerCase()]||i.Unknown:i.Unknown},e.fileTypeFromFileName=function(t){return e.fileTypeFromExtension(e.getFileExtension(t))},e.provenanceNameFromType=function(e){switch(e){case r.AADGraph:return"AADGraph";case r.Exchange:return"Exchange";case r.OfficeGraph:return"OfficeGraph";case r.OfficeMru:return"OfficeMru";case r.SharePoint:return"SharePoint";case r.Substrate:return"Substrate";default:return"Unknown"}},e.getFileExtension=function(e){if(!e)return"";var t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1)},e.getFileExtensionFromUrl=function(e){if(!e)return"";var t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1).split("?")[0]},e.documentIconFromType=function(t,n){return void 0===n&&(n="32x32"),t===i.Portfolio?"document-icon-sprite document-icon-sprite-"+e.fileIconNameFromType(t).toLowerCase()+"-"+n:"document-icon--"+n+" document-icon--"+e.fileIconNameFromType(t).toLowerCase()},e.referralFromFileType=function(t){switch(t){case i.Word:return s.a.Word;case i.Excel:return s.a.Excel;case i.PowerPoint:return s.a.PowerPoint;case i.OneNote:return s.a.OneNote;case i.Sway:return s.a.Sway;case i.Visio:return s.a.Visio;case i.Project:case i.ProjectOperations:case i.Portfolio:return s.a.Project;case i.PowerBI:return s.a.PowerBI;default:return e.fileTypeNameFromType(t)}},e.referralFromFileLocation=function(t){if(t&&t.length){if(t.match(e.OneDriveBusinessUrlRegex)||t.match(e.OneDriveConsumerUrlRegex))return s.a.OneDrive;if(t.match(e.SharePointUrlRegex))return s.a.SharePoint}return null},e.isConsumerDocument=function(e){return l.a.getHostName(e).lastIndexOf("live.net")>0},e.fileNameWithoutExtension=function(e){if(!e)return e;var t=e.lastIndexOf(".");return-1===t?e:e.substring(0,t)},e.prototype.documentIconWithSize=function(t){return void 0===t&&(t="32x32"),e.documentIconFromType(this.fileType,t)},e.prototype.getClickData=function(t,n,i,r){void 0===r&&(r=!1);var o={};o.ImpressionId=this.impressionId,r?(o.ElementId=t,o.DocumentId=this.id):o.ElementId=this.id,o.Referral=e.referralFromFileType(this.fileType),o.Index=i.toString(),o.DocumentType=this.fileTypeName,o.Action=n;var a=this.timeSinceLastOpenInSeconds();return null!==a&&(o.InactivityDuration=a.toString()),{eventName:t,params:o,metrics:[]}},e.prototype.getClickDataForPath=function(t,n,i){var r=this.getClickData(t,n,i);return r&&r.params&&(r.params.Referral=e.referralFromFileLocation(this.url)),r},e.prototype.timeSinceLastOpenInSeconds=function(){return this.lastViewedTime?Math.round(((new Date).getTime()-this.lastViewedTime.getTime())/1e3):null},e.prototype.getId=function(){return this.id},e.createExtensionToFileTypeValues=function(){e.fileTypeStringToExtensions||e.createFileTypeStringToExtensionsValues(),e.extensionToFileType={};var t=function(t){if(!e.fileTypeStringToExtensions.hasOwnProperty(t))return"continue";var n=e.fileTypeStringToExtensions[t];if(!n)return"continue";n.forEach((function(n){e.extensionToFileType[n]=i[t]}))};for(var n in e.fileTypeStringToExtensions)t(n)},e.createFileTypeStringToExtensionsValues=function(){(e.fileTypeStringToExtensions={})[i[i.Excel]]=["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","csv"],e.fileTypeStringToExtensions[i[i.Visio]]=["vsd","vss","vst","vdx","vsx","vtx","vsl","vsu","vsw","vsdx","vsdm","vssm","vstx","vstm"],e.fileTypeStringToExtensions[i[i.PowerPoint]]=["ppt","pptx","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","powerpoint"],e.fileTypeStringToExtensions[i[i.Word]]=["doc","dot","docx","docm","dotx","dotm","docb","word"],e.fileTypeStringToExtensions[i[i.Photos]]=["jpg","png","jpeg","gif","svg","bmp","tif","tiff","heic"],e.fileTypeStringToExtensions[i[i.Video]]=e.StreamExtensions,e.fileTypeStringToExtensions[i[i.Outlook]]=["msg","eml"],e.fileTypeStringToExtensions[i[i.OneNote]]=["one"],e.fileTypeStringToExtensions[i[i.Pdf]]=["pdf"],e.fileTypeStringToExtensions[i[i.Audio]]=["mp3"],e.fileTypeStringToExtensions[i[i.Text]]=["txt"],e.fileTypeStringToExtensions[i[i.Fluid]]=["fluid","loop"],e.fileTypeStringToExtensions[i[i.Stream]]=e.StreamExtensions,e.fileTypeStringToExtensions[i[i.Whiteboard]]=["whiteboard"],e.fileTypeStringToExtensions[i[i.MeetingNotes]]=["note"]},e.prototype.encodeUrl=function(e,t,n){try{var i=e;return t&&((i=a.a.decodeUrl(e))||(i=e)),a.a.encodeUrl(i,n)}catch(t){return e}},e.prototype.setupAttribution=function(t,n){if(this.fileType!==i.Sway&&this.fileType!==i.Forms&&this.fileType!==i.Project&&this.fileType!==i.ProjectOperations)if(this.attribution=o.a.Format(this.pathArray,n)[1],t)this.attributionUrl=t;else{var r=this.url?this.url.lastIndexOf(this.isLocal?"\\":"/"):-1;if(this.attributionUrl=-1===r?this.url:this.url.substring(0,r+1),this.attributionUrl&&this.attributionUrl.match(e.OneDriveConsumerUrlRegex)){var a=l.a.getLocation(this.attributionUrl).path;a.lastIndexOf("/",a.length-2)<=0&&(this.attributionUrl=this.attributionUrl+"?id=root")}}},e.OneDriveBusinessUrlRegex=/http[s]?:\/\/[\S]*?-my\.sharepoint[\S]*?\.com/,e.SharePointUrlRegex=/http[s]?:\/\/[\S]*?\.sharepoint[\S]*?\.com/,e.OneDriveConsumerUrlRegex=/http[s]?:\/\/d\.docs\.live\.net/,e.NameToFileType={none:i.None,unknown:i.Unknown,excel:i.Excel,onenote:i.OneNote,pdf:i.Pdf,powerpoint:i.PowerPoint,audio:i.Audio,video:i.Video,visio:i.Visio,word:i.Word,photos:i.Photos,text:i.Text,outlook:i.Outlook,sway:i.Sway,forms:i.Forms,formsquiz:i.FormsQuiz,project:i.Project,projectoperations:i.ProjectOperations,portfolio:i.Portfolio,news:i.NewsArticle,newsarticle:i.NewsArticle,onedrive:i.OneDrive,sharepoint:i.SharePoint,bohemia:i.Fluid,fluid:i.Fluid,loop:i.Fluid,"loop components":i.Fluid,powerbi:i.PowerBI,streamsvideo:i.StreamsVideo,yammer:i.Yammer,mindmeister:i.MindMeister,stream:i.Stream,spaces:i.Spaces,monday:i.Monday,trello:i.Trello,platform:i.Platform,whiteboard:i.Whiteboard,meetingnotes:i.MeetingNotes,myanalytics:i.MyAnalytics,list:i.List,playlists:i.PlayLists,"meeting object":i.MeetingObject,upcomingmeeting:i.UpcomingMeeting},e.NameToProvenance={Unknown:r.Unknown,AADGraph:r.AADGraph,Exchange:r.Exchange,OfficeGraph:r.OfficeGraph,OfficeMru:r.OfficeMru,SharePoint:r.SharePoint,Substrate:r.Substrate},e.StreamExtensions=["mts","m2ts","ts","3g2","3gp","3gp2","3gpp","asf","wmv","avi","m4v","mov","mp4","mp4v","ogg","webm","movie","mkv","mpg","mpeg"],e}()},Bc8L:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},Bcjp:function(e,t,n){},Bmgn:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},Brer:function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var i=n("bb6g"),r=n("3Vsh"),o=n("lrJm"),a=n("hhzZ"),l=n("R7NL"),s=n("BaAg"),c=n("p6Zr"),u=n("L/Tc"),d=n("fKR7"),p=n("4/We"),h=n("cgnd"),f=n("/I02"),m=n("oAX+"),b=n("ZBli"),v=n("pjz5"),g=n("kpuN"),y=n("pd4Y"),S=n("wwmn"),w=(n("Dpxn"),n("casz")),C=n("BMb5"),I=n("pOWU"),T=n("keVe"),k=n("TOqr"),A=function(e){function t(n,i,r,o,a,l,s,c,u,d,p,f){var m=e.call(this,n,o,a,"SharePoint",l,s,d,f,"WLID1.1 ")||this;m.capabilitiesService=i,m.dateService=c,m.windowService=u,m.globalErrorHandler=p,m.requestCache=new Map,m.itemPathPredicate=":/",m.requestConfig={headers:new Map([["accept","application/json"],["Prefer","allow-zerobyte"],["application","officehome"]])},m.inMockMode&&(m.itemPathPredicate="?path=");var b=m.contextService.sharedContext;return m.isConsumer=r.config.authType===h.a.MSA,m.myDriveUrl=(m.isConsumer?m.getConsumerBaseUrl():m.getCommercialBaseUrl(b.oneDriveResourceId))+"/"+t.drivePath,m}return Object(i.__extends)(t,e),t.getItemParams=function(e,n,r,o,a){void 0===o&&(o=""),void 0===a&&(a="open");var l=n?Object(i.__spread)(new Set(e.concat(t.WacDataSelectParams))):e;return[l.length?"$select="+l.join(","):"",r?"$expand=thumbnails":"",n?"action="+a:"",o?"$filter="+o:""].filter(Boolean).join("&")},t.getWopiHostDataFromItem=function(e){var t,n,i,r,o,a,l;return{bundleUrl:null!==(n=null===(t=null==e?void 0:e.officeBundle)||void 0===t?void 0:t.url)&&void 0!==n?n:"",bundleVersion:null!==(r=null===(i=null==e?void 0:e.officeBundle)||void 0===i?void 0:i.version)&&void 0!==r?r:"",downloadUrl:(null==e?void 0:e["@content.downloadUrl"])||(null==e?void 0:e["@microsoft.graph.downloadUrl"]),eTag:null==e?void 0:e.eTag,fileName:null==e?void 0:e.name,fileSize:null==e?void 0:e.size,irmEnabled:null===(o=null==e?void 0:e.sensitivityLabel)||void 0===o?void 0:o.protectionEnabled,isNewFile:!1,readOnly:null===(a=null==e?void 0:e.currentUserRole)||void 0===a?void 0:a.readOnly,wac:null===(l=null==e?void 0:e.openWith)||void 0===l?void 0:l.wac,sharepointIds:null==e?void 0:e.sharepointIds}},t.prototype.getMyDriveRootUrl=function(e){var t=this;if(void 0===e&&(e=0),!this.capabilitiesService.capabilities.oneDriveApisEnabled)return Promise.resolve(null);if(!this.myDriveRootUrlPromise){var n=new Promise((function(n,i){var o=t.getMyDriveRootUrlStream(e);o.results.pipe(Object(r.a)(1)).toPromise().then((function(e){e&&e.userRoot?n(e):i("No/Incomplete data returned.")})),o.initialCompletion.then((function(e){e&&(t.globalErrorHandler.handleCacheObservableError(e,"Escyx","TBMsL"),e.cacheError&&e.networkError&&i(e))}))}));this.myDriveRootUrlPromise=n}return this.myDriveRootUrlPromise},t.prototype.getMyDriveRootUrlStream=function(e){var t=this;if(void 0===e&&(e=0),this.myDriveRootUrlStream)return this.myDriveRootUrlStream;var n=this.getMyDriveRootUrlInternal("cache-only",e),i=this.getMyDriveRootUrlInternal("network-first",e),r=m.a.createResultsWithCacheObservable(n,i,null,(function(e){return t.myDriveRootUrlStream=null}));return this.myDriveRootUrlStream=r,this.myDriveRootUrlStream},t.prototype.getSharedItemWithThumbnail=function(e,n,i,r,o,a,l){return void 0===a&&(a=!1),void 0===l&&(l=0),this.getSharedItemWithParams(e,n,i,t.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],o,!0),r,a,l)},t.prototype.getSharedItemWithoutThumbnail=function(e,n,i,r,o,a,l,s){return void 0===a&&(a="open"),void 0===l&&(l=!1),void 0===s&&(s=0),this.getSharedItemWithParams(e,n,i,t.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],o,!1,"",a),r,l,s)},t.prototype.getSharedItemWithThumbnailAndIds=function(e,n,i,r,o,a,l){return void 0===a&&(a=!1),void 0===l&&(l=0),this.getSharedItemWithParams(e,n,i,t.getItemParams(["id","sharepointIds"],o,!0),r,a,l)},t.prototype.getItemWithWacDataAndThumbnails=function(e,n,i,r){return void 0===i&&(i=!1),void 0===r&&(r=0),this.getItemWithParams(e.url,e.driveId,e.docId,n,t.getItemParams([],!0,!0),i,r)},t.prototype.getItemWithWacData=function(e,n,i,r,o,a,l){return void 0===o&&(o="open"),void 0===a&&(a=!1),void 0===l&&(l=0),this.getItemWithParams(e,n,i,r,t.getItemParams([],!0,!1,null,o),a,l)},t.prototype.getItemAccessForUser=function(e,t,n,i){var r=this,o=this.getApiInfo(e,!0),a=o.baseUrl+"/drives/"+encodeURIComponent(t)+"/items/"+encodeURIComponent(n)+"/oneDrive.checkAccess";return new Promise((function(e,t){var n=r.getRequestConfig();n.headers.set("Content-Type","application/json"),r.post("Vroom_OneDrive_Item_Check_Access_Request",a,JSON.stringify({value:[{email:i}]}),(function(n){n.instrument((function(e,t){t.params.RequestId=r.getRequestIdFromResponse(e)})).then((function(n){n&&n.data&&n.data.value&&n.data.value[0]?e(n.data.value[0]):t(new I.b(n,"No data returned"))})).catch((function(e){r.globalErrorHandler.handleError(e,"B95N9"),t(e)}))}),t,n,null,null,null,null,o.tokenType,o.resourceUrl,null,"network-only",null,null)}))},t.prototype.getEnterpriseTemplatesLibraries=function(){var e=this,n=t.getItemParams(["id","name","organizationAssets"],!1,!1,"organizationAssets/officeTemplateLibrary%20ne%20null"),i=this.getCommercialBaseUrl(this.contextService.sharedContext.sharePointResourceId,!1,!0)+"/drives"+(n?"?"+n:"");return this.getDriveItems("Template_Libraries_Request",i,"cache-only").catch((function(){return e.getDriveItems("Template_Libraries_Request",i,"network-first",void 0,null,0,"BrowseOrgTemplates","AUO")}))},t.prototype.getDriveItemChildrenWithThumbnails=function(e,n,i,r,o){if(void 0===i&&(i="network-first"),!e)return null;var a=t.getItemParams([],!1,!0),l=n?"items/"+encodeURIComponent(n)+"/":"root/",s=this.getCommercialBaseUrl(this.contextService.sharedContext.sharePointResourceId)+"/drives/"+encodeURIComponent(e)+"/"+l+"children"+(a?"?"+a:"");return this.getDriveItems("Vroom_Item_Request",s,i,void 0,null,0,r,o)},t.prototype.createNewFile=function(e,t,n){var i=this;void 0===n&&(n=!1);var r=this.myDriveUrl+"root/children?select=webDavUrl,"+(n?"openWith,":"")+"*",o={name:e,file:{},"@name.conflictBehavior":"rename"};return new Promise((function(e,n){i.post("Vroom_Create_File_Request",r,o,(function(t){t.instrument((function(e,t){t.params.RequestId=i.getRequestIdFromResponse(e)})).then((function(t){var i=t.data;i&&i.id?e(i):n(new I.b(t,"Could not parse drive item from Vroom response"))})).catch((function(e){if(e&&e.data){var t={};t.DebugInfo=JSON.stringify(e.data),t.HttpCode=e.status.toString(),i.instrumentationService.logDebugCacheEvent("Vroom_Create_File_Request",t)}i.globalErrorHandler.handleError(e,"vcXyA")}))}),(function(e){e&&e.httpResponse?n(e.httpResponse.data?{error:{code:""+e.httpResponse.status,data:""+e.httpResponse.data}}:{error:{code:""+e.httpResponse.status}}):n()}),i.getRequestConfig(),null,null,null,null,"OneDrive",i.contextService.sharedContext.oneDriveResourceId,null,null,!0,{category:"CreateFile",fileType:t})}))},t.prototype.uploadFile=function(e,t,n,i,r,o,a){var l=this;return new Promise((function(s,c){e&&e.name||c(new I.b(null,"Invalid file"));var u=l.getUploadLocation(l.myDriveUrl,e,n,i)+"content?@name.conflictBehavior=rename&select=webDavUrl,*";l.put("Vroom_Upload_File_Request",u,e,(function(n){n.instrument((function(n,i){return l.instrumentUploadResponse(n,i,e,t)})).then((function(e){var t=e.data;t&&t.id?s(t):c(new I.b(e,"Could not parse drive item from Vroom response"))})).catch((function(e){l.globalErrorHandler.handleError(e,"dSenI")}))}),c,l.getRequestConfig(),r,null,o,a,"OneDrive",l.contextService.sharedContext.oneDriveResourceId)}))},t.prototype.createUploadSession=function(e,t,n,i,r){var o=this;return new Promise((function(a,l){e&&e.name||l(new I.b(null,"Invalid file"));var s=o.getUploadLocation(o.myDriveUrl,e,n,i)+(o.inMockMode?"":"oneDrive.")+"createUploadSession";o.post("Vroom_Create_Upload_Session_Request",s,{item:{"@name.conflictBehavior":"rename"}},(function(n){n.instrument((function(n,i){if(o.instrumentUploadResponse(n,i,e,t),n.ok){var r=n.data;i.params.Length=r&&r.uploadUrl?r.uploadUrl.length.toString():"0"}})).then((function(e){var t=e.data;t&&t.uploadUrl?a(t):l(new I.b(e,"Could not parse upload session from Vroom response"))})).catch((function(e){o.globalErrorHandler.handleError(e,"d9WE9")}))}),l,o.getRequestConfig(),null,null,r,null,"OneDrive",o.contextService.sharedContext.oneDriveResourceId)}))},t.prototype.cancelUploadSession=function(e,t,n){return this.cancelUploadSessionInternal(e,t,n,"OneDrive",this.contextService.sharedContext.oneDriveResourceId)},t.prototype.uploadFragment=function(e,t,n,i,r,o,a,l,s){var c=this;return new Promise((function(u,d){e||d(new I.b(null,"Invalid session url"));var p="select=webDavUrl,*";e.endsWith(p)||(e=b.a.appendQuery(e,p));var h=new Map,f=Math.max(0,n-t);h.set("Content-Range","bytes "+t+"-"+(t+f-1)+"/"+i),c.put("OneDrive_Graph_Upload_Fragment_Request",e,r,(function(e){e.instrument((function(e,n){n.params.TotalSize=i.toString(),n.params.ActualSize=f.toString(),n.params.Index=t.toString(),n.params.UploadSessionId=o,n.params.RequestId=c.getRequestIdFromResponse(e)})).then((function(e){return u(e.data)})).catch((function(e){c.globalErrorHandler.handleError(e,"t59Ym")}))}),d,{headers:h},a,null,l,s,"None")}))},t.prototype.getUploadSessionStatus=function(e,t,n){return this.getUploadSessionStatusInternal(e,t,n,"OneDrive",this.contextService.sharedContext.oneDriveResourceId)},t.prototype.getDocumentActivity=function(e,n,i){var r=this;if(void 0===i&&(i=0),!e||!e.driveId||!e.docId)return Promise.reject(new I.b(null,"Drive and doc IDs are required"));var o=n+"_"+e.driveId+"_"+e.docId+"_activity",a=this.getRequestFromCache(o);if(a)return a;var l=new Promise((function(a,l){var s=r.getCommercialApiInfo(e.url);s||l("Invalid document url");var c=s.baseUrl+"/drives/"+encodeURIComponent(e.driveId)+"/items/"+encodeURIComponent(e.docId)+"/activities";r.get("Vroom_Activity_Request",c,(function(n){n.instrument((function(t,n){if(n.params.RequestId=r.getSharepointRequestId(t),n.params.FileFormat=d.a[e.format],t&&t.ok&&t.data&&t.data.value){var i=t.data.value.length.toString();n.params.ActualSize=i,n.params.Distribution=r.distributionByActionType(t.data.value)}})).then((function(e){e&&e.data&&e.data.value?a(e.data.value.map((function(e){return{action:e.action.hasOwnProperty(t.mentionKey)?{type:u.a.Mention,data:e.action[t.mentionKey]}:e.action.hasOwnProperty(t.commentKey)?{type:u.a.Comment,data:e.action[t.commentKey]}:e.action.hasOwnProperty(t.editKey)?{type:u.a.Edit,data:e.action[t.editKey]}:{type:u.a.Unknown,data:null},actor:e.actor,timestamp:r.getPreferredTime(e.times)}}))):l(new I.b(e,"No data returned"))})).catch((function(e){r.globalErrorHandler.handleError(e,"ACZGk")}))}),(function(e){r.requestCache.delete(o),l(e)}),r.getRequestConfig(),n,null,null,null,s.tokenType,s.resourceUrl,i)}));return this.requestCache.set(o,{promise:l,expiryTime:this.dateService.addSeconds(this.dateService.getCurrentDate(),this.contextService.sharedContext.activityLifetimeInSeconds)}),l},t.prototype.getUploadLocation=function(e,t,n,i){return e+(this.inMockMode?"upload/":(i?"root"+this.itemPathPredicate+i+"/":n?"items/"+n+this.itemPathPredicate:"root"+this.itemPathPredicate)+encodeURIComponent(t.name)+this.itemPathPredicate)},t.prototype.instrumentUploadResponse=function(e,t,n,i){t.params.TotalSize=n.size.toString(),t.params.UploadSessionId=i,t.params.RequestId=this.getRequestIdFromResponse(e)},t.prototype.getRootUrlsFromRootItem=function(e,n){var i=null,r=e?e.webUrl:null;if(!r)return this.instrumentationService.logGenericEvent("OneDrive_Places_Bad_Url"),null;if(!this.isConsumer){var o=t.oneDriveBaseUrlSearchRegex.exec(r);o&&o.length&&(i=o[0])}return{tenantRoot:i,userRoot:r,fromCache:"cache-only"===n}},t.prototype.getSharesUrl=function(e){try{for(var t=this.windowService.nativeWindow.btoa(unescape(encodeURIComponent(e))),n=t.length-1;"="===t.charAt(n);)--n;return"shares/u!"+(t=t.slice(0,n+1).replace(/\+/g,"-").replace(/\//g,"_"))+"/driveItem"}catch(e){return this.globalErrorHandler.handleError(e,"fYwwF"),null}},t.prototype.cancelUploadSessionInternal=function(e,t,n,i,r){var o=this;return new Promise((function(a,l){e||l(new I.b(null,"Invalid session url")),o.delete("OneDrive_Graph_Cancel_Upload_Session_Request",e,null,(function(e){e.instrument((function(e,n){n.params.UploadSessionId=t,n.params.RequestId=o.getRequestIdFromResponse(e)})).then((function(){return a(null)})).catch((function(e){o.globalErrorHandler.handleError(e,"wQvvW")}))}),l,o.getRequestConfig(),n,null,i,r)}))},t.prototype.getUploadSessionStatusInternal=function(e,t,n,i,r){var o=this;return new Promise((function(a,l){e||l(new I.b(null,"Invalid session url")),o.get("OneDrive_Graph_Upload_Status_Request",e,(function(e){e.instrument((function(e,n){n.params.UploadSessionId=t,n.params.RequestId=o.getRequestIdFromResponse(e)})).then((function(e){return a(e.data)})).catch((function(e){o.globalErrorHandler.handleError(e,"PPAU2")}))}),l,o.getRequestConfig(),"network-only",null,n,null,i,r)}))},t.prototype.getMyDriveRoot=function(e,t){return this.getMyDriveItem("root",e,t)},t.prototype.createSharingLink=function(e,t){var n=this;if(this.isConsumer)return Promise.reject("api only available for commercial");var i=this.getCommercialBaseUrl(this.contextService.sharedContext.sharePointResourceId,!1,!0)+"/drives/"+encodeURIComponent(e)+"/items/"+encodeURIComponent(t)+"/createLink",r={type:"addressBar"},o=this.getRequestConfig();return o.headers.set("Content-Type","application/json"),new Promise((function(e,t){n.post("Vroom_Create_Link_Request",i,JSON.stringify(r),(function(i){i.instrument((function(e,t){t.params.RequestId=n.getRequestIdFromResponse(e)})).then((function(n){var i,r;(null==n?void 0:n.ok)&&(null===(r=null===(i=null==n?void 0:n.data)||void 0===i?void 0:i.link)||void 0===r?void 0:r.webUrl)?e(n.data.link.webUrl):t(n.statusText)})).catch((function(e){n.globalErrorHandler.handleError(e)}))}),t,o)}))},t.prototype.getThumbnailString=function(e){var t=this,n=new FileReader;return new Promise((function(i,r){e=(t.isConsumer?t.getConsumerBaseUrl():t.getCommercialBaseUrl(t.contextService.sharedContext.oneDriveResourceId))+"/"+e;var o=t.getRequestConfig({responseType:"blob"}),a=t.getApiInfo(e);t.get("Vroom_Thumbnail_String_Request",e,(function(e){e.instrument((function(e,n){n.params.RequestId=t.getSharepointRequestId(e)})).then((function(e){e&&e.data?(n.onloadend=function(){var e="string"==typeof n.result&&n.result||"";e.length>0?i(e):r()},n.onerror=r,n.onabort=r,n.readAsDataURL(e.data)):r()})).catch((function(e){t.globalErrorHandler.handleError(e,"AfEUN")}))}),r,o,"network-only",null,null,null,a.tokenType,a.resourceUrl)}))},t.prototype.getFluidEnabled=function(e){var n=this,i=this.getCommercialBaseUrl(this.contextService.sharedContext.sharePointResourceId,!1,!0)+"/"+t.drivePath+"root/opStream/fluidEnabled";return new Promise((function(t,r){n.get("Vroom_Get_Fluid_Enabled_Request",i,(function(e){e.then((function(e){return t(e.data.isFluidEnabled)})).catch((function(e){n.globalErrorHandler.handleError(e,"PPAU2"),r()}))}),r,n.getRequestConfig(),e,null)}))},t.prototype.handleQueryParam=function(e,t,n){"mockvroom"===e&&this.mockRequestHeader&&(null==n||n.headers.set(this.mockRequestHeader,t))},t.prototype.getRequestIdFromResponse=function(t){var n;return this.isConsumer?this.getHeaderValue(t.headers,"ms-cv"):null!==(n=e.prototype.getRequestIdFromResponse.call(this,t))&&void 0!==n?n:this.getSharepointRequestId(t)},t.prototype.getMyDriveItem=function(e,t,n){return this.getDriveItem("Vroom_Item_Request",""+this.myDriveUrl+e,t,null,"OneDrive",this.contextService.sharedContext.oneDriveResourceId,n)},t.prototype.getItemWithParams=function(e,t,n,i,r,o,a){void 0===o&&(o=!1),void 0===a&&(a=0);var l=this.getApiInfo(e);if(!l)return Promise.reject("Invalid document url");var s=l.baseUrl+"/drives/"+encodeURIComponent(t)+"/items/"+encodeURIComponent(n)+"/"+(r?"?"+r:""),c=r.includes("openWith");return this.getDriveItem(c?"Vroom_Item_With_Wac_Data_Request":"Vroom_Item_Request",s,i,null,l.tokenType,l.resourceUrl,a,c,o)},t.prototype.getSharedItemWithParams=function(e,t,n,i,r,o,a){var l=this;void 0===o&&(o=!1),void 0===a&&(a=0);var c=this.getSharesUrl(e);if(!c)return Promise.reject(new I.b(null,"Failed to construct shares url"));var u=this.getApiInfo(e),d=this.inMockMode?"shares?itemUrl="+encodeURIComponent(c)+"&currentDate="+this.dateService.getCurrentDateMinuteGranularity().toISOString():c+(i?"?"+i:""),p=u.baseUrl+"/"+d,h=i.includes("openWith");return this.getDriveItem(h?"Vroom_Shares_With_Wac_Data_Request":"Vroom_Shares_Request",p,r,(function(e,i){if(i.params.RequestId=l.getSharepointRequestId(e),i.params.DocumentType=s.b[t],n&&(i.params.FileFormat=n),e.ok){var r=e.data,o=r?r.thumbnails:null;i.params.ItemCount=(o?o.length:0).toString()}}),u.tokenType,u.resourceUrl,a,h,o)},t.prototype.getDriveItem=function(e,n,i,r,o,a,l,s,c){var u=this;void 0===l&&(l=0),void 0===s&&(s=!1),void 0===c&&(c=!1);var d=n+"/"+i,p=c?void 0:this.getRequestFromCache(d);if(p)return p;var h=new Promise((function(s,c){var p=u.getRequestConfig();p.headers.has(t.scenarioHeader)&&p.headers.delete(t.scenarioHeader),p.headers.has(t.scenarioTypeHeader)&&p.headers.delete(t.scenarioTypeHeader),u.get(e,n,(function(e){e.instrument((function(e,t){t.params.RequestId=u.getRequestIdFromResponse(e),r&&r(e,t)})).then((function(e){e&&e.data?s(e.data):c(new I.b(e,"No data returned"))})).catch((function(e){u.globalErrorHandler.handleError(e,"tIvZK")}))}),(function(e){u.requestCache.delete(d),c(e)}),p,i,null,null,null,o,a,l)}));return this.requestCache.set(d,{promise:h,expiryTime:s?this.dateService.addHours(this.dateService.getCurrentDate(),10):void 0}),h},t.prototype.getDriveItems=function(e,n,i,r,o,a,l,s){var c=this;void 0===a&&(a=0);var u=n+"/"+i,d=this.getRequestFromCache(u);if(d)return d;var p=new Promise((function(d,p){var h=c.getRequestConfig();l?h.headers.has(t.scenarioHeader)?h.headers[t.scenarioHeader]=l:h.headers.set(t.scenarioHeader,l):h.headers.has(t.scenarioHeader)&&h.headers.delete(t.scenarioHeader),s?h.headers.has(t.scenarioTypeHeader)?h.headers[t.scenarioTypeHeader]=s:h.headers.set(t.scenarioTypeHeader,s):h.headers.has(t.scenarioTypeHeader)&&h.headers.delete(t.scenarioTypeHeader),c.get(e,n,(function(e){e.then((function(e){e&&e.data?d(e.data):p(new I.b(e,"No data returned"))})).catch((function(e){c.globalErrorHandler.handleError(e,"QYFpr")}))}),(function(e){c.requestCache.delete(u),p(e)}),h,i,null,null,null,r,o,a)}));return this.requestCache.set(u,{promise:p}),p},t.prototype.distributionByActionType=function(e){return e?e.map((function(e){if(e&&e.action){var t=Object.keys(e.action);if(t&&t.length)return t[0]}return""})).reduce((function(e,t,n){return e+(0===n?"":";")+t}),""):""},t.prototype.getPreferredTime=function(e){return e?e.observedTime?new Date(e.observedTime):e.recordedTime?new Date(e.recordedTime):null:null},t.prototype.getRequestFromCache=function(e){if(this.requestCache.has(e)){var t=this.requestCache.get(e);if(t.promise&&(!t.expiryTime||t.expiryTime>this.dateService.getCurrentDate()))return t.promise;this.requestCache.delete(e)}return null},t.prototype.getApiInfo=function(e,t){return this.isConsumer?this.getConsumerApiInfo(e):this.getCommercialApiInfo(e,t)},t.prototype.getConsumerApiInfo=function(e){var t=v.a.getLocation(e);return t&&t.protocol&&t.host?{baseUrl:this.getConsumerBaseUrl(),tokenType:"OneDrive",resourceUrl:this.contextService.sharedContext.oneDriveResourceId,hostname:t.hostname}:null},t.prototype.getCommercialApiInfo=function(e,t){void 0===t&&(t=!1);var n,i=v.a.getLocation(e);if(!i||!i.protocol||!i.host)return null;var r=this.capabilitiesService.capabilities.useOdbUrlForVroom;return{baseUrl:this.getCommercialBaseUrl(n=r&&this.contextService.sharedContext.oneDriveResourceId?this.contextService.sharedContext.oneDriveResourceId:i.protocol+"//"+i.host,!1,t),tokenType:r?"OneDrive":this.getTokenType(n),resourceUrl:n,hostname:i.hostname}},t.prototype.getCommercialBaseUrl=function(e,t,n){return void 0===n&&(n=!1),e=this.inMockMode?""+this.contextService.sharedContext.officeHomeApiRoot:e,t?e+"/_api":n?e+"/_api/v2.1":e+"/_api/v2.0"},t.prototype.getConsumerBaseUrl=function(){return this.inMockMode?this.contextService.sharedContext.officeHomeApiRoot:this.contextService.sharedContext.oneDriveConsumerApi},t.prototype.getTokenType=function(e){return s.a.referralFromFileLocation(e)===c.a.OneDrive?"OneDrive":"SharePoint"},t.prototype.getRequestConfig=function(e){return void 0===e&&(e={}),Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},this.requestConfig),{headers:new Map(this.requestConfig.headers)}),e)},t.prototype.getSharepointRequestId=function(e){return e.headers&&e.headers.get("SPRequestGuid")},t.prototype.getMyDriveRootUrlInternal=function(e,t){var n=this;return this.getMyDriveRoot(e,t).then((function(t){return n.getRootUrlsFromRootItem(t,e)}))},t.WacDataSelectParams=["id","openWith","officebundle","currentUserRole","eTag","name","size","content.downloadUrl","file","sharepointIds","sensitivityLabel","webUrl"],t.mentionKey="mention",t.commentKey="comment",t.editKey="edit",t.drivePath="drive/",t.oneDriveBaseUrlSearchRegex=/^https?:\/\/(.(?!\/))*.\//i,t.scenarioHeader="scenario",t.scenarioTypeHeader="scenarioType",t.sharesFileTypes=new Set([s.b.Excel,s.b.PowerPoint,s.b.Visio,s.b.Word,s.b.OneNote]),t.ɵprov=T.cc({factory:function(){return new t(T.dc(g.b),T.dc(p.a),T.dc(h.b),T.dc(a.a),T.dc(l.a),T.dc(f.a),T.dc(S.a),T.dc(y.a),T.dc(C.b),T.dc(k.q),T.dc(o.b),T.dc(w.a))},token:t,providedIn:"root"}),t}(I.a)},CC5A:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var i,r=n("bb6g"),o=function(){function e(e){this.onTabAddedOrUpdated=new Array,Object.assign(this,e)}return e.prototype.updateOrAddTab=function(e,t){var n,i;void 0===t&&(t=-1);for(var o=this.tabs,a=!1,l=o.length,s=0;s<o.length;s++)if(o[s].id===e.id){a=!0,l=s,o[s]=e;break}a||(-1===t||t>=o.length?o.push(e):o.splice(t,0,e));try{for(var c=Object(r.__values)(this.onTabAddedOrUpdated),u=c.next();!u.done;u=c.next())(0,u.value)(e,l,a)}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}},e.prototype.registerOnTabAddedOrUpdated=function(e){this.onTabAddedOrUpdated.push(e)},e}();!function(e){e[e.Unknown=0]="Unknown",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.Error=3]="Error"}(i||(i={}))},CCRL:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=new(n("keVe").q)("LAZY_VIEW_ENTRY_COMPONENT")},COYM:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return l}));var i=n("BMb5"),r=n("keVe"),o=n("oHg+"),a="CryptoAPI Not Available",l=function(){function e(e,t){this.cryptoApiAvailable=e,this.windowService=t}return Object.defineProperty(e.prototype,"crypto",{get:function(){if(!this.cryptoApiAvailable)throw new Error(a);return this.windowService.nativeWindow.crypto},enumerable:!0,configurable:!0}),e.ɵprov=r.cc({factory:function(){return new e(r.dc(o.a),r.dc(i.b))},token:e,providedIn:"root"}),e}()},CVeG:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.escapeHtml=function(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},e.stripTags=function(e){return e?e.replace(/<.*?>/g,""):""},e}()},CfLe:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},ConB:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return e.Controlled="Controlled",e.SupportedNotControlled="SupportedNotControlled",e.Unknown="Unknown",e.Unsupported="Unsupported",e}({})},D6F8:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},D8EG:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},DCBR:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("hhzZ"),n("W3Zz"),n("hZW2"),n("4/We"),n("PBJH"),n("qTBP");var i=function(){function e(e,t,n,i,r,o){this.capabilitiesService=e,this.changeDetector=t,this.deviceDetector=n,this.documentService=i,this.instrumentationService=r,this.locService=o,this.cardIncrement=4,this.currentCarouselPage=0,this.maxCardsPerLine=4,this.cardMinWidth=217,this.cardMargin=12}return e.prototype.ngOnInit=function(){this.sharedInit(),this.cards=this.carousel.cards,this.canSwipe=!this.deviceDetector.isDesktopDevice(),this.carousel.cards.length>0&&(this.maxCardContainerWidths=[this.maxCardContainerWidth(1),this.maxCardContainerWidth(2),this.maxCardContainerWidth(3),this.maxCardContainerWidth(4)])},e.prototype.navigateCards=function(e){var t=this,n=this.currentCarouselPage+e*this.cardIncrement;return n<this.cards.length&&n>=0&&(this.navigationAnnouncement="",e<0?setTimeout((function(){return t.navigationAnnouncement=t.previousPage}),0):setTimeout((function(){return t.navigationAnnouncement=t.nextPage}),0),this.currentCarouselPage=n,this.logNavClick(e),!0)},e.prototype.updateCarouselCardData=function(e,t){void 0===e&&(e=0),void 0===t&&(t=!1),this.carouselElement&&(this.cardIncrement=this.getNumCards(e,t))},e.prototype.trackByIndex=function(e){return e},e.prototype.sharedInit=function(){this.cardMinWidth=this.isSuggestedActions?368:217,this.cardMargin=this.isSuggestedActions?20:12,this.disableAnimation=this.capabilitiesService.capabilities.disableAnimation,this.nextPage=this.locService.ButtonNextPage,this.previousPage=this.locService.ButtonPreviousPage},e.prototype.maxCardContainerWidth=function(e){return(this.cardMinWidth+this.cardMargin)*e},e.prototype.logNavClick=function(e){var t={};t.Index=this.currentCarouselPage.toString(),t.Increment=this.cardIncrement.toString(),t.TotalSize=this.cards.length.toString(),this.navClickLogging(t,e<0?"NavPrevious":"NavNext")},e.prototype.getNumCards=function(e,t){if(void 0===e&&(e=0),void 0===t&&(t=!1),!this.cards||!this.cards.length)return 0;this.changeDetector.detectChanges();var n=t?this.documentService.nativeDocument.documentElement.clientWidth:this.carouselContainer.nativeElement.clientWidth+this.cardMargin;!e||this.isSuggestedActions||t||(n-=this.cardMargin+e);for(var i=this.maxCardsPerLine;i>0;i--)if(n>=this.maxCardContainerWidths[i-1])return i},e}()},DQbD:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("4/We"),r=n("cgnd"),o=n("/I02"),a=n("keVe"),l=function(){function e(e,t,n){this.clientStartupConfigService=e,this.contextService=t,this.capabilitiesService=n,this.bootId=0}return Object.defineProperty(e.prototype,"HostContext",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audience",{get:function(){return this.capabilitiesService.capabilities.fluidAudience!==this.capabilitiesService.getDefaultFluidAudience()?this.capabilitiesService.capabilities.fluidAudience:function(e){switch(e){case"tbprod":case"pfprod":case"unprod":case"usprod":case"prod":return"Production";case"tbprodprv":case"pfprodprv":case"unprodprv":case"usprodprv":case"ppe":case"prodprv":case"ppeprv":case"sdf":return"Dogfood";case"dev":case"developer":case"test":default:return"Local"}}(this.clientStartupConfigService.config.sharedClientStartupContext.deploymentEnvironment)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostAppVersion",{get:function(){return""+this.clientStartupConfigService.config.sharedClientStartupContext.buildId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostCorrelationId",{get:function(){return this.clientStartupConfigService.config.sharedClientStartupContext.correlationId+"."+this.bootId},enumerable:!0,configurable:!0}),e.prototype.getBootId=function(){return this.bootId},Object.defineProperty(e.prototype,"hostSessionId",{get:function(){return this.clientStartupConfigService.config.sharedClientStartupContext.correlationId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostLocaleContext",{get:function(){return{uiLanguage:this.contextService.sharedContext.officeMarket.toLowerCase()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostName",{get:function(){return"Office.com"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostAppName",{get:function(){return"Office.com"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostAppPlatform",{get:function(){return"Web"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userContext",{get:function(){return{user:{oid:this.clientStartupConfigService.config.puid,tenantId:this.clientStartupConfigService.config.tenantId}}},enumerable:!0,configurable:!0}),e.prototype.resetFluidHostContext=function(e){e&&(this.hostScenarioStartTime=void 0,this.hostScenarioName=void 0),this.bootId++},e.ɵprov=a.cc({factory:function(){return new e(a.dc(r.b),a.dc(o.a),a.dc(i.a))},token:e,providedIn:"root"}),e}()},DTNF:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=new(n("keVe").q)("SERVICE_WORKER_USER_ID_FACTORY")},Dpxn:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},EUVs:function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));var i=n("bb6g"),r=n("AlWG"),o=n("UAwW"),a=n("NLr0"),l=n("f0qX"),s=n("3Vsh"),c=n("DrEg"),u=n("JYvP"),d=n("zvoD"),p=n("lFv5"),h=n("dpyN"),f=n("6/Wk"),m=n("hhzZ"),b=n("BaAg"),v=n("jCfB"),g=n("4/We"),y=n("/I02"),S=n("ufVG"),w=n("IAGz"),C=n("IBRu"),I=n("pjz5"),T=n("y9oG"),k=n("hZW2"),A=n("Z0U4"),P=n("5aVq"),E=n("Xc4i"),_=n("BMb5"),O=n("keVe"),F=n("X+PR"),D=n("TOqr"),M=function(){function e(e,t,n,i,o,a,l,s,c,u,d){this.activatedRoute=e,this.capabilitiesService=t,this.contextService=n,this.documentService=i,this.instrumentationService=o,this.location=a,this.officeRouteService=l,this.reactShellConfigService=s,this.shellShimService=c,this.uiHostBootstrapperService=u,this.windowService=d,this._loadedDocuments=new r.a(new Map),this.docTitleEnabled=this.capabilitiesService.capabilities.wacHeaderDisabled,this.capabilitiesService.wacHostEnabled()&&(this.setupAbandonListener(),this.capabilitiesService.capabilities.isEmbedMode||this.setupResetShellListener())}return e.getParamsForDocumentInfo=function(e,t){return void 0===t&&(t={}),this.getWacParams(e.driveId,e.docId,e.docUrl,t)},e.getParamsForMruFileItem=function(e,t){return void 0===t&&(t={}),this.getWacParams(e.driveId,e.docId,e.canonicalUrl,t)},e.getWacParams=function(e,t,n,r){var o;return void 0===r&&(r={}),Object(i.__assign)(Object(i.__assign)({},r),((o={})[v.a.DriveId]=e,o[v.a.ItemId]=t,o[v.a.DocUrl]=n,o))},e.getDocumentInfoForMruFileItem=function(e,t){return{docId:e.docId,docUrl:e.canonicalUrl,driveId:e.driveId,fileType:e.fileType,fileName:e.fileName,wdOrigin:t}},e.isValidDocumentInfo=function(e){return!!e.docId&&!!e.driveId||!!e.docUrl},e.prototype.bootstrapAndRouteMruFileItem=function(t,n,i,r,o){void 0===i&&(i={}),this.bootstrapAndRoute(e.getDocumentInfoForMruFileItem(t,n),i,r,o?this.uiHostBootstrapperService.convertMruInflationPromise(o,n,r):void 0)},e.prototype.bootstrapAndRoute=function(e,t,n,r){return void 0===t&&(t={}),Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.capabilitiesService.wacHostEnabledForFileType(e.fileType)?[4,this.bootstrap(e,n,r)]:[2];case 1:return i.sent()(t),[2]}}))}))},e.prototype.bootstrapZeroByteFile=function(t,n,r,o,a){var l=this;if(this.capabilitiesService.wacHostEnabledForFileType(t.fileType)){var s=r.then((function(n){var i={docId:n.docId,driveId:n.driveId,docUrl:n.canonicalUrl,fileName:n.fileName,wdOrigin:t.wdOrigin,fileType:t.fileType,newFile:!0},r=""+l.windowService.nativeWindow.location.origin+l.getContentPath(t.fileType)+"?"+l.getQueryParamString(e.getParamsForDocumentInfo(i));return i.newFileInfo={NewFilePath:r,TemplateSource:o?{FileGetUrl:"",DocUniqueId:o}:void 0},i})),c=this.uiHostBootstrapperService.bootstrapZeroByteDocument(t,n,s,o,a);return function(){return Object(i.__awaiter)(l,void 0,void 0,(function(){var e=this;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return this.logLoadStart(c),[4,this.updateBootedDocumentsMap(c,!0)];case 1:return t.sent()(),c.data.documentIdentifierPromise.then((function(t){e.updateInformation(c.bootedDocumentInfo.bootId,t)})),[2]}}))}))}}},e.prototype.bootstrapDocumentFromLoader=function(e,t,n){var r,o,a;return void 0===n&&(n=!1),Object(i.__awaiter)(this,void 0,void 0,(function(){var l,s,c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.capabilitiesService.wacHostEnabledForFileType(e.fileType)?[4,this.hasLoadedDocumentsObservable().toPromise()]:[2];case 1:return l=i.sent(),n&&l||(s=this.getApplicationParamsFromDocument(e),e.applicationUrlParams=s,(c=e.applicationUrlParams.actnavid)&&!(null===(a=null===(o=null===(r=this.activatedRoute)||void 0===r?void 0:r.snapshot)||void 0===o?void 0:o.queryParams)||void 0===a?void 0:a[v.a.Nav])&&this.officeRouteService.updateQueryParams({nav:c}),this.bootstrap(e,t,void 0,n)),[2]}}))}))},e.prototype.loadMruItem=function(e,t,n){return void 0===n&&(n=!1),this.bootstrap({docId:e.docId,driveId:e.driveId,docUrl:e.canonicalUrl,fileType:e.fileType,wdOrigin:this.contextService.getWdOrigin(t)},Date.now(),void 0,n)},e.prototype.prebootDocument=function(e,t){this.uiHostBootstrapperService.prebootDocument({docId:e.docId,driveId:e.driveId,docUrl:e.url,fileType:e.fileType,wdOrigin:this.contextService.getWdOrigin(t)})},e.prototype.bootstrap=function(e,t,n,i,r){if(void 0===t&&(t=Date.now()),void 0===i&&(i=!1),void 0===r&&(r=!1),this.capabilitiesService.wacHostEnabledForFileType(e.fileType)){var o=this.uiHostBootstrapperService.bootstrapItem(e,t,n);return this.logLoadStart(o),this.updateBootedDocumentsMap(o,i,r)}},e.prototype.prebootApplication=function(e,t){var n=this;if(e===b.b.Visio){var i=this.uiHostBootstrapperService.bootstrapApplication(e,t);if(i){var o=new w.a,a=this.setUpDeferredTearDown(o),l=i.correlationAndBoot[1],s={bootAndLoadInfo:i.loadData,visible:!1,lockRouting:!!a,bootCompleted:!1,loadCancellationToken:o};o.onCancel((function(){null==a||a.cleanUp(),n.unloadAllDocuments(),i.cancelLoad()}));var c=new r.a(s);this._loadedDocuments.next(new Map([[l,c]]))}}},e.prototype.updateBootedDocumentsMap=function(t,n,o){var a;return void 0===n&&(n=!1),void 0===o&&(o=!1),Object(i.__awaiter)(this,void 0,void 0,(function(){var l,s,c,u,d,p,h,f,m,v,g,y=this;return Object(i.__generator)(this,(function(S){switch(S.label){case 0:return l=Object(i.__read)(Object(C.a)(),3),s=l[0],c=l[1],u=l[2],[4,this.getCurrentLoadedDocuments()];case 1:return d=S.sent(),p=d.get(t.bootedDocumentInfo.bootId),h=void 0,p?[3,3]:(f=new w.a,[4,this.unlockRoutes()]);case 2:return S.sent(),h=n?void 0:this.setUpDeferredTearDown(f),m={bootAndLoadInfo:t,visible:!o,lockRouting:!!h,bootCompleted:!1,deferHelper:h,routeEndPromise:s,loadCancellationToken:f},f.onCancel((function(){null==h||h.cleanUp(),y.unloadAllDocuments(),u()})),this.locationSubscription&&!(null===(a=this.locationSubscription)||void 0===a?void 0:a.closed)||(this.locationSubscription=this.location.subscribe((function(t){var n,i=null!==(n=t.url)&&void 0!==n?n:"",r=I.a.getQueryParams(i),o=y.getAppNameFromUrl(i),a=b.a.fileTypeNameToFileType(o),l=y.getDocumentInfoFromParams(r,a);l&&e.isValidDocumentInfo(l)&&y.bootstrapDocumentFromLoader(l,Date.now(),!1)}))),v=new r.a(m),this._loadedDocuments.next(new Map([[t.bootedDocumentInfo.bootId,v]])),[3,4];case 3:g=p.getValue(),p.next(Object(i.__assign)(Object(i.__assign)({},g),{visible:!o,bootAndLoadInfo:t})),h=g.deferHelper,S.label=4;case 4:return[2,function(e){void 0===e&&(e={}),y.routeToContentPage(t.bootedDocumentInfo.documentInfo,h,e).then((function(e){return null==h||h.cleanUp(),e?c():u()}))}]}}))}))},e.prototype.updateInformation=function(t,n,r,o){var a,l=this;void 0===o&&(o=!1);var s=null===(a=this._loadedDocuments.getValue())||void 0===a?void 0:a.get(t);if(s){var c=s.getValue();if(c){var u=Object(i.__assign)(Object(i.__assign)({},c),{bootAndLoadInfo:{correlationId:c.bootAndLoadInfo.correlationId,bootedDocumentInfo:{bootId:t,documentInfo:null!=n?n:c.bootAndLoadInfo.bootedDocumentInfo.documentInfo},data:c.bootAndLoadInfo.data},visible:null!=r?r:c.visible});s.next(u),o&&c.routeEndPromise.then((function(){var t=e.getParamsForDocumentInfo(u.bootAndLoadInfo.bootedDocumentInfo.documentInfo);l.officeRouteService.updateQueryParams(t)}))}}},e.prototype.unloadAllDocuments=function(){this.locationSubscription.unsubscribe(),this._loadedDocuments.next(new Map)},e.prototype.resetShell=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.capabilitiesService.capabilities.isEmbedMode?[2]:(t=this.documentService.nativeDocument.getElementById("ReactShellHeader"))&&t.childElementCount?(this.documentService.removeCssClassFromElement(t,e.HiddenShellClass),[4,this.shellShimService.getShellShim()]):[3,2];case 1:return(n=i.sent()).Notifications.UnmuteToasts&&n.Notifications.UnmuteToasts(),[3,3];case 2:this.docTitleEnabled||(r=this.reactShellConfigService.reactShellConfig.resourceUrl)&&this.documentService.addScriptToPage(r,(function(){return o.windowService.nativeWindow.bootstrapReactShell()}),(function(){var e;return o.instrumentationService.logErrorEvent("Shell_Bootstrapper_Load_Error",((e={}).ShellBootAfterStartup="true",e.ResourceUrl=r,e))})),i.label=3;case 3:return[2]}}))}))},e.prototype.getLoadedDocumentsObservable=function(){return this._loadedDocuments.asObservable().pipe(Object(l.a)((function(e){return Array.from(e.keys()).map((function(t){return{bootId:t,data:e.get(t).asObservable()}}))})))},e.prototype.hasLoadedDocumentsObservable=function(){return this._loadedDocuments.asObservable().pipe(Object(l.a)((function(e){return e.size>0})),Object(s.a)(1))},e.prototype.getCurrentLoadedDocuments=function(){return this._loadedDocuments.asObservable().pipe(Object(c.a)()).toPromise()},e.prototype.getDocumentInfoFromParams=function(e,t,n){var i,r,o=e[v.a.ItemId],a=e[v.a.DriveId],l=null!==(r=this.decodeParamWithKey(e,v.a.DocUrl))&&void 0!==r?r:this.decodeParamWithKey(e,v.a.ContentUri),s=e[v.a.Nav];return{docId:o,driveId:a,docUrl:l,wdOrigin:null!=n?n:this.contextService.getWdOrigin("DIRECT"),applicationUrlParams:s?(i={},i.actnavid=s,i):void 0,fileType:t}},e.prototype.getWacHostControlQueryParams=function(t){return e.WacHostControlFileTypes.indexOf(t)>=0&&this.capabilitiesService.capabilities.wacHostControlFlight?this.capabilitiesService.capabilities.pwaEnabled?{wdwachostcf:"hwa"}:{wdwachostcf:"web"}:{}},e.prototype.unlockRoutes=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r=this;return Object(i.__generator)(this,(function(o){switch(o.label){case 0:return this.capabilitiesService.capabilities.wacHostTimeoutTeardownEnabled?[4,this.getCurrentLoadedDocuments()]:[2,Promise.resolve()];case 1:return e=o.sent(),t=Array.from(e.keys()),n=t.map((function(t){return Object(i.__awaiter)(r,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){return this.unlockRoute(t),[2,e.get(t).asObservable().pipe(Object(c.a)()).toPromise().then((function(e){return e.lockRouting?e.routeEndPromise:Promise.resolve()}))]}))}))})),[2,Promise.all(n)]}}))}))},e.prototype.unlockRoute=function(e,t){return void 0===t&&(t=0),Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){return this.changeRouterLock(e,!1,t),[2]}))}))},e.prototype.changeRouterLock=function(e,t,n){return void 0===n&&(n=0),Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r,o=this;return Object(i.__generator)(this,(function(a){switch(a.label){case 0:return[4,this.getCurrentLoadedDocuments()];case 1:return n=a.sent(),r=n.get(e),setTimeout((function(){return Object(i.__awaiter)(o,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,r.asObservable().pipe(Object(c.a)()).toPromise()];case 1:return e=n.sent(),r.next(Object(i.__assign)(Object(i.__assign)({},e),{lockRouting:t})),[2]}}))}))}),0),[2]}}))}))},e.prototype.awaitUnblockedRouted=function(){return this._loadedDocuments.asObservable().pipe(Object(u.a)((function(e){var t=Array.from(e.values()),n=t.map((function(e){return e.asObservable().pipe(Object(l.a)((function(e){return e.lockRouting})),Object(d.a)((function(e){return!e})),Object(s.a)(1))}));return t.length?Object(o.a)(n):Object(a.a)([])})),Object(l.a)((function(e){return null})),Object(s.a)(1)).toPromise()},e.prototype.markBootCompleted=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(o){switch(o.label){case 0:return t=this._loadedDocuments.getValue(),[4,(n=t.get(e)).asObservable().pipe(Object(c.a)()).toPromise()];case 1:return r=o.sent(),n.next(Object(i.__assign)(Object(i.__assign)({},r),{bootCompleted:!0})),[2]}}))}))},e.prototype.getApplicationParamsFromDocument=function(e){var t,n=e.docUrl;if(!n)return{};var i=I.a.getQueryParams(n),r=i?i.nav:void 0;return r?((t={}).actnavid=r,t):{}},e.prototype.setUpDeferredTearDown=function(e){var t,n,i=this;if(this.capabilitiesService.capabilities.wacHostDeferredTeardownEnabled&&"Content"!==(null===(t=this.officeRouteService.getCurrentRoute())||void 0===t?void 0:t.route))return{start:function(){n=i.location.subscribe((function(t){-1===t.url.indexOf("content")&&e.cancel()}))},cleanUp:function(){n.unsubscribe()}}},e.prototype.routeToContentPage=function(t,n,i){var r=e.getParamsForDocumentInfo(t,i);return null==n||n.start(),this.officeRouteService.navigateTo({route:"Content",app:t.fileType},!1,r,void 0,!!n)},e.prototype.decodeParamWithKey=function(e,t){var n=e[t];if(n){var i=n;try{i=decodeURIComponent(n.replace(/\+/g," "))}catch(e){i=null!=n?n:void 0}return i}},e.prototype.getContentPath=function(e){return""+this.capabilitiesService.capabilities.startPageRootPath+b.b[e].toLowerCase()+this.capabilitiesService.capabilities.wacHostPagePath},e.prototype.getQueryParamString=function(e){return Object.keys(e).filter((function(t){return e[t]})).reduce((function(t,n){return t+"&"+n+"="+e[n]}),"").slice(1)},e.prototype.getAppNameFromUrl=function(e){if(e){var t=e.split("/");if(t.length>=3)return t[2]}},e.prototype.setupAbandonListener=function(){var e=this;this.getLoadedDocumentsObservable().pipe(Object(p.a)()).subscribe((function(t){var n=Object(i.__read)(t,2),r=n[0],o=n[1];null==r||r.forEach((function(t){return Object(i.__awaiter)(e,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return(null==o?void 0:o.some((function(e){return t.bootId===e.bootId})))?[3,2]:[4,t.data.pipe(Object(c.a)()).toPromise()];case 1:(e=n.sent()).bootCompleted||this.logAbandon(e.bootAndLoadInfo),n.label=2;case 2:return[2]}}))}))}))}))},e.prototype.setupResetShellListener=function(){var e=this;this.hasLoadedDocumentsObservable().pipe(Object(h.a)(),Object(f.a)(1)).subscribe((function(t){t||e.resetShell()}))},e.prototype.logLoadStart=function(e){this.instrumentationService.logGenericEvent("WacDocument_Load_Start",Object(T.a)(e.correlationId,e.bootedDocumentInfo.documentInfo))},e.prototype.logAbandon=function(e){this.instrumentationService.logGenericEvent("WacDocument_Abandon",Object(T.a)(e.correlationId,e.bootedDocumentInfo.documentInfo))},e.HiddenShellClass="hide-shell",e.DeferTimeoutMultiplier=5,e.WacHostControlFileTypes=[b.b.Word,b.b.Excel,b.b.PowerPoint],e.ɵprov=O.cc({factory:function(){return new e(O.dc(F.a),O.dc(g.a),O.dc(y.a),O.dc(k.a),O.dc(m.a),O.dc(D.g),O.dc(A.a),O.dc(S.a),O.dc(P.a),O.dc(E.a),O.dc(_.b))},token:e,providedIn:"root"}),e}()},EVbV:function(e,t,n){"use strict";n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return D}));var i=n("keVe"),r=n("pzhl"),o=n("PkQn"),a=n("4/We"),l=n("1GMS"),s=n("cAxl"),c=n("3bNC"),u=n("TOqr"),d=n("Jn4Q"),p=n("dx17"),h=n("hZW2"),f=n("y1jW"),m=n("7Gwk"),b=n("hhzZ"),v=n("PBJH"),g=n("kfAr"),y=n("AY/E"),S=n("1Bt+"),w=n("TIi1"),C=n("EUVs"),I=n("BMb5"),T=i.xb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeIn",definitions:[{type:1,expr:"inactive => active",animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"500ms 0ms linear"}],options:null}],options:{}}]}});function k(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-icon-font",[],[[1,"aria-label",0]],null,null,r.b,r.a)),i.yb(1,638976,null,0,o.a,[a.a],{cssClass:[0,"cssClass"],iconFontType:[1,"iconFontType"],size:[2,"size"]},null)],(function(e,t){var n=t.component;e(t,1,0,i.Gb(1,"ms-fcl-tp activity-icon ",n.iconCssClass,""),n.htmlDescription.icon,n.iconSize)}),(function(e,t){var n=t.component;e(t,0,0,null==n.htmlDescription||null==n.htmlDescription.activityDescription?null:n.htmlDescription.activityDescription.plainText)}))}function A(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-person-picture",[],null,null,null,l.b,l.a)),i.yb(1,573440,null,0,s.a,[c.a],{person:[0,"person"],personPictureCard:[1,"personPictureCard"]},null)],(function(e,t){e(t,1,0,t.component.person,!0)}),null)}function P(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),i.Yb(-1,null,[" - "]))],null,null)}function E(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,"span",[],null,null,null,null,null)),i.yb(1,278528,null,0,u.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(2,{"activity-deep-link__underlined ms-fcl-tp":0}),(e()(),i.Yb(3,null,["",""]))],(function(e,t){var n=t.component,i=e(t,2,0,n.teamsDeepLink&&n.activityDeepLinkHovered);e(t,1,0,i)}),(function(e,t){e(t,3,0,t.component.inTeams)}))}function _(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,7,"div",[["class","activity-description__date"]],[[8,"title",0]],null,null,null,null)),i.yb(1,278528,null,0,u.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"activity-description__title--clipped":0,"activity-description__date--fluent ms-fcl-npa":1}),(e()(),i.Yb(3,null,[" "," "])),(e()(),i.ib(16777216,null,null,1,null,P)),i.yb(5,16384,null,0,u.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,E)),i.yb(7,16384,null,0,u.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,!!n.title,n.fluentRefresh);e(t,1,0,"activity-description__date",i),e(t,5,0,n.teamsDeepLink),e(t,7,0,n.teamsDeepLink)}),(function(e,t){var n=t.component;e(t,0,0,i.Gb(1,"",n.secondLine,"")),e(t,3,0,n.secondLine)}))}function O(e){return i.bc(0,[(e()(),i.zb(0,0,[[1,0],["descriptionElement",1]],null,7,"span",[["class","activity-description ms-fcl-ns"]],null,null,null,null,null)),i.yb(1,278528,null,0,u.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"activity-description--clipped":0,"activity-description--card":1,"activity-description--card--fluent":2,"activity-description--mobile":3,"activity-description--motion-padding":4,"ms-fcl-ns":5,"ms-fcl-nd":6}),(e()(),i.zb(3,0,null,null,2,"span",[],[[8,"innerHTML",1],[8,"title",0]],[[null,"mouseenter"]],(function(e,t,n){var i=!0;return"mouseenter"===t&&(i=!1!==e.component.onHover()&&i),i}),null,null)),i.yb(4,278528,null,0,u.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(5,{"activity-deep-link ms-fcl-tp":0,"list-item__text--large activity-description__title--clipped ms-fcl-ns":1,"activity-description--large":2}),(e()(),i.ib(16777216,null,null,1,null,_)),i.yb(7,16384,null,0,u.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.numLines,2===n.numLines&&!n.fluentRefresh,2===n.numLines&&n.fluentRefresh,n.mobileListItem&&2!==n.numLines,!!n.title,!n.fluentRefresh,n.fluentRefresh);e(t,1,0,"activity-description ms-fcl-ns",i);var r=e(t,5,0,n.activityDeepLink&&n.activityDeepLinkHovered,!!n.title,n.timestampAndTitleInSameLine);e(t,4,0,r),e(t,7,0,2===n.numLines)}),(function(e,t){var n=t.component;e(t,3,0,n.htmlDescription.html,i.Gb(1,"",null==n.htmlDescription||null==n.htmlDescription.activityDescription?null:n.htmlDescription.activityDescription.plainText,""))}))}function F(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,null,null,null,null,null,null,null)),i.Nb(null,0),(e()(),i.ib(0,null,null,0))],null,null)}function D(e){return i.bc(0,[i.Ub(671088640,1,{descriptionElement:0}),(e()(),i.zb(1,0,null,null,8,"div",[],[[24,"@fadeIn",0],[8,"id",0]],[[null,"mouseover"],[null,"mouseleave"]],(function(e,t,n){var i=!0,r=e.component;return"mouseover"===t&&(i=!1!==r.activityHovered()&&i),"mouseleave"===t&&(i=!1!==r.activityUnhovered()&&i),i}),null,null)),i.yb(2,278528,null,0,u.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(3,{"activity-description__container":0,"activity-description__container--mobile":1}),(e()(),i.ib(16777216,null,null,1,null,k)),i.yb(5,16384,null,0,u.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,A)),i.yb(7,16384,null,0,u.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,O)),i.yb(9,16384,null,0,u.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,F)),i.yb(11,16384,null,0,u.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,3,0,!n.iconOnly,n.mobileListItem);e(t,2,0,i),e(t,5,0,(null==n.htmlDescription?null:n.htmlDescription.icon)&&n.showIcon),e(t,7,0,!n.showIcon&&(null==n.person?null:n.person.email)),e(t,9,0,(null==n.htmlDescription?null:n.htmlDescription.html)&&!n.iconOnly),e(t,11,0,!n.htmlDescription)}),(function(e,t){var n=t.component;e(t,1,0,n.activityState,n.docId?n.getActivityElementId():null)}))}i.vb("ohp-activity-description",d.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,D,T)),i.yb(1,5226496,null,0,d.a,[p.a,a.a,i.h,h.a,f.b,m.a,b.a,v.a,g.a,y.a,S.a,w.a,C.a,I.b],null,null)],(function(e,t){e(t,1,0)}),null)}),{activities:"activities",lastViewedTime:"lastViewedTime",iconOnly:"iconOnly",showIcon:"showIcon",person:"person",iconCssClass:"iconCssClass",iconSize:"iconSize",activityDeepLink:"activityDeepLink",title:"title",docId:"docId",activityDescriptionInput:"activityDescriptionInput",index:"index",fileType:"fileType",navId:"navId",numLines:"numLines",mobileListItem:"mobileListItem",teamsDeepLink:"teamsDeepLink",area:"area",useSolidIcon:"useSolidIcon",timestampAndTitleInSameLine:"timestampAndTitleInSameLine"},{},["*"])},EYcb:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("AlWG"),r=n("keVe"),o=function(){function e(){this._error=new i.a(null)}return e.prototype.showErrorDialog=function(e){this._error.next(e)},Object.defineProperty(e.prototype,"error",{get:function(){return this._error.asObservable()},enumerable:!0,configurable:!0}),e.ɵprov=r.cc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},Epfv:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return s}));var i=n("bb6g");function r(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(495).then(n.t.bind(null,"yfDh",7))];case 1:return[2,e.sent().default]}}))}))}function o(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return e?[2,new TextEncoder]:[4,r()];case 1:return[2,new(t.sent().TextEncoderLite)]}}))}))}function a(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return e?[2,new TextDecoder]:[4,r()];case 1:return[2,new(t.sent().TextDecoderLite)]}}))}))}function l(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,o("TextEncoder"in t)];case 1:return[2,n.sent().encode(e)]}}))}))}function s(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,a("TextDecoder"in t)];case 1:return[2,n.sent().decode(e)]}}))}))}},EqbI:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("bb6g"),r=n("hhzZ"),o=n("R7NL"),a=n("/I02"),l=n("kpuN"),s=n("wwmn"),c=n("v3sZ"),u=n("casz"),d=n("pOWU"),p=n("keVe"),h=n("TOqr"),f=function(e){function t(t,n,i,r,o,a,l,s){var c=e.call(this,t,n,i,"OneNote",r,o,l,s)||this;return c.oneNoteConfigService=a,c.COPY_CLASS_NOTEBOOK="/notebooks/saveacopy",c.CLIENT_DEV_MODE_RESOURCE_URL="https://www.onenote.com",c.BASE_URL="/api",c.VERSION="1.0",c.newPageHtml="<!DOCTYPE html>\n    <html>\n      <head>\n        <title>{PAGETITLE}</title>\n      </head>\n      <body>\n      </body>\n    </html>",c.getClassNoteBookPromise=null,c.inMockMode=r.sharedContext.inMockMode,c}return Object(i.__extends)(t,e),t.prototype.getClassNoteBooks=function(){var e=this,t={};return this.getClassNoteBookPromise||(this.getClassNoteBookPromise=new Promise((function(n,i){e.get("Get_ClassNotebooks_Request",e.oneNoteConfigService.config.oneNoteApiPath+e.BASE_URL+"/v"+e.VERSION+"/me/notes/classnotebooks?hasaccessto=true&orderby=lastModifiedTime desc",(function(t){t.instrument((function(t,n){n.params.RequestId=e.getRequestIdFromResponse(t)})).then((function(e){n(e.data.value)}))}),(function(t){e.getClassNoteBookPromise=null,i(t)}),t,"network-only")}))),this.getClassNoteBookPromise},t.prototype.generateSaveCopyClassNotebookLink=function(e,t,n){var i=this.inMockMode?this.CLIENT_DEV_MODE_RESOURCE_URL:this.oneNoteConfigService.config.oneNoteApiPath,r=e.indexOf("-"),o=e.substring(0,r),a=e.substring(r+1).toLowerCase();return""+i+this.COPY_CLASS_NOTEBOOK+"/?notebookId="+o+"|{"+a+"}&notebookName="+t+"&notebookUrl="+n},t.prototype.getNotebookSections=function(e,t,n){var i=this,r="/myOrganization/siteCollections/"+e+"/sites/"+t+"/notes/notebooks/1-"+n+"/sections",o={};return new Promise((function(a,l){i.get("Get_OneNote_Sections_Request",i.oneNoteConfigService.config.oneNoteApiPath+i.BASE_URL+"/v"+i.VERSION+r,(function(r){r.instrument((function(e,t){t.params.RequestId=i.getRequestIdFromResponse(e)})).then((function(i){var r=(i&&i.data&&i.data.value||[]).map((function(i){return{name:i.name,siteId:e,webId:t,listItemUniqueId:n,sectionId:i.id,key:i.id}}));a(r)}))}),(function(e){l(e)}),o,"network-only")}))},t.prototype.createPageInSection=function(e,t,n,i){var r=this,o={headers:new Map};o.headers.set("Content-Type","text/html");var a="/myOrganization/siteCollections/"+e+"/sites/"+t+"/notes/sections/"+n+"/pages";return new Promise((function(e,t){r.post("Get_OneNote_Page_Request",r.oneNoteConfigService.config.oneNoteApiPath+r.BASE_URL+"/v"+r.VERSION+a,r.newPageHtml.replace("{PAGETITLE}",i),(function(n){n.instrument((function(e,t){t.params.RequestId=r.getRequestIdFromResponse(e)})).then((function(n){var i=n.data;i&&i.links&&i.links.oneNoteWebUrl.href?e(i.links.oneNoteWebUrl.href):t("error parsing response")})).catch((function(e){t(e)}))}),(function(e){e&&e.httpResponse?t(e.httpResponse.data?{error:{code:""+e.httpResponse.status,data:""+e.httpResponse.data}}:{error:{code:""+e.httpResponse.status}}):t()}),o)}))},t.prototype.getRequestIdFromResponse=function(e){return e.headers.get("X-CorrelationId")},t.ɵprov=p.cc({factory:function(){return new t(p.dc(l.b),p.dc(r.a),p.dc(o.a),p.dc(a.a),p.dc(s.a),p.dc(c.a),p.dc(h.q),p.dc(u.a))},token:t,providedIn:"root"}),t}(d.a)},Eu1D:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Unknown=0]="Unknown",e[e.Disabled=1]="Disabled",e[e.Loading=2]="Loading",e[e.Displayed=3]="Displayed",e[e.Failed=4]="Failed"}(i||(i={}))},EuUe:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},Eup2:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var i=n("bb6g"),r=n("keVe"),o=n("zvoD"),a=n("f0qX"),l=n("3Vsh"),s=n("DCBR"),c=(n("lrJm"),n("vcPZ")),u=(n("SPVw"),n("kaEK")),d=n("0ZeC"),p=(n("dOgD"),n("CC5A")),h=n("hhzZ"),f=(n("Vwd8"),n("BaAg")),m=n("Eu1D"),b=(n("QOOv"),n("JT1q")),v=(n("7wk3"),n("AXqk"),n("W3Zz")),g=(n("hZW2"),n("7Gwk"),n("U8M1"),n("rBEp"),n("n826"),n("Uqr9"),n("xoWf"),n("BMb5"),n("4/We"),n("cgnd"),n("/I02"),n("PBJH"),n("RJiy"),n("aXuH"),function(e){function t(t,n,i,o,a,l,s,c,u,d,p,h,f,m,b,v,g,y,S,w,C,I,T){var k=e.call(this,t,n,h,m,b,f)||this;return k.capabilitiesService=t,k.changeDetector=n,k.recommendedService=i,k.contextService=o,k.floodgateService=a,k.globalErrorHandler=l,k.performanceService=s,k.jumpListService=c,k.browserPaintMeasurementService=u,k.oneDriveGraphService=d,k.mruConfigService=p,k.deviceDetector=h,k.locService=f,k.instrumentationService=b,k.dataSecurityService=v,k.eventService=g,k.userDataStorageService=y,k.featureCalloutService=S,k.userProfileService=w,k.officeFeedService=C,k.clientStartupContextService=I,k.windowService=T,k.currentCarouselPage=0,k.translateX="0",k.stateChanged=new r.n,k}return Object(i.__extends)(t,e),t.prototype.ngOnInit=function(){var e=this;this.sharedInit();var n=this.capabilitiesService.capabilities;this.stateChanged.emit({state:m.a.Loading}),this.isAntpExperience=n.antpLoaded,this.mruConfig=this.mruConfigService.config,this.fluentRefresh=n.fluentRefresh,this.isFluentRecommended=this.fluentRefresh&&!this.isSuggestedActions,this.canSwipeRecommended=this.deviceDetector.isMobileDevice(),this.visibleCardPeek=this.isFluentRecommended?32:40,this.maxCardsPerLine=this.isAntpExperience||this.isFluentRecommended?5:4,this.appFilter=this.fileType?new Set([this.fileType]):null,this.fileType&&this.fileType===f.b.Stream&&this.appFilter.add(f.b.Video),this.bottomTrayEnabled=n.bottomTrayEnabled,this.isOfficeFeed=(this.mruConfig.officeFeedControlEnabled||this.mruConfig.officeFeedFlightEnabled)&&!this.isStartPage,this.listId=this.isOfficeFeed?t.officeFeedListId:t.recommendedListId,this.recommendedEnabled=this.mruConfig.recommendedEnabled&&this.fileType!==f.b.Sway&&this.fileType!==f.b.OneNote&&this.fileType!==f.b.Forms&&(this.fileType!==f.b.Visio||this.mruConfig.recommendedVisioEnabled),this.showAnalytics=this.mruConfig.analyticsEnabled&&this.fileType===f.b.Sway,this.showActivity=!this.showAnalytics&&this.mruConfig.activityEnabled&&this.fileType!==f.b.OneNote,this.showSharing=!this.showAnalytics&&this.mruConfig.sharingStatusEnabled,this.componentArea=this.isSuggestedActions?h.b.SuggestedActions:h.b.Recommended,this.recommendedMotion=!this.isAntpExperience&&this.mruConfig.recommendedMotionEnabled&&!this.canSwipeRecommended&&this.deviceDetector.deviceInfo.browser.browserType!==v.a.Safari,this.recommendedDocView=this.isSuggestedActions?"SuggestedAction":"Card";var i=function(t){e.eventService.broadcastEvent({name:"recommendedReady",args:[t]})};if(this.recommendedTitle=this.isSuggestedActions?this.locService.RecommendedActionsSectionTitle:this.locService.RecommendedDocumentsSectionTitle,this.recommendedEnabled){var r=void 0;this.isOfficeFeed?(r=this.officeFeedService.getOfficeFeed(),this.officefeedBounce=this.eventService.events.withScope(1).pipe(Object(o.a)((function(e){return"appTileClick"===e.name})),Object(a.a)((function(e){return e.args[0]}))).subscribe((function(t){if(e.cards){var n=Math.min(e.currentCarouselPage+e.cardIncrement-1,e.cards.length-1),i=e.cards[n];i&&e.officeFeedService.logInstrumentation([i.feedbackId],["bounce"],[i.fromCache?"cache":"service"],[t])}}))):r=this.recommendedService.getRecommendedDocs(this.appFilter),r?(this.recommendedStream=r.results.subscribe((function(t){return e.processRecommendedTask(t)})),r.results.pipe(Object(l.a)(1)).toPromise().then((function(e){return i(e.items.length)})),r.initialCompletion.then((function(t){t&&(e.globalErrorHandler.handleCacheObservableError(t,"tCyIn","jtlYX"),e.stateChanged.emit({state:m.a.Failed}),i(0),t.cacheError&&t.networkError&&e.eventService.broadcastEvent({name:"recommendedFailed",args:[]}))}))):i(0)}else i(0)},t.prototype.onScrollFocus=function(e){(e?this.recommendedNavLeft:this.recommendedNavRight).nativeElement.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})},t.prototype.ngAfterViewChecked=function(){var e=this;this.recommendedEnabled&&this.mruConfig.recommendedCalloutEnabled&&!this.recommendedCalloutPromise&&void 0!==this.carouselElement&&this.cards&&this.cards.length>0&&(this.recommendedCalloutPromise=this.userProfileService.doesMetricExist("Recommended_Callout_Impression",!0),this.recommendedCalloutPromise.then((function(t){t||e.userDataStorageService.get("SawRecommended",1).then((function(t){if(t)e.userProfileService.incrementMetric("Recommended_Callout_Impression");else{var n=e.documentService.nativeDocument.querySelector(".list-header__title--card-carousel");e.featureCalloutService.addCallout(new c.a(n,"Recommended",h.b.Documents,e.locService.RecommendedDocumentsCalloutTitle,e.locService.RecommendedDocumentsCalloutSubtitle,null,null,null,!1,!1,!0)),e.instrumentationService.logImpressionEvent("Recommended_Callout_Impression",{},["Recommended_Callout_Impression"])}}))})))},t.prototype.ngOnDestroy=function(){this.recommendedStream&&this.recommendedStream.unsubscribe(),this.officefeedBounce&&this.officefeedBounce.unsubscribe()},t.prototype.recommendedMotionDone=function(){this.recommendedMotion&&(this.motionState="",this.checkCorrectTranslation())},t.prototype.navigateCards=function(t){var n;if(e.prototype.navigateCards.call(this,t)){if(this.isOfficeFeed){var r=this.cards.slice(this.currentCarouselPage,this.currentCarouselPage+this.cardIncrement);this.logOfficeFeedGeneralViews(r),this.loggedFirstScroll&&this.loggedLimitScroll||this.logOfficeFeedScroll()}if(this.recommendedMotion){var o=Math.min(this.currentCarouselPage+this.cardIncrement+1,this.cards.length);o>this.recommendedMotionList.length&&(n=this.recommendedMotionList).push.apply(n,Object(i.__spread)(this.cards.slice(this.currentCarouselPage+1,o))),this.setRightOffset(),this.translateX=this.isSuggestedActions?"translateX("+100*-t+"%)":"translateX("+100*-t+"%) translateX("+t*(this.cardMargin+this.visibleCardPeek)+"px)",this.motionState="moving"}return this.statusAnnouncement="",this.changeDetector.detectChanges(),this.statusAnnouncement=-1===t?this.locService.RecommendedScrollPreviousAriaAnnouncement:this.locService.RecommendedScrollNextAriaAnnouncement,this.logRecommendedImpression(this.cards[this.currentCarouselPage].fromCache),!0}return!1},t.prototype.updateCarouselCardData=function(){if(e.prototype.updateCarouselCardData.call(this,this.recommendedMotion?this.visibleCardPeek:0,this.isFluentRecommended),this.recommendedMotion&&this.checkCorrectTranslation(),this.canSwipeRecommended){var t=this.virtualCards&&this.virtualCards.first&&this.virtualCards.first.nativeElement?this.virtualCards.first.nativeElement.clientWidth:null;t&&this.eventService.broadcastEvent({name:"recommendedCardSize",args:[t,501.77>this.windowService.nativeWindow.innerWidth?2:766.98>this.windowService.nativeWindow.innerWidth?3:4]})}},t.prototype.onDeleteRecommendedItem=function(e){var t,n=this.cards.indexOf(e.item);n>-1&&(this.cards.splice(n,1),this.currentCarouselPage>=this.cards.length&&(this.currentCarouselPage=Math.max(0,this.currentCarouselPage-this.cardIncrement)),this.recommendedMotion&&(this.recommendedMotionList=this.cards.slice(0,this.currentCarouselPage+this.cardIncrement+1))),this.isOfficeFeed?"myAnalyticsInsight"!==e.item.mruV2Category?this.officeFeedService.logInstrumentation([e.item.feedbackId],["neverShowAgain"],[e.item.fromCache?"cache":"service"]):this.officeFeedService.performAction(e.item.feedbackId,d.a.DismissAction,null===(t=e.item.potentialAction.filter((function(e){return e.name===d.a.DismissAction}))[0])||void 0===t?void 0:t.actionPayload):this.recommendedService.removeDocument(e.item.spoId),this.cards.length>0&&this.logRecommendedImpression(this.cards[this.currentCarouselPage].fromCache),this.statusAnnouncement="",this.changeDetector.detectChanges(),this.statusAnnouncement=this.locService.RemoveDocumentAriaTitle},t.prototype.logNavClick=function(e){var t={};t.Index=this.currentCarouselPage.toString(),t.Increment=this.cardIncrement.toString(),t.TotalSize=this.cards.length.toString(),t.ItemCategory=this.listId,t.ImpressionId=this.impressionId,this.instrumentationService.logClickEvent("Recommended_Nav_Click",e<0?"NavPrevious":"NavNext",this.componentArea,null,null,t)},t.prototype.checkCorrectTranslation=function(){this.setRightOffset(),this.carouselElement.nativeElement.style.cssText=(this.contextService.isRtl?"left":"right")+": "+this.calcTranslateX},t.prototype.setRightOffset=function(){if(this.cardIncrement){var e=this.currentCarouselPage/this.cardIncrement,t=Math.round(1e4*e)/100;this.calcTranslateX=this.isSuggestedActions?"calc("+t+"% + "+20*e+"px)":"calc("+t+"% - "+this.visibleCardPeek*e+"px)"}},t.prototype.processRecommendedTask=function(e){var t=this;if(e.items){this.impressionId=e.impressionId;var n=e.items.map(this.isOfficeFeed?function(n,i){return Object(b.d)(n,"mru_item_"+i,e.impressionId,t.contextService.isRtl,t.clientStartupContextService.config.authType,e.fromCache)}:function(n,i){return Object(b.f)(n,"mru_item_"+i,e.impressionId,t.contextService.isRtl,t.clientStartupContextService.config.authType,e.fromCache)});if(this.cards&&this.copyInflationData(this.cards,n),this.cards=n,this.stateChanged.emit({state:m.a.Displayed}),this.performanceService.mark(e.fromCache?"Cached_Recommended_Ready":"Recommended_Ready"),this.browserPaintMeasurementService.recordWhenPainted("Recommended"),this.capabilitiesService.capabilities.batchGraphEnabled){var i=n.map((function(e){return e.url}));this.oneDriveGraphService.getSharedItemsWithThumbnails(i)}if(this.cards.length>0){if(this.isFluentRecommended?this.maxCardContainerWidths=[0,481,641,1025,1367]:(this.maxCardContainerWidths=[this.maxCardContainerWidth(1),this.maxCardContainerWidth(2),this.maxCardContainerWidth(3),this.maxCardContainerWidth(4)],this.isAntpExperience&&this.maxCardContainerWidths.push(this.maxCardContainerWidth(5))),this.cardIncrement=this.getNumCards(this.recommendedMotion?this.visibleCardPeek:0,this.isFluentRecommended),this.recommendedMotion&&(this.recommendedMotionList=this.cards.slice(0,Math.max(this.currentCarouselPage+this.cardIncrement,this.maxCardsPerLine)+1)),this.logRecommendedImpression(e.fromCache),this.isOfficeFeed){var r=this.cards.slice(0,this.cardIncrement);this.logOfficeFeedGeneralViews(r)}this.capabilitiesService.capabilities.recommendedFloodgate&&this.capabilitiesService.capabilities.showFloodgate&&this.floodgateService.recordFloodgate(["RecommendedImpressionGeneral"])}this.appFilter&&0!==this.appFilter.size||this.jumpListService.registerRecommendedJumpList(this.cards)}},t.prototype.logOfficeFeedGeneralViews=function(e){var t=e.map((function(e){return e.feedbackId})),n=e.map((function(){return"view"})),i=e.map((function(e){return e.fromCache?"cache":"service"}));this.officeFeedService.logInstrumentation(t,n,i)},t.prototype.logOfficeFeedScroll=function(){var e=[],t=[],n=[];if(this.loggedFirstScroll){if(this.currentCarouselPage+this.cardIncrement>=this.cards.length&&!this.loggedLimitScroll){var i=Math.min(this.currentCarouselPage+this.cardIncrement-1,this.cards.length-1);e.push(this.cards[i].feedbackId),t.push("scrollLimit"),n.push(this.cards[i].fromCache?"cache":"service"),this.loggedLimitScroll=!0}}else{var r=this.cards[this.currentCarouselPage-1];e.push(r.feedbackId),t.push("scrollStart"),n.push(r.fromCache?"cache":"service"),this.loggedFirstScroll=!0}t.length>0&&e.length>0&&n.length>0&&this.officeFeedService.logInstrumentation(e,t,n)},t.prototype.copyInflationData=function(e,t){var n,r,o=function(t){var n=null;e.some((function(e){return e.documentUrl===t.documentUrl&&(n=e,!0)}))&&t.copyInflationData(n,a.mruConfig.mruActivityEnabled)},a=this;try{for(var l=Object(i.__values)(t),s=l.next();!s.done;s=l.next())o(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}},t.prototype.logRecommendedImpression=function(e){var t=this.cards,n=t.slice(this.currentCarouselPage,Math.min(this.currentCarouselPage+this.cardIncrement,this.cards.length)),i=!n||this.dataSecurityService.securityLevel>=2?n:n.filter((function(e){return!e.isLocal})),r=f.a.distributionFromFileItems(i),o={};if(o.RenderSize=(i?i.length:0).toString(),o.Distribution=r,o.ElementId=this.listId,o.TotalSize=this.getNumLoggableItems(t).toString(),o.State="Card",o.TabState=p.a[p.a.Loaded],o.ImpressionId=this.impressionId,o.FromServiceWorkerCache=(!!e).toString(),o.Area=this.componentArea,this.capabilitiesService.capabilities.suggestedActionsEnabled&&(o.SuggestedActionsDistribution=this.getSuggestedActionsDistribution(this.cards)),void 0!==this.currentCarouselPage&&(o.Index=this.currentCarouselPage.toString()),void 0!==this.cardIncrement&&(o.Increment=this.cardIncrement.toString()),t.length>0){var a=t[0].timeSinceLastOpenInSeconds();null!==a&&(o.InactivityDuration=a.toString())}this.instrumentationService.logImpressionEvent("Recommended_Impression",o)},t.prototype.getNumLoggableItems=function(e){return e?this.dataSecurityService.securityLevel>=2?e.length:e.filter((function(e){return!e.isLocal})).length:0},t.prototype.getSuggestedActionsDistribution=function(e){var t=this;return e?e.reduce((function(e,n,i){return e+(0===i?"":";")+t.suggestedActionType(n)}),""):""},t.prototype.suggestedActionType=function(e){switch(e.activity.reasonType){case u.a.MyAnalytics:return"add_todo";case u.a.Task:return"view_task";case u.a.Comment:case u.a.Mention:return"reply";case u.a.Edit:case u.a.Trending:return"view_changes";case u.a.Meeting:return"join_meeting";default:return"open_in_browser"}},t.recommendedListId="recommended-mru",t.officeFeedListId="officefeed-mru",t}(s.a))},"ExL+":function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("bb6g"),r=n("hhzZ"),o=n("R7NL"),a=n("BaAg"),l=n("/I02"),s=n("idgT"),c=n("kpuN"),u=n("dQLD"),d=n("wwmn"),p=n("casz"),h=n("hoyd"),f=n("pOWU"),m=n("keVe"),b=n("TOqr"),v=function(e){function t(t,n,i,r,o,a,l,s,c,u){var d=e.call(this,t,n,i,"OfficeHome",r,o,a,l)||this;return d.odspConfigService=s,d.templatesConfigService=c,d.workloadsService=u,d.requestConfig={headers:new Map([["Accept","application/json"]])},d}return Object(i.__extends)(t,e),t.prototype.getOdspProvisioningStatus=function(e,t){var n=this;if(this.getOdspProvisioningStatusCache)return this.getOdspProvisioningStatusCache;var i=new Promise((function(i,r){n.get("ODSP_Provisioning_Status",n.contextService.sharedContext.officeHomeApiRoot+n.odspConfigService.config.odspProvisioningStatusApiPath,(function(e){e.then((function(e){e.data.SharepointUrl||e.data.OneDriveUrl||(n.getOdspProvisioningStatusCache=null),i(e.data)}))}),(function(e){n.getOdspProvisioningStatusCache=null,r(e)}),n.requestConfig,"network-only",void 0,void 0,t,void 0,void 0,e)}));return this.getOdspProvisioningStatusCache=i,i},t.prototype.getLicenseStatus=function(e,t,n,i){var r=this;if(this.getLicenseStatusCache)return this.getLicenseStatusCache;var o=new Promise((function(o,l){var s=r.templatesConfigService.resources(a.b.Visio);r.get("Visio_License_Status",r.contextService.sharedContext.officeHomeApiRoot+s.LicenseStatusApiPath+"?app="+e+"&scenarioId="+t,(function(e){e.then((function(e){e.data.App||e.data.IsLicensed||(r.getLicenseStatusCache=null),o(e.data)}))}),(function(e){r.getLicenseStatusCache=null,l(e)}),r.requestConfig,"network-only",void 0,void 0,i,void 0,void 0,n)}));return this.getLicenseStatusCache=o,o},t.prototype.checkInAppNavEnabled=function(e){var t=this;return new Promise((function(n){t.workloadsService.getWorkloads().then((function(t){if(e){var i=t.find((function(t){return t.FileType===e}));n(i&&i.InAppNav)}else{var r=t.find((function(e){return e.FileType===a.b.SharePoint})),o=t.find((function(e){return e.FileType===a.b.OneDrive}));n(r&&r.InAppNav||o&&o.InAppNav)}}))}))},t.prototype.initializeProvisioningStatus=function(){var e=this;this.checkInAppNavEnabled().then((function(t){t&&e.getOdspProvisioningStatus()}))},t.prototype.handleQueryParam=function(e,t){"mockshellservicemode"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)},t.ɵprov=m.cc({factory:function(){return new t(m.dc(c.b),m.dc(r.a),m.dc(o.a),m.dc(l.a),m.dc(d.a),m.dc(b.q),m.dc(p.a),m.dc(u.a),m.dc(s.a),m.dc(h.a))},token:t,providedIn:"root"}),t}(f.a)},FHrx:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.configParserService=e,this.config=this.configParserService.parse("serviceWorkerEncryptionConfig")||{cryptoKey:null,digestSaltBase64:null}}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},"Ft/N":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i="X-SW-OHP-FetchStrategy"},GPFm:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},GmnP:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("bb6g"),r=n("hhzZ"),o=n("Uqr9"),a=n("keVe"),l=function(){function e(e,t){this.instrumentationService=e,this.performanceService=t,this.performanceMarker=new Map}return e.prototype.ngOnDestroy=function(){this.fluidCorrelationId=void 0},e.prototype.setCorrelationId=function(e){this.fluidCorrelationId=e},e.prototype.instrumentStart=function(e){this.instrumentationService.logGenericEvent(e,this.getInstrumentationParams({State:"Start"}))},e.prototype.instrumentError=function(e,t){var n,i=((n={}).Error=t?JSON.stringify(t):"",n);this.instrumentationService.logErrorEvent(e,this.getInstrumentationParams(i))},e.prototype.instrumentBootError=function(e,t){this.instrumentFailure("DirectNav.Edit"===e||"DocumentClick"===e?"FluidContent_Open":"FluidContent_CreateNew",t)},e.prototype.instrumentSuccess=function(e,t,n,i){void 0===t&&(t=!1);var r={State:"Success"};r.VersionHistory=t.toString(),n&&(r.DebugInfo=n),i&&(r.Consumer=i),this.instrumentationService.logGenericEvent(e,this.getInstrumentationParams(r))},e.prototype.instrumentFailure=function(e,t,n,i){void 0===n&&(n=!1);var r={State:"Fail"};r.Error=t?JSON.stringify(t):"",r.VersionHistory=n?"true":"false",i&&(r.Consumer=i),this.instrumentationService.logGenericEvent(e,this.getInstrumentationParams(r))},e.prototype.logPerformanceEventFromClick=function(e,t){var n,i,r=null!==(i=this.performanceMarker.get(e))&&void 0!==i?i:{clickTimeMarker:1,instrumentationParams:(n={},n.ResourceId=this.fluidCorrelationId,n)};this.performanceService.mark(t+"."+e,r.clickTimeMarker,void 0,r.instrumentationParams)},e.prototype.logPerformanceBootStart=function(e){var t,n=((t={}).ResourceId=this.fluidCorrelationId,t),i=this.performanceService.mark("FluidContentPerformanceMarker.DocumentLoadStart."+e,0,void 0,n);this.performanceMarker.set(e,{clickTimeMarker:i,instrumentationParams:n})},e.prototype.instrumentClickEvent=function(e,t,n){this.instrumentationService.logClickEvent(e,t,n)},e.prototype.instrumentImpressionEvent=function(e,t){this.instrumentationService.logImpressionEvent(e,this.getInstrumentationParams(t))},e.prototype.getInstrumentationParams=function(e){var t;return void 0===e&&(e={}),Object(i.__assign)(((t={}).ResourceId=this.fluidCorrelationId,t),e)},e.ɵprov=a.cc({factory:function(){return new e(a.dc(r.a),a.dc(o.b))},token:e,providedIn:"root"}),e}()},H90i:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return r}));var i,r,o="OfficeDotCom",a="OfficeDotComPrv";!function(e){e.Home="MAIN",e.Start="START",e.Content="CONTENT",e.Templates="TEMPLATES",e.Search="SEARCH"}(i||(i={})),function(e){e.Web="WEB",e.HWA="HWA",e.PWA="PWA",e.NTP="NTP",e.Embed="EMBED"}(r||(r={}))},HCeo:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("cenr");function r(e,t){var n,r=((n={}).Error=e,n.DebugInfo=t,n);Object(i.a)("Performance_Mark_Failure",r)}},IA5y:function(e,t,n){"use strict";n.d(t,"h",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return l})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return f}));var i=n("BaAg"),r=n("ksTh");function o(e){return e&&"EmailAttachment"===e.source}function a(e){switch(e){case i.b.Word:return"ms-word:ofe|u|";case i.b.Excel:return"ms-excel:ofv|ofc|u|";case i.b.Visio:return"ms-visio:ofe|u|";case i.b.PowerPoint:return"ms-powerpoint:ofe|u|";case i.b.OneNote:return"onenote:"}return null}function l(e){var t=i.b.None;return(t="Custom"===e.type?i.b.ThirdParty:"fluid"===e.extension&&e.url.includes("Office%20Spaces")?i.b.Spaces:"Lists"===e.type?i.b.List:"Project"===e.type&&"ProjectOperations"===e.sub_type?i.b.ProjectOperations:e.extension?i.a.fileTypeFromExtension(e.extension):i.b[e.type]||i.b.None)&&t!==i.b.None||(t=i.a.fileTypeNameToFileType(e.type)),t}function s(e){var t;return null===(t=e.user_relationship)||void 0===t?void 0:t.last_action_datetime}function c(e){var t;return null===(t=e.user_relationship)||void 0===t?void 0:t.last_access_datetime}function u(e){try{return e?new Date(e):null}catch(e){return null}}function d(e){if(e)return{last_access_datetime:u(e.last_access_datetime),last_modified_datetime:u(e.last_modified_datetime),last_shared_by_id:e.last_shared_by_id,last_shared_datetime:u(e.last_shared_datetime),save_for_later_datetime:u(e.save_for_later_datetime),last_shared_by_history:e.last_shared_by_history,last_shared_display_name:e.last_shared_display_name,last_action_datetime:u(e.last_action_datetime)}}function p(e){var t,n;if(!e||!e.headers)return"";var i=e.headers,o=i.get("X-CalculatedBETarget")||"",a=i.get("X-FEServer")||"",l=i.get(r.b),s="",c=null===(n=null===(t=e.data)||void 0===t?void 0:t.diagnostics_data)||void 0===n?void 0:n.extended_info;return c&&(s="WorkingSetFilesPlugin:"+c.WorkingSetFilesPlugin+", MruFilesPlugin:"+c.MruFilesPlugin+", Version:"+c.Version),"BE:"+o+", FE:"+a+"|"+s+", CID:"+l}function h(e,t,n,i,o,a){return{headers:new Map([["X-AnchorMailbox",e],["X-Office-Application",t],["X-Office-Scenario",a],["X-RoutingParameter-SessionKey",n],["X-Ms-ClientAppId",i],[r.a,o]])}}function f(e){return{headers:new Map([[r.a,e]])}}},IAGz:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){this.reset()}return e.prototype.cancel=function(){this.cancelPromise()},e.prototype.onCancel=function(e){return this.promise.then(e)},e.prototype.reset=function(){var e=this;this.promise=new Promise((function(t){e.cancelPromise=t}))},e}()},IBRu:function(e,t,n){"use strict";function i(){var e,t;return[new Promise((function(n,i){e=n,t=i})),e,t]}n.d(t,"a",(function(){return i}))},Ihso:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a}));var i=!1;function r(e){e&&cancelAnimationFrame(e)}function o(e){return i?void e():requestAnimationFrame((function(){i=!0,e(),Promise.resolve().then((function(){i=!1}))}))}function a(e){return o((function(){return setTimeout(e,0)}))}},JH4S:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.user=e.parse("userContext")||{companyDisplayName:null,displayName:null,hasNoLicense:!1,hasTrialSubscription:!1,isAdmin:!1,isEdu:!1,isEduFaculty:!1,isEduStudent:!1,isSmb:!1,isIw:!1,isDynamics:!1,isGcc:!1,isValid:!1,mruAvailable:!1,themed:!1,themeId:"Unknown",isFirstRelease:!1},this.user.mruAvailable=this.user.isValid&&!this.user.hasNoLicense}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},JScD:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("BaAg"),r=n("dFxn"),o=n("keVe"),a=function(){function e(e){this.config=e.parse("uploadConfig"),this.config&&(this.config.uploadFileTypes=new Set([i.b.Excel,i.b.Word,i.b.PowerPoint,i.b.Visio,i.b.Stream]),this.config.editableFileTypes=new Set([i.b.Excel,i.b.Word,i.b.PowerPoint]))}return e.ɵprov=o.cc({factory:function(){return new e(o.dc(r.a))},token:e,providedIn:"root"}),e}()},JT1q:function(e,t,n){"use strict";n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return f})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return v}));var i=n("BaAg"),r=n("lwM0"),o=n("4ach"),a=n("7Rc8"),l=n("fKR7");function s(e){if(e){var t=r.a.decodeUrl(e);if(t){var n=t.split("://");if(n.length>1){var i=n[1].split("/");return i.pop(),i}}}return[]}function c(e,t,n,r,a,s,c){var u,d,p,h,f,m=e.MetaData,b=i.a.fileTypeNameToFileType(e.FileType);if(m){m.SPListId&&m.SPListItemUniqueId&&m.SPSiteId&&m.SPSiteUrl&&m.SPWebId&&(u={listId:m.SPListId,listItemId:null,listItemUniqueId:m.SPListItemUniqueId,siteId:m.SPSiteId,siteUrl:m.SPSiteUrl,webId:m.SPWebId}),m.CreatedDate&&(d=new Date(m.CreatedDate)),m.DriveId&&(p=m.DriveId);var v=m.SwayMetaData;v&&(h=v.ThumbnailId,f=v.IsTransformedFromWord?r.SwayTransformedFromWord:null)}var g=e&&e.MetaData&&b===i.b.Forms?e.MetaData.FormsMetaData:null,y=new l.b(l.a.Recent,t,n,e.DocId||e.ServerDocId,p||e.DriveId,e.FileName,e.Title,e.Url,e.WebUrl,null,null,e.LastAccessedTime,null,b,0,i.a.NameToProvenance[e.Provenance],e.PathArray,a,s,c,e.Application,e.ResourceId,e.StorageHost,e.UrlAlreadyEncoded,e.IsPinned,null,b===i.b.PowerBI?e.MetaData.PowerBIMetaData.breadcrumb_url:null,e.Category,e.MruV2Type,e.MruId,e.Activity,!1,e.IsLocal,d,u,void 0!==e.Sharing?{shared:!!e.Sharing}:void 0,e.LifecycleInfo,null,null,null,null,{thumbnailId:h},f,null,!1,e.ServiceId,null,null,e.FeedbackId,e.ServerDocId,g?g.owner_name:e&&e.MetaData?e.MetaData.CreatedByUserName:null,null,e.Extension?o.b.getExtensionToFormType(e.Extension):g&&g.owner_type?o.b.getOwnerPrincipalTypeToFormType(g.owner_type):null,g?g.owner_id:null,g?g.owner_tenant_id:null,null,null,null,null,null,null,null,null,null,null,null,null,null,g?g.form_type:null,g?g.category:null);return y.metaData=g,y.extension=e.Extension,y}function u(e,t,n,r,o,a){var c,u=e.SharepointInfo;u&&u.list_id&&u.list_item_unique_id&&u.site_id&&u.site_url&&u.web_id&&(c={listId:u.list_id,listItemId:null,listItemUniqueId:u.list_item_unique_id,siteId:u.site_id,siteUrl:u.site_url,webId:u.web_id});var d=new l.b(l.a.Recommended,t,n,e.DocId,e.DriveId,e.FileName,e.Title,e.Url,e.WebUrl,null,e.LastAccessedTime,e.LastAccessedTime,null,i.a.fileTypeNameToFileType(e.FileType),0,i.a.NameToProvenance[e.Provenance],e.IsEmailAttachment?[]:s(e.Url),r,o,a,e.Application,e.ResourceId,e.StorageHost,e.UrlAlreadyEncoded,e.IsPinned,null,null,e.Category,null,null,e.Activity,e.IsEmailAttachment,e.IsLocal,null,c,null,!1,e.EmailReference,null,null,null,null,null,e.SPOId,e.IsCollab,null,e.NavigationId,null,null,e.ServerDocId,null,e.TeamsDeepLink);return d.iconUrl=e.IconUrl,d.extension=e.Extension,d}function d(e,t,n,r,o,a,c){var u;void 0===c&&(c=!1);var d,p=e.SharepointInfo;p&&(u={listId:p.list_id,listItemId:null,listItemUniqueId:p.list_item_unique_id,siteId:p.site_id,siteUrl:p.site_url,webId:p.web_id}),e.ThumbnailUrl&&(d={small:e.ThumbnailUrl,medium:e.ThumbnailUrl,large:e.ThumbnailUrl,recommendedThumbnail:e.ThumbnailUrl});var h=new l.b(c?l.a.Trending:function(e){var t=l.a.OfficeFeedDocument;switch(e.toLocaleLowerCase()){case"upcomingmeeting":t=l.a.UpcomingMeeting;break;case"newsarticle":t=l.a.News;break;case"streamsvideo":t=l.a.StreamsVideo;break;case"myanalyticsinsight":t=l.a.MyAnalytics}return t}(e.Category),t,n,e.DocId,e.DriveId,e.FileName,e.Title,e.Url,e.WebUrl,null,e.LastAccessedTime,e.LastAccessedTime,null,i.a.fileTypeNameToFileType(e.FileType),0,i.a.NameToProvenance[e.Provenance],e.PathArray||(e.IsEmailAttachment?[]:s(e.Url)),r,o,a,e.Application,e.ResourceId,e.StorageHost,e.UrlAlreadyEncoded,e.IsPinned,null,null,e.Category,null,null,e.Activity,e.IsEmailAttachment,!1,null,u,null,!1,e.EmailReference,null,null,null,null,null,e.SPOId,e.IsCollab,null,e.NavigationId,d,e.FeedbackId,e.ServerDocId,null,e.TeamsDeepLink,null,null,null,!1,!1,null,null,null,null,null,null,[],null,null,null,e.MediaDuration);return"upcomingmeeting"===e.Category.toLowerCase()?(h.startTime=e.MeetingStart,h.endTime=e.MeetingEnd,h.location=e.Location,h.attendees=e.Attendees,h.joinUrl=e.JoinUrl,h.organizer=e.Organizer,h.joinMeetingText=e.JoinMeetingText):"myanalyticsinsight"===e.Category.toLocaleLowerCase()&&(h.taskInsight=e.TaskInsight,h.potentialAction=e.PotentialAction,h.insightName=e.InsightName,h.insightDescription=e.InsightDescription,h.insightDescriptionPrefix=e.InsightDescriptionPrefix,h.activityUser=e.Actor,h.url=e.Url),h.iconUrl=e.IconUrl,h.extension=e.Extension,h}function p(e,t,n,r,o,a){return new l.b(l.a.NoteBook,t,n,e.id,null,e.displayName,e.displayName,e.links.oneNoteWebUrl.href,null,null,new Date(e.lastModifiedDateTime),null,null,i.b.OneNote,null,i.a.NameToProvenance[e.displayName],s(e.links.oneNoteWebUrl.href),r,o,a,i.a.fileTypeNameFromType(i.b.OneNote),null,null,!0,!1,{fullName:e.displayName,email:null},null,null,null,null,null,!1,!1,new Date(e.createdDateTime))}function h(e,t,n,r,o,a,s,c){return new l.b(s||l.a.Form,t,n,e.id,null,e.title,e.title,e.url,null,null,new Date(e.modifiedDate),null,new Date(e.dateTimeShared),i.b.Forms,0,null,null,r,o,a,i.b[i.b.Forms],null,null,!0,!1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,{thumbnailId:e.otherInfo&&e.otherInfo.Theme&&e.otherInfo.Theme.Name?e.otherInfo.Theme.Name:null,thumbnailUrl:e.background?e.background.resourceUrl:null,thumbnailFillColor:e.otherInfo?e.otherInfo.SecondaryCustomizedThemeColor:null},null,null,null,null,null,null,null,e.id,e.ownerDisplayName,null,c||e.ownerPrincipalType,e.ownerId,e.ownerTenantId,!!e.softDeleted,!1,null,null,null,null,null,null,null,null,null,null,null,e.type,e.category)}function f(e,t,n,r,o,a){return new l.b(l.a.ClassNoteBook,t,n,e.id,null,e.name,e.name,e.links.oneNoteWebUrl.href,null,null,new Date(e.lastModifiedTime),null,null,i.b.OneNote,null,i.a.NameToProvenance[e.name],s(e.links.oneNoteWebUrl.href),r,o,a,i.a.fileTypeNameFromType(i.b.OneNote),null,null,!0,!1,{fullName:e.lastModifiedBy,email:null},null,null,null,null,null,!1,!1,new Date(e.createdTime))}function m(e,t,n,r,o,a){var c,u=e.SharepointIds;u&&u.ListId&&u.ListItemUniqueId&&u.SiteId&&u.SiteUrl&&u.WebId&&(c={listId:u.ListId,listItemId:null,listItemUniqueId:u.ListItemUniqueId,siteId:u.SiteId,siteUrl:u.SiteUrl,webId:u.WebId});var d=new Date(e.SharedDate),p=e.EmailReference&&1===e.EmailReference.AttachmentType;return new l.b(l.a.Shared,t,n,e.ItemId,e.DriveId,e.FileName,i.a.fileNameWithoutExtension(e.FileName),e.DocumentUrl,e.WebUrl,null,new Date(e.LastModifiedDate),null,d,i.a.fileTypeNameToFileType(e.Application),e.SharingType,i.a.NameToProvenance[e.FileName],p?[]:s(e.DocumentUrl),r,o,a,e.Application,e.ResourceId,e.StorageHost,!0,!1,null,null,null,null,null,null,!!e.EmailReference,!1,new Date(e.CreatedDate),c,null,void 0,e.EmailReference,e.SharedByUserName,e.SharedByUserEmail,null,null,null,null,null,null,null,null,null,e.ItemId,e.CreatedByUserName,null,e.OwnerType,e.OwnerId)}function b(e,t,n,r,o,c){var u=null,d=null;if(e&&e.ResourceReference&&e.ResourceReference.Id){var p=e.ResourceReference.Id.split("/");4===p.length&&(u=p[1],d=p[3])}var h=e.ResourceVisualization.LastModifiedBy?{fullName:e.ResourceVisualization.LastModifiedBy.Name,email:e.ResourceVisualization.LastModifiedBy.Address}:null,f=new Date(e.ResourceVisualization.LastModifiedDateTime),m=e.ResourceVisualization.ContainerWebUrl,b=e.ResourceVisualization.Title;return new l.b(l.a.Trending,t,n,d,u,b,b,e.ResourceReference.WebUrl,null,null,f,null,null,i.a.fileTypeNameToFileType(e.ResourceVisualization.Type),0,i.c.Substrate,s(m+"/"+b),r,o,c,e.ResourceVisualization.Type,e.Id,a.b.SharePointOnline,!0,!1,h,m)}function v(e){return{DocId:e.docId,Extension:e.extension,FileName:e.fileName,Title:e.title,Url:e.documentUrl,WebUrl:e.webUrl,LastAccessedTime:e.lastViewedTime,FileType:e.fileTypeName,Provenance:e.provenanceName,PathArray:e.pathArray,IsPinned:e.isPinned,Application:e.application,ResourceId:e.resourceId,StorageHost:e.storageHost,Category:e.mruV2Category,MruV2Type:e.mruV2Type,MruId:e.mruV2Id,Activity:e.activity,DriveId:e.driveId,EmailReference:e.emailReference,IsEmailAttachment:e.isEmailAttachment,IsLocal:e.isLocal}}},JWB6:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("AlWG"),r=n("lrJm"),o=n("BMb5"),a=n("6cfW"),l=n("keVe"),s=n("511z"),c=function(){function e(e,t,n){var i=this;if(this.hasServiceWorkerApi=e,this.windowService=t,this.globalErrorHandler=n,e){var r=t.nativeWindow.navigator.serviceWorker;r.controller?this.updateCurrentState("Controlled"):(this.updateCurrentState("SupportedNotControlled"),r.ready.then((function(){r.controller&&i.updateCurrentState("Controlled")})).catch((function(e){i.updateCurrentState("Unsupported"),Object(a.a)(e)||n.handleError(e,"E5E2n")})))}else this.updateCurrentState("Unsupported")}return Object.defineProperty(e.prototype,"stateObservable",{get:function(){return this.stateSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentState",{get:function(){return this.currentServiceWorkerState},enumerable:!0,configurable:!0}),e.prototype.updateCurrentState=function(e){this.currentServiceWorkerState=e,this.stateSubject?this.stateSubject.next(e):this.stateSubject=new i.a(e),"Controlled"!==e&&"Unsupported"!==e||this.stateSubject.complete()},e.ɵprov=l.cc({factory:function(){return new e(l.dc(s.a),l.dc(o.b),l.dc(r.b))},token:e,providedIn:"root"}),e}()},Jn4Q:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("bb6g"),r=n("zvoD"),o=n("kaEK"),a=n("Eup2"),l=(n("kfAr"),n("1Bt+"),n("A/um")),s=n("hhzZ"),c=n("BaAg"),u=n("jCfB"),d=n("fKR7"),p=(n("hZW2"),n("7Gwk"),n("AY/E"),n("TIi1"),n("EUVs"),n("BMb5"),n("4/We"),n("PBJH"),n("CVeG")),h=(n("dx17"),function(){function e(e,t,n,i,r,o,a,l,c,u,d,p,h,f){this.activityDescriptionService=e,this.capabilitiesService=t,this.changeDetectorRef=n,this.documentService=i,this.domSanitizer=r,this.eventService=o,this.instrumentationService=a,this.locService=l,this.mruItemInflationService=c,this.peopleCardService=u,this.responsiveRelativeDatePipe=d,this.urlLauncherService=p,this.wacContentService=h,this.windowService=f,this.showIcon=!0,this.mobileListItem=!1,this.area=s.b.Recommended,this.useSolidIcon=!1,this.timestampAndTitleInSameLine=!1,this.activityDeepLinkHovered=!1}return e.prototype.ngOnInit=function(){var e=this;this.person=this.person,this.activityState=this.activities?"active":"inactive",this.iconSize=this.iconSize||16,this.shortDate=this.windowService.innerWidth<640,this.inTeams=this.locService.TimeSentInTeams,this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh,this.locService.supportsLocaleSpecifiers&&(this.eventsSubscription=this.eventService.events.withScope(1).pipe(Object(r.a)((function(e){return"contentWidthChanged"===e.name}))).subscribe((function(t){var n;n=Object(i.__read)(t.args,1),e.shortDate=n[0]<640,e.updateDescription()}))),this.updateDescription()},e.prototype.ngOnChanges=function(){this.updateDescription()},e.prototype.ngAfterViewInit=function(){this.softUpdatePeopleCards()},e.prototype.ngDoCheck=function(){this.softUpdatePeopleCards()},e.prototype.ngOnDestroy=function(){this.eventsSubscription&&this.eventsSubscription.unsubscribe(),this.removePeopleCards()},e.prototype.onHover=function(){this.updatePeopleCards()},e.prototype.activityHovered=function(){this.activityDeepLinkHovered=!0},e.prototype.activityUnhovered=function(){this.activityDeepLinkHovered=!1},e.prototype.clicked=function(e){var t,n;if(this.activityDeepLink||this.teamsDeepLink){e&&e.preventDefault();var i=this.activityDeepLink||this.teamsDeepLink;!this.teamsDeepLink&&this.capabilitiesService.capabilities.wacHostEnabled&&this.capabilitiesService.capabilities.wacHostApps.has(this.fileType)?(this.logClick(),this.wacContentService.bootstrapAndRoute({docUrl:i,fileType:this.fileType,wdOrigin:"",applicationUrlParams:(t={},t.actnavid=this.navId,t)},((n={})[u.a.Nav]=this.navId,n))):(this.urlLauncherService.openUrl(i,"RecommendedDeepLink"),this.logClick())}},e.prototype.getActivityElementId=function(){return e.activitySectionId+"-"+this.docId},e.prototype.logClick=function(t){void 0===t&&(t=!1);var n={};n.ItemId=this.activityDeepLink?"activity-description":"teams-deep-link",n.Index=this.index.toString(),n.ItemCategory=a.a.recommendedListId,n.State=this.area===s.b.SuggestedActions?"SuggestedAction":"Card",n.ResourceId=this.docId,n.Area=this.area,n.DocumentType=c.b[this.fileType],n.ActivityDisplayed=this.activityReason?o.a[this.activityReason]:"",n.ClickDestination=t?"ContentPage":"ExternalPage";var i=d.b.referralFromFileType(this.fileType);this.instrumentationService.logClickEvent(this.area===s.b.SuggestedActions?"Suggested_Action_Click":"Recommended_Click",e.activitySectionId,this.area,i,"Web",n)},e.prototype.updateDescription=function(){var e=this,t=this.activityDescriptionInput||this.activityDescriptionService.activityDescription(this.activities,this.lastViewedTime,this.shortDate,2===this.numLines),n=null;if(t&&(n=this.createDescription(t)),!n||this.htmlDescription&&n.html.toString()===this.htmlDescription.html.toString()?!n&&this.htmlDescription&&(this.removePeopleCards(),this.htmlDescription=null,this.dateString=null,this.activityState="inactive"):(this.removePeopleCards(),this.htmlDescription=n,this.dateString=this.getDateString(this.htmlDescription.activityDescription.timestamp),this.activityState="active",this.needPeopleCardUpdate=!0),this.secondLine=this.timestampAndTitleInSameLine?this.dateString+" · "+this.title:this.title||this.dateString,this.capabilitiesService.capabilities.recommendedDeepLinkEnabled||this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled){this.changeDetectorRef.detectChanges();var i=this.documentService.nativeDocument.getElementById(this.getActivityElementId());i&&(this.clickHandler&&i.removeEventListener("click",this.clickHandler),this.clickHandler=function(t){return e.clicked(t)},i.addEventListener("click",this.clickHandler))}},e.prototype.createDescription=function(e){return this.activityReason=e?e.reasonType:void 0,e&&e.formatString?{activityDescription:e,html:this.generateHtml(e),icon:this.reasonTypeToIcon(e.reasonType,this.useSolidIcon)}:null},e.prototype.generateHtml=function(e){if(!e.people||!e.people.length)return e.formatString;var t=p.a.escapeHtml(e.formatString);if(this.activityDeepLink){for(var n=t.split(/(&lt;c[0-9]+&gt;.*?&lt;\/c[0-9]+&gt;)/),i=0;i<n.length;i++)i%2==0&&(n[i]=" <span class='activity-deep-link__underlined'>"+n[i].trim()+"</span> ");t=n.join("").trim()}for(i=0;i<e.people.length;i++){var r=e.people[i];r.tag&&(t=(t=t.replace(new RegExp("&lt;"+r.tag.trim()+"&gt;","g"),r.upn?'<span class="activity-user-name ms-fcl-nd ms-fcl-nd-h'+(this.fluentRefresh?" activity-user-name--fluent":"")+'" title="'+p.a.escapeHtml(r.name)+'" data-email="'+p.a.escapeHtml(r.upn)+'">':"<span>")).replace(new RegExp("&lt;/"+r.tag.trim()+"&gt;","g"),"</span>"))}return this.domSanitizer.bypassSecurityTrustHtml(t)},e.prototype.reasonTypeToIcon=function(e,t){switch(e){case o.a.Edit:return t?l.a.PencilSolid:l.a.Pencil;case o.a.Comment:return t?l.a.Chat:l.a.Comment;case o.a.Mention:return l.a.At;case o.a.Open:return l.a.FolderOpen;case o.a.Share:return l.a.People2;case o.a.Attachment:return l.a.Attach;case o.a.SnoozeExpiry:return l.a.Calendar;case o.a.Trending:return l.a.Trending;case o.a.News:return l.a.News;case o.a.Meeting:return l.a.Calendar;case o.a.Video:return l.a.Video;case o.a.Task:return l.a.Task;case o.a.Default:default:return l.a.Compass}},e.prototype.getDateString=function(e){var t=this.locService.localizedDateString(e);return this.responsiveRelativeDatePipe.transform(e,this.shortDate,t,!1)},e.prototype.softUpdatePeopleCards=function(){var e=this;if(this.capabilitiesService.capabilities.peopleCardsEnabled){if(this.peopleCardService.population()>0)return void this.updatePeopleCards();if(this.queuedPeopleCardUpdate||!this.needPeopleCardUpdate)return;this.queuedPeopleCardUpdate=this.mruItemInflationService.waitOnInflations().then((function(){e.updatePeopleCards(),e.queuedPeopleCardUpdate=null}))}},e.prototype.updatePeopleCards=function(){if(this.capabilitiesService.capabilities.peopleCardsEnabled&&this.needPeopleCardUpdate&&this.htmlDescription&&this.htmlDescription.activityDescription&&this.htmlDescription.activityDescription.people){if(this.descriptionElement&&this.descriptionElement.nativeElement){this.changeDetectorRef.detectChanges();for(var e=this.descriptionElement.nativeElement.querySelectorAll(".activity-user-name"),t=0;t<e.length;t++){var n=e[t].getAttribute("data-email");this.peopleCardService.addPersonaCard(e[t],n)}this.needPeopleCardUpdate=!1}}else this.needPeopleCardUpdate=!1},e.prototype.removePeopleCards=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!(this.capabilitiesService.capabilities.peopleCardsEnabled&&this.htmlDescription&&this.htmlDescription.activityDescription&&this.htmlDescription.activityDescription.people&&this.descriptionElement&&this.descriptionElement.nativeElement))return[2];e=this.descriptionElement.nativeElement.querySelectorAll(".activity-user-name"),t=0,i.label=1;case 1:if(!(t<e.length))return[3,6];n=e[t].getAttribute("data-email"),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this.peopleCardService.removePersonaCard(e[t],n)];case 3:case 4:return i.sent(),[3,5];case 5:return t++,[3,1];case 6:return[2]}}))}))},e.activitySectionId="activity-description-div",e}())},KoFE:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("keVe"),r=(n("6Po3"),n("9c4X"),function(){function e(e,t,n){this.resizeObserverService=e,this.elementRef=t,this.browserPaintService=n,this.resize=new i.n}return e.prototype.ngOnInit=function(){var e=this;this.resizeObserver=this.resizeObserverService.createAndObserve((function(t){return e.onResize(t[0])}),this.elementRef.nativeElement)},e.prototype.ngAfterViewInit=function(){var e=this;this.browserPaintService.runAfterPaint((function(){e.resize.emit(e.elementRef.nativeElement.getBoundingClientRect())}))},e.prototype.ngOnDestroy=function(){this.resizeObserver.disconnect()},e.prototype.onResize=function(e){e&&this.resize.emit(e.contentRect)},e}())},"L/Tc":function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.Edit=2]="Edit",e[e.Comment=3]="Comment",e[e.Mention=4]="Mention"}(i||(i={}))},"L9A/":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},LQqy:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("zvoD"),r=n("3Vsh"),o=n("lrJm"),a=n("hhzZ"),l=n("dFxn"),s=n("6nG3"),c=n("7Gwk"),u=n("uWZl"),d=n("4/We"),p=n("cgnd"),h=n("keVe"),f=function(){function e(e,t,n,o,a,l,c){var u=this;this.consumerLicenseService=e,this.capabilitiesService=t,this.configParserService=n,this.eventService=o,this.globalErrorHandler=a,this.instrumentationService=l,this.startupConfigService=c,this.eventService.events.withScope(1).pipe(Object(i.a)((function(e){return"convertedToPaid"===e.name})),Object(r.a)(1)).toPromise().then((function(){u.refreshedConfig=u.configPromise.then((function(e){return e?{currentSkuInfo:{skuType:s.b.O365Personal,daysExpired:-365},expiredSkuInfo:e.expiredSkuInfo}:{currentSkuInfo:{skuType:s.b.NotDetected,daysExpired:-1},expiredSkuInfo:{skuType:s.b.NotDetected,daysExpired:-1}}}))}))}return e.prototype.getConfig=function(){var t=this;if(this.refreshedConfig)return this.refreshedConfig;if(!this.configPromise){if(this.startupConfigService.config.authType!==p.a.MSA)return Promise.resolve({currentSkuInfo:{skuType:s.b.NotDetected,daysExpired:-1},expiredSkuInfo:{skuType:s.b.NotDetected,daysExpired:-1}});if(this.capabilitiesService.capabilities.pwaEnabled)this.configPromise=this.getPwaConfig();else{var n=this.eventService.events.withScope(0).pipe(Object(i.a)((function(e){return"primaryTokensLoaded"===e.name})),Object(r.a)(1)).toPromise(),o=u.a.fullPageReady();this.configPromise=Promise.race([n,o]).then((function(){return t.configParserService.parse(e.consumerInstallConfigElementId)}))}}return this.configPromise},e.prototype.getCurrentSku=function(){var e=this;return new Promise((function(t){e.getConfig().then((function(e){return t(e&&e.currentSkuInfo?e.currentSkuInfo.skuType:s.b.NotDetected)})).catch((function(){return t(s.b.NotDetected)}))}))},e.prototype.getPwaConfig=function(){var e=this;return new Promise((function(t){try{var n=e.consumerLicenseService.getLicenses();n.results.subscribe((function(n){var i={State:"Succeeded"};i.DebugInfo="ProductIds: "+n.diagnosticInfo,i.SkuType=s.b[n.currentSkuInfo.skuType],i.ActiveDaysLeft=(-n.currentSkuInfo.daysExpired).toString(),i.ExpiredSkuType=s.b[n.expiredSkuInfo.skuType],i.DaysExpired=n.expiredSkuInfo.daysExpired.toString(),i.FromServiceWorkerCache=n.fromCache.toString(),e.instrumentationService.logGenericEvent("Bulk_License_Preview",i),t({currentSkuInfo:n.currentSkuInfo,expiredSkuInfo:n.expiredSkuInfo})})),n.initialCompletion.then((function(n){n&&(n.cacheError&&n.networkError?(e.logFailureEvent(),e.globalErrorHandler.handleError(n,"IMo7P"),t({currentSkuInfo:{skuType:s.b.NotDetected,daysExpired:-1},expiredSkuInfo:{skuType:s.b.NotDetected,daysExpired:-1}})):e.globalErrorHandler.handleCacheObservableError(n,"xJ743","QhHdV"))}))}catch(n){e.logFailureEvent(),t({currentSkuInfo:{skuType:s.b.NotDetected,daysExpired:-1},expiredSkuInfo:{skuType:s.b.NotDetected,daysExpired:-1}})}}))},e.prototype.logFailureEvent=function(){var e={State:"Failed"};e.SkuType=s.b[s.b.NotDetected],e.ActiveDaysLeft="-1",e.ExpiredSkuType=s.b[s.b.NotDetected],e.DaysExpired="-1",this.instrumentationService.logGenericEvent("Bulk_License_Preview",e)},e.consumerInstallConfigElementId="consumerInstallInfo",e.ɵprov=h.cc({factory:function(){return new e(h.dc(s.a),h.dc(d.a),h.dc(l.a),h.dc(c.a),h.dc(o.b),h.dc(a.a),h.dc(p.b))},token:e,providedIn:"root"}),e}()},M3TP:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},M56G:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("keVe"),r=(n("hhzZ"),n("jrGV"),n("W3Zz"),n("4/We"),n("PBJH"),n("s+Eq"),function(){function e(e,t,n,r,o){this.actionContextMenuService=e,this.capabilitiesService=t,this.deviceDetector=n,this.instrumentationService=r,this.locService=o,this.leftAlignedCard=!1,this.horizontalEllipsis=!1,this.actionContextMenuEnabled=!1,this.menuToggled=new i.n,this.menuFocused=new i.n,this.mobileMenusEnabled=this.capabilitiesService.capabilities.mobileContextMenusEnabled}return e.prototype.ngOnChanges=function(e){e.hasOwnProperty("menuModel")&&this.initializeDropdownMenuModel(this.menuModel)},e.prototype.ngOnInit=function(){this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh||this.horizontalEllipsis,this.initializeDropdownMenuModel(this.menuModel)},e.prototype.onFocusLink=function(e){this.menuFocused.emit(e)},e.prototype.onToggleMenu=function(e){if(this.actionContextMenuEnabled){var t=this.dropdownMenu.dropdownLink.nativeElement.getBoundingClientRect();return this.actionContextMenu.targetElement={current:{left:t.left,top:t.top+t.height}},void this.actionContextMenuService.openMenu(this.actionContextMenu)}e&&(this.menuModel.rightAligned=!0),this.isOpen=e,this.menuToggled.emit(e),this.instrumentToggle(e)},e.prototype.onSelectItem=function(e){e.item.executeAction(e.nativeDomEvent)},e.prototype.initializeDropdownMenuModel=function(e){if(this.dropdownMenuModel=e,!this.dropdownMenuModel)throw new Error("menuModel must be provided to actions-menu");this.dropdownMenuModel.linkAriaLabel=this.locService.format(this.locService.MruActionsMenuAriaLabel,this.documentName),this.dropdownMenuModel.linkTooltip=this.locService.MruActionsMenuToolTip,this.dropdownMenuModel.linkCssClass="actions-menu-link "+(this.fluentRefresh?"commanding-item--fluent ms-fcl-npa ms-fcl-tp-h ms-fcl-tda-a":"ms-fcl-nd ms-bgc-g40-f ms-bgc-g40-h ms-bgc-g40-a commanding-item ms-bgc-g40-h")+" "+(this.deviceDetector.isDesktopDevice()?" actions-menu-link--hidden":"")},e.prototype.instrumentToggle=function(e){var t=e?"Open":"Close",n={};n.RenderSize=this.menuModel.items.length.toString(),n.Index=this.listItemIndex.toString(),n.Action=t,this.instrumentationService.logClickEvent("Actions_Menu_Toggle","actions-menu-link",this.area,null,null,n,[],this.dataSecurity||0)},e}())},MFXD:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("2dXW"),r=n("ORIk"),o=function(){function e(){this.onlyFuture=new i.a,this.pastAndFuture=new r.a}return e.prototype.withScope=function(e){switch(e){case 1:return this.onlyFuture.asObservable();case 0:return this.pastAndFuture.asObservable();default:throw new Error("Unknown Observable Scope")}},e.prototype.next=function(e){this.onlyFuture.next(e),this.pastAndFuture.next(e)},e.prototype.asScopableObservable=function(){return this},e}()},MRNN:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("Z0U4"),n("4/We"),n("/I02"),n("PBJH"),n("8q3P");var i=function(){function e(e,t,n,i){this.capabilitiesService=e,this.contextService=t,this.locService=n,this.officeRouteService=i,this.responsive=!1,this.focusOnLoad=!1}return e.prototype.ngOnInit=function(){var e=this;this.defaultAriaLabel=this.locService.CloseAppGalleryAriaLabel,this.isRtl=this.contextService.isRtl,this.routeSubscription=this.officeRouteService.subscribeToRouteChangeEnd((function(t){return e.backRoute=t.backRoute})),this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh},e.prototype.ngOnDestroy=function(){this.routeSubscription&&this.routeSubscription.unsubscribe()},e.prototype.navigateBack=function(){this.backRoute&&this.backRoute.route?this.officeRouteService.back():this.defaultBackRoute&&this.officeRouteService.navigateTo(this.defaultBackRoute,!0)},e}()},MbTY:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("AlWG"),r=n("keVe"),o=function(){function e(){this._inputDialog=new i.a(null)}return e.prototype.showInputDialog=function(e){this._inputDialog.next(e)},Object.defineProperty(e.prototype,"inputDialog",{get:function(){return this._inputDialog.asObservable()},enumerable:!0,configurable:!0}),e.ɵprov=r.cc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},"NL/U":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("oKW8");function r(e){return(Object(i.a)().getTime()-e.getTime())/1e3}},NdOS:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},OOtI:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("bb6g"),r=n("keVe"),o=(n("mNaV"),n("dOgD"),n("RJiy"),n("+YV+"),n("BaAg")),a=(n("QOOv"),n("7Rc8"),n("7Gwk"),n("4/We"),n("cgnd")),l=(n("/I02"),n("PBJH"),n("JScD"),n("9MHL"),function(){function e(e,t,n,i,o,a,l,s,c,u,d,p,h,f){var m=this;this.capabilitiesService=e,this.eventService=t,this.mruConfigService=n,this.locService=i,this.mruDataService=o,this.officeFeedService=a,this.createMenuService=l,this.recommendedService=s,this.oneDriveUploadService=c,this.uploadConfigService=u,this.clientStartupConfigService=d,this.startupConfigService=p,this.edgeworthDataService=h,this.contextService=f,this.uploadEnabled=!1,this.numLoggableItems=0,this.mruOutputs={stateChanged:function(e){return m.onMruStateChange(e)}},this.mruStateChanged=new r.n}return e.prototype.ngOnInit=function(){this.capabilities=this.capabilitiesService.capabilities,this.isAntpExperience=this.capabilities.antpLoaded,this.mruConfig=this.mruConfigService.config,this.sectionLandmarkAriaLabel=this.isAntpExperience?this.locService.EdgeMruSectionTitleShort:this.locService.MruSectionTitleShort,this.title=this.capabilities.detailedConsumerHeadersEnabled?this.locService.MruHeaderConsumer:this.sectionLandmarkAriaLabel,this.isStartpage=!!this.fileType,this.appFilter=this.fileType?new Set([this.fileType]):null,this.fileType&&this.fileType===o.b.Stream&&this.appFilter.add(o.b.Video),this.edgeworthEnabled=this.capabilities.edgeworthEnabled&&this.fileType!==o.b.Forms&&this.fileType!==o.b.OneNote&&this.fileType!==o.b.Sway,this.edgeworthReactEnabled=this.capabilities.edgeworthReactEnabled,this.quickAccessEnabled=this.capabilities.quickAccessV1Enabled&&!this.isStartpage,this.recommendedReact=this.capabilities.recommendedReact,this.leftNavReact=this.capabilities.leftNavReact,this.isConsumer=this.startupConfigService.config.authType===a.a.MSA,this.noGutter=this.capabilities.fluentRefresh||this.quickAccessEnabled&&!this.isConsumer,this.spacesFolder=this.capabilities.spacesEnabled&&this.fileType===o.b.Spaces?this.locService.SpacesFolderName:"",this.initializeUpload(),this.initializeCreateButton(),this.initializeRecommended(),this.edgeworthEnabled?(this.contextService.isEdgeworth=!0,this.edgeworthReactEnabled||this.edgeworthDataService.init(this.appFilter)):this.initializeMru()},e.prototype.ngOnDestroy=function(){this.recommendedSubscription&&this.recommendedSubscription.unsubscribe(),this.mruSubscription&&this.mruSubscription.unsubscribe()},e.prototype.onMruStateChange=function(e){this.mruStateChanged.emit(e)},e.prototype.initializeUpload=function(){var e=this;this.capabilities.oneDriveUploadEnabled&&this.uploadConfigService.config&&this.fileType!==o.b.Sway&&this.fileType!==o.b.OneNote&&this.fileType!==o.b.Forms&&this.oneDriveUploadService.uploadEnabledPromise.then((function(t){return e.uploadEnabled=t}))},e.prototype.initializeCreateButton=function(){var e=this;this.createMenuService.createButtonEnabledPromise.then((function(t){return e.createButtonEnabled=t}))},e.prototype.initializeRecommended=function(){var e=this;if(this.mruConfig.recommendedEnabled&&this.fileType!==o.b.Sway&&this.fileType!==o.b.OneNote&&this.fileType!==o.b.Forms&&!this.isAntpExperience){var t=!this.mruConfig.officeFeedControlEnabled&&!this.mruConfig.officeFeedFlightEnabled||this.fileType?this.recommendedService.getRecommendedDocs(this.appFilter):this.officeFeedService.getOfficeFeed();this.recommendedSubscription=t.results.subscribe((function(t){e.eventService.broadcastEvent({name:"recommendedDataReady",args:[t.items.length]}),e.hasRecommendedDocs=t.items.length>0}))}},e.prototype.initializeMru=function(){var e=this;this.recentMruStream=this.mruDataService.getMruDocuments(this.appFilter),this.mruSubscription=this.recentMruStream.results.subscribe((function(t){t.items.length?(e.initialDocsAvailable=!0,e.numLoggableItems=t.items.length):Promise.all([e.createMenuService.createButtonEnabledPromise,e.oneDriveUploadService.uploadEnabledPromise]).then((function(t){var n=Object(i.__read)(t,2);return e.showZeroExperience=e.fileType===o.b.Forms||e.mruConfig.showZeroExperience&&(n[0]||n[1]||e.clientStartupConfigService.config.authType===a.a.OrgId)})),e.eventService.broadcastEvent({name:"mruDataReady",args:[t.items.length]})})),this.clientStartupConfigService.config.authType===a.a.MSA&&this.recentMruStream.initialCompletion.then((function(t){t&&t.cacheError&&t.networkError&&e.eventService.broadcastEvent({name:"mruFailed",args:[]})}))},e}())},OPPn:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},OPwp:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return f}));var i,r=n("2dXW"),o=n("zvoD"),a=n("f0qX"),l=n("BaAg"),s=n("p6Zr"),c=n("kpuN"),u=n("w1PR"),d=n("4/We"),p=n("pjz5"),h=n("keVe");!function(e){e[e.Share=1]="Share",e[e.CopyLink=2]="CopyLink",e[e.AtMention=3]="AtMention",e[e.LinkSettings=4]="LinkSettings",e[e.ManageAccess=5]="ManageAccess",e[e.Notify=6]="Notify",e[e.AddPeople=7]="AddPeople"}(i||(i={}));var f=function(){function e(e,t,n){var i=this;this.accessTokenService=e,this.capabilitiesService=t,this.themingService=n,this.shareControl=new r.a,this.capabilitiesService.capabilities.darkModeEnabled&&(this.themeShadesSubscription=this.themingService.darkModeSubscription.subscribe((function(e){i.isDarkMode=e})))}return e.getShareControlModeFromString=function(e){switch(e){case"copy":return i.CopyLink;case"atMention":return i.AtMention;case"linkSettings":return i.LinkSettings;case"manageAccess":return i.ManageAccess;case"notify":return i.Notify;case"addPeople":return i.AddPeople;default:return i.Share}},e.prototype.ngOnDestroy=function(){this.themeShadesSubscription&&this.themeShadesSubscription.unsubscribe()},e.prototype.getToken=function(e,t,n,i){void 0===i&&(i=null);var r=p.a.getLocation(e),o=r?r.protocol+"//"+r.hostname:"";return null===i&&(i=this.getTokenType(e)),this.accessTokenService.getAccessToken(i,!1,o,t,{category:"Share",fileType:n})},e.prototype.getTokenType=function(e){return l.a.referralFromFileLocation(e)===s.a.OneDrive?"OneDrive":"SharePoint"},e.prototype.showControl=function(e){this.updateNext(e,0)},e.prototype.hideControl=function(e){this.updateNext(e,1)},e.prototype.subscribeToOpenEvents=function(e){return this.shareControl.asObservable().pipe(Object(o.a)((function(e){return e&&0===e.type})),Object(a.a)((function(e){return e.shareControl}))).subscribe(e)},e.prototype.subscribeToCloseEvents=function(e){return this.shareControl.asObservable().pipe(Object(o.a)((function(e){return e&&1===e.type})),Object(a.a)((function(e){return e.shareControl}))).subscribe(e)},e.prototype.getDarkMode=function(){return this.isDarkMode},e.prototype.updateNext=function(e,t){e&&e.file&&null!=e.index&&this.shareControl.next({type:t,shareControl:e})},e.ɵprov=h.cc({factory:function(){return new e(h.dc(c.b),h.dc(d.a),h.dc(u.b))},token:e,providedIn:"root"}),e}()},OWzB:function(e,t,n){"use strict";n.d(t,"a",(function(){return B}));var i=n("bb6g"),r=n("3Vsh"),o=n("lrJm"),a=n("DQbD"),l=n("BaAg"),s=n("4ach"),c=n("7Rc8"),u=n("4/We"),d=n("cgnd"),p=n("/I02"),h=n("PBJH"),f=n("ZBli"),m=function(){function e(){}return e.hasNoInvalidCharacter=function(e,t){var n,r;try{for(var o=Object(i.__values)(t),a=o.next();!a.done;a=o.next())if(-1!==e.indexOf(a.value))return!1}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!0},e.hasNoDuplicates=function(t,n,i){return void 0===i&&(i=!1),i?e.hasNoDuplicatesCaseInsensitiveTrimmed(t,n):-1===n.indexOf(t)},e.isNotStartingWithSpace=function(e){return!e||e&&" "!==e[0]},e.isContainingLessThanLimitedCharacters=function(e,t){return e.length<=t},e.isNotEmptyString=function(e){return null!=e&&e.length>0},e.hasNoDuplicatesCaseInsensitiveTrimmed=function(e,t){var n,r;try{for(var o=Object(i.__values)(t),a=o.next();!a.done;a=o.next()){var l=a.value;if(e.trim().toLowerCase()===l.trim().toLowerCase())return!1}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!0},e}(),b=n("hhzZ"),v=function(){function e(){}return e.createOnenoteNotebookDialog=function(e,t,n,r,o){var a=[function(e){return m.isNotEmptyString(e)?null:{isValid:!1,message:""}},function(t){return m.hasNoInvalidCharacter(t,["?","*","\\","/",":","<",">","|","'"])?null:{isValid:!1,message:e.CreateNewNoteBookNameInvalidChars}},function(t){return m.isNotStartingWithSpace(t)?null:{isValid:!1,message:e.CreateNewNoteBookNameCannotStartWithSpace}},function(t){return m.isContainingLessThanLimitedCharacters(t,128)?null:{isValid:!1,message:e.CreateNewNoteBookNameExceeds128Chars}}],l=function(t){s.inputValidator=function(e){return c(e,Object(i.__spread)(a))},n.getNoteBooks(t).results.toPromise().then((function(t){if(t&&t.value&&t.value.length){var n=[].concat(a);n.push((function(n){return m.hasNoDuplicates(n,t.value.map((function(e){return e.displayName})),!0)?null:{isValid:!1,message:e.CreateNewNoteBookNameAlreadyExist}})),s.inputValidator=function(e){return c(e,n)}}}))},s={title:t.CreateNewBlankText,placeholder:t.CreateFileDialogOneNoteInputPlaceholder,dismissAction:o},c=function(e,t){var n,r;try{for(var o=Object(i.__values)(t),a=o.next();!a.done;a=o.next()){var l=(0,a.value)(e);if(l)return l}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return{isValid:!0,message:""}};return s.inputValidator=function(e){return c(e,Object(i.__spread)(a))},l("cache-first-network-onmiss"),s.inputButtonModel={executeAction:function(e){r(e),l("network-first")},text:e.CreateFileDialogButtonText},s.componentArea=b.b.Templates,s},e}(),g=n("idgT"),y=n("kpuN"),S=n("n826"),w=n("keVe"),C=function(){function e(e,t,n){this.globalErrorHandler=e,this.oneDriveGraphService=t,this.instrumentationService=n}return e.prototype.createStreamContent=function(e,t){e.capabilities.createStreamPlaylistEnabled?(this.performAction(t,l.b.PlayLists),this.instrumentationService.logClickEvent("New_Playlist_Button_Click","CreateNewPlaylist",b.b.Templates,l.b.PlayLists.toString())):e.capabilities.createStreamRecorderEnabled&&(this.performAction(t,l.b.Stream),this.instrumentationService.logClickEvent("New_Recorder_Button_Click","CreateNewRecorder",b.b.Templates,l.b.Stream.toString()))},e.prototype.performAction=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,s;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.oneDriveGraphService.getMyDriveRootUrl()];case 1:if(n=i.sent(),r=n&&n.userRoot){switch(-1===(o=r.lastIndexOf("/Documents"))&&(this.instrumentationService.logErrorEvent("OneDrive_User_RootUrl",this.createInstrumentationParams(e,t)),this.globalErrorHandler.handleError("userRootUrl not in expected format","sCtl9")),this.oneDriveUrl=r.substring(0,o),a="",t){case l.b.Stream:a=this.oneDriveUrl+"/_layouts/15/stream.aspx?action=create&enableFeatures=60543&cid="+e;break;default:a=this.oneDriveUrl+"/_layouts/15/lists.aspx?&openCreate=true&workload=Stream&cid="+e}window.open(a,"_blank")}return[3,3];case 2:return s=i.sent(),this.instrumentationService.logErrorEvent(t===l.b.PlayLists?"New_Playlist_Button_Click":"New_Recorder_Button_Click",this.createInstrumentationParams(e)),[2,this.globalErrorHandler.handleError(s,"sCtl9")];case 3:return[2]}}))}))},e.prototype.createInstrumentationParams=function(e,t){var n,i;return t?((n={}).ResourceId=e,n.DocumentType=l.b[t],n):((i={}).ResourceId=e,i)},e.ɵprov=w.cc({factory:function(){return new e(w.dc(o.b),w.dc(S.a),w.dc(b.a))},token:e,providedIn:"root"}),e}(),I=n("hZW2"),T=n("EYcb"),k=n("7Gwk"),A=n("TDzr"),P=n("MbTY"),E=n("Bc8L"),_=n("Z0U4"),O=n("Dpxn"),F=n("v3sZ"),D=n("p6gk"),M=n("ExL+"),R=n("m+UP"),x=n("TIi1"),L=n("Brer"),N=n("EUVs"),U=n("BMb5"),W=n("hoyd"),B=function(){function e(e,t,n,i,r,o,a,s,c,u,d,p,h,f,m,b,v,g,y,S,w,C,I,T,k,A,P,E,_){var O=this;this.accessTokenService=e,this.capabilitiesService=t,this.clientStartupConfigService=n,this.contextService=i,this.createStreamService=r,this.documentService=o,this.errorDialogService=a,this.eventService=s,this.fluidHostContext=c,this.formsService=u,this.globalErrorHandler=d,this.inputDialogService=p,this.instrumentationService=h,this.localAppLauncherService=f,this.locService=m,this.mruDataService=b,this.officeRouteService=v,this.oneDriveService=g,this.oneNoteGraphService=y,this.oneNoteConfigService=S,this.startupConfigService=w,this.shellService=C,this.swayService=I,this.templatesConfigService=T,this.urlLauncherService=k,this.vroomService=A,this.wacContentService=P,this.windowService=E,this.workloadsService=_;var F=this.capabilitiesService.capabilities;this.isPwa=F.pwaEnabled,this.fluidSupportEnabled=F.fluidSupportEnabled,this.wacHostApps=new Set(F.wacHostApps),F.visioWacHostCreateNewEnabled||this.wacHostApps.delete(l.b.Visio),this.numCreatesPending=0,this.wacHostCreateNewEnabled=F.wacHostCreateNewEnabled,this.createLcidEnabled=this.templatesConfigService.config.createLcidEnabled,this.createLinkCandidates=new Map;var D=F.createOneDriveDocApiEnabled;if(this.createLinkCandidates.set(l.b.Word,{title:m.CreateMenuLinkWordTitle,fileTypeName:m.CreateModalLinkWordTitle,appName:m.WordName,fileType:l.b.Word,newDocName:this.locService.NewWordDocumentFileName,fileExtension:"docx",workloadOnlineName:this.locService.WordName,spinnerColor:"#185ABD",canCreateBlankDocument:D,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!F.startPageApps.has(l.b.Word),createDocAspxEnabled:F.createDocAspxWordEnabled,docAspxId:1}),this.createLinkCandidates.set(l.b.Excel,{title:m.CreateMenuLinkExcelTitle,fileTypeName:m.CreateModalLinkExcelTitleAlt,appName:m.ExcelName,fileType:l.b.Excel,newDocName:this.locService.NewExcelWorkbookFileName,fileExtension:"xlsx",workloadOnlineName:this.locService.ExcelName,spinnerColor:"#107C41",canCreateBlankDocument:D,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!F.startPageApps.has(l.b.Excel),createDocAspxEnabled:F.createDocAspxExcelEnabled,docAspxId:2}),this.createLinkCandidates.set(l.b.PowerPoint,{title:m.CreateMenuLinkPowerPointTitle,fileTypeName:m.CreateModalLinkPowerPointTitle,appName:m.PowerPointName,fileType:l.b.PowerPoint,newDocName:this.locService.NewPowerPointPresentationFileName,fileExtension:"pptx",workloadOnlineName:this.locService.PowerPointName,spinnerColor:"#C43E1C",canCreateBlankDocument:D,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!F.startPageApps.has(l.b.PowerPoint),createDocAspxEnabled:F.createDocAspxPowerPointEnabled,docAspxId:3}),this.createLinkCandidates.set(l.b.Sway,{title:m.CreateMenuLinkSwayTitle,fileTypeName:m.CreateModalLinkSwayTitle,appName:m.SwayName,fileType:l.b.Sway,workloadOnlineName:this.locService.MicrosoftSwayName,spinnerColor:"#038387",canCreateBlankDocument:F.swayCreateNewEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!F.startPageApps.has(l.b.Sway),createDocAspxEnabled:!1}),F.fluidCreateNewEnabled&&this.createLinkCandidates.set(l.b.Fluid,{title:m.CreateMenuLinkFluidTitle,fileTypeName:m.CreateModalLinkFluidTitle,appName:m.FluidName,fileType:l.b.Fluid,canCreateBlankDocument:this.fluidSupportEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),F.fluidCreateAbpEnabled&&this.createLinkCandidates.set(l.b.FluidActivityBlueprint,{title:m.CreateMenuLinkFluidAbpTitle,fileTypeName:m.CreateModalLinkFluidAbpTitle,appName:m.FluidName,fileType:l.b.FluidActivityBlueprint,canCreateBlankDocument:this.fluidSupportEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),F.startPageApps.has(l.b.Forms)&&(this.createLinkCandidates.set(l.b.Forms,{appName:m.FormsName,title:m.CreateMenuLinkFormsTitle,fileTypeName:m.CreateModalLinkFormsFormTitle,workloadOnlineName:m.FormsName,fileType:l.b.Forms,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1,spinnerColor:"#038387"}),this.createLinkCandidates.set(l.b.FormsQuiz,{appName:m.FormsName,title:m.CreateMenuLinkFormsQuizTitle,fileTypeName:m.CreateModalLinkFormsQuizTitle,workloadOnlineName:m.FormsName,fileType:l.b.FormsQuiz,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1,spinnerColor:"#038387"})),F.startPageApps.has(l.b.OneNote)&&this.oneNoteConfigService.config.enableOneNoteApis&&this.createLinkCandidates.set(l.b.OneNote,{title:m.CreateMenuLinkOneNoteTitle,fileTypeName:m.CreateModalLinkOneNoteTitle,appName:m.OneNoteName,fileType:l.b.OneNote,workloadOnlineName:this.locService.OneNoteName,spinnerColor:"#7719AA",canCreateBlankDocument:D,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!1,createDocAspxEnabled:!1}),F.createOneNotePageEnabled&&this.createLinkCandidates.set(l.b.OneNotePage,{title:m.CreateMenuLinkOneNotePageTitle,fileTypeName:m.CreateModalLinkOneNotePageTitle,appName:m.OneNoteName,fileType:l.b.OneNotePage,workloadOnlineName:this.locService.OneNoteName,spinnerColor:"#7719AA",canCreateBlankDocument:D,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!1,createDocAspxEnabled:!1}),F.startPageApps.has(l.b.Visio)?this.createLinkCandidates.set(l.b.Visio,{title:m.CreateMenuLinkVisioTitle,fileTypeName:m.CreateModalLinkVisioTitle,appName:m.VisioName,fileType:l.b.Visio,newDocName:this.locService.NewVisioDrawingFileName,fileExtension:"vsdx",workloadOnlineName:this.locService.VisioName,spinnerColor:"#4C68B1",canCreateBlankDocument:D,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!1,createDocAspxEnabled:F.createDocAspxVisioEnabled,docAspxId:8}):F.createVisioEnabled&&this.createLinkCandidates.set(l.b.Visio,{title:m.CreateMenuLinkVisioTitle,fileTypeName:m.CreateModalLinkVisioTitle,appName:m.VisioName,fileType:l.b.Visio,newDocName:this.locService.NewVisioDrawingFileName,fileExtension:"vsdx",workloadOnlineName:this.locService.VisioName,spinnerColor:"#4C68B1",canCreateBlankDocument:D&&F.createDocAspxVisioEnabled,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!0,createDocAspxEnabled:F.createDocAspxVisioEnabled,docAspxId:8}),F.createDocumentSupported&&(F.createDocAspxWordEnabled||F.createDocAspxExcelEnabled||F.createDocAspxPowerPointEnabled)&&this.accessTokenService.getAccessToken("OneDrive"),this.workloadsPromiseHasVisio=this.workloadsService.getWorkloads().then((function(e){return!!e.find((function(e){return e.FileType===l.b.Visio}))})),this.appManifests=new Map([]),F.listsCreateEnabled&&this.appManifests.set("list",{name:"Lists",creationFileType:l.b[l.b.List],fileTypeNameLocalized:m.CreateFileTypeNameListsList,id:"ListsAppId",staticTabs:[{entityId:"1",name:"List",contentUrl:"openCreate=true&workload=Office",websiteUrl:"",scopes:[]}],version:"1.0.0."}),F.yammerCreateEnabled&&this.appManifests.set("yammer",{name:"Yammer",creationFileType:l.b[l.b.Yammer],fileTypeNameLocalized:m.CreateFileTypeNameYammerPost,id:"YammerAppId",staticTabs:[{entityId:"1",name:"Post",contentUrl:"",websiteUrl:"",scopes:[]}],version:"1.0.0."}),F.powerBiCreateEnabled&&this.appManifests.set("powerbi",{name:"Power BI",creationFileType:l.b[l.b.PowerBI],fileTypeNameLocalized:m.CreateFileTypeNamePowerBiReport,id:"PowerBIAppId",staticTabs:[{entityId:"1",name:"Report",contentUrl:"",websiteUrl:"groups/me/quickcreate",scopes:[]}],version:"1.0.0."}),F.whiteboardCreateEnabled){if(!this.whiteboardTenantCheck){var M=this.vroomService.getFluidEnabled("cache-only").catch((function(){return O.vroomService.getFluidEnabled("network-first")}));this.whiteboardTenantCheck=function(e,t){var n=new Promise((function(e,t){setTimeout((function(){return t(new Error("Timeout"))}),5e3)}));return Promise.race([n,t])}(0,M)}this.whiteboardTenantCheck=this.whiteboardTenantCheck.then((function(e){return e&&O.appManifests.set("whiteboard",{name:"Whiteboard",creationFileType:l.b[l.b.Whiteboard],fileTypeNameLocalized:m.CreateFileTypeNameWhiteboardWhiteboards,id:"WhiteboardAppId",staticTabs:[{entityId:"1",name:"Whiteboards",contentUrl:"openCreate=true",websiteUrl:"",scopes:[]}],version:"1.0.0."}),e}))}else this.whiteboardTenantCheck=Promise.resolve(!0)}return e.prototype.getCreateLinks=function(t){var n=this;return this.createLinksPromise||(this.createLinksPromise=new Promise((function(i){var r=[];n.workloadsService.getProvisionedWorkloads().then((function(o){o=o||[],(n.capabilitiesService.capabilities.fluidFirst?e.fluidFirstMenuOrdering:e.menuOrdering).forEach((function(e){var i;if(i=e===l.b.Fluid||e===l.b.FluidActivityBlueprint?n.getFluidWorkload(e):e===l.b.Trello?n.getThirdPartyWorkload(e):o.find((function(t){return t.FileType===e||e===l.b.FormsQuiz&&t.FileType===l.b.Forms||e===l.b.OneNotePage&&t.FileType===l.b.OneNote}))){var a=n.getCreateLinkForWorkload(i,e===l.b.FormsQuiz?l.b.FormsQuiz:e===l.b.OneNotePage?l.b.OneNotePage:null,t);a&&r.push(a)}})),i(r)}))})).then((function(t){var i=[];e.thirdPartyOrdering.forEach((function(e){i.push(n.getThirdPartyAppsCreateLink(l.b[e].toLowerCase()))}));var r=[],o=function(){return e.firstPartyCreateIntentOrdering.forEach((function(e){r.push(n.getFirstPartyAppsCreateLink(l.b[e].toLowerCase()))})),Promise.all(r.concat(i)).then((function(i){i=i.filter((function(e){return!!e}));var r=t.concat(i),o=n.capabilitiesService.capabilities.fluidFirst?e.fluidFirstCombinedMenuOrdering:e.combinedMenuOrdering;return r.sort((function(e,t){return o.indexOf(e&&e.workload?e.workload.FileType:l.b.None)-o.indexOf(t&&t.workload?t.workload.FileType:l.b.None)}))}))};return n.whiteboardTenantCheck.then(o,o)}))),this.createLinksPromise},e.prototype.createItem=function(e,t,i,o,a,s,c,u,d){var p=this;void 0===a&&(a=""),void 0===d&&(d=!1);var h=this.capabilitiesService.capabilities.scenarioId;switch(e){case l.b.Spaces:return void Promise.all([n.e(6),n.e(0),n.e(1),n.e(7),n.e(8),n.e(9),n.e(10),n.e(11),n.e(14),n.e(17),n.e(20),n.e(21),n.e(24),n.e(36),n.e(482)]).then(n.bind(null,"2zXp")).then((function(e){e.showCreateSpacesDialog({})}));case l.b.Visio:return this.workloadsPromiseHasVisio.then((function(n){return n?p.createItemHelper(e,t,i,o,a,s,c,u,d):h?void p.shellService.getLicenseStatus(l.b[e],h).then((function(n){return n.IsLicensed?p.createItemHelper(e,t,i,o,a,s,c,u,d):p.errorDialogService.showErrorDialog({category:"StartPage",error:"NoLicenceVisio",fileType:e})})):p.errorDialogService.showErrorDialog({category:"StartPage",error:"NoLicenceVisio",fileType:e})}));case l.b.OneNotePage:return void this.mruDataService.getMruDocuments(new Set([l.b.OneNote])).results.pipe(Object(r.a)(1)).toPromise().then((function(e){p.eventService.broadcastEvent({name:"createOnenotePageDialog",args:[e&&e.items||[]]})}));case l.b.Stream:return void this.createStreamService.createStreamContent(this.capabilitiesService,this.clientStartupConfigService.config.sharedClientStartupContext.correlationId);default:return this.createItemHelper(e,t,i,o,a,s,c,u,d)}},e.prototype.createItemFromManifest=function(e,t){var n=this,i=Date.now(),r=this.windowService.nativeWindow.open("","_blank");return new Promise((function(o){return n.requestNewItemFromManifest(e.FileType,e.IsThirdParty?e.ThirdPartyCreateUrl:e.Url,r,t,i,o)}))},e.getCreateButtonBackground=function(e){return l.b[e]+"_ButtonBackground"},e.prototype.createItemHelper=function(e,t,i,r,o,a,s,c,u){var d=this;void 0===o&&(o="");var p=this.createLinkCandidates.get(e);if(!p)return r&&r({type:"Error",latency:0}),Promise.resolve();var h=function(){var h=d.shouldOpenInUIHost(e,o);return new Promise((function(f){var m=s||d.getNewDocLinkTarget(e),g=function(e){r&&r(e),f("CreatePending"===e.type)};if(("_self"===m||h)&&d.numCreatesPending>0)g({type:"CreatePending",latency:-1});else if(d.numCreatesPending++,p.canCreateBlankDocument){var y,S=Date.now(),w=d.windowService.nativeWindow,C=function(n){if(p.createDocAspxEnabled&&!h){var l=d.getDocAspxApiUrl(p.docAspxId,d.getOriginParam(!0,!!i),S,i?i.AssetId:null,o),s=d.accessTokenService.getAccessToken("OneDrive");Promise.all([l,s]).then((function(o){var l=o[0],s=o[1];if(s&&s.success){var h;y&&y!==w?(y.document.write("<!doctype html> <html> <head> </head> <body> </body> </html> "),h=y.document):h=d.documentService.nativeDocument;var m=d.getDocaspxFormHtml(l,s.token);d.documentService.appendHTMLToElement(h.body,m);var b=h.getElementById("create-new-doc-form");if(b){var v=Date.now()-S;r&&r({type:"GoToBlankDocInstant",latency:v,platform:"Web"}),b.submit(),f()}else d.requestNewItem(p,e,S,t,y,f,r,n,i,a,null,c,u)}else d.requestNewItem(p,e,S,t,y,f,r,n,i,a,null,c)})).catch((function(){d.requestNewItem(p,e,S,t,y,f,r,n,i,a,null,c,u)}))}else d.requestNewItem(p,e,S,t,y,f,r,n,i,a,o,c,u)},I={NativeWindow:function(){y=w},Blank:function(){y=w.open("","_blank"),d.newTabWindow=y}},T=d.isPwa||h||"_blank"!==m||d.fluidSupportEnabled&&e===l.b.Fluid?I.NativeWindow:I.Blank;switch(e){case l.b.OneNote:var k=d.templatesConfigService.resources(e);return void d.inputDialogService.showInputDialog(v.createOnenoteNotebookDialog(d.locService,k,d.oneNoteGraphService,(function(e){d.instrumentationService.logClickEvent("Input_Dialog_Button_Click","FileDialogCreateNewButton",b.b.InputDialog,l.a.referralFromFileType(l.b.OneNote)),T(),C(e)}),(function(){d.numCreatesPending--})));default:T(),C()}}else d.launchOfficeApp(p.fileType).then((function(){g({type:"GoToLanding",latency:0,platform:"Native"})})).catch((function(){!function(){if(t&&p.canFallbackToLandingPage)return d.capabilitiesService.capabilities.contentLauncherEnabled?void Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(t,{action:"CreateNewFallback"}).then((function(){g({type:"GoToLanding",latency:0,platform:"Web"})})).catch((function(){d.showError("Generic",p.fileType,"OpenFailed",t),g({type:"Error",latency:0})}))})):void d.urlLauncherService.openUrl(t,"CreateNewFallback").then((function(){g({type:"GoToLanding",latency:0,platform:"Web"})})).catch((function(){d.showError("Generic",p.fileType,"OpenFailed",t),g({type:"Error",latency:0})}));d.showError("Generic",p.fileType),g({type:"Error",latency:0})}()}))})).then((function(e){e||d.numCreatesPending--}))};return[l.b.Excel,l.b.Visio].includes(e)&&!i&&this.capabilitiesService.capabilities.pwaEnabled?this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(t){return t.launchApp(l.b[e],"",{action:"OpenDocument",event:event,inAppNavFileType:e}).then((function(e){return e.success?(r&&r({type:"GoToLanding",latency:0,platform:"Native"}),Promise.resolve()):h()})).catch(h)})):this.localAppLauncherService.launchOfficeApp(l.b[e],"",null,!0).then((function(e){return e?(r&&r({type:"GoToLanding",latency:0,platform:"Native"}),Promise.resolve()):h()})).catch(h):h()},e.prototype.getFirstPartyAppsCreateLink=function(e){var t=this;return new Promise((function(n){var i=t.appManifests.get(e);i?t.getFirstPartyGenericWorkload(i).then((function(e){return n(e?t.getCreateLinkForFirstPartyWorkload(e):null)})).catch((function(){return n(null)})):n(null)}))},e.prototype.getThirdPartyAppsCreateLink=function(e){var t=this;return new Promise((function(n){var i=t.appManifests.get(e);if(i){var r=t.getThirdPartyGenericWorkload(i);n(r?t.getCreateLinkForThirdPartyWorkload(r):null)}else n(null)}))},e.prototype.getFirstPartyGenericWorkload=function(e){var t=this;return this.workloadsService.getWorkloads().then((function(n){var i,r=n.find((function(t){var n;return(null==t?void 0:t.AppId)===e.name||(null===(n=t.AppId)||void 0===n?void 0:n.includes(e.name.replace(/\s/g,"")))}));if(!r)return null;var o=null===(i=r.Url)||void 0===i?void 0:i.split("?"),a=o[0]+(o[0].endsWith("/")?"":"/")+(e.staticTabs&&e.staticTabs[0]&&e.staticTabs[0].websiteUrl?e.staticTabs[0].websiteUrl:"")+"?"+(o[1]?o[1]+"&":"")+(e.staticTabs&&e.staticTabs[0]&&e.staticTabs[0].contentUrl?e.staticTabs[0].contentUrl+"&":"")+"cid="+t.clientStartupConfigService.config.sharedClientStartupContext.correlationId;return{getId:function(){return e.name.replace(/\s/g,"")},Id:e.name.replace(/\s/g,""),Referral:e.name.replace(/\s/g,""),FileType:e.creationFileType?l.a.fileTypeNameToFileType(e.creationFileType):void 0,FileTypeNameLocalized:e.fileTypeNameLocalized,Url:a,Color:r.Color,IconUnicodeCodepointCssClass:r.IconUnicodeCodepointCssClass,Text:e.name,SubText:void 0,Title:e.staticTabs&&e.staticTabs[0].name||e.name,IsThirdParty:!1,IsNativeClientOnlyApp:!1,IconFont:void 0,Size:void 0,ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,ThirdPartyIcon:void 0,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:e.id,CollectorId:void 0,ThirdPartyCreateUrl:""}}))},e.prototype.getThirdPartyGenericWorkload=function(e){return{getId:function(){return e.name},Id:e.name,Referral:e.name,FileType:l.b.ThirdParty,Url:"",Color:e.accentColor,IconUnicodeCodepointCssClass:"",Text:e.name,SubText:void 0,Title:e.name,IsThirdParty:!0,IsNativeClientOnlyApp:!1,IconFont:void 0,Size:void 0,ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,ThirdPartyIcon:e.largeImageUrl&&""!==e.largeImageUrl?e.largeImageUrl:e.smallImageUrl,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:e.id,CollectorId:void 0,ThirdPartyCreateUrl:e.staticTabs&&e.staticTabs[0]&&e.staticTabs[0].contentUrl}},e.prototype.getThirdPartyWorkload=function(e){return e===l.b.Trello?{getId:function(){return"ShellTrello"},Id:"ShellTrello",Referral:"Trello",FileType:l.b.Trello,Url:"",Color:"#008FE4",IconUnicodeCodepointCssClass:"ms-ohp-svg-Icon ms-ohp-Icon ms-ohp-Icon--trelloLogo",Text:void 0,SubText:void 0,Title:void 0,IsThirdParty:!1,IsNativeClientOnlyApp:!1,IconFont:void 0,Size:void 0,ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,ThirdPartyIcon:void 0,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:void 0,CollectorId:void 0,ThirdPartyCreateUrl:void 0}:null},e.prototype.getFluidWorkload=function(e){var t={getId:function(){return"ShellFluid"},Id:"ShellFluid",Referral:"Fluid",FileType:l.b.Fluid,Url:"",Color:"#0078D4",IconUnicodeCodepointCssClass:"ms-ohp-svg-Icon ms-ohp-Icon ms-ohp-Icon--fluidLogo",Text:void 0,SubText:void 0,Title:void 0,IsThirdParty:!1,IsNativeClientOnlyApp:!1,IconFont:void 0,Size:void 0,ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,ThirdPartyIcon:void 0,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:void 0,CollectorId:void 0,ThirdPartyCreateUrl:void 0};switch(e){case l.b.Fluid:return t;case l.b.FluidActivityBlueprint:return t.getId=function(){return"ShellFluidAbp"},t.Id="ShellFluidAbp",t.FileType=l.b.FluidActivityBlueprint,t.Url="",t}},e.prototype.requestNewItem=function(e,t,r,o,a,c,u,p,h,f,m,b,v){var g=this,y=function(e){u&&u(e),c()},S=function(){return Date.now()-r},w=function(t,i,r){var o=function(n){g.showError("OpenFailed"===n&&"GoToBlankDoc"===r?"OpenNewDocFailed":"Generic",e.fileType,n,"OpenFailed"===n?t:""),y({type:"Error",latency:S()})};if(t)return g.isPwa?g.capabilitiesService.capabilities.contentLauncherEnabled?void Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(t,{action:"OpenDocument"}).then((function(){y({type:i,latency:S(),platform:"Web"})}),(function(){o("OpenFailed")}))})):void g.urlLauncherService.openUrl(t,r).then((function(){y({type:i,latency:S(),platform:"Web"})}),(function(){o("OpenFailed")})):void 0!==a.open?(u&&u({type:i,latency:S(),platform:"Web"}),g.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(t,{action:"OpenDocument",linkTarget:"_top",targetTab:a})})):a.open(t,"_top"),void c()):void o("OpenFailed");o("CreateFile")},C=function(t){g.launchOfficeApp(e.fileType,"",a).then((function(){y({type:"GoToLandingFallback",latency:S(),platform:"Native"})})).catch((function(){!function(){if(o&&e.canFallbackToLandingPage)w(o,"GoToLandingFallback","CreateNewFallback");else{g.showError(t,e.fileType);var n=S();y({type:"Error",latency:n})}}()}))},I=function(){var n,o=null,I=null,T="GoToBlankDoc";switch(t){case l.b.Sway:o=g.swayService.createNew().then((function(e){return{canonicalUrl:e,webUrl:e}}));break;case l.b.OneNote:o=g.oneNoteGraphService.createNewNotebook(p).then((function(e){var t=g.addLoginHint(e.links.oneNoteWebUrl.href);return{canonicalUrl:t,webUrl:t}}));break;case l.b.Forms:o=h?g.formsService.createFormFromTemplate(h,s.a.Users).then((function(e){return{canonicalUrl:e,webUrl:e}})):g.formsService.createForm(l.b.Forms,f,b).then((function(e){return{canonicalUrl:e,webUrl:e}})),T="CreateNewFallback";break;case l.b.FormsQuiz:o=g.formsService.createForm(l.b.FormsQuiz,f,b).then((function(e){return{canonicalUrl:e,webUrl:e}})),T="CreateNewFallback";break;default:I=(n=Object(i.__read)(g.createOneDriveFile(e,h?h.AssetId:null,r),2))[0],o=n[1]}var k=g.shouldOpenInUIHost(t,m)?g.wacContentService.bootstrapZeroByteFile({fileName:I,fileType:t,wdOrigin:g.getOriginParam(!1,!!h)},r,o,null==h?void 0:h.AssetId,m):void 0,A=!1;k&&(e.canOpenBlankDocInNativeApp?g.localAppLauncherService.shouldOpenInOfficeApp(l.b[e.fileType]).then((function(e){e||A||(A=!0,u&&u({type:"GoToBlankDoc",latency:S(),platform:"Web"}),k(),c())})):(A=!0,u&&u({type:"GoToBlankDoc",latency:S(),platform:"Web",documentUrlPromise:o.then((function(e){return e.canonicalUrl}))}),v||k(),c())),o.then((function(t){if(!A){if(A=!0,!e.canOpenBlankDocInNativeApp)return void g.launchWebApp(t,T,w,u,c,S,k);g.launchOfficeApp(e.fileType,t.canonicalUrl,a).then((function(){y({type:"GoToBlankDoc",latency:S(),platform:"Native"})})).catch((function(){g.launchWebApp(t,T,w,u,c,S,k)}))}})).catch((function(e){g.globalErrorHandler.handleError(e,"foSs8");var t=e&&e.error&&e.error.code||"";C("404"===t?"OneDriveProvisioning":e&&e.error&&"CAP_Error"===e.error.data?"ConditionalAccessFallback":g.clientStartupConfigService.config.authType===d.a.MSA&&"403"===t?"OneDriveDisabled":"Generic")}))};if(a||(a=this.windowService.nativeWindow),this.isPwa||void 0!==a.open){if(a!==this.windowService.nativeWindow)try{var T=this.getLoadingPageHtml(t);a.document.write(T)}catch(e){return this.globalErrorHandler.handleError(e,"T3UKJ"),void C("Generic")}this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchTemplate(l.b[t],h?h.TemplateBinaryUrl:null).then((function(e){if(!e)throw new Error("launchOfficeAppWithTemplate failed");y({type:"GoToBlankDoc",latency:S(),platform:"Native"})})).catch((function(){t===l.b.Fluid||t===l.b.FluidActivityBlueprint?(g.numCreatesPending--,g.launchFluidExperience(t)):I()}))})):this.localAppLauncherService.launchOfficeAppWithTemplate(l.b[t],h?h.TemplateBinaryUrl:null).then((function(e){if(!e)throw new Error("launchOfficeAppWithTemplate failed");y({type:"GoToBlankDoc",latency:S(),platform:"Native"})})).catch((function(){t===l.b.Fluid||t===l.b.FluidActivityBlueprint?(g.numCreatesPending--,g.launchFluidExperience(t)):I()}))}else C("Generic")},e.prototype.requestNewItemFromManifest=function(e,t,i,r,o,a){var l=this,s=function(e){r&&r(e),a()},c=function(){return Date.now()-o};this.launchWebApp({canonicalUrl:t,webUrl:t},"OpenFile",(function(t,o,u){var d=function(n){l.showError("OpenNewDocFailed",e,n,"OpenFailed"===n?t:""),s({type:"Error",latency:c()})};return l.isPwa?l.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){return e.launchUrl(t,{action:u.toString()}).then((function(){s({type:o,latency:c(),platform:"Web"})}),(function(){d("OpenFailed")}))})):l.urlLauncherService.openUrl(t,u).then((function(){s({type:o,latency:c(),platform:"Web"})}),(function(){d("OpenFailed")})):(r&&r({type:o,latency:c(),platform:"Web"}),l.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){return e.launchUrl(t,{action:u.toString(),linkTarget:"_top",targetTab:i})})):(i.open(t,"_top"),void a()))}),r,a,(function(){return Date.now()-o}))},e.prototype.createOneDriveFile=function(e,t,n){var i=this,r=e.newDocName+"."+e.fileExtension,o=this.shouldOpenInUIHost(e.fileType);return[r,new Promise((function(a,l){var s=Date.now();i.oneDriveService.createNewFile(r,e.fileType,o).then((function(e){var r={};e.webDavUrl&&(r.canonicalUrl=i.addLoginHint(e.webDavUrl));var l=i.addLoginHint(e.webUrl),c="action=editnew";-1===(l=l.replace(new RegExp("([?&])action[^&]*"),"$1action=editnew")).lastIndexOf(c)&&(l=f.a.appendQuery(l,c)),t&&(l=l+"&wdTpl="+t),(t||i.createLcidEnabled)&&(l+="&wdlcid="+i.contextService.sharedContext.officeMarketLcid);var u=i.capabilitiesService.capabilities.scenarioId;u&&(l+="&wdscenarioid="+u);var d=i.getOriginParam(!1,!!t);l=f.a.appendQuery(l,"wdNewAndOpenCt="+n+"&ct="+n+"&wdPreviousSession="+i.startupConfigService.config.sharedClientStartupContext.correlationId+"&wdOrigin="+d),r.webUrl=l,o&&(e.parentReference&&(r.docId=e.id,r.driveId=e.parentReference.driveId,r.fileName=e.name),r.wopiFetchData={fetchDiagnostics:{startTime:s},wopiHostData:L.a.getWopiHostDataFromItem(e)}),a(r)})).catch((function(e){i.globalErrorHandler.handleError(e,"dYEKI"),l(e||"Creating new file failed")}))}))]},e.prototype.getNewDocLinkTarget=function(e){var t=this.createLinkCandidates.get(e);return this.capabilitiesService.capabilities.capPopupEnabled&&(e===l.b.Word||e===l.b.Excel||e===l.b.PowerPoint||e===l.b.Visio||e===l.b.OneNote)&&this.accessTokenService.hasCAPError("Graph")||e===l.b.Fluid||e===l.b.FluidActivityBlueprint?"_self":this.isPwa||"_blank"===this.contextService.sharedContext.defaultLinkTarget&&(this.clientStartupConfigService.config.authType===d.a.OrgId||!t.canCreateBlankDocument)?"_blank":"_self"},e.prototype.showError=function(e,t,n,i){void 0===n&&(n="CreateFile"),this.newTabWindow&&(this.newTabWindow.close(),this.newTabWindow=null),this.errorDialogService.showErrorDialog({category:n,error:e,fileType:t,inputText:i})},e.prototype.getLoadingPageHtml=function(e){var t=" <!doctype html> <html> <head> <title>TITLE</title> <meta charset=utf-8 /> <style>body{margin:0;padding:0}.parent{text-align:center;width:100%;height:100%}.title{font-family:'Segoe UI SemiLight','Segoe UI WPC Semilight','Segoe UI',Segoe,Tahoma,Helvetica,Arial,sans-serif;font-size:30px;margin-bottom:-12px}.load_center{position:absolute;left:0;right:0;bottom:50%}.spinner{display:inline-block;margin:25px auto;border-radius:50%;border:1.5px solid #d9d9d9;border-top-color:SPINNERCOLOR;width:40px;height:40px;-webkit-animation:spinAnimation 1.3s infinite cubic-bezier(.53,.21,.29,.67);animation:spinAnimation 1.3s infinite cubic-bezier(.53,.21,.29,.67)}@-webkit-keyframes spinAnimation{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes spinAnimation{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}</style> </head> <body> <div class=parent> <div class=load_center> <div class=title>ONLINEAPPNAME</div> <br> <span role=presentation class=spinner></span> </div> </div> </body> </html> ";return(t=(t=t.replace("TITLE",this.locService.CreateNewDocumentLoadingPageTitle)).replace("SPINNERCOLOR",this.getWorkloadSpinnerColor(e))).replace("ONLINEAPPNAME",this.getWorkloadOnlineName(e))},e.prototype.getDocaspxFormHtml=function(e,t){return"<form id=create-new-doc-form method=post action=APIURL style=display:none target=_top><input id=create-new-doc-token name=access_token value=ONEDRIVETOKEN /></form> ".replace("APIURL",e).replace("ONEDRIVETOKEN",t)},e.prototype.getWorkloadOnlineName=function(e){var t=this.createLinkCandidates.get(e);return t?t.workloadOnlineName:""},e.prototype.getWorkloadSpinnerColor=function(e){var t=this.createLinkCandidates.get(e);return t&&t.spinnerColor?t.spinnerColor:"#2b579a"},e.prototype.getCreateLinkForWorkload=function(t,n,i){var r=n||t.FileType,o=this.createLinkCandidates.get(r),a=t.Id;if(!o)return null;var s=t.Url;return r===l.b.Sway?s=f.a.appendQuery(s,"campaign=OHPCreateNew"):r!==l.b.Forms&&r!==l.b.FormsQuiz||(s=this.formsService.getCreateFormsLink(r,null,i),a=r===l.b.FormsQuiz?t.Id+"Quiz":t.Id),{ariaLabel:this.locService.format(this.locService.CreateMenuLinkAriaLabelFormat,o.title),title:o.title,fileTypeName:o.fileTypeName,appName:o.appName,icon:l.a.documentIconFromType(t.FileType,"32x32"),svgButtonBackground:e.getCreateButtonBackground(r),workload:t,url:s,creationFileType:r,getId:function(){return a}}},e.prototype.getCreateLinkForThirdPartyWorkload=function(e){return{ariaLabel:e.Text,title:e.Text,fileTypeName:e.Text,appName:e.Text,icon:"",svgButtonBackground:"",workload:e,url:e.ThirdPartyCreateUrl,iconUrl:e.ThirdPartyIcon,creationFileType:l.b.ThirdParty,getId:function(){return e.Id}}},e.prototype.getCreateLinkForFirstPartyWorkload=function(t){return{ariaLabel:t.Text,title:t.Title,fileTypeName:t.FileTypeNameLocalized,appName:t.Text,icon:t.FileType===l.b.List?null:t.IconUnicodeCodepointCssClass,workload:t,url:t.Url,svgButtonBackground:e.getCreateButtonBackground(t.FileType),creationFileType:t.FileType,getId:function(){return t.Id},createFromManifest:!0}},e.prototype.getDocAspxApiUrl=function(e,t,n,i,r){var o=this;return new Promise((function(a,l){o.oneDriveService.getMyDriveRootUrl().then((function(s){var c=s.userRoot,u=c.lastIndexOf("/Documents");if(-1!==u){var d=c.substring(0,u)+"/_layouts/15/doc.aspx?action=editnew&doctype="+e+"&wdOrigin="+t+"&docliburl="+c+"&ct="+n;i&&(d+=r?"&templateDriveId="+r+"&templateItemId="+i:"&wdTpl="+i),(i||o.createLcidEnabled)&&(d+="&wdlcid="+o.contextService.sharedContext.officeMarketLcid);var p=o.capabilitiesService.capabilities.scenarioId;p&&(d+="&wdscenarioid="+p),o.capabilitiesService.capabilities.outgoingLoginHintEnabled&&(d+="&login_hint="+encodeURIComponent(o.startupConfigService.config.loginHint)),a(d)}else l("docliburl not in expected format")})).catch((function(){l("Failed to get doclib url")}))}))},e.prototype.getOriginParam=function(e,t){return this.contextService.getWdOrigin(t?e?"TEMPLATES-INSTANT":"TEMPLATES":e?"NEW-INSTANT":"NEW")},e.prototype.launchOfficeApp=function(e,t,i){return void 0===t&&(t=""),void 0===i&&(i=void 0),this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(n){return n.launchApp(l.b[e],t,{action:t?"OpenDocument":"OpenInApp",event:event,targetTab:i}).then((function(e){if(!e.success)return Promise.reject()}))})):this.localAppLauncherService.launchOfficeApp(l.b[e],t).then((function(e){if(!e)return Promise.reject()}))},e.prototype.shouldOpenInUIHost=function(e,t){return(!t||this.capabilitiesService.capabilities.wacHostOrgTemplatesEnabled)&&this.wacHostCreateNewEnabled&&this.capabilitiesService.wacHostEnabledForFileType(e)&&this.wacHostApps&&this.wacHostApps.has(e)},e.prototype.launchWebApp=function(e,t,n,i,r,o,a){a?(i&&i({type:"GoToBlankDoc",latency:o(),platform:"Web"}),a(),r()):n(e.webUrl,"GoToBlankDoc",t)},e.prototype.launchFluidExperience=function(e){var t=this;this.fluidHostContext.hostScenarioStartTime=Date.now(),this.fluidHostContext.hostScenarioName=e===l.b.Fluid?"CreateNew":"CreateNew.Abp",this.oneDriveService.getMyDriveRoot("network-first").then((function(n){var i=n.webUrl.lastIndexOf("/Documents");if(-1!==i){var r=n.webUrl.substring(0,i);t.officeRouteService.navigateTo({route:"Content",app:l.b.Fluid},!1,{action:"editnew",abpId:e===l.b.Fluid?void 0:1,siteUrl:r,drive:n.parentReference.driveId})}}))},e.prototype.addLoginHint=function(e){return f.a.appendLoginHint(e,this.startupConfigService.config.loginHint,this.capabilitiesService.capabilities.outgoingLoginHintEnabled)},e.menuOrdering=[l.b.Word,l.b.PowerPoint,l.b.Excel,l.b.Forms,l.b.FormsQuiz,l.b.OneNotePage,l.b.Sway,l.b.OneNote,l.b.Visio,l.b.FluidActivityBlueprint,l.b.Fluid],e.fluidFirstMenuOrdering=[l.b.FluidActivityBlueprint,l.b.Fluid,l.b.Word,l.b.PowerPoint,l.b.Excel,l.b.Forms,l.b.FormsQuiz,l.b.OneNotePage,l.b.Sway,l.b.OneNote,l.b.Visio],e.thirdPartyOrdering=[],e.firstPartyCreateIntentOrdering=[l.b.List,l.b.Yammer,l.b.PowerBI,l.b.Whiteboard],e.combinedMenuOrdering=[l.b.Word,l.b.PowerPoint,l.b.Excel,l.b.Forms,l.b.FormsQuiz,l.b.OneNote,l.b.List,l.b.OneNotePage,l.b.Sway,l.b.Visio,l.b.FluidActivityBlueprint,l.b.Fluid,l.b.Yammer,l.b.PowerBI,l.b.Whiteboard],e.fluidFirstCombinedMenuOrdering=[l.b.FluidActivityBlueprint,l.b.Fluid,l.b.Word,l.b.PowerPoint,l.b.Excel,l.b.Forms,l.b.FormsQuiz,l.b.OneNote,l.b.List,l.b.OneNotePage,l.b.Sway,l.b.Visio,l.b.Yammer,l.b.PowerBI,l.b.Whiteboard],e.ɵprov=w.cc({factory:function(){return new e(w.dc(y.b),w.dc(u.a),w.dc(d.b),w.dc(p.a),w.dc(C),w.dc(I.a),w.dc(T.a),w.dc(k.a),w.dc(a.a),w.dc(A.a),w.dc(o.b),w.dc(P.a),w.dc(b.a),w.dc(E.a),w.dc(h.a),w.dc(c.a),w.dc(_.a),w.dc(O.a),w.dc(D.a),w.dc(F.a),w.dc(d.b),w.dc(M.a),w.dc(R.a),w.dc(g.a),w.dc(x.a),w.dc(L.a),w.dc(N.a),w.dc(U.b),w.dc(W.a))},token:e,providedIn:"root"}),e}()},OtXi:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=new(n("keVe").q)("WRAPPER_VERSION")},OyI4:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("bb6g"),r=n("BaAg"),o=n("pOWU"),a=n("uUrA"),l=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p){var h=e.call(this,t,n,i,"MruPlusPlus",r,o,l,p)||this;h.globalErrorHandler=s,h.startupConfigService=c;var f=h.contextService.sharedContext,m=a.config;return h.supportedApps=d,h.serviceBaseUrl=h.inMockMode?f.officeHomeApiRoot+"/"+u:m.mruServiceRoot+"/"+u,h}return Object(i.__extends)(t,e),t.prototype.requestParams=function(e,n){var i=n&&n.size?this.supportedApps.filter((function(e){return n.has(r.a.fileTypeNameToFileType(e))})):this.supportedApps;return""+t.appSpecifier+i.join(",")+"&"+t.sizeSpecifier+e+"&"+t.localeSpecifier+this.contextService.sharedContext.officeMarket},t.prototype.getNewRequestConfig=function(e){return{headers:this.requestHeaders(e,a.a.createGuid())}},t.prototype.getRequestIdFromResponse=function(t){return e.prototype.getRequestIdFromResponse.call(this,t,"X-CorrelationId")},t.prototype.requestHeaders=function(e,t){var n=this.startupConfigService.config.sharedClientStartupContext,i=new Map([["X-Office-Platform","Web"],["X-Office-Application",this.contextService.sharedContext.iceApplicationId.toString()],["X-Office-Version",n.buildId],["X-CorrelationId",t]]);return e&&i.set("Content-Type","application/json"),i},t.localeSpecifier="rs=",t.sizeSpecifier="show=",t.appSpecifier="apps=",t}(o.a)},PBJH:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("bb6g"),r=n("BaAg"),o=n("dFxn"),a=n("BMb5"),l=n("TJwc"),s=n("/I02"),c=n("keVe"),u=function(){function e(e,t,n){this.windowService=n,this.dateFormatOptionsMap=new Map,this.intlSupported=!0,this.officeMarket=e.sharedContext.officeMarket,this.setSupportsLocaleSpecifiers(),this.dateFormatOptionsMap.set(1,{year:"numeric",month:"short",day:"numeric"}),this.dateFormatOptionsMap.set(2,{year:"numeric",month:"long",day:"numeric",weekday:"long"}),this.dateFormatOptionsMap.set(3,{day:"numeric",weekday:"short"}),this.dateFormatOptionsMap.set(4,{day:"numeric",weekday:"long"}),this.dateFormatOptionsMap.set(5,{month:"short",day:"numeric"}),this.dateFormatOptionsMap.set(6,{weekday:"short"}),this.dateFormatOptionsMap.set(7,{hour:"numeric",minute:"numeric"}),this.intlDateFormatterMap=new Map,this.tryInitializeIntlFormatter();var i=t.parse("resourceStrings");i&&Object.assign&&Object.assign(this,i)}return e.prototype.appResource=function(e,t){return this[""+e+r.b[t]]||this[e]},e.prototype.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return l.a.format.apply(l.a,Object(i.__spread)([e],t))},e.prototype.localizedDateString=function(e){return this.formatDate(e,0)},e.prototype.localizedDateStringMedium=function(e){return this.formatDate(e,1)},e.prototype.localizedDateStringLong=function(e){return this.formatDate(e,2)},e.prototype.localizedWeekdayDate=function(e){return this.formatDate(e,3)},e.prototype.localizedWeekdayDateLong=function(e){return this.formatDate(e,4)},e.prototype.localizedMonthDate=function(e){return this.formatDate(e,5)},e.prototype.localizedWeekday=function(e){return this.formatDate(e,6)},e.prototype.formatTimeFromDate=function(e){return this.intlSupported&&this.intlDateFormatterMap&&(this.intlDateFormatterMap.has(7)||this.tryInitializeIntlFormatter(7))?this.intlDateFormatterMap.get(7).format(e):this.supportsLocaleSpecifiers&&this.dateFormatOptionsMap?e.toLocaleTimeString(this.officeMarket,this.dateFormatOptionsMap.get(7)):e.toTimeString()},e.prototype.localizedNumberString=function(e){return this.intlNumberFormatter?this.intlNumberFormatter.format(e):this.supportsLocaleSpecifiers?e.toLocaleString(this.officeMarket):e.toString()},e.prototype.appName=function(e){switch(e){case r.b.Word:return this.WordName;case r.b.Excel:return this.ExcelName;case r.b.PowerPoint:return this.PowerPointName;case r.b.Sway:return this.SwayName;case r.b.OneNote:return this.OneNoteName;case r.b.Visio:return this.VisioName;case r.b.Forms:case r.b.FormsQuiz:return this.FormsName;case r.b.Stream:return this.StreamName;case r.b.Fluid:case r.b.FluidActivityBlueprint:return this.FluidName}return""},e.prototype.tryInitializeIntlFormatter=function(e){if(!this.intlSupported)return!1;try{if("Intl"in this.windowService.nativeWindow)return e?(this.intlDateFormatterMap.set(e,new Intl.DateTimeFormat(this.officeMarket,this.dateFormatOptionsMap.get(e))),this.dateFormatOptionsMap.delete(e),0===this.dateFormatOptionsMap.size&&(this.dateFormatOptionsMap=null)):(this.intlDateFormatterMap.set(0,new Intl.DateTimeFormat(this.officeMarket)),this.intlNumberFormatter=new Intl.NumberFormat(this.officeMarket)),!0}catch(e){}return this.intlSupported=!1,this.intlDateFormatterMap=null,this.intlNumberFormatter=null,this.dateFormatOptionsMap=null,!1},e.prototype.formatDate=function(e,t){if(this.intlSupported&&this.intlDateFormatterMap&&(this.intlDateFormatterMap.has(t)||this.tryInitializeIntlFormatter(t)))return this.intlDateFormatterMap.get(t).format(e);if(this.supportsLocaleSpecifiers){if(0===t)return e.toLocaleDateString(this.officeMarket);if(this.dateFormatOptionsMap){var n=this.dateFormatOptionsMap.get(t);return e.toLocaleDateString(this.officeMarket,n)}}return e.toDateString()},e.prototype.setSupportsLocaleSpecifiers=function(){this.supportsLocaleSpecifiers=function(){try{(0).toLocaleString("i")}catch(e){return"RangeError"===e.name}return!1}()},e.ɵprov=c.cc({factory:function(){return new e(c.dc(s.a),c.dc(o.a),c.dc(a.b))},token:e,providedIn:"root"}),e}()},POe7:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.prototype.transform=function(e){if(e)return{email:e.upn,fullName:e.name}},e}()},PTf4:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var i=n("BaAg");function r(e,t,n,r,o,a){if(n.config.moreTemplatesRedirectionEnabled)switch(e){case i.b.Visio:var l=n.config.visioMoreTemplatesUrl;l=l+"&lpOrigin=OFFICECOM-WEB.START&correlationId="+o.config.sharedClientStartupContext.correlationId+"&omkt="+t+"&ds="+(a.user.isGcc?"1":"0");var s=r.capabilities.scenarioId;return s&&(l=l+"&scenarioid="+s),l;default:return}}function o(e,t,n){switch(e){case i.b.Visio:return!n.config.visioUnsupportedTemplatesLocales.includes(t);default:return!0}}function a(e,t,n){switch(n){case i.b.Stream:return e.format(e.StreamCrossLinkString,t.config.streamDocumentationUrl,t.config.streamCrossLinkUrl);default:return}}},PZOQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("PBJH");var i=function(){function e(e){this.locService=e}return e.prototype.transform=function(e){return this.formatDataSize(e)},e.prototype.formatDataSize=function(e){for(var t=4,n=0;n<1&&t>=0;)n=e/Math.pow(1024,t),t--;var i=n<10&&n%1>=.1?10:1;n=Math.round(n*i)/i;var r=this.locService.localizedNumberString(n),o="";switch(t){case 3:o=this.locService.Terabytes;break;case 2:o=this.locService.Gigabytes;break;case 1:o=this.locService.Megabytes;break;case 0:o=this.locService.Kilobytes;break;case-1:o=this.locService.Bytes}return r+" "+o},e}()},PkQn:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("keVe"),r=(n("4/We"),n("3anA")),o=(n("A/um"),function(){function e(e){this.capabilitiesService=e,this.iconClicked=new i.n}return e.prototype.ngOnInit=function(){this.classAttrValue=this.getClasses(),this.styleAttrValue=this.getStyle()},e.prototype.ngOnChanges=function(e){(e.hasOwnProperty("iconFontCssClass")||e.hasOwnProperty("iconFontType")||e.hasOwnProperty("iconFontName")||e.hasOwnProperty("cssClass"))&&(this.classAttrValue=this.getClasses()),(e.hasOwnProperty("size")||e.hasOwnProperty("color"))&&(this.styleAttrValue=this.getStyle())},e.prototype.handleClick=function(){this.iconClicked.emit()},e.prototype.getClasses=function(){var e=this.iconFontCssClass?this.iconFontCssClass:r.a.FluentIconCssClass,t=this.capabilitiesService.capabilities.svgAppIconsEnabled;return this.iconFontCssClass||(this.iconFontName?e+=" "+r.a.getCssClassFromGlyphName(this.iconFontName,t):void 0!==this.iconFontType&&(e+=" "+r.a.getCssClass(this.iconFontType,t))),this.cssClass&&(e+=" "+this.cssClass),this.isThirdParty&&(e+=" ms-ohp-Icon"),e},e.prototype.getStyle=function(){var e=this.style?this.style:{};return this.size&&(e["font-size"]=this.size+"px"),this.color&&(e.color=this.color),e},e}())},QOOv:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("mruConfig")||{activityEnabled:!1,activityStrings:{},addWacParams:!1,analyticsCachingEnabled:!1,analyticsEnabled:!1,clickableFolderEnabled:!1,copyLinkEnabled:!1,deferFeedWrite:!1,infiniteShowMoreEnabled:!1,isNewLifecycleEventEnabled:!1,isNewTimeWindowInHours:0,logThumbnailLoadSuccess:!1,maxInitialListItems:0,maxTotalListItems:0,mobileShareAndActivityEnabled:!1,mruActivityEnabled:!1,mruNumItemsToRequest:0,mruPinEnabled:!1,mruServiceRoot:null,newMruActions:!1,numRecommendedToRequest:0,officeFeedApiRootPath:"",officeFeedControlEnabled:!1,officeFeedFlightEnabled:!1,officeFeedFlightName:"",officeFeedFlightControlName:"",officeFeedExperimentName:"",officeFeedExperimentControlName:"",officeFeedFlight2Name:"",officeFeedFlight2ControlName:"",officeFeedExperiment2Name:"",officeFeedExperiment2ControlName:"",officeFeedFlight3Name:"",officeFeedFlight3ControlName:"",officeFeedExperiment3Name:"",officeFeedExperiment3ControlName:"",officeFeedNewSchemaEnabled:"",oneDriveDiscoverViewId:null,oneDriveRecentViewId:null,oneDriveSharedViewId:null,onlyMruActivityEnabled:!1,permissionsEnabled:!1,recommendedApiDismissedDocumentsPath:"",recommendedB2ApiRootPath:"",recommendedB2ApiFilesPath:"",recommendedB2EndpointEnabled:!1,recommendedCalloutEnabled:!1,recommendedEnabled:!1,recommendedFluidEnabled:!1,recommendedMotionEnabled:!1,recommendedNewCardsEnabled:!1,recommendedPdfEnabled:!1,recommendedRemoveItemEnabled:!1,recommendedVisioEnabled:!1,shareApiEndpoint:null,shareControlEnabled:!1,shareControlCAPPopupEnabled:!1,sharedAttachmentsEnabled:!1,sharedWithMeV2Enabled:!1,sharedWithMeViewEnabled:!1,sharingStatusEnabled:!1,showDownloadAction:!1,showZeroExperience:!1,substrateApiEndpoint:null,supportedFileTypes:[],supportedFileTypesSwM:[],swayTransformedFromWordAttributionEnabled:!1,tileViewEnabled:!1,thumbnailSWEnabled:!1,trendingAroundMeEnabled:!1,trendingDocsEnabled:!1,webUrlMruConsumerEnabled:!1,wordIconFontClass:"",excelIconFontClass:"",visioIconFontClass:"",powerPointIconFontClass:"",oneNoteIconFontClass:"",swayIconFontClass:"",formsIconFontClass:"",powerBIIconFontClass:"",streamIconFontClass:"",outlookIconFontClass:"",silentS2SFlow:!1,upcomingMeetingAttendeeDisplayMax:0,upcomingMeetingEnabled:!1,fileCardSupportedFileTypes:[],useFeedS2SApi:!1,myAnalyticsEnabled:!1}}return e.unpinnedListId="unpinned-mru",e.pinnedListId="pinned-mru",e.sharedListId="shared-mru",e.trendingListId="trending-docs",e.classNoteBookListId="classNotebook-mru",e.appItemListId="app-items-mru",e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},QhWD:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("bb6g"),r=n("CCRL"),o=n("casz"),a=n("cgnd"),l=n("RsrG"),s=function(){function e(){}return e.prototype.shouldLoad=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2]}))}))},e}(),c=function(){function e(e,t){this.scheduler=e,this.modulePriorityService=t}return e.prototype.shouldLoad=function(e){var t=this,n=this.modulePriorityService.getSchedulePriority(e);return new Promise((function(e){return t.scheduler.scheduleWork(e,n)}))},e}(),u=n("keVe"),d=function(){function e(){}return e.ɵprov=u.cc({factory:function(){return function(e,t,n){try{switch(e.config.chunkLoadStrategy){case"idle-callback":return new c(t,n);case"noop":default:return new s}}catch(e){return new s}}(u.dc(a.b),u.dc(o.a),u.dc(l.a))},token:e,providedIn:"root"}),e}(),p=function(){function e(e,t,n){this.ngModuleLoader=e,this.injector=t,this.downloadStrategy=n,this.ngModuleCache=new Map}return e.prototype.loadLazyViewFromModule=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,o,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(t=this.ngModuleCache.get(e))?[3,3]:[4,this.downloadStrategy.shouldLoad(e)];case 1:return i.sent(),[4,this.ngModuleLoader.load(e)];case 2:n=i.sent(),t=n.create(this.injector),this.ngModuleCache.set(e,t),i.label=3;case 3:return o=t.componentFactoryResolver,a=t.injector.get(r.a),[2,o.resolveComponentFactory(a)]}}))}))},e.ɵprov=u.cc({factory:function(){return new e(u.dc(u.w),u.dc(u.o),u.dc(d))},token:e,providedIn:"root"}),e}()},QtYd:function(e,t,n){"use strict";n.d(t,"a",(function(){return We})),n.d(t,"b",(function(){return Qe}));var i=n("keVe"),r=n("TOqr"),o=n("g0MB"),a=n("w1PR"),l=n("pzhl"),s=n("PkQn"),c=n("4/We"),u=n("9gjh"),d=n("7J/E"),p=n("PBJH"),h=n("/I02"),f=n("55A9"),m=n("TDzr"),b=n("7Gwk"),v=n("EYcb"),g=n("cgnd"),y=n("2lMP"),S=n("dx17"),w=n("8EWw"),C=n("pd4Y"),I=n("W3Zz"),T=n("hZW2"),k=n("y1jW"),A=n("hhzZ"),P=n("Bc8L"),E=n("QOOv"),_=n("kfAr"),O=n("dOgD"),F=n("Z0U4"),D=n("n826"),M=n("EqbI"),R=n("Uqr9"),x=n("1Bt+"),L=n("OPwp"),N=n("9gXN"),U=n("uNUv"),W=n("6u39"),B=n("TIi1"),z=n("Brer"),j=n("Xc4i"),H=n("EUVs"),V=n("BMb5"),q=n("hoyd"),G=n("7Rc8"),Z=n("DQbD"),Q=n("GmnP"),K=n("kpuN"),Y=n("gZ+X"),J=n("XWg3"),X=n("sVeK"),$=n("WJRI"),ee=n("kVgv"),te=n("KoFE"),ne=n("9c4X"),ie=n("6Po3"),re=n("bb6g"),oe=n("zvoD"),ae=n("f0qX"),le=n("dpyN"),se=function(e){function t(t){var n=e.call(this,217,434,868)||this;return n.eventService=t,n.eventService.events.withScope(0).pipe(Object(oe.a)((function(e){return"recommendedCardSize"===e.name})),Object(ae.a)((function(e){return{size:e.args[0],num:e.args[1]}})),Object(le.a)((function(e,t){return e.size===t.size&&e.num===t.num}))).subscribe((function(e){var t=e.size,i=e.num;n.updateItemAndBufferSize(t,t*(i+1),t*(i+3))})),n}return Object(re.__extends)(t,e),t}(J.e),ce=n("Eup2"),ue=n("RJiy"),de=n("U8M1"),pe=n("lrJm"),he=n("rBEp"),fe=n("7wk3"),me=n("AXqk"),be=n("xoWf"),ve=n("SPVw"),ge=n("Vwd8"),ye=i.xb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeIn",definitions:[{type:1,expr:":enter",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:"{{ opacity }}"},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDuration:"150ms",opacity:.5}}},options:{params:{fadeInDuration:"500ms",opacity:1}}},options:null}],options:{}},{type:7,name:"recommendedMotionTrigger",definitions:[{type:0,name:"moving",styles:{type:6,styles:{transform:"{{ translationParam }}"},offset:null},options:{params:{translationParam:"translateX(0)"}}},{type:1,expr:"*=>moving",animation:{type:4,styles:null,timings:"400ms ease-in-out"},options:null}],options:{}}]}});function Se(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,"h3",[["class","ms-fcl-nd"],["id","recommendedHeader"]],null,null,null,null,null)),i.yb(1,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"list-header__title list-header__title--carousel":0,"list-header__title--fluent":1}),(e()(),i.Yb(3,null,["",""]))],(function(e,t){var n=t.component,i=e(t,2,0,!n.fluentRefresh,n.fluentRefresh);e(t,1,0,"ms-fcl-nd",i)}),(function(e,t){e(t,3,0,t.component.recommendedTitle)}))}function we(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,12,"div",[["class","carousel-nav"]],null,null,null,null,null)),(e()(),i.zb(1,0,[[3,0],["recommendedNavLeft",1]],null,5,"button",[["class","icon-button ms-bgc-g40-h ms-fcl-nd-h"],["data-clicklog","custom"],["id","recommended-nav-left"],["keyboardFocusTooltip",""]],[[1,"aria-label",0],[8,"title",0],[1,"aria-disabled",0],[8,"tabIndex",0]],[[null,"focus"],[null,"click"]],(function(e,t,n){var i=!0,r=e.component;return"focus"===t&&(i=!1!==r.onScrollFocus(!0)&&i),"click"===t&&(i=!1!==r.navigateCards(-1)&&i),i}),null,null)),i.yb(2,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(3,{"icon-button--disabled ms-fcl-nta":0,"ms-fcl-ns":1,"first-arrow":2,"icon-button--fluent":3}),i.yb(4,4210688,null,0,o.a,[i.l,i.D,a.b],null,null),(e()(),i.zb(5,0,null,null,1,"ohp-icon-font",[["cssClass","carousel-nav__arrow"],["iconFontName","ChevronLeft"],["size","16"]],null,null,null,l.b,l.a)),i.yb(6,638976,null,0,s.a,[c.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null),(e()(),i.zb(7,0,[[4,0],["recommendedNavRight",1]],null,5,"button",[["class","icon-button ms-bgc-g40-h ms-fcl-nd-h"],["data-clicklog","custom"],["id","recommended-nav-right"],["keyboardFocusTooltip",""]],[[1,"aria-label",0],[8,"title",0],[1,"aria-disabled",0],[8,"tabIndex",0]],[[null,"focus"],[null,"click"]],(function(e,t,n){var i=!0,r=e.component;return"focus"===t&&(i=!1!==r.onScrollFocus(!1)&&i),"click"===t&&(i=!1!==r.navigateCards(1)&&i),i}),null,null)),i.yb(8,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(9,{"icon-button--disabled ms-fcl-nta":0,"ms-fcl-ns":1,"icon-button--fluent":2}),i.yb(10,4210688,null,0,o.a,[i.l,i.D,a.b],null,null),(e()(),i.zb(11,0,null,null,1,"ohp-icon-font",[["cssClass","carousel-nav__arrow"],["iconFontName","ChevronRight"],["size","16"]],null,null,null,l.b,l.a)),i.yb(12,638976,null,0,s.a,[c.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){var n=t.component,i=e(t,3,0,0===n.currentCarouselPage,0!==n.currentCarouselPage,!n.fluentRefresh,n.fluentRefresh);e(t,2,0,"icon-button ms-bgc-g40-h ms-fcl-nd-h",i),e(t,6,0,"carousel-nav__arrow","ChevronLeft","16",!0);var r=e(t,9,0,n.currentCarouselPage+n.cardIncrement>=n.cards.length,n.currentCarouselPage+n.cardIncrement<n.cards.length,n.fluentRefresh);e(t,8,0,"icon-button ms-bgc-g40-h ms-fcl-nd-h",r),e(t,12,0,"carousel-nav__arrow","ChevronRight","16",!0)}),(function(e,t){var n=t.component;e(t,1,0,n.previousPage,n.previousPage,0===n.currentCarouselPage,0===n.currentCarouselPage?-1:0),e(t,7,0,n.nextPage,n.nextPage,n.currentCarouselPage+n.cardIncrement>=n.cards.length,n.currentCarouselPage+n.cardIncrement>=n.cards.length?-1:0)}))}function Ce(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,5,"div",[],null,null,null,null,null)),i.yb(1,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(2,{"carousel-card--hidden":0,"carousel-card--display-none":1,"carousel-card-container":2,"carousel-card--peek":3,"carousel-card--peek--fluent":4,"carousel-card-container--suggested-actions":5}),(e()(),i.zb(3,0,null,null,2,"ohp-mru-item",[],null,[[null,"deleteItem"]],(function(e,t,n){var i=!0;return"deleteItem"===t&&(i=!1!==e.component.onDeleteRecommendedItem(n)&&i),i}),u.b,u.a)),i.Tb(512,null,d.a,d.a,[p.a,h.a,f.a,m.a,b.a,v.a,g.b]),i.yb(5,770048,null,0,y.a,[S.a,c.a,g.b,w.a,h.a,C.a,I.b,T.a,k.b,b.a,A.a,P.a,p.a,E.a,_.a,d.a,O.a,F.a,D.a,M.a,R.b,i.D,x.a,L.b,N.a,U.a,W.a,B.a,z.a,j.a,H.a,V.b,q.a,G.a,Z.a,Q.a,K.b],{item:[0,"item"],index:[1,"index"],relativeIndex:[2,"relativeIndex"],view:[3,"view"],listId:[4,"listId"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"]},{deleteItem:"deleteItem"})],(function(e,t){var n=t.component,i=e(t,2,0,"moving"!==n.motionState&&t.context.index<n.currentCarouselPage,"moving"!==n.motionState&&t.context.index>n.currentCarouselPage+n.cardIncrement,!n.isSuggestedActions,!n.isSuggestedActions&&!n.fluentRefresh,n.isFluentRecommended,n.isSuggestedActions);e(t,1,0,i),e(t,5,0,t.context.$implicit,t.context.index,t.context.index,n.recommendedDocView,n.listId,n.showActivity,n.showSharing,n.showAnalytics,n.fileType)}),null)}function Ie(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Ce)),i.yb(2,278528,null,0,r.j,[i.O,i.L,i.s],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,n.recommendedMotionList,n.trackByIndex)}),null)}function Te(e){return i.bc(0,[(e()(),i.zb(0,0,[[5,0],["virtualCard",1]],null,3,"div",[["class","carousel-card-container carousel-card--virtual-touch"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,2,"ohp-mru-item",[],null,[[null,"deleteItem"]],(function(e,t,n){var i=!0;return"deleteItem"===t&&(i=!1!==e.component.onDeleteRecommendedItem(n)&&i),i}),u.b,u.a)),i.Tb(512,null,d.a,d.a,[p.a,h.a,f.a,m.a,b.a,v.a,g.b]),i.yb(3,770048,null,0,y.a,[S.a,c.a,g.b,w.a,h.a,C.a,I.b,T.a,k.b,b.a,A.a,P.a,p.a,E.a,_.a,d.a,O.a,F.a,D.a,M.a,R.b,i.D,x.a,L.b,N.a,U.a,W.a,B.a,z.a,j.a,H.a,V.b,q.a,G.a,Z.a,Q.a,K.b],{item:[0,"item"],index:[1,"index"],relativeIndex:[2,"relativeIndex"],view:[3,"view"],listId:[4,"listId"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"]},{deleteItem:"deleteItem"})],(function(e,t){var n=t.component;e(t,3,0,t.context.$implicit,t.context.index+n.currentCarouselPage,t.context.index,n.recommendedDocView,n.listId,n.showActivity,n.showSharing,n.showAnalytics,n.fileType)}),null)}function ke(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,5,null,null,null,null,null,null,null)),(e()(),i.zb(1,0,null,null,4,"cdk-virtual-scroll-viewport",[["class","virtual-scroll-cards cdk-virtual-scroll-viewport"],["orientation","horizontal"]],[[2,"cdk-virtual-scroll-orientation-horizontal",null],[2,"cdk-virtual-scroll-orientation-vertical",null]],null,null,Y.b,Y.a)),i.Tb(6144,null,J.b,null,[J.d]),i.yb(3,245760,null,0,J.d,[i.l,i.h,i.z,[2,J.h],[2,X.c],J.f,[2,J.i]],{orientation:[0,"orientation"]},null),(e()(),i.ib(16777216,null,0,1,null,Te)),i.yb(5,409600,null,0,J.c,[i.O,i.L,i.s,[1,J.d],i.z],{cdkVirtualForOf:[0,"cdkVirtualForOf"],cdkVirtualForTrackBy:[1,"cdkVirtualForTrackBy"]},null)],(function(e,t){var n=t.component;e(t,3,0,"horizontal"),e(t,5,0,n.cards,n.trackByIndex)}),(function(e,t){e(t,1,0,"horizontal"===i.Ob(t,3).orientation,"horizontal"!==i.Ob(t,3).orientation)}))}function Ae(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,"div",[["class","carousel-card-container carousel-card--desktop"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,2,"ohp-mru-item",[],null,[[null,"deleteItem"]],(function(e,t,n){var i=!0;return"deleteItem"===t&&(i=!1!==e.component.onDeleteRecommendedItem(n)&&i),i}),u.b,u.a)),i.Tb(512,null,d.a,d.a,[p.a,h.a,f.a,m.a,b.a,v.a,g.b]),i.yb(3,770048,null,0,y.a,[S.a,c.a,g.b,w.a,h.a,C.a,I.b,T.a,k.b,b.a,A.a,P.a,p.a,E.a,_.a,d.a,O.a,F.a,D.a,M.a,R.b,i.D,x.a,L.b,N.a,U.a,W.a,B.a,z.a,j.a,H.a,V.b,q.a,G.a,Z.a,Q.a,K.b],{item:[0,"item"],index:[1,"index"],relativeIndex:[2,"relativeIndex"],view:[3,"view"],listId:[4,"listId"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"],leftAlignActionsMenu:[9,"leftAlignActionsMenu"]},{deleteItem:"deleteItem"})],(function(e,t){var n=t.component;e(t,3,0,t.context.$implicit,t.context.index+n.currentCarouselPage,t.context.index,n.recommendedDocView,n.listId,n.showActivity,n.showSharing,n.showAnalytics,n.fileType,n.isAntpExperience&&t.context.index!==n.cardIncrement-1)}),null)}function Pe(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,2,null,Ae)),i.yb(2,278528,null,0,r.j,[i.O,i.L,i.s],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),i.Qb(0,r.r,[]),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,i.Zb(t,2,0,i.Ob(t,3).transform(n.cards,n.currentCarouselPage,n.currentCarouselPage+n.cardIncrement)),n.trackByIndex)}),null)}function Ee(e){return i.bc(0,[i.Ub(671088640,1,{carouselElement:0}),i.Ub(671088640,2,{carouselContainer:0}),i.Ub(671088640,3,{recommendedNavLeft:0}),i.Ub(671088640,4,{recommendedNavRight:0}),i.Ub(671088640,5,{virtualCards:1}),(e()(),i.zb(5,0,null,null,1,"ohp-title-announcer",[],null,null,null,$.b,$.a)),i.yb(6,49152,null,0,ee.a,[],{announcement:[0,"announcement"]},null),(e()(),i.zb(7,0,[[2,0],["carouselContainer",1]],null,24,"div",[["class","carousel"]],[[8,"hidden",0],[24,"@fadeIn",0],[24,"@.disabled",0],[1,"aria-label",0]],null,null,null,null)),i.yb(8,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(9,{"recommended--antp":0,"carousel--fluent":1}),(e()(),i.zb(10,0,null,null,6,"div",[],null,null,null,null,null)),i.yb(11,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(12,{"list-header--carousel--motion":0,"list-header list-header--carousel":1,"list-header--fluent":2}),(e()(),i.ib(16777216,null,null,1,null,Se)),i.yb(14,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,we)),i.yb(16,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(17,0,null,null,14,"div",[],null,null,null,null,null)),i.yb(18,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(19,{"carousel--outer carousel--virtual-outer":0,"recommended-container__motion":1,"recommended-container__motion--suggested-actions":2,"recommended-container__motion--hidden":3,"recommended-container__gap":4}),(e()(),i.zb(20,0,[[1,0],["carouselElement",1]],null,11,"div",[],[[24,"@recommendedMotionTrigger",0]],[[null,"ohpResize"],[null,"@recommendedMotionTrigger.done"]],(function(e,t,n){var i=!0,r=e.component;return"ohpResize"===t&&(i=!1!==r.updateCarouselCardData()&&i),"@recommendedMotionTrigger.done"===t&&(i=!1!==r.recommendedMotionDone()&&i),i}),null,null)),i.yb(21,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(22,{"carousel--inner":0,"generic-tile-container generic-tile-container--card card__content":1,"recommended-inner__motion":2,"recommended-inner__motion--suggested-actions":3,"generic-tile-container--card--suggested-actions":4}),i.yb(23,4407296,null,0,te.a,[ne.a,i.l,ie.a],null,{resize:"ohpResize"}),i.Rb(24,{translationParam:0}),i.Rb(25,{value:0,params:1}),(e()(),i.ib(16777216,null,null,1,null,Ie)),i.yb(27,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,ke)),i.yb(29,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Pe)),i.yb(31,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,6,0,n.statusAnnouncement);var i=e(t,9,0,n.isAntpExperience,n.fluentRefresh);e(t,8,0,"carousel",i);var r=e(t,12,0,n.recommendedMotion,!n.fluentRefresh,n.fluentRefresh);e(t,11,0,r),e(t,14,0,n.cards&&n.cards.length>0),e(t,16,0,n.cards&&!n.canSwipeRecommended&&!(0===n.currentCarouselPage&&n.currentCarouselPage+n.cardIncrement>=n.cards.length));var o=e(t,19,0,n.canSwipeRecommended,n.recommendedMotion,n.recommendedMotion&&n.isSuggestedActions,"moving"===n.motionState,n.recommendedMotion||n.fluentRefresh);e(t,18,0,o);var a=e(t,22,0,n.canSwipeRecommended,!n.canSwipeRecommended&&!n.recommendedMotion,n.recommendedMotion,n.recommendedMotion&&n.isSuggestedActions,!n.recommendedMotion&&!n.canSwipeRecommended&&n.isSuggestedActions);e(t,21,0,a),e(t,23,0),e(t,27,0,n.recommendedMotion),e(t,29,0,n.canSwipeRecommended),e(t,31,0,!n.canSwipeRecommended&&!n.recommendedMotion)}),(function(e,t){var n=t.component;e(t,7,0,!n.cards||!n.cards.length,void 0,n.disableAnimation,n.recommendedTitle);var i=e(t,25,0,n.motionState,e(t,24,0,n.translateX));e(t,20,0,i)}))}i.vb("ohp-recommended",ce.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"ohp-recommended",[],null,null,null,Ee,ye)),i.Tb(4608,null,J.h,se,[b.a]),i.yb(2,8634368,null,0,ce.a,[c.a,i.h,ue.a,h.a,de.a,pe.b,R.b,he.a,fe.a,D.a,E.a,I.b,p.a,T.a,A.a,me.a,b.a,be.a,ve.a,ge.b,O.a,g.b,V.b],null,null)],(function(e,t){e(t,2,0)}),null)}),{carousel:"carousel",navClickLogging:"navClickLogging",fourCardsMax:"fourCardsMax",isSuggestedActions:"isSuggestedActions",fileType:"fileType",isStartPage:"isStartPage"},{stateChanged:"stateChanged"},[]);var _e=n("7IJ8"),Oe=n("QhWD"),Fe=n("casz"),De=n("RsrG"),Me=n("WLAd"),Re=n("OOtI"),xe=n("+YV+"),Le=n("9MHL"),Ne=n("JScD"),Ue=n("mNaV"),We=i.xb({encapsulation:2,styles:[],data:{}});function Be(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"ohp-recommended",[],null,null,null,Ee,ye)),i.Tb(4608,null,J.h,se,[b.a]),i.yb(2,8634368,null,0,ce.a,[c.a,i.h,ue.a,h.a,de.a,pe.b,R.b,he.a,fe.a,D.a,E.a,I.b,p.a,T.a,A.a,me.a,b.a,be.a,ve.a,ge.b,O.a,g.b,V.b],{isSuggestedActions:[0,"isSuggestedActions"],fileType:[1,"fileType"],isStartPage:[2,"isStartPage"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.isSuggestedActions,n.fileType,!!n.fileType)}),null)}function ze(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,_e.a,[Oe.a,i.O,pe.b,g.b,Fe.a,De.a,ie.a,i.z,Me.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{fileType:0}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.fileType);e(t,1,0,"recommended-react#RecommendedReactModule",n)}),null)}function je(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Be)),i.yb(2,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,ze)),i.yb(4,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,!n.recommendedReact),e(t,4,0,n.recommendedReact)}),null)}function He(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,_e.a,[Oe.a,i.O,pe.b,g.b,Fe.a,De.a,ie.a,i.z,Me.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"],outputs:[2,"outputs"]},null),i.Rb(2,{headless:0,recentMruStreamData:1,fileType:2,maxInitialDocs:3,maxTotalDocs:4}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.headless,n.recentMruStream,n.fileType,n.maxInitialDocs,n.maxTotalDocs);e(t,1,0,"mru#MruModule",i,n.mruOutputs)}),null)}function Ve(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,_e.a,[Oe.a,i.O,pe.b,g.b,Fe.a,De.a,ie.a,i.z,Me.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{fileType:0,folderName:1}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.fileType,n.spacesFolder);e(t,1,0,"edgeworth#EdgeworthModule",i)}),null)}function qe(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,_e.a,[Oe.a,i.O,pe.b,g.b,Fe.a,De.a,ie.a,i.z,Me.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"quick-access#QuickAccessReactModule")}),null)}function Ge(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,_e.a,[Oe.a,i.O,pe.b,g.b,Fe.a,De.a,ie.a,i.z,Me.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{fileType:0}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.fileType);e(t,1,0,"ew-react#EdgeworthReactModule",n)}),null)}function Ze(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,15,"div",[["class","mru-section section--fluent"],["id","mru-section"],["role","region"]],[[1,"aria-label",0]],null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"h2",[["class","visually-hidden"]],null,null,null,null,null)),(e()(),i.Yb(2,null,["",""])),(e()(),i.zb(3,0,null,null,12,"div",[],null,null,null,null,null)),i.yb(4,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(5,{"width-restrictor width-restrictor--responsive":0,"width-restrictor--no-gutter":1}),(e()(),i.ib(16777216,null,null,1,null,je)),i.yb(7,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,He)),i.yb(9,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Ve)),i.yb(11,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,qe)),i.yb(13,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Ge)),i.yb(15,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,5,0,!(n.isAntpExperience||n.noGutter),n.noGutter);e(t,4,0,i),e(t,7,0,!n.isAntpExperience&&!n.spacesFolder),e(t,9,0,(n.initialDocsAvailable||n.showZeroExperience)&&!n.edgeworthEnabled),e(t,11,0,n.edgeworthEnabled&&!n.edgeworthReactEnabled&&!n.quickAccessEnabled),e(t,13,0,n.edgeworthEnabled&&n.quickAccessEnabled),e(t,15,0,n.edgeworthEnabled&&n.edgeworthReactEnabled&&!n.quickAccessEnabled)}),(function(e,t){var n=t.component;e(t,0,0,n.sectionLandmarkAriaLabel),e(t,2,0,n.sectionLandmarkAriaLabel)}))}function Qe(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","mru-component"]],null,null,null,null,null)),i.yb(1,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"section--first":0}),(e()(),i.ib(16777216,null,null,1,null,Ze)),i.yb(4,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.firstSection&&(!n.leftNavReact||n.isConsumer));e(t,1,0,"mru-component",i),e(t,4,0,n.initialDocsAvailable||n.showZeroExperience||n.hasRecommendedDocs||n.edgeworthEnabled)}),null)}i.vb("ohp-documents-component",Re.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-documents-component",[],null,null,null,Qe,We)),i.yb(1,245760,null,0,Re.a,[c.a,b.a,E.a,p.a,G.a,O.a,xe.a,ue.a,Le.a,Ne.a,g.b,g.b,Ue.a,h.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{firstSection:"firstSection",fileType:"fileType",headless:"headless",maxInitialDocs:"maxInitialDocs",maxTotalDocs:"maxTotalDocs",isSuggestedActions:"isSuggestedActions"},{mruStateChanged:"mruStateChanged"},[])},R0N1:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("/I02");var i=function(){function e(e){this.contextService=e}return e.prototype.ngOnInit=function(){this.target=this.contextService.sharedContext.defaultLinkTarget},e}()},R4AA:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("BMb5"),r=n("keVe"),o=function(){function e(e){this.windowService=e,this.ntpApi=this.windowService.nativeWindow.chrome&&this.windowService.nativeWindow.chrome.embeddedSearch&&this.windowService.nativeWindow.chrome.embeddedSearch.newTabPage}return e.prototype.isAvailable=function(){return!!this.ntpApi},e.prototype.logHistogram=function(e){return!!this.ntpApi&&(this.ntpApi.logEvent(e),!0)},e.prototype.isDarkMode=function(){return this.ntpApi&&this.ntpApi.themeBackgroundInfo&&this.ntpApi.themeBackgroundInfo.isNtpBackgroundDark},e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.b))},token:e,providedIn:"root"}),e}()},R7NL:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n("bb6g"),r=n("9h0M"),o=n("ciUQ"),a=n("+2OL"),l=n("Ft/N"),s=n("JWB6"),c=n("3GGT"),u=n("wwmn"),d=n("Uqr9"),p=n("BMb5"),h=n("cgnd"),f=n("/I02"),m=n("hhzZ"),b=n("keVe"),v=n("5MEU"),g=function(){function e(e){this.promise=e}return Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return"Promise"},enumerable:!0,configurable:!0}),e.prototype.instrument=function(e){return this.instrumentCallback=e,this},e.prototype.then=function(e,t){return this.promise.then(e,t)},e.prototype.catch=function(e){return this.promise.catch(e)},e.prototype.finally=function(e){return this.promise.finally(e)},e}(),y=function(){function e(e,t,n,i,r,o,a,l,s){this.httpClient=e,this.contextService=t,this.startupConfigService=n,this.instrumentationService=i,this.windowService=r,this.serviceWorkerStateService=a,this.serviceWorkerConfigService=l,this.workloadQueryParameterValue=s,this.officeHomeApiConfig=o.config}return e.prototype.request=function(t,n,i,a,l,s,u){var p=this,h=d.a.now(),f=0,b="cache-only"===i,v=new Promise((function(t,d){if(b){var h=p.serviceWorkerConfigService.config.enabled;if(!h||"Controlled"!==p.serviceWorkerStateService.currentState)return void d(e.failedResponseWithCode(c.a.NotImplemented,n,b,"Cache is not available. Service Worker is in "+(h?p.serviceWorkerStateService.currentState:"disabled")+" state"))}p.prepareRequest(n,i);var f={};n.headers&&n.headers.forEach((function(e,t){f[t]=e}));var m=!!a||!!l,v=m?"events":"response",g={headers:new r.i(f),params:new r.j({fromObject:n.params}),method:n.method,reportProgress:m,responseType:n.responseType,observe:v},y=new r.k(n.method,n.url,n.body,g),S=function(e){var t;return e instanceof r.l?t=e.body:e instanceof r.f&&(t=e.error),{data:t,status:e.status,headers:e.headers,config:n,ok:e.ok,statusText:e.statusText,fromCache:b}},w=p.httpClient.request(y).pipe(Object(o.a)(u||p.officeHomeApiConfig.defaultTimeoutInMs)).subscribe((function(e){e instanceof r.l?t(S(e)):e.type===r.g.UploadProgress&&a?a(e):e.type===r.g.DownloadProgress&&l&&l(e)}),(function(t){if("TimeoutError"!==t.name){var i=p.windowService.nativeWindow.navigator;d(!i||"boolean"!=typeof i.onLine||i.onLine?S(t):e.failedResponseWithCode(c.a.Offline,n,b))}else d(e.failedResponseWithCode(c.a.Timeout,n,b))}));s&&s.onCancel((function(){return w.unsubscribe()}))})),y=new g(v),S=function(n){if(!n.fromCache||n.ok||n.status!==c.a.NotImplemented){f=Math.ceil(d.a.now()-h);var i=n.status;null==i&&(i=e.unknownStatusCode);var r,o=n.statusText;r=null==o?e.unknownError:"ok"===o.toLowerCase()?o:new m.d(o);var a=p.instrumentationService.generateRequestEvent(t,i,f,r,n.fromCache);y.instrumentCallback&&y.instrumentCallback(n,a),a.record()}},w=s?s.onCancel((function(){return Promise.resolve(e.failedResponseWithCode(c.a.Cancelled,n,b))})):new Promise((function(){}));return Promise.race([v,w]).then(S,S),y},e.prototype.get=function(e,t,n,r,o,a,l){var s=Object(i.__assign)({},n);return s.url=t,s.method="GET",this.request(e,s,r,null,o,a,l)},e.prototype.post=function(e,t,n,r,o,a,l,s,c){void 0===r&&(r={});var u=Object(i.__assign)({},r);return u.url=t,u.method="POST",u.body=n,this.request(e,u,c||"network-only",o,a,l,s)},e.prototype.put=function(e,t,n,r,o,a,l,s){void 0===r&&(r={});var c=Object(i.__assign)({},r);return c.url=t,c.method="PUT",c.body=n,this.request(e,c,"network-only",o,a,l,s)},e.prototype.delete=function(e,t,n,r,o,a){void 0===r&&(r={});var l=Object(i.__assign)({},r);return l.url=t,l.method="DELETE",l.body=n,this.request(e,l,"network-only",null,null,o,a)},e.prototype.patch=function(e,t,n,r,o,a,l,s){void 0===r&&(r={});var c=Object(i.__assign)({},r);return c.url=t,c.method="PATCH",c.body=n,this.request(e,c,"network-only",o,a,l,s)},e.failedResponseWithCode=function(e,t,n,i){return{data:null,status:e,headers:new r.i,config:t,ok:!1,statusText:i||c.a[e],fromCache:n}},e.prototype.prepareRequest=function(e,t){var n=this;if("Controlled"===this.serviceWorkerStateService.currentState&&this.serviceWorkerConfigService.config.enabled&&(e.headers?e.headers.forEach((function(t,i){if(void 0===t){e.headers.set(i,"");var r={ItemCategory:"Malformed Request"};r.Error="Undefined header passed to Service Worker: "+i,n.instrumentationService.logGenericEvent("Unhandled_Exception",r)}})):e.headers=new Map,e.headers.set(l.a,t)),0===e.url.lastIndexOf(this.contextService.sharedContext.officeHomeApiRoot+"/",0)){e.headers||(e.headers=new Map);var i=this.officeHomeApiConfig,r=this.startupConfigService.config;i.correlationIdHeader&&r.sharedClientStartupContext.correlationId&&e.headers.set(i.correlationIdHeader,r.sharedClientStartupContext.correlationId),i.userIdHeader&&r.puid&&e.headers.set(i.userIdHeader,r.puid),i.tenantIdHeader&&r.tenantId&&e.headers.set(i.tenantIdHeader,r.tenantId),i.authTypeHeader&&r.authTypeString&&e.headers.set(i.authTypeHeader,r.authTypeString),i.authVersionHeader&&r.authVersion&&e.headers.set(i.authVersionHeader,r.authVersion),e.params||(e.params={}),i.workloadQueryParameter&&(e.params[i.workloadQueryParameter]=this.workloadQueryParameterValue),r.sharedClientStartupContext.testTraffic&&i.testTrafficHeader&&e.headers.set(i.testTrafficHeader,"1"),!r.sharedClientStartupContext.corpNet&&i.externalTrafficHeader&&e.headers.set(i.externalTrafficHeader,"1"),(i.flightOverridesParamName&&i.flightOverrides||i.featureOverridesParamName&&i.featureOverrides)&&(i.flightOverridesParamName&&i.flightOverrides&&!e.params.hasOwnProperty(i.flightOverridesParamName)&&(e.params[i.flightOverridesParamName]=i.flightOverrides),i.featureOverridesParamName&&i.featureOverrides&&!e.params.hasOwnProperty(i.featureOverridesParamName)&&(e.params[i.featureOverridesParamName]=i.featureOverrides))}},e.unknownError="NotAvailable",e.unknownStatusCode=-1,e.ɵprov=b.cc({factory:function(){return new e(b.dc(r.c),b.dc(f.a),b.dc(h.b),b.dc(m.a),b.dc(p.b),b.dc(u.a),b.dc(s.a),b.dc(a.a),b.dc(v.a))},token:e,providedIn:"root"}),e}()},RJiy:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var i=n("lrJm"),r=n("hhzZ"),o=n("R7NL"),a=n("QOOv"),l=n("7ma0"),s=n("kpuN"),c=n("wwmn"),u=n("casz"),d=n("ZtId"),p=n("BMb5"),h=n("4/We"),f=n("cgnd"),m=n("/I02"),b=n("9260"),v=n("keVe"),g=n("TOqr"),y=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,h){this.recommendedDataService=new b.a(e,t,n,i,r,o,a,l,s,c,u,d,p,h)}return e.prototype.getRecommendedService=function(){return this.recommendedDataService},e.ɵprov=v.cc({factory:function(){return new e(v.dc(s.b),v.dc(h.a),v.dc(m.a),v.dc(r.a),v.dc(o.a),v.dc(a.a),v.dc(c.a),v.dc(g.q),v.dc(i.b),v.dc(f.b),v.dc(d.a),v.dc(u.a),v.dc(p.b),v.dc(l.a))},token:e,providedIn:"root"}),e}(),S=function(){function e(){}return e.ɵprov=v.cc({factory:function(){return function(e){return e.getRecommendedService()}(v.dc(y))},token:e,providedIn:"root"}),e}()},"RR/o":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return p}));var i,r=n("bb6g"),o=n("kaEK"),a=n("BaAg"),l=n("o2Lt"),s=n("pOWU"),c=n("CVeG"),u=n("oAX+"),d=n("OyI4");!function(e){e[e.Default=0]="Default",e[e.FrequentlyOpen=1]="FrequentlyOpen",e[e.RecentlyOpen=2]="RecentlyOpen",e[e.WeeklyOpen=3]="WeeklyOpen",e[e.SingleEditYou=4]="SingleEditYou",e[e.MultipleEditYouAndOthers=5]="MultipleEditYouAndOthers",e[e.SingleCommentYou=6]="SingleCommentYou",e[e.MultipleCommentYouAndOthers=7]="MultipleCommentYouAndOthers",e[e.CommentReplyYou=8]="CommentReplyYou",e[e.SharedWithMe=9]="SharedWithMe",e[e.EmailAttachment=10]="EmailAttachment",e[e.SingleMentionYou=11]="SingleMentionYou",e[e.MultipleMentionYouAndOthers=12]="MultipleMentionYouAndOthers",e[e.CommentReplyOthers=13]="CommentReplyOthers",e[e.SnoozeExpiry=14]="SnoozeExpiry",e[e.CommentReplyToYou=15]="CommentReplyToYou",e[e.SingleEditOthers=16]="SingleEditOthers",e[e.MultipleEditOthers=17]="MultipleEditOthers",e[e.SingleCommentOthers=18]="SingleCommentOthers",e[e.MultipleCommentOthers=19]="MultipleCommentOthers",e[e.SingleMentionOthers=20]="SingleMentionOthers",e[e.MultipleMentionOthers=21]="MultipleMentionOthers",e[e.Trending=22]="Trending",e[e.Meeting=23]="Meeting",e[e.PeakMoment=24]="PeakMoment",e[e.HighEngagement=25]="HighEngagement",e[e.SingleMentionedYou=26]="SingleMentionedYou",e[e.MultipleMentionedYou=27]="MultipleMentionedYou",e[e.SingleTaskActivityByYou=28]="SingleTaskActivityByYou",e[e.MultipleTaskActivityByYou=29]="MultipleTaskActivityByYou",e[e.SingleTaskActivityByOthers=30]="SingleTaskActivityByOthers",e[e.MultipleTaskActivityByOthers=31]="MultipleTaskActivityByOthers",e[e.SingleTaskActivityYouAssignee=32]="SingleTaskActivityYouAssignee",e[e.MultipleTaskActivityYouAssignee=33]="MultipleTaskActivityYouAssignee",e[e.SingleTaskActivityYouCreator=34]="SingleTaskActivityYouCreator",e[e.MultipleTaskActivityYouCreator=35]="MultipleTaskActivityYouCreator"}(i||(i={}));var p=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p,h,f,m,b,v){var g=e.call(this,t,n,i,r,o,l,s,c,u,"v2/recent",l.config.supportedFileTypes,h)||this;return g.userContextService=a,g.mruConfigService=l,g.performanceService=d,g.updateContentService=p,g.windowService=f,g.capabilitiesService=m,g.urlAuthenticatorService=b,g.deviceDetector=v,g.fetchRequestIndex=0,g.mruDataStreams=new Map,g.windowService=f,g}return Object(r.__extends)(t,e),t.convertMruActivityToActivityDescription=function(e){for(var n=e.badge.message_format,i=null,r=function(){var t=i[1];n=n.replace(i[0],(function(){return"<c"+t+">"+e.badge.users[t].display_name+"</c"+t+">"}))};null!==(i=t.activityRegex.exec(n));)r();return{formatString:n,plainText:c.a.stripTags(n),people:(e.badge.users||[]).map((function(e,t){return{upn:e.upn,tag:"c"+t,name:e.display_name}})),reasonType:t.convertMruReasonTypeToActivityReason(e.badge.type),timestamp:e.badge.timestamp?new Date(e.badge.timestamp):null}},t.convertMruReasonTypeToActivityReason=function(e){switch(e){case i.FrequentlyOpen:case i.RecentlyOpen:case i.WeeklyOpen:return o.a.Open;case i.SingleEditYou:case i.MultipleEditOthers:case i.MultipleEditYouAndOthers:case i.SingleEditOthers:return o.a.Edit;case i.SingleCommentYou:case i.SingleCommentOthers:case i.MultipleCommentOthers:case i.MultipleCommentYouAndOthers:case i.CommentReplyYou:case i.CommentReplyOthers:case i.CommentReplyToYou:return o.a.Comment;case i.SharedWithMe:return o.a.Share;case i.EmailAttachment:return o.a.Attachment;case i.SingleMentionYou:case i.MultipleMentionYouAndOthers:case i.SingleMentionOthers:case i.MultipleMentionOthers:case i.SingleMentionedYou:case i.MultipleMentionedYou:return o.a.Mention;case i.SnoozeExpiry:return o.a.SnoozeExpiry;case i.Trending:case i.PeakMoment:case i.HighEngagement:return o.a.Trending;case i.Meeting:return o.a.Meeting;case i.SingleTaskActivityByYou:case i.MultipleTaskActivityByYou:case i.SingleTaskActivityByOthers:case i.MultipleTaskActivityByOthers:case i.SingleTaskActivityYouAssignee:case i.MultipleTaskActivityYouAssignee:case i.SingleTaskActivityYouCreator:case i.MultipleTaskActivityYouCreator:return o.a.Task;default:return o.a.Default}},t.prototype.getMruDocuments=function(e){var n,i=this,r=this.getUrl(e),o=!(!e||!e.size);if(this.mruDataStreams.has(r))return this.mruDataStreams.get(r);o&&this.mostRecentUnfilteredDocs&&this.mostRecentUnfilteredDocs.items&&(n=this.mostRecentUnfilteredDocs.items.filter((function(t){return e.has(a.a.fileTypeNameToFileType(t.FileType))})));var l=n&&n.length?Promise.resolve({items:n,impressionId:t.mruPlusPlusV2ImpressionId,fromCache:!0}):this.fetchMru(r,"cache-only",o),s=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchMru(o,r):this.fetchMru(r,"network-first",o),c=this.updateContentService.getOrAddUpdateStream(this.getUpdateStreamKey(r),(function(){return i.fetchMru(r,"network-first",o)})),d=u.a.createResultsWithCacheObservable(l,s,c,(function(e){return i.mruDataStreams.delete(r)}),{items:[],impressionId:t.mruPlusPlusV2ImpressionId,fromCache:!1});if(this.mruDataStreams.set(r,d),this.mruConfigService.config.silentS2SFlow){var p=this.getS2SUrl(e);this.fetchMru(p,"network-only",o,!0)}return d},t.prototype.updateMruDocuments=function(e){return this.updateContentService.pushUpdate(this.getUpdateStreamKey(this.getUrl(e)))},t.prototype.removeDocument=function(e){var t=this;return new Promise((function(n,i){t.delete("Mru_Delete",t.serviceBaseUrl,{category:e.Category,type:e.MruV2Type,app:e.Application,mru_id:e.MruId,url:e.Url},(function(e){e.instrument((function(e,n){n.params.RequestId=t.getRequestIdFromResponse(e)})).then((function(){return n(null)}))}),i,t.getNewRequestConfig(!0))}))},t.prototype.updatePinnedState=function(e){var t=this;return new Promise((function(n,i){t.post("Mru_Update_Pin",t.serviceBaseUrl,{category:e.Category,type:e.MruV2Type,app:e.Application,mru_id:e.MruId,url:e.Url,is_pinned:e.IsPinned},(function(e){e.instrument((function(e,n){n.params.RequestId=t.getRequestIdFromResponse(e)})).then((function(){return n(null)}))}),i,t.getNewRequestConfig(!0))}))},t.prototype.writeMruDocument=function(e){var t=this;return new Promise((function(n,i){var r={category:e.Category,type:e.MruV2Type,app:e.Application,mru_id:e.MruId,url:e.Url,extension:a.a.getFileExtensionFromUrl(e.Url),title:e.Title,onedrive_info:{drive_id:e.DriveId,item_id:e.DocId}};t.post("Mru_Write",t.serviceBaseUrl,r,(function(e){e.instrument((function(e,n){n.params.RequestId=t.getRequestIdFromResponse(e)})).then((function(){return n(null)}))}),i,t.getNewRequestConfig(!0))}))},t.prototype.handleQueryParam=function(e,t,n){"mockmru"===e&&this.mockRequestHeader&&n.headers.set(this.mockRequestHeader,t)},t.prototype.isAuthError=function(t){return e.prototype.isAuthError.call(this,t)||-1===t},t.isPwaProject=function(e){return e.meta_data&&"PJO"===e.meta_data.type&&e.app.toLowerCase()===a.b[a.b.Project].toLowerCase()},t.fileType=function(e){var t=a.a.fileTypeFromExtension(e.extension);return t&&t!==a.b.None||(t="Project"===e.app&&e.meta_data&&"ProjectOperations"===e.meta_data.type?a.b.ProjectOperations:a.a.fileTypeNameToFileType(e.app)),t},t.prototype.getUrl=function(e){if(this.startupConfigService.config.sharedClientStartupContext.useMruS2SFlow)return this.getS2SUrl(e);var t=this.requestParams(this.mruConfigService.config.mruNumItemsToRequest,e);return this.serviceBaseUrl+"/docs?"+t},t.prototype.getS2SUrl=function(e){var t=this.requestParams(this.mruConfigService.config.mruNumItemsToRequest,e);return this.contextService.sharedContext.officeHomeApiRoot+"/api/mru?"+t},t.prototype.getUpdateStreamKey=function(e){return"mruplusplusv2-"+e},t.prototype.fetchMru=function(e,n,i,r){var o=this;return void 0===r&&(r=!1),new Promise((function(l,c){var u,d,p;o.userContextService.user.mruAvailable?(o.startupConfigService.config.sharedClientStartupContext.useMruS2SFlow||r?(u="None",d={},p="Mru_S2S_Request"):(u="MruPlusPlus",d=o.getNewRequestConfig(!1),p="Mru_Request"),o.get(p,e,(function(n){n.instrument((function(n,i){i.params.RequestId=o.getRequestIdFromResponse(n),i.params.Index=(o.fetchRequestIndex++).toString(),i.params.ImpressionId=t.mruPlusPlusV2ImpressionId;var r=n.headers;r&&(i.params.PartnerGeo=r.get("X-OfficeCluster")),n.data&&n.data.diagnostics_data&&void 0!==n.data.diagnostics_data.total_duration&&(i.params.MruDuration=n.data.diagnostics_data.total_duration.toString());var l=o.performanceService.getResourceTimingEntries(e);if(l&&l.length){var s=l[l.length-1];s.workerStart&&s.responseStart&&(i.params.ServiceWorkerProcessingLatency=Math.ceil(s.responseStart-s.workerStart).toFixed())}if(n.ok&&n.data){var c=void 0,u=(c=n.data.documents&&n.data.documents.items?n.data.documents.items:[]).length;o.mruConfigService.config.mruPinEnabled&&o.mruConfigService.config.recommendedEnabled&&c.sort((function(e,t){return new Date(t.time_stamp).getTime()-new Date(e.time_stamp).getTime()})),i.params.ActualSize=u.toString(),i.params.Distribution=a.a.distributionFromFileTypes(c.map((function(e){return t.fileType(e)}))),i.params.MruPlusPlusV2MetaDataDistribution=c.map((function(e){return o.checkMetaData(e)?1:0})).toString(),o.mruConfigService.config.recommendedEnabled&&(i.params.ResourceIdDistribution=c.slice(0,12).map((function(e){return e.resource_id})).toString())}})).then((function(e){var t=e.data,n=e.fromCache;if(r)l();else{var a=o.processMruData(t,i,n);l(a)}})).catch((function(e){o.globalErrorHandler.handleError(e,"hJU2J")}))}),c,d,n,null,null,null,u)):c(new s.b(null,"User does not have an MRU"))}))},t.prototype.prefetchMru=function(e,t){var n=this;return this.windowService.nativeWindow.prefetchMruDataPromise?new Promise((function(t){n.windowService.nativeWindow.prefetchMruDataPromise.then((function(i){var r=n.processMruData(i,e,!1);t(r)})).catch((function(e){n.globalErrorHandler.handleError(e,"hJU2J")}))})):this.fetchMru(t,"network-first",e)},t.prototype.checkMetaData=function(e){return e.onedrive_info&&!!e.onedrive_info.drive_id&&!!e.onedrive_info.item_id&&e.creation_info&&!!e.creation_info.timestamp&&e.sharepoint_info&&!!e.sharepoint_info.site_url},t.prototype.mruItemFromMruPlusPlusV2Item=function(e){var n=this.mruConfigService.config,i=new Date(e.time_stamp),r=n.swayTransformedFromWordAttributionEnabled;e.onedrive_info=e.onedrive_info||{},e.sharepoint_info=e.sharepoint_info||{},e.creation_info=e.creation_info||{},e.meta_data=e.meta_data||{};var o={DriveId:e.onedrive_info.drive_id,ItemId:e.onedrive_info.item_id,CreatedByUserEmail:e.creation_info.user_info&&e.creation_info.user_info.upn,CreatedByUserName:e.creation_info.user_info&&e.creation_info.user_info.display_name,CreatedDate:e.creation_info.timestamp,SPListId:e.sharepoint_info.list_id,SPListItemUniqueId:e.sharepoint_info.list_item_unique_id,SPSiteId:e.sharepoint_info.site_id,SPSiteUrl:e.sharepoint_info.site_url,SPWebId:e.sharepoint_info.web_id,SwayMetaData:{ThumbnailId:e.meta_data.SwayThumbnail,IsTransformedFromWord:r&&!!e.meta_data.SwayIsTransformedFromWord&&"true"===e.meta_data.SwayIsTransformedFromWord.toString().toLowerCase()},FormsMetaData:{category:e.meta_data.category,form_type:e.meta_data.form_type,owner_id:e.meta_data.owner_id,owner_name:e.meta_data.owner_name,owner_tenant_id:e.meta_data.owner_tenant_id,owner_type:e.meta_data.owner_type,primary_color:e.meta_data.primary_color,background_image:e.meta_data.background_image},PowerBIMetaData:{breadcrumb_url:e.meta_data.breadcrumb_url}},l=n.mruActivityEnabled,s=e.service_info?e.service_info.friendly_service_name:"";s&&(e.display_path=e.display_path||[],e.display_path.unshift(s));var c=!1,u=t.fileType(e);return u!==a.b.MeetingNotes&&u!==a.b.Whiteboard||(c=!0),{DocId:o.ItemId,DriveId:o.DriveId,Extension:e.extension,FileName:e.title,Title:e.title,Url:c?e.web_url:e.url,WebUrl:e.web_url,LastAccessedTime:i,FileType:a.b[u],Provenance:a.c[a.c.OfficeMru],PathArray:e.display_path,IsPinned:e.is_pinned,Application:e.app,ResourceId:e.resource_id,Category:e.category,MruV2Type:e.type,MruId:e.mru_id,UrlAlreadyEncoded:!0,MetaData:o,Activity:e.activity_info&&l?t.convertMruActivityToActivityDescription(e.activity_info):void 0,Sharing:e.sharing_info&&l?e.sharing_info.state:void 0,LifecycleInfo:e.lifecycle_info&&l?!!e.lifecycle_info.flags:void 0,ServiceId:e.service_info?e.service_info.service_id:"",ServerDocId:e.server_doc_id}},t.prototype.convertToMruData=function(e,n){var i=this;void 0===n&&(n=!1);var r=(e.documents&&e.documents.items?e.documents.items:[]).filter((function(e){return("Sway"===e.app||"Portfolio"===e.app||"Project"===e.app||"Forms"===e.app||"Bohemia"===e.app||"Fluid"===e.app||"PowerBI"===e.app||-1===e.url.lastIndexOf("?"))&&!t.isPwaProject(e)})).map((function(e){return i.mruItemFromMruPlusPlusV2Item(e)})),o=this.deviceDetector.isMobileDevice()||this.deviceDetector.isTabletDevice();return r.forEach((function(e){a.b[e.FileType]===a.b.Forms&&(e.Url=i.urlAuthenticatorService.appendPvrAndUpnAuthParams(e.Url),o&&(e.Url=e.Url.replace(l.b,l.a)))})),r=r.filter((function(e){var t,n,i;return a.b[e.FileType]!==a.b.Forms||"survey"!==(null===(i=null===(n=null===(t=e.MetaData)||void 0===t?void 0:t.FormsMetaData)||void 0===n?void 0:n.form_type)||void 0===i?void 0:i.toLowerCase())})),this.mruConfigService.config.mruPinEnabled&&r.sort((function(e,t){return t.LastAccessedTime.getTime()-e.LastAccessedTime.getTime()})),{items:r,impressionId:t.mruPlusPlusV2ImpressionId,fromCache:n}},t.prototype.processMruData=function(e,t,n){void 0===n&&(n=!1);var i=this.convertToMruData(e,n);return t||(this.mostRecentUnfilteredDocs=i),i},t.mruPlusPlusV2ImpressionId="MruPlusPlusV2Impression",t.activityRegex=new RegExp("{([0-9]+)}"),t}(d.a)},RitX:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var i=n("keVe"),r=n("TOqr"),o=n("mu6k"),a=n("W3Zz"),l=n("hZW2"),s=n("PBJH"),c=n("BMb5"),u=i.xb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"openAndClose",definitions:[{type:1,expr:"* => openMobile",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{transform:"translate3d(0, 100%, 0)"},offset:null},{type:4,styles:{type:6,styles:{transform:"translate3d(0, 0, 0)"},offset:null},timings:"{{ slideDuration }} cubic-bezier(0.1, 0.9, 0.2, 1)"}],options:{params:{slideDuration:"300ms"}}},options:null},options:null},{type:1,expr:"* => open",animation:[{type:6,styles:{height:0},offset:null},{type:4,styles:{type:6,styles:{height:"*"},offset:null},timings:"300ms cubic-bezier(.1,.9,.2,1)"}],options:null},{type:1,expr:"open => closing",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:1},offset:null},{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDuration:"100ms"}}},options:null},options:null}],options:{}}]}});function d(e){return i.bc(0,[(e()(),i.ib(0,null,null,0))],null,null)}function p(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,2,null,d)),i.yb(2,540672,null,0,r.o,[i.O],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),i.Rb(3,{item:0,index:1}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,3,0,t.parent.context.$implicit,t.parent.context.index);e(t,2,0,i,n.menuItemTemplate)}),null)}function h(e){return i.bc(0,[(e()(),i.zb(0,0,[[2,0],["menuItem",1]],null,4,"li",[["tabindex","-1"]],[[8,"id",0],[1,"aria-label",0],[1,"aria-describedby",0],[1,"role",0],[1,"data-clicklog",0],[1,"data-area",0],[1,"aria-posinset",0],[1,"aria-setsize",0],[1,"aria-selected",0],[1,"aria-checked",0]],[[null,"click"],[null,"mouseenter"],[null,"keydown"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.onSelectItem(e.context.$implicit,e.context.index,n)&&i),"mouseenter"===t&&(i=!1!==r.setActiveIndex(e.context.index)&&i),"keydown"===t&&(i=!1!==r.handleKey(n)&&i),i}),null,null)),i.yb(1,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"menu-item--mobile":0}),(e()(),i.ib(16777216,null,null,1,null,p)),i.yb(4,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,r=i.Gb(1,"menu-item ms-bgc-g40-h ms-bgc-w ms-bgc-g40-f ms-bgc-g40-a ",t.context.$implicit.cssClass,""),o=e(t,2,0,n.mobileMenu);e(t,1,0,r,o),e(t,4,0,n.menuItemTemplate)}),(function(e,t){var n=t.component;e(t,0,0,n.getIdForItem(t.context.$implicit),t.context.$implicit.ariaLabel,t.context.$implicit.ariaDescribedBy,n.ariaRole,n.menuModel.customLogging?"custom":"",n.menuModel.customLogging?"":n.menuModel.hostComponentArea,t.context.index+1,n.menuModel.items.length,n.menuModel.announceItemIsSelected&&t.context.$implicit.ariaSelected,n.menuModel.announceItemIsSelected&&t.context.$implicit.ariaChecked)}))}function f(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,5,"div",[],[[1,"aria-label",0],[24,"@openAndClose",0]],[[null,"@openAndClose.done"]],(function(e,t,n){var i=!0;return"@openAndClose.done"===t&&(i=!1!==e.component.onAnimationCompleted(n)&&i),i}),null,null)),i.yb(1,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"menu--right":0,"menu--center":1,"menu--bottom":2,"context-menu--mobile":3}),(e()(),i.zb(3,0,null,null,2,"ul",[["aria-haspopup","true"],["class","officeHome-callout-main menu__content ms-bgc-w"]],[[8,"id",0],[1,"role",0],[1,"aria-label",0]],null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,h)),i.yb(5,278528,null,0,r.j,[i.O,i.L,i.s],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null)],(function(e,t){var n=t.component,r=i.Gb(1,"menu officeHome-callout ",n.menuModel.cssClass,""),o=e(t,2,0,n.menuModel.rightAligned&&!n.leftAlignedCard,n.menuModel.centerAligned,n.menuModel.bottomAligned,n.mobileMenu);e(t,1,0,r,o),e(t,5,0,n.menuModel.items,n.trackById)}),(function(e,t){var n=t.component;e(t,0,0,n.menuAriaLabel,n.animationState),e(t,3,0,i.Gb(1,"",n.menuModel.id,"-dropdown"),"menuitemcheckbox"===n.ariaRole||"radio"===n.ariaRole?"menu":"listbox",n.menuAriaLabel)}))}function m(e){return i.bc(0,[i.Ub(671088640,1,{menuWrapper:0}),i.Ub(671088640,2,{dropdownItems:1}),(e()(),i.ib(16777216,null,null,1,null,f)),i.yb(3,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,3,0,t.component.open)}),null)}i.vb("ohp-menu",o.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"ohp-menu",[],null,null,null,m,u)),i.yb(1,4440064,null,1,o.a,[a.b,l.a,i.h,s.a,i.D,i.l,c.b],null,null),i.Ub(603979776,1,{menuItems:1})],(function(e,t){e(t,1,0)}),null)}),{menuModel:"menuModel",animateClose:"animateClose",mobileMenu:"mobileMenu",leftAlignedCard:"leftAlignedCard",multiSelect:"multiSelect",contextAriaLabel:"contextAriaLabel",ariaRole:"ariaRole",selectedIndex:"selectedIndex"},{selectItem:"selectItem",closeMenu:"closeMenu"},[])},RsrG:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("keVe"),r=function(){function e(){}return e.prototype.getSchedulePriority=function(e){switch(e){case"mru#MruModule":case"edgeworth#EdgeworthModule":case"ew-react#EdgeworthReactModule":case"quick-access#QuickAccessReactModule":case"recommended-react#RecommendedReactModule":case"left-nav-react#LeftNavReactModule":case"workspace-nav#WorkspaceNavModule":case"fluent-theme-provider#FluentThemeProviderModule":case"new-user-shelf#NewUserShelfModule":return 0;case"auto-suggest#AutoSuggestModule":case"install#InstallModule":case"create-menu#CreateMenuModule":case"first-run#FirstRunModule":case"places#PlacesModule":case"upload-button#UploadButtonModule":return 1;case"upload-dialog#UploadDialogModule":case"banner#BannerModule":case"fluid-content#FluidContentModule":case"wac-content#WacContentModule":return 2;default:return 3}},e.ɵprov=i.cc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},RtYo:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return e.ActionContextMenuIcon="ActionContextMenuIcon",e.RenderIcon="RenderIcon",e.Url="Url",e.Svg="Svg",e.Brand="Brand",e}({})},Ry9Z:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("BaAg"),r=n("QOOv"),o=n("m+UP"),a=n("keVe"),l=function(){function e(e,t){this.mruConfigService=e,this.swayService=t}return e.prototype.getAnalytics=function(t,n){return"cache-only"===n&&!this.mruConfigService.config.analyticsCachingEnabled||t.fileType!==i.b.Sway?Promise.resolve(void 0):this.swayService.getAnalytics(t.url,n).then((function(t){return e.convertFromSwayAnalytics(t)}))},e.prototype.prefetchAnalytics=function(e,t){if(!t||this.mruConfigService.config.analyticsCachingEnabled){var n=e.filter((function(e){return e.fileType===i.b.Sway})).map((function(e){return e.url}));this.swayService.prefetchAnalytics(n,t?"cache-only":"network-first")}},e.convertFromSwayAnalytics=function(e){if(e)return{viewCount:e.viewCount,averageTimeSpentMs:e.averageTimeSpent,averageCompletionRatio:e.AverageScrollDistance,glancedReads:e.glancedReads,quickReads:e.quickReads,deepReads:e.deepReads}},e.ɵprov=a.cc({factory:function(){return new e(a.dc(r.a),a.dc(o.a))},token:e,providedIn:"root"}),e}()},"S8t+":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("ICP0"),r=n("NLr0"),o=n("f0qX"),a=n("2q5z"),l=n("uzn7"),s=n("3XMr"),c=n("keVe"),u=function(){function e(e,t){this.localStorageService=e,this.edgeworthDeltaSyncService=t,this.init()}return e.prototype.getLastUiSyncTimestamp=function(){var t=this.localStorageService.get(e.UiSyncTimestampStorageKeyPrefix);return t?new Date(t):null},e.prototype.setLastUiSyncTimestamp=function(t){this.localStorageService.set(e.UiSyncTimestampStorageKeyPrefix,t.toISOString())},e.prototype.init=function(){var e=this;this.uiTimestamp=Object(i.a)(Object(r.a)(this.getLastUiSyncTimestamp()),this.edgeworthDeltaSyncService.syncTimestampUpdated.pipe(Object(o.a)((function(){return new Date})),Object(a.a)((function(t){e.setLastUiSyncTimestamp(t)}))))},e.UiSyncTimestampStorageKeyPrefix="_Edgeworth"+window.ewWorkload+"LastUiSyncTimestamp",e.ɵprov=c.cc({factory:function(){return new e(c.dc(l.a),c.dc(s.a))},token:e,providedIn:"root"}),e}()},SPVw:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("AlWG"),r=n("uzn7"),o=n("keVe"),a=function(){function e(e){this.localStorageService=e,this._callouts=new i.a([]),this.callouts=this._callouts.asObservable()}return e.prototype.addCallout=function(e){e.isValid()&&!this.calloutDismissed(e)&&(!e.completed&&this.calloutCompleted(e)&&(e.completed=!0),this._callouts.next(this._callouts.getValue().concat(e)))},e.prototype.addCallouts=function(e){var t=this,n=e.filter((function(e){return!(!e.isValid()||t.calloutDismissed(e)||(!e.completed&&t.calloutCompleted(e)&&(e.completed=!0),0))}));this._callouts.next(this._callouts.getValue().concat(n))},e.prototype.clearCallouts=function(){this._callouts.next([])},e.prototype.dismissCallout=function(e){e.persistCompletion&&this.localStorageService.set(this.getCompletedKey(e.calloutType),!0),e.persistDismissal&&this.localStorageService.set(this.getDismissKey(e.calloutType),!0)},e.prototype.calloutDismissed=function(e){if(!e.persistDismissal)return!1;var t=this.getDismissKey(e.calloutType);return!!this.localStorageService.get(t)},e.prototype.calloutCompleted=function(e){if(!e.persistCompletion)return!1;var t=this.getCompletedKey(e.calloutType);return!!this.localStorageService.get(t)},e.prototype.getDismissKey=function(t){return e.calloutDismissedKeyPrefix+"_"+t},e.prototype.getCompletedKey=function(t){return e.calloutCompletedKeyPrefix+"_"+t},e.calloutDismissedKeyPrefix="_FeatureCalloutDismissed",e.calloutCompletedKeyPrefix="_FeatureCalloutCompleted",e.ɵprov=o.cc({factory:function(){return new e(o.dc(r.a))},token:e,providedIn:"root"}),e}()},"T/SX":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},T6pR:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},TDzr:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var i=n("bb6g"),r=n("3Vsh"),o=n("5ZNw"),a=n("hhzZ"),l=n("R7NL"),s=n("p6Zr"),c=n("H90i"),u=n("JT1q"),d=n("7Rc8"),p=n("fKR7"),h=n("/I02"),f=n("clUe"),m=function(){function e(){}return e.objectToArrayHelper=function(e){return Array.isArray(e)?e:e?[e]:[]},e}(),b=n("uUrA"),v=n("pjz5"),g=n("BaAg"),y=n("4ach"),S=n("cgnd"),w=n("PBJH"),C=function(){function e(){}return e.toHash=function(e){var t,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},e}(),I=n("oAX+"),T=n("ZBli"),k=n("kpuN"),A=n("W3Zz"),P=n("7Gwk"),E=n("zwsB"),_=n("o2Lt"),O=n("Z0U4"),F=n("wwmn"),D=n("casz"),M=n("BJbw"),R=n("pOWU"),x=n("keVe"),L=n("TOqr"),N=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p,h,f,m,b,v){var g=e.call(this,t,i,r,"Forms",o,l,u,d)||this;g.eventService=n,g.locService=a,g.formsConfigService=s,g.officeRouteService=c,g.startupConfigService=p,g.clientStartupConfigService=h,g.urlAuthenticatorService=f,g.deviceDetector=m,g.templatesService=b,g.mruDataService=v,g.getFormsGroupsDataStreamCache=null,g.getMyFormsDataStreamCache=null,g.getSharedFormsDataStreamCache=null,g.getMyFormsResponsesCache=null,g.getFormsThemeMappingSetCache=null,g.getFormDataPromisesCache={},g.getFormsGroupMembersStreamCache={},g.getFormsInGroupDataStreamCache={};var y=g.clientStartupConfigService.config;return g.startupConfigService.config.authType===S.a.MSA?(g.tenantId=g.formsConfigService.config.formsMsaTenantId,g.guid=g.convertConsumerPuidToGuid(y.puid)):(g.tenantId=y.tenantId,g.guid=y.objectId),g}return Object(i.__extends)(t,e),t.prototype.onInitFormsStartPage=function(){this.accessTokenService.getAccessToken("Forms",!1,null,!0,{category:"CreateFile",fileType:g.b.Forms}),this.setFormsCompromisedUserAlert()},t.prototype.getFormsTermsOfServiceUrl=function(){return this.formsConfigService.config.termsOfServiceLinkOrgId},t.prototype.getForm=function(e,n,r,o){var a=this;return!o&&this.getFormDataPromisesCache[e]||(this.getFormDataPromisesCache[e]=new Promise((function(o,l){a.get("Get_Form",a.formsConfigService.config.formsApiPath+t.GET_FORM(a.tenantId,n,r,e),(function(e){e.instrument((function(e,t){t.params.RequestId=a.getRequestIdFromResponse(e)})).then((function(e){if(e&&e.data&&e.data.id){var t=a.getFormUrl(e.data.id);e.data=Object(i.__assign)(Object(i.__assign)({},e.data),{fromCache:e.fromCache}),e.data.url=t,e.data.ownerPrincipalType=n,e.data.otherInfo&&(e.data.otherInfo=JSON.parse(e.data.otherInfo)),o(e.data)}}))}),l,a.getRequestConfig(),"network-first")}))),this.getFormDataPromisesCache[e]},t.prototype.unpinSharedForm=function(e){var n=this;return new Promise((function(i,r){n.delete("Forms_Shared_UnpinRequest",n.formsConfigService.config.formsApiPath+t.SHARED_FORM(e),null,(function(e){e.instrument((function(e,t){t.params.RequestId=n.getRequestIdFromResponse(e)})).then((function(e){i(e.data)}))}),(function(e){r(e)}),n.getRequestConfig())}))},t.prototype.postCopyForm=function(e,n,r,o,a,l,s){var c=this,u=s===y.a.Groups;return new Promise((function(d,p){var h={newOwnerId:a,newTenantId:c.tenantId,isNewOwnerGroup:u,patchProperties:{title:n}},f=function(e){e.instrument((function(e,t){t.params.RequestId=c.getRequestIdFromResponse(e)})).then((function(e){var t=e.data.otherInfo,n=c.getFormUrl(e.data.id),r=Object(i.__assign)(Object(i.__assign)({},e.data),{otherInfo:JSON.parse(t),url:n});c.clearCache(s,a),m.unsubscribe(),d(r)}))},m=(u?c.getFormsInGroup(a):c.getMyForms()).results.subscribe((function(i){if(!i||!i.fromCache){if(i&&i.value){var a=i.value.filter((function(e){return!e.softDeleted})).map((function(e){return e.title}));h.patchProperties.title=function(e,t){if(-1!==t.indexOf(e)){var n=e+" ",i=1,r=e&&e.match(/([\s\S]+)\(([1-9]\d*)\)$/);for(r&&3===r.length&&(n=r[1],i=parseInt(r[2],10));-1!==t.indexOf(e);)e=n+"("+ ++i+")"}return e}(n,a)}c.post("Forms_Copy_Request",c.formsConfigService.config.formsApiPath+t.COPY_FORMS_PATH(r,l,o,e),h,f,(function(e){p(e)}),c.getRequestConfig())}}))}))},t.prototype.createForm=function(e,t,n){var i=this;return new Promise((function(r){r(i.getCreateFormsLink(e,(t||{type:"users"}).identifier,n))}))},t.prototype.createFormFromTemplate=function(e,n,i){var o=this,a=i||this.guid;return new Promise((function(i,l){o.templatesService.getTemplateContent(g.b.Forms,e.AssetId,e.TemplateBinaryUrl).results.pipe(Object(r.a)(1)).subscribe((function(r){o.post("Form_Create_Form_From_Template",o.formsConfigService.config.formsApiPath+t.CREATE_FORM_FROM_TEMPLATE(o.tenantId,n,a),r.data.Content.Value,(function(t){t.instrument((function(t,n){n.params.RequestId=o.getRequestIdFromResponse(t),n.params.ElementId=e.AssetId})).then((function(e){i(o.getCreateFormFromTemplateLink(e.data.id))}))}),(function(e){l(e)}),o.getRequestConfig(),null,null,null,null,void 0,null,null,null,!0,{category:"CreateFile",fileType:g.b.Forms})}))}))},t.prototype.postMoveForms=function(e,n,i,r,o){var a=this;return new Promise((function(l,s){a.post("Recycle_Form_Request",a.formsConfigService.config.formsApiPath+t.MOVE_FORM_PATH(a.tenantId,n,i,e),{isNewOwnerGroup:r===y.a.Groups,newOwnerId:o},(function(e){e.instrument((function(e,t){return t.params.RequestId=a.getRequestIdFromResponse(e),e})).then((function(e){a.clearCache(n,i),a.clearCache(r,o),l(e.data)}))}),(function(e){s(e)}),a.getRequestConfig())}))},t.prototype.getFormAuthenticatedCdn=function(e){var t=this.clientStartupConfigService.config.sharedClientStartupContext,n="prodprv"===t.deploymentEnvironment&&"scu"===t.geoName,i=this.urlAuthenticatorService.appendPvrAndUpnAuthParams(this.formsConfigService.config.formsCdnPath+(e?_.c:this.deviceDetector.isMobileDevice()||this.deviceDetector.isTabletDevice()?_.a:_.b));return T.a.appendAndReplaceQueryParams(i,{origin:n?c.b:c.a,lang:this.contextService.sharedContext.officeMarket,sessionId:this.startupConfigService.config.sharedClientStartupContext.sessionId},!1,!0)},t.prototype.getFormGroupThumbnailUrl=function(e){return this.getImage(this.formsConfigService.config.formsApiPath+t.MY_FORMS_GROUP_THUMBNAIL_PATH(e),"Forms_Group_Thumbnail_Fetch")},t.prototype.getFormsInGroup=function(e,n){var r=this;if(n&&(this.getFormsInGroupDataStreamCache[e]=null),this.getFormsInGroupDataStreamCache[e])return this.getFormsInGroupDataStreamCache[e];var o=function(n){return new Promise((function(o,a){r.get("Forms_From_Group_Request",r.formsConfigService.config.formsApiPath+t.FORMS_FROM_GROUP(r.tenantId,e),(function(e){e.instrument((function(e,t){t.params.RequestId=r.getRequestIdFromResponse(e)})).then((function(e){e&&e.data&&e.data.value&&(e.data=Object(i.__assign)(Object(i.__assign)({},e.data),{fromCache:e.fromCache}),e.data.value=m.objectToArrayHelper(e.data.value),e.data.value.forEach((function(e){e.otherInfo&&(e.otherInfo=JSON.parse(e.otherInfo)),e.ownerPrincipalType=y.a.Groups,e.url=r.getFormUrl(e.id)})),o(e.data))}))}),(function(e){a(e)}),r.getRequestConfig(),n)}))},a=o("cache-only"),l=o("network-first"),s=I.a.createResultsWithCacheObservable(a,l,null,(function(t){r.getFormsInGroupDataStreamCache[e]=null}));return this.getFormsInGroupDataStreamCache[e]=s,this.getFormsInGroupDataStreamCache[e]},t.prototype.getFormsGroupMembers=function(e){var n=this;if(this.getFormsGroupMembersStreamCache[e])return this.getFormsGroupMembersStreamCache[e];var i=function(i){return new Promise((function(r,o){n.get("Forms_Group_Members_Request",n.formsConfigService.config.formsApiPath+t.FORMS_GROUP_MEMBERS(e),(function(e){e.instrument((function(e,t){t.params.RequestId=n.getRequestIdFromResponse(e)})).then((function(e){r(e.data)}))}),(function(e){o(e)}),n.getRequestConfig(),i)}))},r=i("cache-only"),o=i("network-first"),a=I.a.createResultsWithCacheObservable(r,o,null,(function(t){return n.getFormsGroupMembersStreamCache[e]=null}));return this.getFormsGroupMembersStreamCache[e]=a,a},t.prototype.getFormsGroups=function(){var e=this;if(this.getFormsGroupsDataStreamCache)return this.getFormsGroupsDataStreamCache;var n=function(n){return new Promise((function(i,r){e.get("Forms_Groups_Request",e.formsConfigService.config.formsApiPath+t.MY_FORMS_GROUPS,(function(t){t.instrument((function(t,n){n.params.RequestId=e.getRequestIdFromResponse(t)})).then((function(t){e.mruDataService.getMruDocuments(new Set([g.b.Forms])).results.subscribe((function(e){var n=new Map;e.items.forEach((function(e,t){"GroupForm"===e.Extension&&void 0===n[e.MetaData.FormsMetaData.owner_id]&&(n[e.MetaData.FormsMetaData.owner_id]=t)})),t.data.value.sort((function(e,t){return n[e.id]>=0&&n[t.id]>=0?n[e.id]-n[t.id]:n[e.id]>=0?-1:1})),i(t.data)})),e.mruDataService.getMruDocuments(new Set([g.b.Forms])).initialCompletion.then((function(e){e&&e.cacheError&&e.networkError&&i(t.data)}))}))}),(function(e){r(e)}),e.getRequestConfig(),n)}))},i=n("cache-only"),r=n("network-first"),o=I.a.createResultsWithCacheObservable(i,r,null,(function(t){return e.getFormsGroupsDataStreamCache=null}));return this.getFormsGroupsDataStreamCache=o,o},t.prototype.setFormsRecycleState=function(e,n,i,r){var o=this,a=r?"Recycle_Form_Request":"Restore_Form_Request";return new Promise((function(l,s){o.patch(a,o.formsConfigService.config.formsApiPath+t.FORM_EDIT_OR_DELETE_PATH(o.tenantId,i,n,e),{softDeleted:r?1:0},(function(e){e.instrument((function(e,t){t.params.RequestId=o.getRequestIdFromResponse(e)})).then((function(){o.clearCache(i,n),l()}))}),(function(e){s(e)}),o.getRequestConfig())}))},t.prototype.hardDeleteForm=function(e,n,i){var r=this;return new Promise((function(o,a){r.delete("Forms_Delete_Request",r.formsConfigService.config.formsApiPath+t.FORM_EDIT_OR_DELETE_PATH(r.tenantId,i,n,e),{},(function(e){e.instrument((function(e,t){t.params.RequestId=r.getRequestIdFromResponse(e)})).then((function(){r.clearCache(i,n),o()}))}),(function(e){a(e)}))}))},t.prototype.getCreateFormsLink=function(e,t,n){var i="Create",r="CreateQuiz",o=function(e,t,n){return"Action="+t+"&Title="+e+(n?"&GroupId="+n:"")},a=this.getFormAuthenticatedCdn(!1),l={Action:null,Fragment:null};if(e===g.b.Forms)l.Fragment=o(this.locService.NewFormsSurveyFileName,i,t),l.Action=i;else{if(e!==g.b.FormsQuiz)return null;a=a.replace(_.a,_.b),l.Fragment=o(this.locService.NewFormsQuizFileName,r,t),l.Action=r}return a=T.a.appendAndReplaceQueryParams(a,l,!0),this.appendQueryInformation(a,!0,n)},t.prototype.getFormUrl=function(e){return this.getFormAuthenticatedCdn(!1)+"#FormId="+e},t.prototype.getAllMyFormsLink=function(){var e=this,t={title:this.locService.AllMyFormsRedirectLabel,tooltip:this.locService.AllMyFormsRedirectTooltip,ariaLabel:this.locService.AllMyFormsRedirectTooltip,referral:s.a.Forms,zeroTitle:this.locService.AllMyFormsRedirectLabel};return this.formsConfigService.config.neoPortalPageEnabled?Object(i.__assign)(Object(i.__assign)({},t),{url:this.urlAuthenticatorService.appendPvrAndUpnAuthParams(this.getFormAuthenticatedCdn(!0))}):Object(i.__assign)(Object(i.__assign)({},t),{onClick:function(){e.officeRouteService.navigateTo({app:g.b.Forms,route:"MyForms"})}})},t.prototype.getCreateFormFromTemplateLink=function(e){var t=this.getFormAuthenticatedCdn(!1);return t=T.a.appendAndReplaceQueryParams(t,{Action:"CreateByTemplate",Fragment:"FormId="+e},!0),this.appendQueryInformation(t,!0)},t.prototype.getFormGroupMemberThumbnailUrl=function(e,n){return this.getImage(this.formsConfigService.config.formsApiPath+t.FORMS_MEMBER_THUMBNAIL_PATH(e,n),"Forms_Members_Thumbnail_Fetch")},t.prototype.getMyFormsResponses=function(){var e=this;return this.getMyFormsResponsesCache||(this.getMyFormsResponsesCache=new Promise((function(n,i){e.get("Forms_Responses",e.formsConfigService.config.formsApiPath+t.FORMS_RESPONSE_COUNT_PATH,(function(t){t.instrument((function(t,n){n.params.RequestId=e.getRequestIdFromResponse(t)})).then((function(e){e&&e.data?n(m.objectToArrayHelper(e.data.value)):i()}))}),i,e.getRequestConfig(),"network-first")}))),this.getMyFormsResponsesCache},t.prototype.getSharedForms=function(){var e=this;if(this.getSharedFormsDataStreamCache)return this.getSharedFormsDataStreamCache;var n=function(n){return new Promise((function(i,r){e.get("Shared_Forms_Request",e.formsConfigService.config.formsApiPath+t.SHARED_FORMS_PATH,(function(t){t.instrument((function(t,n){n.params.RequestId=e.getRequestIdFromResponse(t)})).then((function(t){t&&t.data&&t.data.value?(t.data.value.sort((function(e,t){return e.modifiedDate===t.modifiedDate?0:e.modifiedDate<t.modifiedDate?1:-1})),t.data.value.forEach((function(t){t.id&&(t.url=e.getFormUrl(t.id),t.ownerPrincipalType=y.b.getOwnerPrincipalTypeToFormType(t.ownerType||t.ownerPrincipalType||t.OwnerPrincipalType))})),i(t.data)):r()}))}),(function(e){r(e)}),e.getRequestConfig(),n)}))},i=n("cache-only"),r=n("network-first"),o=I.a.createResultsWithCacheObservable(i,r,null,(function(t){return e.getSharedFormsDataStreamCache=null}));return this.getSharedFormsDataStreamCache=o,o},t.prototype.setFormsCompromisedUserAlert=function(){var e=this;this.getReputationTierCache||(this.getReputationTierCache=this.getUserReputationTier()),this.getReputationTierCache.then((function(t){t===y.c.Bad&&e.pushFormsAnnouncements("FormsCompromisedUser")}))},t.prototype.pushFormsAnnouncements=function(e,t){var n="announcement-background-color-wrapper--alert",i="announcement-section__title--black announcement-close__button--black";switch(e){case"FormsCompromisedUser":this.eventService.broadcastEvent({name:"newAnnouncement",args:[new o.a(e,this.locService.FormsCompromisedUserAlertMessage,null,"","",!1,"announcement-background-color-wrapper--error",i,null,null,{text:this.locService.TermsOfUseLink,url:this.getFormsTermsOfServiceUrl(),shouldFocusOnInit:!1})]});break;case"FormsMoveToRecycleBin":var r=this.locService.FormsMoveToRecycleBinMessage;r&&this.eventService.broadcastEvent({name:"newAnnouncement",args:[new o.a(e,r,null,"","",!1,n,i,null,null,null,5)]});break;case"FormsRestored":this.eventService.broadcastEvent({name:"newAnnouncement",args:[new o.a(e,this.locService.format(this.locService.FormsRestoredMessage,'"'+t+'"'),null,"","",!1,n,i)]});break;case"FormsPermanentlyDeleted":this.eventService.broadcastEvent({name:"newAnnouncement",args:[new o.a(e,this.locService.format(this.locService.FormsPermanentlyDeletedMessage,'"'+t+'"'),null,"","",!1,n,i)]})}},t.prototype.setFormsCopySuccessAnnouncement=function(e,t,n,i,r){var a,l,s;switch(t){case y.a.Users:l=this.locService.FormsCopyToMyFormsMessage,s=this.locService.AllMyFormsRedirectLabel,a=this.officeRouteService.getUrlForRoute({app:g.b.Forms,route:"MyForms"});break;case y.a.Groups:l=this.locService.FormsCopyToGroupMessage,s=r,a=this.officeRouteService.getUrlForRoute({app:g.b.Forms,route:"GroupForms"},{groupId:i})}this.eventService.broadcastEvent({name:"newAnnouncement",args:[new o.a("FormsCopied",this.locService.format(l,'"'+e+'"'),null,"","",!1,"announcement-background-color-wrapper--alert","announcement-section__title--black announcement-close__button--black",null,null,n?{url:a,text:s,shouldFocusOnInit:!0}:null)]})},t.prototype.setFormsMoveToGroupSuccessAnnouncement=function(e,t,n){var i=this.officeRouteService.getUrlForRoute({app:g.b.Forms,route:"GroupForms"},{groupId:t});this.eventService.broadcastEvent({name:"newAnnouncement",args:[new o.a("FormsMoveToGroup",this.locService.format(this.locService.FormsMoveToGroupMessage,'"'+e+'"'),null,"","",!1,"announcement-background-color-wrapper--alert","announcement-section__title--black announcement-close__button--black",null,null,{url:i,text:n,shouldFocusOnInit:!0})]})},t.prototype.getMyForms=function(e){var n=this;if(e&&(this.getMyFormsDataStreamCache=null),this.getMyFormsDataStreamCache)return this.getMyFormsDataStreamCache;var r=function(e){return new Promise((function(r,o){n.get("My_Forms_Request",n.formsConfigService.config.formsApiPath+t.MY_FORMS_PATH,(function(e){e.instrument((function(e,t){t.params.RequestId=n.getRequestIdFromResponse(e)})).then((function(e){e.data=Object(i.__assign)(Object(i.__assign)({},e.data),{fromCache:e.fromCache}),e&&e.data&&e.data.value&&(e.data.value=m.objectToArrayHelper(e.data.value),e.data.value.forEach((function(e){e.ownerPrincipalType=y.a.Users,e.otherInfo&&(e.otherInfo=JSON.parse(e.otherInfo)),e.url=n.getFormUrl(e.id)})),e.data.value=e.data.value.sort((function(e,t){return new Date(t.modifiedDate).getTime()-new Date(e.modifiedDate).getTime()}))),r(e.data)}))}),(function(e){o(e)}),n.getRequestConfig(),e)}))},o=r("cache-only"),a=r("network-first"),l=I.a.createResultsWithCacheObservable(o,a,null,(function(e){n.getMyFormsDataStreamCache=null}));return this.getMyFormsDataStreamCache=l,this.getMyFormsDataStreamCache},t.prototype.fetchFormThumbnail=function(e){var n=this,i=function(){return n.inMockMode?""+location.origin+t.FORMS_THUMBNAIL_MOCK_PATH:""+n.formsConfigService.config.formsApiPath},r=function(t){return{defaultImage:t+"/Images/Theme/"+n.getFormsDefaultImageName(e.fileName),defaultColor:n.formsConfigService.config.defaultThumbnailColor}},o=function(t){e.thumbnails.backgroundColor=t},a=function(t){e.thumbnails.small=t,e.thumbnails.medium=t,e.thumbnails.large=t,e.thumbnails.recommendedThumbnail=t},l=function(){return new Promise((function(l){var s,c,u=i(),d=r(u),h=e.metaData&&e.metaData.background_image?n.inMockMode?""+u+v.a.getLocation(e.metaData.background_image).path:e.metaData.background_image:d.defaultImage,f=e.metaData&&e.metaData.primary_color?e.metaData.primary_color:d.defaultColor;if(e.format===p.a.Recent)return o(f),a(h),void l();e.thumbnailInfo&&e.thumbnailInfo.thumbnailFillColor&&(f=e.thumbnailInfo.thumbnailFillColor),"Customized Theme"===(null===(s=e.thumbnailInfo)||void 0===s?void 0:s.thumbnailId)&&(null===(c=e.thumbnailInfo)||void 0===c?void 0:c.thumbnailUrl)?(h=e.thumbnailInfo.thumbnailUrl,o(f),a(h),l()):e.thumbnailInfo&&e.thumbnailInfo.thumbnailId?n.getFormsThemingData().then((function(i){var r=i[e.thumbnailInfo.thumbnailId];r&&(r.SecondaryColor&&(f=r.SecondaryColor),r.BackgroundImage&&(h=n.inMockMode?""+location.origin+t.FORMS_THUMBNAIL_MOCK_PATH+r.BackgroundImage:""+n.formsConfigService.config.formsApiPath+r.BackgroundImage)),o(f),a(h),l()})).catch((function(){o(f),a(h),l()})):(o(f),a(h),l())}))};return e.format===p.a.SharedForm?new Promise((function(t){n.getForm(e.serverDocId,e.ownerType,e.ownerId).then((function(i){var r=Object(u.b)(i,null,null,null,n.clientStartupConfigService.config.authType,i.fromCache);e.thumbnailInfo=r.thumbnailInfo,l().then(t).catch(t)})).catch((function(){var e=r(i());o(e.defaultColor),a(e.defaultImage),t()}))})):l()},t.prototype.handleQueryParam=function(e,t){"mockformsservicemode"===e&&this.mockRequestHeader&&this.getRequestConfig().headers.set(this.mockRequestHeader,t.toString())},t.prototype.getRequestIdFromResponse=function(e){return this.getHeaderValue(e.headers,"x-correlationid")},t.prototype.getImage=function(e,t){var n=this;return new Promise((function(i,r){n.get(t,e,(function(e){e.instrument((function(e,t){t.params.RequestId=n.getRequestIdFromResponse(e)})).then((function(e){if(e&&e.data){var t=new FileReader;t.addEventListener("load",(function(){var e=t.result.toString();e=e.replace("data:image/pjpeg","data:image/jpeg"),i(e)}),!1),t.readAsDataURL(e.data)}}))}),(function(e){r(e)}),{responseType:"blob"},"network-only")}))},t.prototype.appendQueryInformation=function(e,t,n){var i=this.officeRouteService.getCurrentRoute();return T.a.appendAndReplaceQueryParams(e,{route:n||(i&&i.route?i.route:void 0)},t)},t.prototype.getRequestConfig=function(){return{headers:new Map([["Accept","application/json"],["x-ms-form-request-source","ms-startpage"],["x-usersessionid",this.startupConfigService.config.sharedClientStartupContext.sessionId],["x-correlationid",b.a.createGuid()],["x-anchormailbox",this.guid+"@"+this.tenantId]])}},t.prototype.clearCache=function(e,t){switch(e){case y.a.Groups:if(!t)break;this.getFormsInGroupDataStreamCache[t]=null;break;case y.a.Users:this.getMyFormsDataStreamCache=null}},t.prototype.convertConsumerPuidToGuid=function(e){return"00000000-0000-0000-".concat(e.slice(0,4),"-",e.slice(4))},t.prototype.getFormsDefaultImageName=function(e){e=e||"Untitled form";var t=this.formsConfigService.config.defaultImagesAvailable;return"default-"+(Math.abs(C.toHash(e))%t+1)+".png"},t.prototype.getFormsThemingData=function(){var e=this;return this.getFormsThemeMappingSetCache||(this.getFormsThemeMappingSetCache=new Promise((function(n,i){e.get("Forms_Theme_Request",e.formsConfigService.config.formsApiPath+""+(e.inMockMode?t.FORMS_THEMES_MOCK:t.FORMS_THEMES),(function(t){t.instrument((function(t,n){n.params.RequestId=e.getRequestIdFromResponse(t)})).then((function(e){n(e.data)}))}),(function(t){e.getFormsThemeMappingSetCache=null,i(t)}),e.getRequestConfig(),"network-first",null,null,null,"None")}))),this.getFormsThemeMappingSetCache},t.prototype.getUserReputationTier=function(){var e=this;return new Promise((function(n,i){e.get("Get_User_Reputation_Tier",e.formsConfigService.config.formsApiPath+t.USER_REPUTATION_TIER_PATH,(function(t){t.instrument((function(t,n){n.params.RequestId=e.getRequestIdFromResponse(t)})).then((function(e){e&&e.data?n(e.data):i()}))}),(function(e){i(e)}),e.getRequestConfig(),"network-only")}))},t.SHARED_FORMS_PATH=(t.BASE_URL="/formapi/api")+"/me/sharedWithMeForms",t.MY_FORMS_PATH=t.BASE_URL+"/me/light/forms?$select=id,title,modifiedDate,settings,ownerId,ownerTenantId,category,background,otherInfo,softDeleted,status,type&$filter=type+ne+%27survey%27",t.FORMS_RESPONSE_COUNT_PATH=t.BASE_URL+"/light/GetRespCounts()",t.FORMS_THUMBNAIL_MOCK_PATH="/content/mockData/shared/services/mockData/form/thumbnails",t.FORMS_THEMES_MOCK="/Themes",t.FORMS_THEMES="/Themes.json",t.MY_FORMS_GROUPS=t.BASE_URL+"/groups",t.USER_REPUTATION_TIER_PATH=t.BASE_URL+"/userReputationTier",t.GET_FORM=function(e,n,i,r){return t.BASE_URL+"/"+e+"/"+n+"/"+i+"/light/forms('"+r+"')?$select=id,rowCount,background,otherInfo,settings,type,category"},t.COPY_FORMS_PATH=function(e,n,i,r){return t.BASE_URL+"/"+e+"/"+n+"/"+i+"/light/forms('"+r+"')/CopyToUser"},t.MOVE_FORM_PATH=function(e,n,i,r){return t.BASE_URL+"/"+e+"/"+n+"/"+i+"/light/forms('"+r+"')/MoveForm"},t.FORMS_MEMBER_THUMBNAIL_PATH=function(e,n){return t.BASE_URL+"/groups('"+e+"')/members('"+n+"')/photo/$value"},t.FORMS_GROUP_MEMBERS=function(e){return t.BASE_URL+"/groups('"+e+"')/members"},t.FORM_EDIT_OR_DELETE_PATH=function(e,n,i,r){return t.BASE_URL+"/"+e+"/"+n+"/"+i+"/forms('"+r+"')"},t.FORMS_FROM_GROUP=function(e,n){return t.BASE_URL+"/"+e+"/groups/"+n+"/light/forms?$select=id,title,modifiedDate,ownerId,ownerTenantId,softDeleted,category,rowCount,background,otherInfo,type&$filter=type+ne+%27survey%27"},t.MY_FORMS_GROUP_THUMBNAIL_PATH=function(e){return t.BASE_URL+"/groups('"+e+"')/photo/$value"},t.SHARED_FORM=function(e){return t.BASE_URL+"/light/sharedWithMeForms('"+e+"')"},t.CREATE_FORM_FROM_TEMPLATE=function(e,n,i){return t.BASE_URL+"/"+e+"/"+n+"/"+i+"/light/forms"},t.ɵprov=x.cc({factory:function(){return new t(x.dc(k.b),x.dc(P.a),x.dc(a.a),x.dc(l.a),x.dc(h.a),x.dc(w.a),x.dc(F.a),x.dc(E.a),x.dc(O.a),x.dc(L.q),x.dc(D.a),x.dc(S.b),x.dc(S.b),x.dc(M.a),x.dc(A.b),x.dc(f.a),x.dc(d.a))},token:t,providedIn:"root"}),t}(R.a)},TIi1:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},TJwc:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!e)return e;for(var i=e,r=function(e){var n=new RegExp("\\{"+e+"\\}","gi");i=i.replace(n,(function(){return t[e]}))},o=0;o<t.length;o++)r(o);return i},e.getDuplicateItemName=function(e){var t=e.match(/(.*)\(([0-9]+)\)$/i),n=function(e,t){return e.trim()+" ("+t+")"};return t?n(t[1],parseInt(t[2])+1):n(e,2)},e}()},Tqea:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("6ib3");function r(e){switch(e){case i.a.Word:return"Word";case i.a.Excel:return"Excel";case i.a.PowerPoint:return"PowerPoint";case i.a.MeetingNotes:case i.a.OneNote:case i.a.OneNoteClassNoteBook:case i.a.OneNotePage:return"OneNote";case i.a.Pdf:return"PDF";case i.a.Visio:return"Visio";case i.a.Audio:return"Audio";case i.a.Video:return"Video";case i.a.Photos:return"Photos";case i.a.Outlook:return"Outlook";case i.a.Text:return"Text";case i.a.Sway:return"Sway";case i.a.Forms:case i.a.FormsQuiz:return"Forms";case i.a.Project:return"Project";case i.a.ProjectOperations:return"ProjectOperations";case i.a.Portfolio:return"Portfolio";case i.a.NewsArticle:return"NewsArticle";case i.a.Fluid:return"Fluid";case i.a.PowerBI:return"PowerBI";case i.a.StreamsVideo:return"Streams";case i.a.Stream:return"Stream";case i.a.UpcomingMeeting:return"UpcomingMeeting";case i.a.List:return"List";case i.a.Spaces:return"Spaces";case i.a.MindMeister:return"MindMeister";case i.a.Monday:return"monday.com";case i.a.Trello:return"Trello";case i.a.Platform:return"Platform";case i.a.Whiteboard:return"Whiteboard";case i.a.MeetingObject:return"MeetingObject";case i.a.ThirdParty:return"Custom";case i.a.MyAnalytics:return"MyAnalytics";default:return"Document"}}},U8M1:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("4/We"),r=n("cgnd"),o=n("fVt+"),a=n("1LNb"),l=n("Z0U4"),s=n("keVe"),c=function(){function e(e,t,n,i,o){var a=this;this.capabilitiesService=e,this.clientStartupConfigService=t,this.feedbackService=n,this.officeRouteService=i,this.userConsentConfigService=o,this.userConsentConfigPromise=null,this.capabilitiesService.capabilities.showFloodgate&&(this.capabilitiesService.capabilities.userConsentCallEnabled&&this.clientStartupConfigService.config.authType===r.a.MSA&&!this.userConsentConfigPromise&&(this.userConsentConfigPromise=this.userConsentConfigService.getConfig()),this.floodgateInitPromise=new Promise((function(e,t){var n=function(t){var n=a.feedbackService.getOCVTelemetryData(t.toString());OfficeBrowserFeedback.initOptions.applicationGroup=n.applicationGroup,OfficeBrowserFeedback.initOptions.telemetryGroup=n.telemetryGroup,OfficeBrowserFeedback.initOptions.webGroup=n.webGroup,OfficeBrowserFeedback.initOptions.appId=a.feedbackService.getOcvAppId(),OfficeBrowserFeedback.floodgate.initOptions&&(OfficeBrowserFeedback.floodgate.initOptions.onSurveyActivatedCallback={onSurveyActivated:function(e){return a.activateSurvey(e)}}),OfficeBrowserFeedback.floodgate.initialize().then(e)};a.userConsentConfigPromise?a.userConsentConfigPromise.then((function(e){0!==e.userConsent?t():a.feedbackService.addOCVScriptToPage(n)||t()})):a.feedbackService.addOCVScriptToPage(n)||t()})))}return e.prototype.recordFloodgate=function(e){this.capabilitiesService.capabilities.showFloodgate&&this.floodgateInitPromise.then((function(){OfficeBrowserFeedback.floodgate.start().then((function(){var t=OfficeBrowserFeedback.floodgate.getEngine().getActivityListener();e.forEach((function(e){return t.logActivity(e)})),OfficeBrowserFeedback.floodgate.stop()}))}))},e.prototype.activateSurvey=function(e){var t=this.officeRouteService.getRouteItemForCurrentLocation().route;!t||"OfficeHome"!==t&&"Search"!==t&&"AppGallery"!==t||e.launch()},e.ɵprov=s.cc({factory:function(){return new e(s.dc(i.a),s.dc(r.b),s.dc(a.a),s.dc(l.a),s.dc(o.a))},token:e,providedIn:"root"}),e}()},Uqr9:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return S}));var i=n("bb6g"),r=n("cOkY"),o=n("zvoD"),a=n("3Vsh"),l=n("hhzZ"),s=n("BaAg"),c=n("4/We"),u=n("cgnd"),d=n("MFXD"),p=n("AXqk"),h=n("7Gwk"),f=n("Z0U4"),m=n("re3B"),b=n("BMb5"),v=n("keVe"),g=n("qfyf"),y=function(){function e(){}return e.now=function(){var e=window.performance;return e&&e.now?e.now():(void 0===this.nowOffset&&(this.nowOffset=e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:Date.now()),Date.now()-this.nowOffset)},e}(),S=function(){function e(t,n,i,r,l,s,c,u,p){var h=this;if(this.queuedMarks=t,this.dataSecurityService=n,this.instrumentationService=l,this.windowService=s,this.clientStartupConfigService=c,this.capabilities=p,this.dumpedMeasures=new Set,this.dumpedBrowserMarkers=!1,this.recordedMarkers=new Map,this.recordedMeasures=new Map,this.paramsForAppMeasures=new Map,this.globalStateParamsForBrowserMeasures=null,this._marks=new d.a,this.loggingEnabled=e.performanceLoggingSupported(this.windowService.nativeWindow),this.loggingEnabled){i.events.withScope(0).pipe(Object(o.a)((function(e){return"shellPlusLoaded"===e.name})),Object(a.a)(1)).toPromise().then((function(){setTimeout((function(){return h.log()}),1e3)})),this.capabilities.capabilities.antpLoaded&&i.events.withScope(0).pipe(Object(o.a)((function(e){return"antpReady"===e.name})),Object(a.a)(1)).toPromise().then((function(){setTimeout((function(){return h.log()}),0)})),r.addUnloadEvent((function(){h.mark("App_Unloaded",1),h.log()}));var f=function(e){h.currentRoute=e,h.mark("App_Navigation_Start",h.lastRecordedRouteNavigationStartMarker?0:h.windowService.nativeWindow.measureAppFrom||"responseStart")};u.subscribeToRouteChangeStart((function(e){e.currentRoute&&e.currentRoute.route&&f(e.currentRoute)})),u.subscribeToRouteChangeEnd((function(e){e.currentRoute&&e.currentRoute.route&&!h.currentRoute&&f(e.currentRoute),null===h.globalStateParamsForBrowserMeasures&&(h.globalStateParamsForBrowserMeasures={},h.instrumentationService.applyGlobalStateParams(h.globalStateParamsForBrowserMeasures,!0))})),this.drainQueuedMarks()}}return e.performanceLoggingSupported=function(e){var t=e.performance;return!!(t&&t.now&&t.mark&&t.timing&&t.timing.navigationStart&&t.measure&&t.getEntriesByType)},e.getBrowserTimingMeasures=function(t,n,r,o){var a=new Array;if(!e.performanceLoggingSupported(t))return a;for(var l in t.performance.timing){var s=e.globalAllowedMarkers.get(l);if(s){var c=t.performance.timing[l],u=t.performance.timing[s];if("number"==typeof c&&"number"==typeof u)if(0!==c&&0!==u)if(c<u)n(l,"Failed to calculate measure for <"+l+"> starting from <"+s+"> due to relative marker value being greater than marker value: <"+l+">="+c+"; diff from <"+s+">="+(c-u));else if(c<t.performance.timing.navigationStart)n(l,"Failed to calculate measure for <"+l+"> starting from <"+s+"> due to marker value being less than <navigationStart> marker value: <"+l+">="+c+"; diff from <navigationStart}>="+(c-t.performance.timing.navigationStart));else if(u<t.performance.timing.navigationStart)n(l,"Failed to calculate measure for <"+l+"> starting from <"+s+"> due to relative marker value being less than <navigationStart> marker value: <"+l+">="+c+"; <"+s+">="+u+"; diff from <navigationStart}>="+(u-t.performance.timing.navigationStart));else{var d=Math.ceil(c-u);a.push({name:l,duration:d,params:r?Object(i.__assign)({},r):{}});var p=l+"_ohp_measure";o&&o(l,p);try{t.performance.measure(p,s,l)}catch(e){n(l,"Failed to record measure for <"+l+"> starting from <"+s+">: exception is thrown")}}else"unloadEventStart"!==l&&"unloadEventEnd"!==l&&n(l,"Failed to calculate measure for <"+l+"> starting from <"+s+"> due to unexpected zero values: <"+l+">="+c+"; <"+s+">="+u);else n(l,"Failed to calculate measure for <"+l+"> starting from <"+s+"> due to unexpected value type: <"+l+"> value type is "+typeof c+"; <"+s+"> value type is "+typeof u)}}return a},e.prototype.mark=function(e,t,n,i){if(void 0===t&&(t=2),void 0===n&&(n=0),this.loggingEnabled&&!(n>this.dataSecurityService.securityLevel)){var o=e;if(this.currentRoute&&this.currentRoute.route){var a=""+this.currentRoute.route+(this.currentRoute.app?s.b[this.currentRoute.app]:"");Object(r.f)(a),o=e+"_"+a}var l=o;if(this.recordedMarkers.has(l)){var c=this.recordedMarkers.get(l)+1;this.recordedMarkers.set(l,c),l=o+"."+c}else this.recordedMarkers.set(l,1);this.windowService.nativeWindow.performance.mark(l);var u=this.lastRecordedRouteNavigationStartMarker||"navigationStart";"App_Navigation_Start"===e&&(Object(r.g)(l),this.lastRecordedRouteNavigationStartMarker=l);var d="navigationStart";return 2===t?d=u:0===t?d="":"string"==typeof t&&(d=t),this.addMeasure(o,l,d,e,i),this.drainQueuedMarks(),l}},e.prototype.getRecordedMarkerNameBySubstring=function(e){return e?Array.from(this.recordedMarkers.keys()).find((function(t){return t.indexOf(e)>=0})):null},e.prototype.getResourceTimingEntries=function(e){try{return this.windowService.nativeWindow.performance.getEntriesByType("resource").filter((function(t){return t.name.lastIndexOf(e)>=0}))}catch(e){return[]}},Object.defineProperty(e.prototype,"marks",{get:function(){return this._marks.asScopableObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigationStart",{get:function(){return this.getPerformanceTimingMember("navigationStart")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchStart",{get:function(){return this.getPerformanceTimingMember("fetchStart")},enumerable:!0,configurable:!0}),e.prototype.getPerformanceTimingMember=function(e){var t=this.windowService.nativeWindow.performance;return t&&t.timing&&t.timing[e]?t.timing[e]:0},e.prototype.drainQueuedMarks=function(){var e=this;this.queuedMarks&&this.queuedMarks.splice(0,this.queuedMarks.length).forEach((function(t){return e.addMeasure(t.markName,t.markName,t.measureFrom||"navigationStart",t.markName,t.eventParams)}))},e.prototype.addMeasure=function(e,t,n,i,r){var o=this.windowService.nativeWindow,a=o.performance.getEntriesByType("mark").find((function(e){return e.name===t}));if(a&&this._marks.next(a),n&&!this.recordedMeasures.has(e)){this.recordedMeasures.set(e,i||e);try{o.performance.measure(e,n,t)}catch(i){return void this.logError(e,"Failed to record <"+e+"> for <"+t+"> starting from <"+n+">: exception is thrown")}this.dumpedBrowserMarkers?(r&&this.paramsForAppMeasures.set(e,r),this.log(e)):(this.instrumentationService.applyGlobalStateParams(r=r||{},!1),this.paramsForAppMeasures.set(e,r))}},e.prototype.log=function(e){var t=this;this.getPerformanceDump(e).forEach((function(e){t.instrumentationService.logPerformanceEvent(e.name,e.duration,e.params)}))},e.prototype.getPerformanceDump=function(e){var t=this,n=new Map;if(!e&&this.dumpedBrowserMarkers)return n;var i,r=this.windowService.nativeWindow;if(e){var o=r.performance.getEntriesByName(e,"measure");if(!o)return n;i=o}else i=r.performance.getEntriesByType("measure").filter((function(e){return!t.dumpedMeasures.has(e.name)&&t.recordedMeasures.has(e.name)}));return i.forEach((function(e){var i=Math.ceil(e.duration),r={};t.paramsForAppMeasures.has(e.name)&&(r=t.paramsForAppMeasures.get(e.name));var o=t.recordedMeasures.get(e.name);n.set(e.name,{name:o,duration:i,params:r}),t.dumpedMeasures.add(e.name)})),e||this.dumpBrowserMarkers(n),n},e.prototype.dumpBrowserMarkers=function(t){var n,r,o=this;if(!this.dumpedBrowserMarkers){var a=this.windowService.nativeWindow;if(this.clientStartupConfigService.config.resourceLoggingEnabled&&this.clientStartupConfigService.config.cdnDomain){var l=new RegExp("https://"+this.clientStartupConfigService.config.cdnDomain+".*","i"),s=a.performance.getEntriesByType("resource").filter((function(e){return l.test(e.name)&&("script"===e.initiatorType||"link"===e.initiatorType)})).filter((function(e){return e.hasOwnProperty("transferSize")?e.transferSize>0:e.responseEnd-e.responseStart>20})),c=void 0,u=0;try{for(var d=Object(i.__values)(s),p=d.next();!p.done;p=d.next()){var h=p.value,f=h.responseEnd;"number"==typeof f&&f>0&&f>u&&(u=f,c=h)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}if(c){var m=c.name.split("/").pop(),b="Last_CDN_Script_Downloaded",v=c.responseEnd,g=null===this.globalStateParamsForBrowserMeasures?{}:Object(i.__assign)({},this.globalStateParamsForBrowserMeasures);g.Filename=m,t.set(b,{name:b,duration:v,params:g}),this.dumpedMeasures.add(b)}}e.getBrowserTimingMeasures(a,(function(e,t){o.logError(e,t)}),this.globalStateParamsForBrowserMeasures,(function(e,t){o.dumpedMeasures.add(t),o.recordedMeasures.set(t,e)})).forEach((function(e){t.set(e.name,e)})),this.dumpedBrowserMarkers=!0}},e.prototype.logError=function(e,t){var n,i=((n={}).Error=e,n.DebugInfo=t,n);this.instrumentationService.logGenericEvent("Performance_Mark_Failure",i)},e.globalAllowedMarkers=new Map([["fetchStart","navigationStart"],["unloadEventStart","navigationStart"],["unloadEventEnd","unloadEventStart"],["domainLookupEnd","domainLookupStart"],["connectEnd","connectStart"],["requestStart","navigationStart"],["responseStart","requestStart"],["responseEnd","responseStart"],["domLoading","responseStart"],["domInteractive","domLoading"],["domComplete","domLoading"]]),e.ɵprov=v.cc({factory:function(){return new e(v.dc(g.a,8),v.dc(p.a),v.dc(h.a),v.dc(m.a),v.dc(l.a),v.dc(b.b),v.dc(u.b),v.dc(f.a),v.dc(c.a))},token:e,providedIn:"root"}),e}()},V9hE:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("8/lW"),r=n("4CZh");function o(e,t,n,o){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===o&&(o=i.a.Security),Object(r.b)(e,"Generic_Debug_Cache",o,t,n,!0)}},VKX6:function(e,t,n){"use strict";var i;function r(){var e=window.performance;return e&&e.now?e.now():(void 0===i&&(i=e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:Date.now()),Date.now()-i)}n.d(t,"a",(function(){return r}))},VY7U:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("PZOQ"),r=n("1Bt+"),o=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[i.a,r.a]}},e}()},VrZ9:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f}));var i=n("keVe"),r=n("TOqr"),o=n("pzhl"),a=n("PkQn"),l=n("4/We"),s=n("MRNN"),c=n("/I02"),u=n("PBJH"),d=n("Z0U4"),p=i.xb({encapsulation:2,styles:[],data:{}});function h(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,5,null,null,null,null,null,null,null)),(e()(),i.zb(1,0,null,null,4,"div",[],null,null,null,null,null)),i.yb(2,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(3,{"back-button":0,"back-button--fluent":1,"ms-u-hiddenMdDown":2}),(e()(),i.zb(4,0,null,null,1,"ohp-icon-font",[["ariaVisible","true"],["dataArea","Hero"],["dataNav","1"],["iconButton","true"],["iconFontName","ArrowLeft"]],null,[[null,"iconClicked"]],(function(e,t,n){var i=!0;return"iconClicked"===t&&(i=!1!==e.component.navigateBack()&&i),i}),o.b,o.a)),i.yb(5,638976,null,0,a.a,[l.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],id:[2,"id"],title:[3,"title"],ariaVisible:[4,"ariaVisible"],ariaLabel:[5,"ariaLabel"],dataArea:[6,"dataArea"],dataNav:[7,"dataNav"],iconButton:[8,"iconButton"],focusOnLoad:[9,"focusOnLoad"]},{iconClicked:"iconClicked"})],(function(e,t){var n=t.component,i=e(t,3,0,!n.fluentRefresh,n.fluentRefresh,n.responsive&&!n.fluentRefresh);e(t,2,0,i),e(t,5,0,"back-button__icon ms-fcl-tp"+(n.fluentRefresh?" back-button__icon--fluent":""),"ArrowLeft",n.elementId,n.backButtonAriaLabel||n.defaultAriaLabel,"true",n.backButtonAriaLabel||n.defaultAriaLabel,"Hero","1","true",n.focusOnLoad)}),null)}function f(e){return i.bc(0,[(e()(),i.ib(16777216,null,null,1,null,h)),i.yb(1,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.backRoute||n.defaultBackRoute)}),null)}i.vb("ohp-back-button",s.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-back-button",[],null,null,null,f,p)),i.yb(1,245760,null,0,s.a,[l.a,c.a,u.a,d.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{elementId:"elementId",backButtonAriaLabel:"backButtonAriaLabel",defaultBackRoute:"defaultBackRoute",responsive:"responsive",focusOnLoad:"focusOnLoad"},{},[])},Vwd8:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return f}));var i=n("bb6g"),r=n("lrJm"),o=n("W3Zz"),a=n("uzn7"),l=n("re3B"),s=n("xoWf"),c=n("cgnd"),u=n("hhzZ"),d=n("keVe"),p=function(){function e(t,n,i,r,o,a,l){var s=this;this.clientStartupConfigService=t,this.localStorageService=n,this.userDataStorageService=o,this.instrumentationService=a,this.globalErrorHandler=l,this.scheduledSavePromise=null,this.pendingFirstTimeMetrics={},this.firstTimeUser=this.userDataStorageService.isFirstUse(),this.firstVisitTimestamp=this.userDataStorageService.getFirstUseTimestamp(),this.bufferingTimeoutInSeconds=r.isMobileDevice()?e.BufferingTimespanInSecondsForMobile:e.BufferingTimespanInSecondsForDesktop,this.localStorageProfileDataKey=".Full_Metrics.v"+e.LocalStorageSchemaVersion,this.fullMetrics=this.localStorageService.get(this.localStorageProfileDataKey),this.fullMetrics&&this.fullMetrics.metrics?this.firstTimeUser&&(this.firstTimeUser=!1,this.firstVisitTimestamp=this.fullMetrics.created):this.fullMetrics=e.createEmptySnapshot(),this.onLoadMetrics=this.fullMetrics.metrics,this.localStorageUnsavedDataKey=".Unsaved_Metrics.v"+e.LocalStorageSchemaVersion,this.unsavedMetrics=this.localStorageService.get(this.localStorageUnsavedDataKey),this.unsavedMetrics&&this.unsavedMetrics.metrics?this.firstTimeUser&&(this.firstTimeUser=!1,this.firstVisitTimestamp=this.unsavedMetrics.created):this.unsavedMetrics=null,this.inMemoryProfile={metrics:this.fullMetrics.metrics},this.roamingStorageProfileDataKey="User_Profile.Metrics.v"+e.LocalStorageSchemaVersion,this.loadFromUserStorage(),this.forceImmediateSave=this.firstTimeUser||!!this.unsavedMetrics,i.addUnloadEvent((function(){return s.flush()}))}return e.prototype.incrementMetric=function(t,n){var i=e.createTimestamp();e.applyIncrement(t,i,this.fullMetrics.metrics);var r=this.fullMetrics.metrics[t];r&&1===r.count&&(this.loadingMetricsFromRoamingStorage?this.pendingFirstTimeMetrics[t]=r.firstOccurrence:this.logMetricRecordedForFirstTime(t)),this.unsavedMetrics||(this.unsavedMetrics=e.createEmptySnapshot()),e.applyIncrement(t,i,this.unsavedMetrics.metrics),this.scheduleSave(n)},e.prototype.flush=function(){this.scheduledSavePromise&&this.forceSave()},e.prototype.get=function(){return this.pendingLoad},e.prototype.isFirstVisit=function(){return this.firstTimeUser},e.prototype.getInitialMetric=function(e){return this.onLoadMetrics[e]},e.prototype.doesMetricExist=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.get()];case 1:for(n in i.sent().metrics)if(t?n===e:n.includes(e))return[2,!0];return[2,!1]}}))}))},e.prototype.fullDaysSinceFirstVisit=function(){if(this.firstTimeUser)return 0;if(void 0===this.firstVisitTimestamp||this.firstVisitTimestamp<0)return-1;var t=e.createTimestamp()-this.firstVisitTimestamp;return Math.floor(t/e.MillisecondsInDay)},e.createTimestamp=function(){return Date.now()},e.createEmptySnapshot=function(){return{metrics:{},created:e.createTimestamp(),saved:-1}},e.applyIncrement=function(e,t,n){if(n.hasOwnProperty(e)){var i=n[e];i.count++,i.lastOccurrence=t}else n[e]={count:1,firstOccurrence:t,lastOccurrence:t}},e.mergeMetrics=function(t,n){for(var i in n)e.applyMetric(t,i,n[i])},e.applyMetric=function(e,t,n){if(e.hasOwnProperty(t)){var r=e[t];r.count+=n.count,r.firstOccurrence>n.firstOccurrence&&(r.firstOccurrence=n.firstOccurrence),r.lastOccurrence<n.lastOccurrence&&(r.lastOccurrence=n.lastOccurrence)}else e[t]=Object(i.__assign)({},n)},e.sanitizeMetrics=function(t){if(!t.hasOwnProperty(e.MetricPresentInSetThatHasToBeSanitized))return t;var n={};for(var i in t)if(!(i.indexOf("_Request")>0||i.indexOf("_Impression")>0)){var r=!1;if(i.startsWith("Referral."))r=!0;else if(i.indexOf("_PageView")>0)r=!0;else if(i.indexOf("_Click")>0||i.indexOf("_Toggle")>0){var o=i.split(".");3===o.length&&u.b.hasOwnProperty(o[1])&&(r=!0)}else"Upload_Completed"===i&&(r=!0);r&&(n[i]=t[i])}return n},e.prototype.resetScheduledSave=function(){this.scheduledSavePromise&&(clearTimeout(this.scheduledSaveTimeoutId),this.scheduledSaveTimeoutId=null,this.scheduledSavePromise=null,this.scheduledSaveEstimatedTime=null)},e.prototype.scheduleSave=function(e){var t=this;if(this.forceImmediateSave)return this.forceImmediateSave=!1,void this.forceSave();if(!this.scheduledSavePromise||e&&!(Date.now()+1e3*e>=this.scheduledSaveEstimatedTime)){this.resetScheduledSave();var n=1e3*(e?Math.min(e,this.bufferingTimeoutInSeconds):this.bufferingTimeoutInSeconds);this.scheduledSaveEstimatedTime=Date.now()+n,this.scheduledSavePromise=new Promise((function(e){t.scheduledSaveTimeoutId=setTimeout((function(){t.forceSave(),e()}),n)}))}},e.prototype.forceSave=function(){var t=this;if(this.resetScheduledSave(),this.clientStartupConfigService.config.sanitizeMetrics&&(this.unsavedMetrics&&(this.unsavedMetrics.metrics=e.sanitizeMetrics(this.unsavedMetrics.metrics)),this.fullMetrics.metrics=e.sanitizeMetrics(this.fullMetrics.metrics)),this.fullMetrics.saved=e.createTimestamp(),this.localStorageService.set(this.localStorageProfileDataKey,this.fullMetrics),this.unsavedMetrics&&this.localStorageService.set(this.localStorageUnsavedDataKey,this.unsavedMetrics),this.loadingMetricsFromRoamingStorage)this.scheduleSave();else{var n=this.unsavedMetrics;this.unsavedMetrics=null,this.userDataStorageService.set(this.roamingStorageProfileDataKey,this.fullMetrics).then((function(){t.unsavedMetrics?t.localStorageService.set(t.localStorageUnsavedDataKey,t.unsavedMetrics):t.localStorageService.remove(t.localStorageUnsavedDataKey)})).catch((function(i){t.globalErrorHandler.handleError(i,"SxWjc"),t.unsavedMetrics&&n&&e.mergeMetrics(n.metrics,t.unsavedMetrics.metrics),t.unsavedMetrics=n,t.unsavedMetrics&&t.localStorageService.set(t.localStorageUnsavedDataKey,t.unsavedMetrics)}))}},e.prototype.loadFromUserStorage=function(){var t=this;this.pendingLoad=new Promise((function(n){t.loadingMetricsFromRoamingStorage=!0,t.userDataStorageService.get(t.roamingStorageProfileDataKey,e.LoadFromUserStorageRemoteAttempts).then((function(n){n&&n.metrics&&(t.unsavedMetrics&&n.saved<t.unsavedMetrics.created&&e.mergeMetrics(n.metrics,t.unsavedMetrics.metrics),t.fullMetrics=n,t.inMemoryProfile.metrics=t.fullMetrics.metrics)})).catch((function(e){t.globalErrorHandler.handleError(e,"QN0a5")})).then((function(){for(var e in t.loadingMetricsFromRoamingStorage=!1,t.pendingFirstTimeMetrics){var i=t.fullMetrics.metrics[e];i&&t.pendingFirstTimeMetrics[e]!==i.firstOccurrence||t.logMetricRecordedForFirstTime(e)}t.pendingFirstTimeMetrics={},n(t.inMemoryProfile)}))}))},e.prototype.logMetricRecordedForFirstTime=function(e){var t={};t.MetricName=e,this.instrumentationService.logGenericEvent("First_Time_Metric",t)},e.BufferingTimespanInSecondsForDesktop=30,e.BufferingTimespanInSecondsForMobile=5,e.LoadFromUserStorageRemoteAttempts=2,e.LocalStorageSchemaVersion=1,e.MillisecondsInDay=864e5,e.MetricPresentInSetThatHasToBeSanitized="Site_Visit",e.ɵprov=d.cc({factory:function(){return new e(d.dc(c.b),d.dc(a.a),d.dc(l.a),d.dc(o.b),d.dc(s.a),d.dc(u.a),d.dc(r.b))},token:e,providedIn:"root"}),e}(),h=function(){function e(e,t,n,i){this.userProfileService=e,this.streamName=t,this.params=n,this.metrics=i}return e.prototype.record=function(){var e=this;if(this.metrics){var t="Generic_Click"===this.streamName&&this.params.Referral?1:void 0;this.metrics.forEach((function(n){return e.userProfileService.incrementMetric(n,t)}))}},e}(),f=function(){function e(e){this.userProfileService=e}return e.prototype.createEvent=function(e,t,n){return new h(this.userProfileService,e,t,n)},e.prototype.flush=function(){this.userProfileService.flush()},e.ɵprov=d.cc({factory:function(){return new e(d.dc(p))},token:e,providedIn:"root"}),e}()},W0EU:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("Xpk8");var i=function(){return function(){}}()},W3Zz:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return c}));var i,r,o,a=n("BMb5"),l=n("keVe");!function(e){e[e.PC=0]="PC",e[e.Mac=1]="Mac",e[e.WindowsPhone=2]="WindowsPhone",e[e.iPad=3]="iPad",e[e.iPhone=4]="iPhone",e[e.AndroidPhone=5]="AndroidPhone",e[e.AndroidTablet=6]="AndroidTablet",e[e.Linux=7]="Linux",e[e.Chromebook=8]="Chromebook",e[e.Other=9]="Other"}(i||(i={})),function(e){e[e.IE=0]="IE",e[e.Edge=1]="Edge",e[e.EdgeLegacy=2]="EdgeLegacy",e[e.Chrome=3]="Chrome",e[e.Firefox=4]="Firefox",e[e.Safari=5]="Safari",e[e.PhantomJS=6]="PhantomJS",e[e.Opera=7]="Opera",e[e.WebView=8]="WebView",e[e.Other=9]="Other"}(r||(r={})),function(e){e.Slow2g="Slow2g",e.Standard2g="Standard2g",e.Standard3g="Standard3g",e.Standard4g="Standard4g",e.Unknown="Unknown"}(o||(o={}));var s=function(){function e(e,t,n){this.major=this.normalize(e),this.minor=this.normalize(t),this.build=this.normalize(n)}return e.prototype.compareTo=function(e){return this.major===e.major&&this.minor===e.minor&&this.build===e.build?0:this.major>e.major||this.major===e.major&&this.minor>e.minor||this.major===e.major&&this.minor===e.minor&&this.build>e.build?1:-1},e.prototype.toString=function(){return this.major+"_"+this.minor+"_"+this.build},e.prototype.normalize=function(e){if("number"==typeof e)return e;if("string"==typeof e){var t=parseInt(e);return isNaN(t)?0:t}return 0},e}(),c=function(){function e(e){this.windowService=e,this.platforms=[{keyword:"Windows NT",platformType:i.PC},{keyword:"Windows XP",platformType:i.PC},{keyword:"Macintosh",platformType:i.Mac},{keyword:"Windows Phone",platformType:i.WindowsPhone,pageName:"windows-phone"},{keyword:"iPad",platformType:i.iPad,pageName:"ipad"},{keyword:"iPhone",platformType:i.iPhone,pageName:"iphone"},{keyword:"Android",platformType:i.AndroidPhone,pageName:"android-phone"},{keyword:"Linux",platformType:i.Linux},{keyword:"CrOS",platformType:i.Chromebook}],this.browsers=[{keyword:"PhantomJS",browserType:r.PhantomJS},{keyword:"Edge",browserType:r.EdgeLegacy},{keyword:"EdgA",browserType:r.Edge},{keyword:"EdgiOS",browserType:r.Edge},{keyword:"Edg",browserType:r.Edge},{keyword:"wv",browserType:r.WebView},{keyword:"MSIE",browserType:r.IE},{keyword:"Trident",browserType:r.IE},{keyword:"OPR",browserType:r.Opera},{keyword:"Chrome",browserType:r.Chrome},{keyword:"CriOS",browserType:r.Chrome},{keyword:"Firefox",browserType:r.Firefox},{keyword:"Safari",browserType:r.Safari}],this.networkTypes=[{keyword:"slow-2g",networkType:o.Slow2g},{keyword:"2g",networkType:o.Standard2g},{keyword:"3g",networkType:o.Standard3g},{keyword:"4g",networkType:o.Standard4g}],this.userAgent=this.windowService.nativeWindow.navigator.userAgent}return e.prototype.getDeviceInfo=function(){if(this.deviceInfo)return this.deviceInfo;var e=this.userAgent.toLowerCase(),t={keyword:"Other",platformType:i.Other};this.platforms.some((function(n){return-1!==e.indexOf(n.keyword.toLowerCase())&&(t=n,!0)})),t.platformType===i.AndroidPhone&&-1===e.indexOf("mobile")&&(t={keyword:"Android",platformType:i.AndroidTablet,pageName:"android-tablet"});var n=new s(0,0,0);if(t.platformType===i.Mac)(o=/Mac OS X (\d+)(_|\.)(\d+)([_\.]?)(\d*)/i.exec(this.userAgent)).length>=6&&(n=new s(o[1],o[3],o[5]));else if(t.platformType===i.PC||t.platformType===i.WindowsPhone)-1!==e.indexOf("windows xp")?n=new s(5,1,0):(o=/Windows (NT|Phone) (OS )?(\d+)\.(\d+)/i.exec(this.userAgent)).length>=5&&(n=new s(o[3],o[4],0));else if(t.platformType===i.iPad||t.platformType===i.iPhone){var o=e.match(/os (\d+)_(\d+)(_(\d+))?/);n=new s(o[1]||0,o[2]||0,o[4]||0)}var a={keyword:"Other",browserType:r.Other};return this.browsers.some((function(t){return-1!==e.indexOf(t.keyword.toLowerCase())&&(a=t,!0)})),this.deviceInfo={platform:t,platformVersion:n,browser:a},this.deviceInfo},e.prototype.getNetworkInfo=function(){if(this.networkType)return this.networkType;var e=this.windowService.nativeWindow.navigator.connection,t=e&&e.effectiveType?e.effectiveType:"Unknown",n={keyword:"Unknown",networkType:o.Unknown};return this.networkTypes.some((function(e){return-1!==t.toLowerCase().indexOf(e.keyword)&&(n=e,!0)})),this.networkType=n.networkType,this.networkType},e.prototype.isDesktopDevice=function(){var e=this.getDeviceInfo().platform.platformType;return e===i.PC||e===i.Mac||e===i.Linux||e===i.Chromebook},e.prototype.isMobileDevice=function(){var e=this.getDeviceInfo().platform.platformType;return e===i.iPhone||e===i.AndroidPhone||e===i.WindowsPhone},e.prototype.isTabletDevice=function(e){void 0===e&&(e=null);var t=this.getDeviceInfo().platform.platformType;return null!==e?t===e:t===i.iPad||t===i.AndroidTablet},e.prototype.isUwp=function(){return this.userAgent.toLowerCase().indexOf("msapphost/")>-1&&"undefined"!=typeof Windows},e.prototype.isWebView2=function(){return this.isUwp()&&void 0!==window.chrome&&void 0!==window.chrome.webview},e.prototype.isIE11Browser=function(){return this.userAgent.toLowerCase().indexOf("trident/7.0")>-1},e.ɵprov=l.cc({factory:function(){return new e(l.dc(a.b))},token:e,providedIn:"root"}),e}()},W3xQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("dFxn"),r=n("cgnd"),o=n("keVe"),a=function(){function e(e,t){this.config=e.parse("calendarConfig"),this.config&&(this.config.peopleImagesEnabled=this.config.peopleImagesEnabled&&!t.config.automatedTestRunning)}return e.ɵprov=o.cc({factory:function(){return new e(o.dc(i.a),o.dc(r.b))},token:e,providedIn:"root"}),e}()},WFKr:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("CVeG"),r=function(){function e(e,t){this.Finished=e,this.Value=t}return e.Finished=function(t){return new e(!0,t)},e.Unfinished=function(t){return new e(!1,t)},e}(),o=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.Pipeline=e}return e.prototype.Run=function(e){if(!this.Pipeline||0===this.Pipeline.length)return e;for(var t=null,n=0;n<this.Pipeline.length;n++){if((t=this.Pipeline[n](e)).Finished)return t.Value;e=t.Value}return t?t.Value:e},e}(),a=function(){function e(){}return Object.defineProperty(e,"MetacharactersMatch",{get:function(){return/[\\^$*+?.()|[\]{}]/g},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MetacharactersReplacement",{get:function(){return"\\$&"},enumerable:!0,configurable:!0}),e.escape=function(t){return t.replace(e.MetacharactersMatch,e.MetacharactersReplacement)},e}(),l=function(){function e(){}return e.Format=function(t,n,i){return e.FormatWithSeparator(t,e.DefaultSeparator(n),i)},e.FormatWithSeparator=function(t,n,r){var o=[],l=e.FormatterPipeline.Run({PathArray:t,Formatted:"",Separator:n,MaxLength:r||e.DefaultMaxLength}).Formatted;o.push(l);var s=i.a.escapeHtml(n),c=""+e.PathSegmentPostfix+e.PathSegmentPrefix+s+e.PathSegmentPostfix+e.PathSegmentPrefix,u=e.GetRegExp(a.escape(s),"g");return o.push(""+e.PathSegmentPrefix+i.a.escapeHtml(l).replace(u,c)+e.PathSegmentPostfix),o},e.DefaultSeparator=function(t){return t?e.DefaultPathSepRtl:e.DefaultPathSepLtr},e.ZeroElements=function(e){return e.PathArray&&0!==e.PathArray.length?r.Unfinished(e):(e.Formatted="",r.Finished(e))},e.TopTooLong=function(t){var n=t.PathArray[0].trim();return n.length>t.MaxLength?(t.Formatted=n.substr(0,t.MaxLength-1).trim()+e.Ellipsis,r.Finished(t)):r.Unfinished(t)},e.SingleElement=function(e){return 1===e.PathArray.length?(e.Formatted=e.PathArray[0].trim(),r.Finished(e)):r.Unfinished(e)},e.TopTooLongForSingleFollower=function(t){var n=t.PathArray[0].trim();return n.length+t.Separator.length+e.Ellipsis.length>t.MaxLength?(t.Formatted=n,r.Finished(t)):r.Unfinished(t)},e.TopTooLongForMultipleFollowers=function(t){var n=t.PathArray[0].trim();return t.PathArray.length>2&&n.length+2*(t.Separator.length+e.Ellipsis.length)>t.MaxLength?(t.Formatted=n,r.Finished(t)):r.Unfinished(t)},e.TopAndBottomTooLongAndOnlyElements=function(t){if(2===t.PathArray.length){var n=t.PathArray[0].trim(),i=t.PathArray[1].trim(),o=n.length+i.length+t.Separator.length+1-t.MaxLength;if(o>1)return t.Formatted=e.Join(n,e.Ellipsis+i.substr(o).trim(),t.Separator),r.Finished(t)}return r.Unfinished(t)},e.TopAndBottomTooLongAndOtherElements=function(t){if(t.PathArray.length>2){var n=t.PathArray[0].trim(),i=t.PathArray[t.PathArray.length-1].trim(),o=n.length+i.length+2*(t.Separator.length+1)-t.MaxLength;if(o>1)return i=i.substr(o).trim(),t.Formatted=e.Join(n,e.Ellipsis,t.Separator),i.length>0&&(t.Formatted=e.Join(t.Formatted,e.Ellipsis+i,t.Separator)),r.Finished(t)}return r.Unfinished(t)},e.MultipleElements=function(t){return t.Formatted=t.PathArray.reduce((function(n,i){return e.Join(n,i,t.Separator)})),t.Formatted.length<=t.MaxLength?r.Finished(t):r.Unfinished(t)},e.CollapseFirst=function(t){var n=e.GetRegExp(t.Separator+".*?"+t.Separator);return t.Formatted=t.Formatted.replace(n,t.Separator+e.Ellipsis+t.Separator),t.Formatted.length<=t.MaxLength?r.Finished(t):r.Unfinished(t)},e.CollapseRemaining=function(t){for(var n=e.GetRegExp(t.Separator+".*?"+t.Separator+".*?"+t.Separator);t.Formatted.length>t.MaxLength;){var i=t.Formatted;if(t.Formatted=t.Formatted.replace(n,t.Separator+e.Ellipsis+t.Separator),i===t.Formatted)break}return r.Finished(t)},e.Join=function(e,t,n){return 0===t.length?e:e.trim()+n+t.trim()},e.GetRegExp=function(t,n){void 0===n&&(n="");var i=t+"/"+n;if(e.RegExpCache.has(i))return e.RegExpCache.get(i);var r=new RegExp(t,n);return e.RegExpCache.set(i,r),r},e.DefaultMaxLength=60,e.DefaultPathSepLtr=" » ",e.DefaultPathSepRtl=" « ",e.Ellipsis="…",e.PathSegmentPrefix='<span dir="auto">',e.PathSegmentPostfix="</span>",e.FormatterPipeline=new o(e.ZeroElements,e.TopTooLong,e.SingleElement,e.TopTooLongForSingleFollower,e.TopTooLongForMultipleFollowers,e.TopAndBottomTooLongAndOnlyElements,e.TopAndBottomTooLongAndOtherElements,e.MultipleElements,e.CollapseFirst,e.CollapseRemaining),e.RegExpCache=new Map,e}()},WJRI:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var i=n("keVe"),r=n("TOqr"),o=n("kVgv"),a=i.xb({encapsulation:2,styles:[],data:{}});function l(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"div",[["aria-live","assertive"],["class","title-announcement"],["tabindex","-1"]],null,null,null,null,null)),(e()(),i.Yb(1,null,[" ","\n"]))],null,(function(e,t){e(t,1,0,t.component.announcement)}))}function s(e){return i.bc(2,[(e()(),i.ib(16777216,null,null,1,null,l)),i.yb(1,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,1,0,t.component.announcement)}),null)}i.vb("ohp-title-announcer",o.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-title-announcer",[],null,null,null,s,a)),i.yb(1,49152,null,0,o.a,[],null,null)],null,null)}),{announcement:"announcement"},{},[])},WLAd:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("hZW2"),r=n("keVe"),o=function(){function e(e){this.documentService=e}return e.prototype.addOnVisibilityChanged=function(e){var t=this.documentService.nativeDocument;t.addEventListener("visibilitychange",(function(){return e(t.visibilityState)}))},e.prototype.getVisibilityState=function(){return this.documentService.nativeDocument.visibilityState},e.prototype.isVisible=function(){return"visible"===this.getVisibilityState()},e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},XQbr:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},XV2T:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(t,n){if(this.userId=t||e.unknownUserId,this.nativeStorage=n,this.nativeStorage){var i=this.getUserBasedKey("_"+Math.round(1e6*Math.random()));try{this.nativeStorage.setItem(i,i),this.nativeStorage.removeItem(i)}catch(e){this.nativeStorage=null}}}return e.prototype.get=function(e){return this.getItem(this.getUserBasedKey(e))},e.prototype.set=function(e,t){this.setItem(this.getUserBasedKey(e),t)},e.prototype.remove=function(e){this.removeItem(this.getUserBasedKey(e))},e.prototype.getGlobal=function(e){return this.getItem(e)},e.prototype.setGlobal=function(e,t){this.setItem(e,t)},e.prototype.removeGlobal=function(e){this.removeItem(e)},e.prototype.findKeys=function(e){if(!this.nativeStorage||!e)return null;for(var t=[],n=0;n<this.nativeStorage.length;n++){var i=this.nativeStorage.key(n);i.indexOf(e)>=0&&t.push(i)}return t},e.prototype.getItem=function(e){if(!this.nativeStorage)return null;var t=this.nativeStorage.getItem(e);return"string"==typeof t?JSON.parse(t):void 0},e.prototype.setItem=function(e,t){if(this.nativeStorage)try{var n=void 0===t?void 0:JSON.stringify(t);this.nativeStorage.setItem(e,n)}catch(e){}},e.prototype.removeItem=function(e){this.nativeStorage&&this.nativeStorage.removeItem(e)},e.prototype.getUserBasedKey=function(t){return e.officeHomeStorageKeyPrefix+"-"+this.userId+t},e.officeHomeStorageKeyPrefix="officeHome",e.unknownUserId="Unknown",e}()},Xc4i:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("bb6g"),r=n("2dXW"),o=n("ro+v"),a=n("3Vsh"),l=(n("hhzZ"),n("BaAg")),s=n("jCfB"),c=(n("4/We"),n("cgnd"),n("/I02"),n("idgT"),n("oAX+")),u=n("y9oG"),d=(n("hZW2"),n("Uqr9"),n("Brer")),p=n("EUVs"),h=function(){function e(e,t,n,i,r,o,a,l){this.capabilitiesService=e,this.clientStartupConfigService=t,this.contextService=n,this.documentService=i,this.instrumentationService=r,this.performanceService=o,this.templatesConfigService=a,this.vroomService=l,this.index=0,this.bootstrappersLoaded=new Map,this.bootstrapperDiagnostics=new Map,this.applicationUrls=new Map,this.performanceMarker=new Map}return e.prototype.loadBootstrapper=function(e,t,n,i){var r=this;if(void 0===i&&(i=!1),this.bootstrappersLoaded.has(e))return this.bootstrappersLoaded.get(e);var o=new Promise((function(t,i){r.bootstrapperDiagnostics.set(e,{startTime:Date.now()}),r.documentService.addScriptToPage(e,(function(){r.bootstrapperDiagnostics.get(e).endTime=Date.now(),t()}),i,!1,l.b[n]+"_bootstrapper")}));return i&&this.templatesConfigService.prefetchStaticResources(n),this.bootstrappersLoaded.set(e,o),this.applicationUrls.set(n,{bootstrapperUrl:e,applicationUrl:t}),o},e.prototype.convertMruInflationPromise=function(e,t,n){var i=this;return e.then((function(e){var r=p.a.getDocumentInfoForMruFileItem(e,t);return{fetchDiagnostics:{startTime:n,endTime:Date.now()},wopiHostData:e.wopiData,fetchedDocumentInfo:r.docId&&r.driveId?i.getDocumentInfoWithSharingLink(r):i.getWopiData(r,!1,!1,!0).then((function(e){return e.fetchedDocumentInfo}))}}))},e.prototype.getWopiData=function(e,t,n,r){var o=this;void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===r&&(r=!1);var a=Date.now(),l=Object(i.__read)(this.getDriveItemWithWacData(e,t,n),2),s=l[1];return l[0].then((function(t){var n,l,c,u;if(t){var p={startTime:a,endTime:Date.now()},h=d.a.getWopiHostDataFromItem(t),f=Object(i.__assign)(Object(i.__assign)({},e),{docUrl:null!==(n=t.webUrl)&&void 0!==n?n:e.docUrl,driveId:null!==(c=null===(l=null==t?void 0:t.parentReference)||void 0===l?void 0:l.driveId)&&void 0!==c?c:e.driveId,docId:null!==(u=null==t?void 0:t.id)&&void 0!==u?u:e.docId}),m=r?o.getDocumentInfoWithSharingLink(f):Promise.resolve(f);return Promise.resolve({wopiHostData:h,fetchDiagnostics:p,fetchedDocumentInfo:m})}return s.then((function(e){return Promise.reject(e)})).catch((function(e){return Promise.reject(e)}))})).catch((function(e){return Promise.reject(e)}))},e.prototype.logPerformanceEventFromClick=function(e,t,n){var i,r,o=null!==(r=this.performanceMarker.get(e))&&void 0!==r?r:{clickTimeMarker:1,instrumentationParams:(i={},i.WacHostEntry=this.contextService.getWdOrigin("DIRECT"),i.ResourceId=this.getCorrelationIdForBootId(e),i.FileFormat=l.a.fileTypeNameFromType(n),i)};this.performanceService.mark(t+"."+e,o.clickTimeMarker,void 0,o.instrumentationParams)},e.prototype.generateCorrelationAndBootId=function(e){var t=null!=e?e:this.index++;return[this.getCorrelationIdForBootId(t),t]},e.prototype.logPerformanceBootStart=function(e,t,n,i){var r,o=((r={}).WacHostEntry=n,r.ResourceId=t,r.FileFormat=l.a.fileTypeNameFromType[i],r),a=this.performanceService.mark("WacContentPerformanceMarker.DocumentLoadStart."+e,0,void 0,o);this.performanceMarker.set(e,{clickTimeMarker:a,instrumentationParams:o})},e.prototype.logBootPerformance=function(e,t,n,i){var r;if(n&&n.documentLoadedTime&&i){var o=((r={}).DebugInfo=JSON.stringify(n),r),a=Object(u.a)(e,t,o);this.instrumentationService.logPerformanceEvent(s.b,n.documentLoadedTime-i,a)}},e.prototype.getDocumentInfoWithSharingLink=function(e){return this.capabilitiesService.capabilities.wacSharingLinkEnabled?this.vroomService.createSharingLink(e.driveId,e.docId).then((function(t){var n;try{n=decodeURIComponent(t)}catch(t){return e}return Object(i.__assign)(Object(i.__assign)({},e),{docUrl:null!=n?n:e.docUrl})})).catch((function(){return e})):Promise.resolve(e)},e.prototype.getCorrelationIdForBootId=function(e){return this.clientStartupConfigService.config.sharedClientStartupContext.correlationId+"."+e},e.prototype.getDriveItemWithWacData=function(e,t,n){var i=this,l=e.docId,s=e.driveId,u=e.docUrl,d=e.fileType,p=t?"editnew":"open",h=s&&l?function(e){return i.vroomService.getItemWithWacData(u,s,l,e,p,n)}:function(e){return i.vroomService.getSharedItemWithoutThumbnail(u,d,null,e,!0,p,n)},f=new r.a;return[(n?Object(o.a)(h("network-only")):c.a.createResultsWithCacheObservable(h("cache-only"),h("network-first"),void 0,(function(e){return f.error(e)})).results).pipe(Object(a.a)(1)).toPromise(),f.toPromise()]},e}()},Xpk8:function(e,t,n){},Y22C:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){this.queuedEvents=[]}return e.prototype.queueEvent=function(e){this.queuedEvents.push(e)},e.prototype.drainQueue=function(){return this.queuedEvents.splice(0,this.queuedEvents.length)},e}()},YnSq:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d}));var i=n("bb6g"),r=n("e3cR"),o=n("obr3"),a=new Map,l="items";function s(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var c,u,d,p,h;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(u=a.get(c=e+".office-start-simple-persistence."+t))return[2,u];i.label=1;case 1:return i.trys.push([1,3,,7]),[4,d=Object(r.b)(c,{upgrade:function(e){try{e.deleteObjectStore(l)}catch(e){}e.createObjectStore(l)},blocking:function(){d.then((function(e){e.close(),a.delete(c)}))},terminated:function(){a.delete(c)}},n)];case 2:return p=i.sent(),a.set(c,d),[2,p];case 3:return(h=i.sent())instanceof DOMException?[4,Object(o.a)(c)]:[3,5];case 4:return i.sent(),[2,s(e,t,n)];case 5:throw new Error("Failed to create database with exception: "+h.toString());case 6:return[3,7];case 7:return[2]}}))}))}function c(e,t,n,o,a,c,u){return void 0===c&&(c=[]),void 0===u&&(u="replace"),Object(i.__awaiter)(this,void 0,void 0,(function(){var d,p,h,f,m,b,v;return Object(i.__generator)(this,(function(g){switch(g.label){case 0:return[4,s(e,t,n)];case 1:d=g.sent(),g.label=2;case 2:g.trys.push([2,7,8,9]),p=Object(i.__values)(c),h=p.next(),g.label=3;case 3:return h.done?[3,6]:(f=h.value).onBeforeWriteValue?[4,f.onBeforeWriteValue(a,o,{userId:e,collectionName:t,collectionVersion:n})]:[3,5];case 4:a=g.sent(),g.label=5;case 5:return h=p.next(),[3,3];case 6:return[3,9];case 7:return m=g.sent(),b={error:m},[3,9];case 8:try{h&&!h.done&&(v=p.return)&&v.call(p)}finally{if(b)throw b.error}return[7];case 9:return a?[2,Object(r.e)(d,[a],l,u,[o])]:[2]}}))}))}function u(e,t,n,o,a){return void 0===a&&(a=[]),Object(i.__awaiter)(this,void 0,void 0,(function(){var c,u,d,p,h,f,m,b;return Object(i.__generator)(this,(function(v){switch(v.label){case 0:return[4,s(e,t,n)];case 1:return c=v.sent(),[4,Object(r.c)(c,l,o)];case 2:if(!(u=v.sent()))return[2,null];v.label=3;case 3:v.trys.push([3,8,9,10]),d=Object(i.__values)(a),p=d.next(),v.label=4;case 4:return p.done?[3,7]:(h=p.value).onAfterReadValue?[4,h.onAfterReadValue(u,o,{userId:e,collectionName:t,collectionVersion:n})]:[3,6];case 5:u=v.sent(),v.label=6;case 6:return p=d.next(),[3,4];case 7:return[3,10];case 8:return f=v.sent(),m={error:f},[3,10];case 9:try{p&&!p.done&&(b=d.return)&&b.call(d)}finally{if(m)throw m.error}return[7];case 10:return[2,u]}}))}))}function d(e,t,n,o){return Object(i.__awaiter)(this,void 0,void 0,(function(){var a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,s(e,t,n)];case 1:return a=i.sent(),[4,Object(r.a)(a,l,o)];case 2:return i.sent(),[2]}}))}))}},Z0U4:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("bb6g"),r=n("X+PR"),o=n("AlWG"),a=n("dpyN"),l=n("zvoD"),s=n("hhzZ"),c=n("BaAg"),u=n("4/We"),d=n("ZBli"),p=n("uzn7"),h=n("5aVq"),f=n("BMb5"),m=n("keVe"),b=n("TOqr"),v=function(){function e(t,n,i,r,l,s,c,u,d){var p=this;this.activatedRoute=t,this.capabilitiesService=n,this.instrumentationService=i,this.localStorageService=r,this.locationStrategy=l,this.platformLocation=s,this.router=c,this.windowService=u,this.shellShimService=d;var h=this.windowService.nativeWindow.history;if(this.historyEnabled=!!h&&!!h.go,this.historyEnabled)try{this.lastPoppedState=this.parseState(h.state),this.windowService.nativeWindow.addEventListener("popstate",(function(e){p.lastPoppedState=p.parseState(e.state)}))}catch(e){this.historyEnabled=!1}this.historyEnabled||this.instrumentationService.logGenericEvent("History_Disabled"),this.initialRoute=this.currentRouteFromPath(this.platformLocation.pathname),this._routes=new o.a({currentRoute:this.initialRoute,type:0}),this.routes=this._routes.asObservable().pipe(Object(a.a)((function(t,n){return t.type===n.type&&e.areRoutesEqual(t.currentRoute,n.currentRoute)}))),this.nativeSearchEnabled=this.capabilitiesService.capabilities.nativeSearchInHeaderEnabled}return e.areRoutesEqual=function(e,t){return!(!e||!t||e.route!==t.route)&&("M365Apps"===e.route&&"M365Apps"===t.route?e.appId===t.appId&&e.entityId===t.entityId&&e.subEntityId===t.subEntityId:"SpaceGallery"===e.route&&"SpaceGallery"===t.route||"SpaceContent"===e.route&&"SpaceContent"===t.route?e.spaceId===t.spaceId:e.app===t.app)},e.prototype.start=function(){var t=this;this.router.events.pipe(Object(l.a)((function(e){return e instanceof r.e||e instanceof r.d}))).subscribe((function(n){var i=n.url?n.url.split("?")[0]:null,o=t.currentRouteFromPath(i),a={currentRoute:o,type:n instanceof r.e?0:1},l=!t.ignoreNextNavigation&&(!t.currentRouteState||!e.areRoutesEqual(o,t.currentRouteState.routeItem)||t.rewriteInProgress);if(t.isRouteChangeEndEvent(a)){if("eager"===t.router.urlUpdateStrategy&&(t.router.urlUpdateStrategy="deferred"),t.ignoreNextNavigation)return void(t.ignoreNextNavigation=!1);var s={routeItem:o,index:t.historyEnabled?t.windowService.nativeWindow.history.length:-1,backRouteItem:null,backIndex:-1,version:e.officeRouteStateVersion};if(t.lastPoppedState&&e.areRoutesEqual(t.lastPoppedState.routeItem,o))s=t.lastPoppedState;else if(t.historyEnabled&&t.currentRouteState){if(s.index!==t.currentRouteState.index+1){var u={};u.Index=s.index.toString(),o&&(u.State=o.route,u.DocumentType=o.app?c.b[o.app]:""),u.Error=t.versionMismatch?"Version":"Index",u.DebugInfo="new: "+JSON.stringify(s)+", current: "+JSON.stringify(t.currentRouteState)+", previous: "+JSON.stringify(t.previousRouteState),t.instrumentationService.logGenericEvent("Unexpected_History_State",u),t.previousRouteState||t.currentRouteState.routeItem&&"OfficeHome"===t.currentRouteState.routeItem.route||(t.historyEnabled=!1,s.index=-1)}if(t.historyEnabled){s.index=t.currentRouteState.index+1;var d=e.areRoutesEqual(t.currentRouteState.routeItem,o);s.backRouteItem=d?t.currentRouteState.backRouteItem:t.currentRouteState.routeItem,s.backIndex=d?t.currentRouteState.backIndex:t.currentRouteState.index}}t.updateState(s),t.lastPoppedState=null,t.previousRouteState=t.currentRouteState,t.currentRouteState=s,t.rewriteInProgress=!1,a.previousRoute=t.previousRouteState?t.previousRouteState.routeItem:null,a.backRoute=s.backRouteItem}l&&t._routes.next(a)}))},e.prototype.hasNavigated=function(){return this.router.navigated},e.prototype.back=function(e){if(void 0===e&&(e=null),this.currentRouteState){this.nativeSearchEnabled&&this.currentRouteState.routeItem&&"Search"===this.currentRouteState.routeItem.route&&this.shellShimService.getShellShim().then((function(e){e.Search.SetSearchText("")}));var t=this.currentRouteState.backIndex-this.currentRouteState.index;this.historyEnabled&&this.currentRouteState.backIndex>=0&&t<0?this.windowService.nativeWindow.history.go(t):e?this.navigateTo(e):this.platformLocation.back()}else e&&this.navigateTo(e)},e.prototype.navigateToPath=function(e){void 0===e&&(e="/");for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=[e].concat(t),o=Object(i.__assign)({},this.activatedRoute.snapshot.queryParams);return this.navigateToInternal(r,!1,o)},e.prototype.getNavigationUrl=function(e){void 0===e&&(e="/");for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=[e].concat(t),o=Object(i.__assign)({},this.activatedRoute.snapshot.queryParams);return this.router.serializeUrl(this.router.createUrlTree(r,{queryParams:o}))},e.prototype.navigateTo=function(e,t,n,r,o){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===o&&(o=!1);var a=this.getCommandsAndParamsForRoute(e,n);if(a){var l=Object(i.__read)(a,2);return this.navigateToInternal(l[0],t,l[1],r,o)}},e.prototype.getUrlForRoute=function(e,t){void 0===t&&(t=null);var n=this.getCommandsAndParamsForRoute(e,t);if(n){var r=Object(i.__read)(n,2),o=r[1],a=r[0].reduce((function(e,t){return e+t.split("/").filter((function(e){return!!e})).join("/")+"/"}),this.platformLocation.protocol+"//"+this.platformLocation.hostname+"/");return d.a.appendQueryParams(a,o)}},e.prototype.updateQueryParams=function(e){var t=this;this.ignoreNextNavigation=!0,this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:e,queryParamsHandling:"merge",replaceUrl:!0}).then((function(){t.ignoreNextNavigation=!1})).catch((function(){t.ignoreNextNavigation=!1}))},e.prototype.navigateToAuxilaryRoute=function(e,t){var n={};n[e]=t?[t]:null,this.ignoreNextNavigation=!0,this.router.navigate([{outlets:n}],{queryParamsHandling:"preserve",skipLocationChange:!0})},e.prototype.redirectAndRewrite=function(e){void 0===e&&(e="/");for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.currentRouteState=this.previousRouteState,this.rewriteInProgress=!0;var i=[e].concat(t);if(this.capabilitiesService.capabilities.isEmbedMode){var r=i.shift(),o=r.split("/").join("");i.unshift("/Embed/".toLowerCase(),o)}this.router.navigate(i,{queryParamsHandling:"preserve",replaceUrl:!0})},e.prototype.subscribeToRouteChangeStart=function(e){return this.routes.pipe(Object(l.a)(this.isRouteChangeStartEvent)).subscribe(e)},e.prototype.subscribeToRouteChangeEnd=function(e){return this.routes.pipe(Object(l.a)(this.isRouteChangeEndEvent)).subscribe(e)},e.prototype.getRouteChangeStartObservable=function(){return this.routes.pipe(Object(l.a)(this.isRouteChangeStartEvent))},e.prototype.getRouteChangeEndObservable=function(){return this.routes.pipe(Object(l.a)(this.isRouteChangeEndEvent))},e.prototype.isOnRoute=function(e){return this.currentRouteState.routeItem.route===e},e.prototype.getCurrentRoute=function(){return this.currentRouteState?this.currentRouteState.routeItem:null},e.prototype.getCurrentPageForLogging=function(){var e=this.getCurrentRoute();return e?""+(e.app?c.b[e.app]:"")+e.route:"Unknown"},e.prototype.getInitialRoute=function(){return this.initialRoute},e.prototype.getRouteItemForCurrentLocation=function(){return this.currentRouteFromPath(this.platformLocation.pathname)},e.prototype.isRouteChangeStartEvent=function(e){return 0===e.type},e.prototype.isRouteChangeEndEvent=function(e){return 1===e.type},e.prototype.getCommandsAndParamsForRoute=function(e,t){if(void 0===t&&(t=null),e){var n=Object(i.__assign)({},this.activatedRoute.snapshot.queryParams);"Search"!==e.route&&this.currentRouteState&&this.currentRouteState.routeItem&&("Search"===this.currentRouteState.routeItem.route||"SearchPersonScoped"===this.currentRouteState.routeItem.route)&&(delete n.q,delete n.p,delete n.e,delete n.s,delete n.pp,delete n.refiners,delete n.wm),this.currentRouteState&&this.currentRouteState.routeItem&&"Content"===this.currentRouteState.routeItem.route&&(delete n.item,delete n.drive,delete n.file,delete n.action,delete n.siteUrl,delete n.abpId,delete n.t),t&&(n=Object(i.__assign)(Object(i.__assign)({},n),t));var r=[];switch(e.route){case"AppGallery":r.push("apps");break;case"Search":case"SearchSiteScoped":r.push("search");break;case"SearchPersonScoped":r.push("search/content");break;case"Start":r.push(this.capabilitiesService.capabilities.startPageRootPath);break;case"Templates":r.push(this.capabilitiesService.capabilities.templatePageRootPath);break;case"Pwa":r.push("pwa");break;case"Create":r.push("create");break;case"Content":case"MyForms":case"GroupForms":r.push(this.capabilitiesService.capabilities.startPageRootPath);break;case"M365Apps":r.push(this.capabilitiesService.capabilities.m365AppsPageRootPath),e.appId&&(r.push(e.appId),e.entityId&&(r.push(e.entityId),e.subEntityId&&r.push(e.subEntityId)));break;case"M365AppsSideload":r.push("m365apps/sideload");break;case"ConsumerAllSearch":r.push("search/main");break;case"ConsumerFileSearch":r.push("search/docs");break;case"ConsumerTemplateSearch":r.push("search/templates");break;case"SpaceGallery":case"SpaceContent":r.push("spaces");break;case"MyContent":r.push("mycontent");break;default:r.push("home")}if(e.app&&r.push(e.app===c.b.Spaces&&"Content"===e.route?"Fluid":c.b[e.app]),"MyForms"===e.route&&r.push("MyForms"),"GroupForms"===e.route&&r.push("GroupForms"),"Content"===e.route&&r.push(this.capabilitiesService.capabilities.wacHostPagePath.replace("/","")),"SpaceContent"===e.route&&r.push(e.spaceId),this.capabilitiesService.capabilities.isEmbedMode){var o=r.shift().split("/").join("");r.unshift("/Embed/",o)}return[r.map((function(e){return e.toLowerCase()})),n]}},e.prototype.currentRouteFromPath=function(e){var t,n,i;if(!e)return null;var r=null,o=null;if(0===(e=e.toLowerCase()).indexOf("/embed")&&(e=e.replace("/embed","")),"/"===e||0===e.indexOf("/home"))r=this.capabilitiesService.capabilities.pwaEnabled?"Pwa":"OfficeHome";else if(0===e.indexOf("/apps"))r="AppGallery";else if(0===e.indexOf("/search"))r=this.isSiteScopedSearchRoute(e)?"SearchSiteScoped":this.isPersonScopedSearchRoute(e)?"SearchPersonScoped":"Search";else if(0===e.indexOf("/pwa"))r="Pwa";else{if(0===e.indexOf("/m365apps"))return{route:r="M365Apps",appId:null!==(t=(a=e.split("/").filter((function(e){return!!e})))[1])&&void 0!==t?t:void 0,entityId:null!==(n=a[2])&&void 0!==n?n:void 0,subEntityId:null!==(i=a[3])&&void 0!==i?i:void 0};if(0===e.indexOf("/create"))r="Create";else{var a;if(0===e.indexOf("/spaces"))return r=1===(a=e.split("/").filter((function(e){return!!e}))).length?"SpaceGallery":"SpaceContent",a.length>1?{route:r,spaceId:a[1]}:{route:r};if(0===e.indexOf("/mycontent"))r="MyContent";else{var l=0===e.indexOf(this.capabilitiesService.capabilities.templatePageRootPath.toLowerCase()),s=0===e.indexOf(this.capabilitiesService.capabilities.startPageRootPath.toLowerCase()),u=e.indexOf(this.capabilitiesService.capabilities.wacHostPagePath.toLowerCase())>=0&&s,d=e.toLocaleLowerCase().indexOf("/myforms")>=0&&s,p=e.toLocaleLowerCase().indexOf("/groupforms")>=0&&s;if(l||s||u||d||p){var h=e.split("/");r=l?"Templates":u?"Content":d?"MyForms":p?"GroupForms":"Start",o=c.a.fileTypeNameToFileType(h[u||d||p?h.length-2:h.length-1])}}}}return r?{route:r,app:o}:null},e.prototype.navigateToInternal=function(e,t,n,i,r){return void 0===t&&(t=!1),void 0===n&&(n={}),void 0===r&&(r=!1),t&&(this.currentRouteState=this.previousRouteState,this.rewriteInProgress=!0),i&&e.length&&this.localStorageService.set(i,e[0]),this.router.urlUpdateStrategy=r?"eager":"deferred",this.router.navigate(e,{queryParams:n,replaceUrl:t})},e.prototype.parseState=function(t){var n=t?t.ohpState:null;return n&&n.version!==e.officeRouteStateVersion&&(this.versionMismatch=!0),this.versionMismatch?null:n},e.prototype.updateState=function(e){if(this.historyEnabled){var t=this.windowService.nativeWindow.history.state?Object(i.__assign)({},this.windowService.nativeWindow.history.state):{};t.ohpState=e,this.locationStrategy.replaceState(t,"",this.platformLocation.pathname,this.platformLocation.search+this.platformLocation.hash)}},e.prototype.isSiteScopedSearchRoute=function(e){return e.startsWith("/search/siteall")||e.startsWith("/search/sitenews")||e.startsWith("/search/sitesites")||e.startsWith("/search/sitefiles")||e.startsWith("/search/siteimages")},e.prototype.isPersonScopedSearchRoute=function(e){return e.startsWith("/search/content")||e.startsWith("/search/contact")||e.startsWith("/search/organization")||e.startsWith("/search/calendar")||e.startsWith("/search/office")},e.officeRouteStateVersion=1,e.ɵprov=m.cc({factory:function(){return new e(m.dc(r.a),m.dc(u.a),m.dc(s.a),m.dc(p.a),m.dc(b.h),m.dc(b.q),m.dc(r.n),m.dc(f.b),m.dc(h.a))},token:e,providedIn:"root"}),e}()},ZBSS:function(e,t,n){"use strict";n.d(t,"B",(function(){return i})),n.d(t,"C",(function(){return r})),n.d(t,"F",(function(){return o})),n.d(t,"l",(function(){return a})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return s})),n.d(t,"D",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"k",(function(){return h})),n.d(t,"A",(function(){return f})),n.d(t,"a",(function(){return m})),n.d(t,"g",(function(){return b})),n.d(t,"o",(function(){return v})),n.d(t,"p",(function(){return g})),n.d(t,"q",(function(){return y})),n.d(t,"r",(function(){return S})),n.d(t,"s",(function(){return w})),n.d(t,"t",(function(){return C})),n.d(t,"v",(function(){return I})),n.d(t,"w",(function(){return T})),n.d(t,"x",(function(){return k})),n.d(t,"y",(function(){return A})),n.d(t,"z",(function(){return P})),n.d(t,"u",(function(){return E})),n.d(t,"c",(function(){return _})),n.d(t,"b",(function(){return O})),n.d(t,"d",(function(){return F})),n.d(t,"f",(function(){return D})),n.d(t,"E",(function(){return M})),n.d(t,"n",(function(){return R}));var i="Release",r="RequestOrigin",o="UserSegment",a="EventSchemaVersion",l="BrowserSessionId",s="DeploymentEnvironment",c="Geo",u="Flights",d="DeviceType",p="AppWorkload",h="EventCategory",f="PageView",m="Action",b="AudienceGroup",v="IsAdmin",g="IsDynamics",y="IsEdu",S="IsEduFaculty",w="IsEduStudent",C="IsFirstVisit",I="IsIw",T="IsSmb",k="AppName",A="PageName",P="PageType",E="IsIntentional",_="Target",O="Result",F="Type",D="Area",M="SubArea",R="Id"},ZBli:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("pjz5"),r=function(){function e(){}return e.appendQueryParam=function(t,n,i){if(!t||!n)return t;var r={};return r[n]=i,e.appendQueryParams(t,r)},e.appendQueryParams=function(t,n,i){return t?e.appendQuery(t,e.buildQueryPath(n,i)):t},e.appendQuery=function(e,t){if(!e||!t)return e;var n=i.a.getLocation(e),r=n.port,o=n.search;return n.protocol+"//"+n.hostname+(r?":"+r:"")+n.path+(o?o+"&":"?")+t+n.hash},e.appendAndReplaceQueryParams=function(t,n,r,o){if(!t||!n)return t;var a={},l=i.a.getLocation(t),s=l.protocol,c=l.hostname,u=l.path,d=l.search,p=l.hash;for(var h in"?"===d[0]&&d.substring(1).split("&").forEach((function(e){var t=e.split("=");r?a[decodeURIComponent(t[0])]=decodeURIComponent(t[1]):a[t[0]]=t[1]})),n)a[h]=n[h];return e.appendQueryParams(s+"//"+c+u+p,a,o)},e.appendLoginHint=function(t,n,i){return i?e.appendQueryParam(t,"login_hint",n):t},e.removeQueryParams=function(t,n,r){if(!t||!n)return t;var o={},a=i.a.getLocation(t),l=a.protocol,s=a.hostname,c=a.path,u=a.search,d=a.hash;return"?"===u[0]&&u.substring(1).split("&").forEach((function(e){var t=e.split("="),i=r?decodeURIComponent(t[0]):t[0];n.some((function(e){return e.toLowerCase()===i.toLowerCase()}))||(o[i]=r?decodeURIComponent(t[1]):t[1])})),e.appendQueryParams(l+"//"+s+c+d,o,!1)},e.buildQueryPath=function(e,t){if(!e)return"";var n="";for(var i in e)n=n+(n?"&":"")+i+"="+(t?e[i]?""+e[i]:"":e[i]?""+encodeURIComponent(e[i]):"");return n},e.replacePathAndAddParams=function(t,n,r){var o=r?e.appendAndReplaceQueryParams(t,r,!1):t,a=i.a.getLocation(o),l=a.port;return a.protocol+"//"+a.hostname+(l?":"+l:"")+n+a.search+a.hash},e}()},ZJrL:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.parseJsonElementWithId=function(e){var t=document.getElementById(e),n=t&&t.textContent;return n?JSON.parse(n):null},e.decodeJsonString=function(e){var t=e.split('"');return t.forEach((function(e,t,n){var i=decodeURIComponent(e);n[t]=i.replace(/"/g,'\\"')})),t.join('"')},e}()},ZcZ3:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("6ib3"),r=n("Tqea");function o(e){switch(e){case i.a.Word:return"WordOnline";case i.a.Excel:return"ExcelOnline";case i.a.PowerPoint:return"PowerPointOnline";case i.a.OneNote:return"OneNoteOnline";case i.a.Sway:return"Sway";case i.a.Visio:return"VisioOnline";case i.a.Project:case i.a.ProjectOperations:case i.a.Portfolio:return"Project";case i.a.PowerBI:return"PowerBIv2";default:return Object(r.a)(e)}}},Zmq1:function(e,t,n){"use strict";var i;function r(e){var t=parseInt(e);return isNaN(t)?0:t}function o(){if(i)return i;var e=window.navigator.userAgent.toLowerCase(),t={keyword:"Other",platformType:"Other"};[{keyword:"Windows NT",platformType:"PC"},{keyword:"Windows XP",platformType:"PC"},{keyword:"Macintosh",platformType:"Mac"},{keyword:"Windows Phone",platformType:"WindowsPhone",pageName:"windows-phone"},{keyword:"iPad",platformType:"iPad",pageName:"ipad"},{keyword:"iPhone",platformType:"iPhone",pageName:"iphone"},{keyword:"Android",platformType:"AndroidPhone",pageName:"android-phone"},{keyword:"Linux",platformType:"Linux"},{keyword:"CrOS",platformType:"Chromebook"}].some((function(n){return-1!==e.indexOf(n.keyword.toLowerCase())&&(t=n,!0)})),"AndroidPhone"===t.platformType&&-1===e.indexOf("mobile")&&(t={keyword:"Android",platformType:"AndroidTablet",pageName:"android-tablet"});var n={major:0,minor:0,build:0};if("Mac"===t.platformType)(o=/Mac OS X (\d+)(_|\.)(\d+)([_\.]?)(\d*)/i.exec(window.navigator.userAgent))&&o.length>=6&&(n={major:r(o[1]),minor:r(o[3]),build:r(o[5])});else if("PC"===t.platformType||"WindowsPhone"===t.platformType)-1!==e.indexOf("windows xp")?n={major:5,minor:1,build:0}:(o=/Windows (NT|Phone) (OS )?(\d+)\.(\d+)/i.exec(window.navigator.userAgent))&&o.length>=5&&(n={major:r(o[3]),minor:r(o[4]),build:0});else if("iPad"===t.platformType||"iPhone"===t.platformType){var o;n={major:r((o=e.match(/os (\d+)_(\d+)(_(\d+))?/))&&o[1]),minor:r(o&&o[2]),build:r(o&&o[4])}}var a={keyword:"Other",browserType:"Other"};return[{keyword:"PhantomJS",browserType:"Headless"},{keyword:"Edge",browserType:"Edge"},{keyword:"MSIE",browserType:"IE"},{keyword:"Edg",browserType:"EdgeChromium"},{keyword:"Chrome",browserType:"Chrome"},{keyword:"CriOS",browserType:"Chrome"},{keyword:"Firefox",browserType:"Firefox"},{keyword:"Safari",browserType:"Safari"}].some((function(t){return-1!==e.indexOf(t.keyword.toLowerCase())&&(a=t,!0)})),i={platform:t,platformVersion:n,browser:a}}n.d(t,"a",(function(){return o}))},ZtId:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},Zy3K:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("BaAg"),n("4/We"),n("PBJH"),n("Bcjp");var i=function(){function e(e,t){this.capabilitiesService=e,this.locService=t}return e.prototype.ngOnInit=function(){this.createLocation=this.locService.BrandOneDrive,this.createLocationPrompt=this.locService.appResource("CreateNewLocationPrompt",this.app),this.oneDriveColor="#0078D4",this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh},e}()},aQ3G:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("bb6g"),r=n("3GGT"),o=n("uUrA"),a=n("Uqr9"),l=n("pOWU"),s=function(){return function(){}}(),c=function(){function e(){this.cachedResponsePromises=new Map}return e.prototype.set=function(e,t,n,i){var r=this.key(t,n,i);this.cachedResponsePromises.set(r,e)},e.prototype.has=function(e,t,n){var i=this.key(e,t,n);return this.cachedResponsePromises.has(i)},e.prototype.get=function(e,t,n){var i=this.key(e,t,n);return this.cachedResponsePromises.get(i)},e.prototype.delete=function(e,t,n){var i=this.key(e,t,n);return this.cachedResponsePromises.delete(i)},e.prototype.key=function(e,t,n){return(t?"beta":"v1.0")+"/"+n+"/"+e},e}(),u=function(e){function t(t,n,i,r,o,a,l,s){var u=e.call(this,t,n,i,"Graph",r,o,a,s)||this;u.globalErrorHandler=l,u.cachedResponsePromises=new c;var d=r.sharedContext;return u.graphServiceHost=u.inMockMode?d.officeHomeApiRoot:d.graphApiRoot,u.requestConfig={headers:new Map},u}return Object(i.__extends)(t,e),t.prototype.getGraph=function(t,n,i,r,o,a,s,c,u,d,p,h){var f=this;if(void 0===o&&(o=!1),void 0===u&&(u=!1),void 0===p&&(p=null),void 0===h&&(h=!1),!h&&this.cachedResponsePromises.has(n,u,i))return this.cachedResponsePromises.get(n,u,i);var m=new Promise((function(h,m){var b=f.getGraphServiceEndpoint(n,u);b||m(new l.b(null,"Graph service endpoint url is not defined"));var v=f.getRequestConfig();v.responseType=void 0!==d?d:"json",e.prototype.get.call(f,t,b,(function(e){e.instrument((function(e,t){t.params.RequestId=f.getRequestIdFromResponse(e),r&&r(e,t)})).then((function(e){return h(e)})).catch((function(e){f.globalErrorHandler.handleError(e,"XDHsY")}))}),(function(e){o&&f.cachedResponsePromises.delete(n,u,i),m(e)}),v,i,a,s,c,void 0,void 0,p)}));return o&&this.cachedResponsePromises.set(m,n,u,i),m},t.prototype.postGraph=function(t,n,i,r,o,a,l,s,c,u,d,p,h){void 0===u&&(u=!1),void 0===d&&(d=!1),void 0===p&&(p=null),void 0===h&&(h=void 0);var f=this.getGraphServiceEndpoint(n,u),m=this.getRequestConfig();return void 0!==h&&h.forEach((function(e,t){m.headers.set(t,e)})),e.prototype.post.call(this,t,f,i,r,o,m,a,l,s,c,void 0,null,null,null,d,p)},t.prototype.putGraph=function(t,n,i,r,o,a,l,s,c,u){void 0===u&&(u=!1);var d=this.getGraphServiceEndpoint(n,u);return e.prototype.put.call(this,t,d,i,r,o,this.getRequestConfig(),a,l,s,c)},t.prototype.batchGraph=function(e,t){for(var n=this.contextService.sharedContext.graphMaxBatchSize,r=[],o=0;o<e.length;o+=5)r.push(this.batchGraphMaxSize(e.slice(o,o+n),t));return Promise.all(r).then((function(e){return[].concat.apply([],Object(i.__spread)(e))}))},t.prototype.patchGraph=function(t,n,i,r,o,a,l,s,c,u,d,p,h){void 0===h&&(h=!1);var f=this.getGraphServiceEndpoint(n,h),m=a||this.getRequestConfig();return e.prototype.patch.call(this,t,f,i,r,o,m,l,s,c,u,d,p)},t.prototype.handleQueryParam=function(e,n,i){"mockgraph"===e&&(null==i||i.headers.set(t.mockGraphHeader,n))},t.prototype.getRequestConfig=function(e){return void 0===e&&(e={}),Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},this.requestConfig),{headers:new Map(this.requestConfig.headers)}),e)},t.prototype.batchGraphMaxSize=function(e,t){var n=this,i=this.contextService.sharedContext.graphMaxBatchSize;if(e.length>i)return Promise.reject(new l.b(null,"Batch requests limited to "+i+" items"));var r="network-only",o=function(e){return e.cacheResult&&"GET"===e.method},a=e.filter((function(e){return!o(e)||!n.cachedResponsePromises.has(e.endpoint,!0,r)})),c=this.batchGraphUncached(a,t),u=0,d=e.map((function(e){var t=o(e);if(t&&n.cachedResponsePromises.has(e.endpoint,!0,r))return n.cachedResponsePromises.get(e.endpoint,!0,r);var i=u,a=c.then((function(o){if(o&&o.length>i){var a=o[i];return!t||a&&a.ok||n.cachedResponsePromises.delete(e.endpoint,!0,r),a}throw new s})).catch((function(i){return i instanceof s||n.globalErrorHandler.handleError(i,"ioc6B"),t&&n.cachedResponsePromises.delete(e.endpoint,!0,r),null}));return t&&n.cachedResponsePromises.set(a,e.endpoint,!0,r),u++,a}));return Promise.all(d)},t.prototype.batchGraphUncached=function(n,i){var r=this;return new Promise((function(s,c){var u=i||"Graph_Batch_Request",d=r.getGraphServiceEndpoint(t.graphBatchEndpoint,!0),p=n.map((function(e,t){var n=void 0;return e.headers&&(n={},e.headers.forEach((function(e,t){return n[t]=e}))),{id:t,method:e.method.toUpperCase(),url:e.endpoint,headers:n,body:e.body}})),h=p.length,f={requests:p},m=o.a.createGuid(),b=a.a.now();e.prototype.post.call(r,u,d,f,(function(e){return function(e,t,i){e.instrument((function(e,t){if(t.params.RequestId=r.getRequestIdFromResponse(e),t.params.Index=1..toString(),t.params.BatchId=m,t.params.BatchSize=h.toString(),e.ok){var n=e.data.responses||[],i=n.length,o=n.filter((function(e){return e.status>=200&&e.status<300})).length;t.params.ItemCount=i.toString(),t.params.SuccessCount=o.toString(),t.params.ErrorCount=(i-o).toString()}})).then((function(e){var i=e.data;if(i&&(i.responses||i.nextLink)){var o=t.concat(i.responses||[]),u=Math.ceil(a.a.now()-b),d=r.orderAndInstrumentBatchResponses(n,o,e.config,e.fromCache,m,h,u);s(d)}else c(new l.b(e,"Could not parse graph batch response"))})).catch((function(e){r.globalErrorHandler.handleError(e,"wFM08")}))}(e,[])}),(function(e){c(e)}),r.getRequestConfig())}))},t.prototype.orderAndInstrumentBatchResponses=function(e,t,n,i,o,a,l){var s=this;return e.map((function(e,c){var u=t.find((function(e){return e.id===c})),d=u.status.toString(),p=u?{data:u.body,status:u.status,headers:u.headers,config:n,ok:u.status>=200&&u.status<300,statusText:d,fromCache:i}:null,h=s.instrumentationService.generateRequestEvent(e.eventName+"_Batched",u?u.status:r.a.UnexpectedResponse,l,p?null:"Response missing from batch",p.fromCache);return h.params.BatchId=o,h.params.BatchSize=a.toString(),h.params.Index=c.toString(),e.instrumentCallback&&p&&p.ok&&e.instrumentCallback(p,h),h.record(),p}))},t.prototype.getGraphServiceEndpoint=function(e,n){return void 0===n&&(n=!1),this.graphServiceHost?this.graphServiceHost+"/"+(n?t.graphBeta:t.graphV1)+"/"+e:""},t.graphV1="v1.0",t.graphBeta="beta",t.graphBatchEndpoint="$batch",t.mockGraphHeader="ohp-mock-graph",t}(l.a)},aXuH:function(e,t,n){},adME:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(e){this.action=e,this.hoverDelay=100}return e.prototype.onMouseEnter=function(){var e=this;this.enabled()&&(this.hoverTimeout=setTimeout((function(){e.action()}),this.hoverDelay))},e.prototype.onMouseLeave=function(){this.hoverTimeout&&(clearTimeout(this.hoverTimeout),this.hoverTimeout=null)},e}()},b7yv:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("zvoD"),r=n("3Vsh"),o=n("dFxn"),a=n("7Gwk"),l=n("4/We"),s=n("keVe"),c=function(){function e(e,t,n){this.configParserService=e,this.capabilitiesService=t,this.eventService=n}return e.prototype.getConfig=function(){var e=this;if(!this.configPromise){var t=function(){return e.configParserService.parse("firstRunConfig")};if(this.capabilitiesService.capabilities.pwaEnabled)this.configPromise=Promise.resolve(t());else{var n=this.eventService.events.withScope(0).pipe(Object(i.a)((function(e){return"primaryTokensLoaded"===e.name})),Object(r.a)(1)).toPromise();this.configPromise=n.then(t)}}return this.configPromise},e.ɵprov=s.cc({factory:function(){return new e(s.dc(o.a),s.dc(l.a),s.dc(a.a))},token:e,providedIn:"root"}),e}()},bN7T:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return l}));var i=n("bb6g");function r(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return[2,e.getRandomValues(new Uint8Array(12))]}))}))}function o(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}function a(e,t,n,a){return Object(i.__awaiter)(this,void 0,void 0,(function(){var l,s,c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,a(JSON.stringify(e))];case 1:return l=i.sent(),[4,r(n)];case 2:return s=i.sent(),[4,n.subtle.encrypt({name:"AES-GCM",iv:s,tagLength:128},t,l)];case 3:return c=i.sent(),[2,o(s.buffer,c)]}}))}))}function l(e,t,n,r,o){return Object(i.__awaiter)(this,void 0,void 0,(function(){var a,l,s,c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return a=e.slice(0,12),l=e.slice(12,e.byteLength),[4,n.subtle.decrypt({name:"AES-GCM",iv:a,tagLength:128},t,l)];case 1:return s=i.sent(),[4,r(new Uint8Array(s))];case 2:return c=i.sent(),[2,JSON.parse(c,o)]}}))}))}},bvSZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("NL/U"),r=n("Tqea"),o=n("ZcZ3");function a(e,t,n,a,l){var s,c,u,d,p,h={};h.ImpressionId=e.impressionId||"",h.ElementId=t,h.DocumentId=e.id,h.Referral=Object(o.a)(e.fileType),h.Index=n.toString(),h.DocumentType=Object(r.a)(e.fileType),h.Action=a;var f=e.lastAccessedTime?Object(i.a)(e.lastAccessedTime):void 0;return void 0!==f&&(h.InactivityDuration=f.toString()),h.Area=l,h.Pinned=(null===(s=e.isPinned)||void 0===s?void 0:s.toString())||"",h.ItemIsNew=(null===(c=e.isNew)||void 0===c?void 0:c.toString())||"",h.ItemIsShared=(null===(u=e.isShared)||void 0===u?void 0:u.toString())||"",h.IsEmailAttachment=(null===(d=e.isEmailAttachment)||void 0===d?void 0:d.toString())||"",h.IsOnPremOrVanity=(null===(p=e.isOnPremOrVanity)||void 0===p?void 0:p.toString())||"",h}},c8Ce:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("zvoD"),r=n("3Vsh"),o=n("dFxn"),a=n("7Gwk"),l=n("4/We"),s=n("keVe"),c=function(){function e(e,t,n){this.configParserService=e,this.capabilitiesService=t,this.eventService=n}return e.prototype.getConfig=function(){var e=this;if(!this.configPromise)if(this.capabilitiesService.capabilities.pwaEnabled)this.configPromise=Promise.resolve(function(){return e.configParserService.parse("upsellConfig")}());else{var t=this.eventService.events.withScope(0).pipe(Object(i.a)((function(e){return"primaryTokensLoaded"===e.name})),Object(r.a)(1)).toPromise();this.configPromise=t.then((function(){return e.configParserService.parse("upsellConfig")}))}return this.configPromise},e.ɵprov=s.cc({factory:function(){return new e(s.dc(o.a),s.dc(l.a),s.dc(a.a))},token:e,providedIn:"root"}),e}()},cAxl:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("3bNC"),n("AXM8");var i=function(){function e(e){this.graphPictureService=e,this.fetchImage=!0,this.isUpcomingMeeting=!1,this.status="None",this.hasPadding=!1,this.personPictureCard=!1,this.iconSize=this.iconSize||30}return e.prototype.ngOnChanges=function(){var e;if(this.fetchImage){var t=this.pictureId||(null===(e=this.person)||void 0===e?void 0:e.email);this.imageBase64Promise=t?this.graphPictureService.getPeoplePicture(t,this.iconSize<=48?"48x48":void 0):Promise.resolve(null)}else this.imageBase64Promise=Promise.resolve(this.imageBase64)},e}()},cOkY:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"g",(function(){return d}));var i=void 0,r=void 0,o=new Map,a=new Map,l=new Set;function s(){return i}function c(e){i=e}function u(){return r}function d(e){r=e}},cZRF:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("bb6g"),r=n("kMgc"),o=n("bN7T"),a=n("jsgn"),l=n("FHrx"),s=n("COYM"),c=n("keVe"),u=function(){function e(e,t){this.webCryptoService=e,this.encryptionConfigService=t}return Object.defineProperty(e.prototype,"key",{get:function(){return this._keyPromise||(this._keyPromise=this.importKey()),this._keyPromise},enumerable:!0,configurable:!0}),e.prototype.importKey=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,Object(a.a)(this.encryptionConfigService.config.cryptoKey,this.webCryptoService.crypto.subtle)]}))}))},e.ɵprov=c.cc({factory:function(){return new e(c.dc(s.b),c.dc(l.a))},token:e,providedIn:"root"}),e}(),d=function(){function e(e,t,n){this.encodingService=e,this.encryptionKeyService=t,this.webCryptoService=n}return e.prototype.encryptData=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.encryptionKeyService.key];case 1:return t=i.sent(),[2,Object(o.b)(e,t,this.webCryptoService.crypto,(function(e){return n.encodingService.encode(e)}))]}}))}))},e.prototype.decryptData=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.encryptionKeyService.key];case 1:return n=i.sent(),[2,Object(o.a)(e,n,this.webCryptoService.crypto,(function(e){return r.encodingService.decode(e)}),t)]}}))}))},e.ɵprov=c.cc({factory:function(){return new e(c.dc(r.a),c.dc(u),c.dc(s.b))},token:e,providedIn:"root"}),e}()},casz:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("bb6g"),r=n("UY9y"),o=n.n(r),a=n("lrJm"),l=n("x+6c"),s=n("WLAd"),c=n("Uqr9"),u=n("BMb5"),d=n("keVe"),p=function(){function e(e,t,n,i,r){var a=this;this.idleCallbackService=e,this.errorHandler=t,this.pageVisibilityService=n,this.windowService=i,this.performanceService=r,this.heap=new o.a([],(function(e,t){return a.compare(e,t)})),this.isProcessing=!1,this.shouldLogFirstIdle=this.pageVisibilityService.isVisible(),this.shouldLogFirstSchedule=!0,this.setOnVisibilityChange(),this.setOnGlobalWindow()}return e.prototype.scheduleWork=function(e,t){if(0===t)return e(),this.createNoopHandle();this.shouldLogFirstSchedule&&(this.shouldLogFirstSchedule=!1,this.performanceService.mark("First_Schedule"));var n={work:e,priority:t,cancelled:!1,completed:!1},i=this.createHandle(n);return this.heap.push(n),this.dequeueWhenIdle(),i},e.prototype.hasTasks=function(){return!!this.heap.peek()},Object.defineProperty(e.prototype,"FCI",{get:function(){return void 0!==this.firstIdle?this.firstIdle:-1},enumerable:!0,configurable:!0}),e.prototype.createHandle=function(e){var t=this,n=function(){return e.cancelled=!0};return{cancel:n,cancelAndRunNow:function(){e.cancelled||(n(),e.completed||(e.work(),e.completed=!0))},adjustPriority:function(i){return n(),e.completed?t.createNoopHandle():t.scheduleWork(e.work,i)}}},e.prototype.createNoopHandle=function(){return{cancel:function(){return null},cancelAndRunNow:function(){return null},adjustPriority:function(){return null}}},e.prototype.dequeueWhenIdle=function(){var e=this;this.pageVisibilityService.isVisible()?this.idleCallbackHandle||(this.idleCallbackHandle=this.idleCallbackService.runWhenIdle((function(t){e.shouldLogFirstIdle&&(e.shouldLogFirstIdle=!1,e.firstIdle=c.a.now(),e.performanceService.mark("First_Idle")),e.idleCallbackHandle=null,e.doWork(t)}))):this.doWork()},e.prototype.doWork=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(this.isProcessing)return[2];this.isProcessing=!0,i.label=1;case 1:if(this.pageVisibilityService.isVisible()&&!(e&&e.timeRemaining()>0))return[3,6];if(!(t=this.heap.pop()))return[3,6];if(t.cancelled)return[3,1];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,t.work(e)];case 3:return i.sent(),t.completed=!0,[3,5];case 4:return n=i.sent(),this.errorHandler.handleError(n,"DXUlK"),[3,5];case 5:return[3,1];case 6:return this.isProcessing=!1,this.heap.peek()&&this.dequeueWhenIdle(),[2]}}))}))},e.prototype.compare=function(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0},e.prototype.setOnGlobalWindow=function(){this.windowService.nativeWindow.scheduler=this},e.prototype.setOnVisibilityChange=function(){var e=this;this.pageVisibilityService.addOnVisibilityChanged((function(t){"hidden"===t&&(e.shouldLogFirstIdle=!1,e.idleCallbackHandle&&(e.idleCallbackService.cancelIdleCallback(e.idleCallbackHandle),e.idleCallbackHandle=null),e.doWork())}))},e.ɵprov=d.cc({factory:function(){return new e(d.dc(l.a),d.dc(a.b),d.dc(s.a),d.dc(u.b),d.dc(c.b))},token:e,providedIn:"root"}),e}()},cenr:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("8/lW"),r=n("4CZh");function o(e,t,n,o){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===o&&(o=i.a.Security),Object(r.b)(e,"Generic_Event",o,t,n,!0)}},cgnd:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d}));var i,r,o,a=n("lrJm"),l=n("dFxn"),s=n("ZJrL"),c=n("keVe");function u(e){if(!r){r=!0;try{o=e?e.parse("clientStartupConfiguration"):s.a.parseJsonElementWithId("clientStartupConfiguration")}catch(e){throw new a.a("Failure to parse clientStartupConfiguration from response",e)}if(!o)throw new a.a("clientStartupConfiguration is not present in response");var t=o.authTypeString;"MSA"===t?(o.authType=i.MSA,window.pwaCurrentUserId&&0===window.pwaCurrentUserId.indexOf("consumers_")&&(o.puid=window.pwaCurrentUserId.substring("consumers_".length)),window.userPrincipalName&&(o.userPrincipalName=window.userPrincipalName,o.loginHint=window.userPrincipalName)):o.authType="OrgId"===t?i.OrgId:i.Unknown,o.isV2Auth="2.0"===o.authVersion}return function(e){var t;t=e.length?"https://"+e:window.location.origin,n.p=t+="/bundles/"}(o.cdnDomain),o}!function(e){e[e.MSA=0]="MSA",e[e.OrgId=1]="OrgId",e[e.Unknown=-1]="Unknown"}(i||(i={}));var d=function(){function e(e){this.config=u(e)}return e.ɵprov=c.cc({factory:function(){return new e(c.dc(l.a))},token:e,providedIn:"root"}),e}()},ci1G:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},cj6A:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("bb6g"),r=n("4/We"),o=n("hZW2"),a=n("casz"),l=n("keVe"),s=function(){function e(e,t,n,i){this.capabilitiesService=e,this.documentService=t,this.ngModuleLoader=n,this.scheduler=i,this.routeModuleMap=new Map([["Start","./wac-start/wac-start.module#WacStartModule"],["AppGallery","./app-gallery/app-gallery.module#AppGalleryModule"],["Templates","./templates/templates.module#TemplatesModule"]]),this.preloadedRoutes=new Set,this.prefetchedDns=new Set}return e.prototype.preload=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return e?this.isOfficeRoute(e)&&this.routeModuleMap.has(e)?[4,this.preloadRoute(e)]:[3,2]:[2];case 1:return t.sent(),[3,3];case 2:e.startsWith("https")&&this.prefetchDns(e),t.label=3;case 3:return[2]}}))}))},e.prototype.isOfficeRoute=function(e){return!e.startsWith("http")},e.prototype.preloadRoute=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return"Start"!==e||this.capabilitiesService.capabilities.wacStartPageEnabled?this.preloadedRoutes.has(e)?[3,3]:(this.preloadedRoutes.add(e),[4,new Promise((function(e){return t.scheduler.scheduleWork(e,3)}))]):[2];case 1:return n.sent(),[4,this.ngModuleLoader.load(this.routeModuleMap.get(e))];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},e.prototype.prefetchDns=function(e){if(!this.prefetchedDns.has(e)){this.prefetchedDns.add(e);var t=new Map([["rel","dns-prefetch"],["href",e]]);this.documentService.addLinkTag(t)}},e.ɵprov=l.cc({factory:function(){return new e(l.dc(r.a),l.dc(o.a),l.dc(l.w),l.dc(a.a))},token:e,providedIn:"root"}),e}()},clUe:function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));var i=n("bb6g"),r=n("j7b/"),o=n("YnSq"),a=n("lwUs"),l=n("lrJm"),s=n("3GGT"),c=n("hhzZ"),u=n("R7NL"),d=n("Vwd8"),p=n("BaAg"),h=n("kpuN"),f=n("6nG3"),m=n("W3Zz"),b=n("Z0U4"),v=n("wwmn"),g=n("casz"),y=n("ZtId"),S=n("Brer"),w=n("pOWU"),C=n("cgnd"),I=n("LQqy"),T=n("/I02"),k=n("PBJH"),A=n("JH4S"),P=n("oAX+"),E=n("idgT"),_=n("keVe"),O=n("TOqr"),F=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p,h,f,m,b,v,g,y){var S=e.call(this,t,l,s,"OfficeHome",r,c,d,g)||this;return S.clientStartupConfigService=n,S.consumerInstallConfigService=i,S.deviceDetector=o,S.globalErrorHandler=a,S.officeRouteService=u,S.startupConfigService=p,S.templatesConfig=h,S.updateContentService=f,S.userContextService=m,S.userProfileService=b,S.locService=v,S.vroomService=y,S.locale=r.sharedContext.officeMarket.toLowerCase(),S.numTemplates=S.templatesConfig.config.numTemplates,S.initializeTemplateCache(),S.requestConfig={headers:new Map},S.templatesStreamMap=new Map,S.enterpriseTemplatesStreamMap=new Map,S.templatesContentStreamMap=new Map,S.deviceInfo=S.deviceDetector.getDeviceInfo(),S}return Object(i.__extends)(t,e),t.prototype.getTemplateContent=function(e,n,i){var r=this;if(this.templatesContentStreamMap.has(e)&&this.templatesContentStreamMap.get(e).has(i))return this.templatesContentStreamMap.get(e).get(i);var o=this.getUrl(e,this.templatesConfig.config.templatesApiEndpoint+t.TEMPLATES_CONTENT_PATH)+"&"+t.templateIdArg+n+"&"+t.templateBinaryUrlArg+i,a=this.fetchTemplateContentData(e,o,n,"cache-only"),l=this.fetchTemplateContentData(e,o,n,"network-first"),s=P.a.createResultsWithCacheObservable(a,l,null,(function(t){r.templatesContentStreamMap.get(e)&&r.templatesContentStreamMap.get(e).delete(i)}));return this.templatesContentStreamMap.get(e)||this.templatesContentStreamMap.set(e,new Map),this.templatesContentStreamMap.get(e).set(i,s),s},t.prototype.getVisioLocalizationLabel=function(e){return this.locService[p.b[e]+"TemplateLabel"]},t.prototype.getTemplatesCollections=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r,a,l,s,c=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!(e&&e.length>0))return[3,8];n=[],r=[],a={},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Promise.all(e.map((function(e){return Object(o.b)(c.clientStartupConfigService.config.puid,t.templatesCollectionPersistenceKey,t.templatesCollectionPersistenceVersion,c.getCacheKey(e),t.templatesPersistencePlugins)})))];case 2:for(n=i.sent(),s=0;s<e.length;++s)n[s]?a[e[s]]=n[s]:r.push(e[s]);return 0===r.length?[2,n]:[3,4];case 3:return i.sent(),r=e,[3,4];case 4:return i.trys.push([4,6,,7]),[4,this.fetchTemplatesCollections(r.join(","))];case 5:for((l=i.sent()).forEach((function(e){e&&e.Templates&&e.Templates.Template&&e.Templates.Template.length>0&&Object(o.c)(c.clientStartupConfigService.config.puid,t.templatesCollectionPersistenceKey,t.templatesCollectionPersistenceVersion,c.getCacheKey(e.CollectionId),e,t.templatesPersistencePlugins)})),s=0;s<r.length;++s)a[r[s]]=l[s];return[2,e.map((function(e){return a[e]})).filter((function(e){return!!e}))];case 6:return i.sent(),[2,n.filter((function(e){return!!e}))];case 7:return[3,9];case 8:return[2,[]];case 9:return[2]}}))}))},t.prototype.getTemplatesRecommended=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!(e&&e.length>0))return[3,8];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(o.b)(this.clientStartupConfigService.config.puid,t.templatesRecommendedPersistenceKey,t.templatesRecommendedPersistenceVersion,this.getCacheKey(e),t.templatesPersistencePlugins)];case 2:return(n=i.sent())?[2,n]:[3,4];case 3:return i.sent(),[3,4];case 4:r=this.getTemplatesRecommendedUrl(e),i.label=5;case 5:return i.trys.push([5,7,,8]),[4,this.fetchTemplatesRecommended(e,r)];case 6:return(a=i.sent())&&a.Template&&a.Template.length&&Object(o.c)(this.clientStartupConfigService.config.puid,t.templatesRecommendedPersistenceKey,t.templatesRecommendedPersistenceVersion,this.getCacheKey(e),a,t.templatesPersistencePlugins),[2,a];case 7:return i.sent(),[3,8];case 8:return[2,null]}}))}))},t.prototype.getTemplates=function(e){var t=this;if(this.templatesStreamMap.has(e))return this.templatesStreamMap.get(e);var n=this.getUrl(e,this.templatesConfig.config.templatesApiEndpoint),i=this.fetchTemplateData(e,n,"cache-only"),r=this.fetchTemplateData(e,n,"network-first"),o=this.updateContentService.getOrAddUpdateStream(this.getUpdateStreamKey(n),(function(){return t.fetchTemplateData(e,n,"network-first")})),a=P.a.createResultsWithCacheObservable(i,r,o,(function(n){return t.templatesStreamMap.delete(e)}));return this.templatesStreamMap.set(e,a),a},t.prototype.updateTemplates=function(e){return this.templatesFromConfig.delete(e),this.templatesStreamMap.delete(e),this.updateContentService.pushUpdate(this.getUpdateStreamKey(this.getUrl(e,this.templatesConfig.config.templatesApiEndpoint)))},t.prototype.getCreateTemplates=function(){var e=this;if(this.createTemplatesStream)return this.createTemplatesStream;var n=this.startupConfigService.config.authType===C.a.OrgId?2:1,i=this.startupConfigService.config.sharedClientStartupContext.flights.replace(/,\s*$/,""),r="&"+t.isIwArg+this.userContextService.user.isIw+"&"+t.isAdminArg+this.userContextService.user.isAdmin+"&"+t.isSmbArg+this.userContextService.user.isSmb+"&"+t.isEduFacultyArg+this.userContextService.user.isEduFaculty+"&"+t.isEduStudentArg+this.userContextService.user.isEduStudent+"&"+t.flightsArg+i+"&"+t.authIdArg+n+"&"+t.pageArg+"Other&"+t.firstVisitAgeInWeeksArg+Math.floor(this.userProfileService.fullDaysSinceFirstVisit()/7)+"&"+t.browserNameArg+m.a[this.deviceInfo.browser.browserType]+"&"+t.osNameArg+m.d[this.deviceInfo.platform.platformType]+"&"+t.osVersionArg+this.deviceInfo.platformVersion+"&"+t.deploymentEnvironmentArg+this.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment,o=this.contextService.sharedContext.officeHomeApiRoot+"/"+this.templatesConfig.config.templatesApiEndpoint+"?"+t.appArg+"Create&"+t.cultureArg+this.locale+"&"+t.limitArg+"20&"+t.isEduArg+this.userContextService.user.isEdu+r,a=this.fetchTemplateData(p.b.None,o,"cache-only"),l=this.fetchTemplateData(p.b.None,o,"network-first"),s=P.a.createResultsWithCacheObservable(a,l,null,(function(t){return e.createTemplatesStream=null}));return this.createTemplatesStream=s,s},t.prototype.getEnterpriseTemplates=function(e,n,i){var r=this;void 0===n&&(n=""),void 0===i&&(i=!1);var o=e.concat(n);if(this.enterpriseTemplatesStreamMap.has(o))return this.enterpriseTemplatesStreamMap.get(o);var a=function(e,n){var r=[];return e&&(r=e.value.filter((function(e){return t.supportedEnterpriseFileTypes.has(p.a.getFileExtension(e.name))||e.folder})).map((function(e){var t=[];if(e.thumbnails.length>0){var n=e.thumbnails[0];t.push(i?{Size:"large",Height:n.large.height,Width:n.large.width,Url:n.large.url,ImageType:"MT"}:{Size:"medium",Height:n.medium.height,Width:n.medium.width,Url:n.medium.url,ImageType:"MT"})}return{AssetId:e.id,Title:e.name,TemplateBinaryUrl:e.webUrl,Thumbnails:t}}))),{Template:r,fromCache:n}},l=this.vroomService.getDriveItemChildrenWithThumbnails(e,n,"cache-only").then((function(e){return a(e,!0)})),s=this.vroomService.getDriveItemChildrenWithThumbnails(e,n,"network-first","BrowseOrgTemplates","AUO").then((function(e){return a(e,!1)})),c=P.a.createResultsWithCacheObservable(l,s,null,(function(e){return r.enterpriseTemplatesStreamMap.delete(o)}));return this.enterpriseTemplatesStreamMap.set(o,c),c},t.prototype.getRequestIdFromOmexResponse=function(e){return this.getHeaderValue(e.headers,"x-ms-request-id")},t.prototype.getEnterpriseTemplatesLibraries=function(){return this.enterpriseTemplateLibraries||(this.enterpriseTemplateLibraries=this.vroomService.getEnterpriseTemplatesLibraries().then((function(e){var t=[];return e&&(t=e.value.map((function(e){return{DriveId:e.id,ItemId:"",Title:e.name}}))),t}))),this.enterpriseTemplateLibraries},t.prototype.isPaidConsumer=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return this.clientStartupConfigService.config.authType!==C.a.MSA?[3,2]:[4,this.consumerInstallConfigService.getCurrentSku()];case 1:return[2,null!==(e=t.sent())&&!(e===f.b.NonActive||e===f.b.NotSubscribed||e===f.b.NotDetected||e===f.b.Perpetual||e===f.b.Perpetual2019)];case 2:return[2,!1]}}))}))},t.prototype.handleQueryParam=function(e,t){"mocktemplates"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)},t.prototype.fetchTemplateContentData=function(e,t,n,r){var o=this;return new Promise((function(a,l){return Object(i.__awaiter)(o,void 0,void 0,(function(){var o,c=this;return Object(i.__generator)(this,(function(i){return o=p.a.fileTypeNameFromType(e),this.get("Template_Content_Request",t,(function(e){e.instrument((function(e,t){e.ok&&(e.data?(t.params.ItemCategory=o,t.params.ElementId=n):t.params.HttpCode=s.a.UnexpectedResponse.toString())})).then((function(e){e.data?a(e):l(new w.b(e,"Null template content response"))})).catch((function(e){c.globalErrorHandler.handleError(e)}))}),l,this.requestConfig,r),[2]}))}))}))},t.prototype.fetchTemplatesCollections=function(e){var t=this,n=this.getTemplatesCollectionUrl(e);return new Promise((function(r,o){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(i){return this.get("Templates_Collections_Request",n,(function(n){n.instrument((function(t,n){var i;if(t.ok)if(t.data&&t.data.Collections&&t.data.Collections.length>0){var r=null===(i=t.data.Collections[0].Templates)||void 0===i?void 0:i.RequestId;n.params.ActualSize=t.data.Collections.length.toString(),n.params.ItemCategory=e,n.params.RequestId=r}else n.params.HttpCode=s.a.UnexpectedResponse.toString()})).then((function(e){if(e.data&&e.data.Collections&&0!==e.data.Collections.length){var n=e.data.Collections.map((function(e){return e&&e.Templates&&e.Templates.Value&&e.Templates.Value.length>0?{CollectionId:e.Collection,Title:e.Collection,Templates:{Template:t.setupTemplates(e.Templates.Value,p.b.None),fromCache:!1}}:null}));n&&0!==n.length||o(new w.b(e,"Null templates response")),r(n)}else o(new w.b(e,"Null templates response"))})).catch((function(e){t.globalErrorHandler.handleError(e,"KAzhF")}))}),o,this.requestConfig,"network-only"),[2]}))}))}))},t.prototype.fetchTemplatesRecommended=function(e,n){var r=this;return new Promise((function(o,a){return Object(i.__awaiter)(r,void 0,void 0,(function(){var r,l=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return r=function(t){t.instrument((function(t,n){if(t.ok)if(t.data&&t.data.Templates.Value&&t.data.Templates.Value.length>0){var i=t.data.Templates.RequestId;n.params.ActualSize=t.data.Templates.Value.length.toString(),n.params.ItemCategory=e,n.params.RequestId=i}else n.params.HttpCode=s.a.UnexpectedResponse.toString()})).then((function(e){if(e.data&&e.data.Templates&&0!==e.data.Templates.Value.length){var t={Template:l.setupTemplates(e.data.Templates.Value,p.b.None),fromCache:!1};t&&0!==t.Template.length||a(new w.b(e,"Null templates response")),o(t)}else a(new w.b(e,"Null templates response"))})).catch((function(e){l.globalErrorHandler.handleError(e,"KlVan")}))},[4,this.isPaidConsumer()];case 1:return i.sent()&&(n+=t.isPremiumString),this.get("Templates_Recommended_Request",n,r,a,this.requestConfig,"network-only"),[2]}}))}))}))},t.prototype.fetchTemplateData=function(e,n,r){var o=this;return new Promise((function(a,l){return Object(i.__awaiter)(o,void 0,void 0,(function(){var o,c,u=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.templatesFromConfig.has(e)?(a({Template:this.templatesFromConfig.get(e),fromCache:"cache-only"===r}),[2]):(o=p.a.fileTypeNameFromType(e),c=function(t){t.instrument((function(e,t){e.ok&&(e.data&&e.data.Templates&&e.data.Templates.Value?(t.params.ActualSize=e.data.Templates.Value.length.toString(),t.params.ItemCategory=o,t.params.RequestId=e.data.Templates.RequestId):t.params.HttpCode=s.a.UnexpectedResponse.toString())})).then((function(t){if(t.data&&t.data.Templates&&t.data.Templates.Value){var n=u.setupTemplates(t.data.Templates.Value,e);a({Template:n,fromCache:t.fromCache})}else l(new w.b(t,"Null templates response"))})).catch((function(e){u.globalErrorHandler.handleError(e,"TFeVI")}))},[4,this.isPaidConsumer()]);case 1:return i.sent()&&(n+=t.isPremiumString),this.get("Templates_Request",n,c,l,this.requestConfig,r),[2]}}))}))}))},t.prototype.initializeTemplateCache=function(){var e=this;this.templatesFromConfig=new Map,this.templatesConfig.getTemplatesInfoPromise().then((function(t){if(t){var n=p.a.fileTypeNameToFileType(t.Application);if(n!==p.b.Unknown){var i=e.setupTemplates(t.Templates.Value,n);e.templatesFromConfig.set(n,i)}}}))},t.prototype.setupTemplates=function(e,t){var n,r;if(t===p.b.Visio)try{for(var o=Object(i.__values)(e),a=o.next();!a.done;a=o.next()){var l=a.value;l.Categories.length&&(l.Title=l.Categories[0].LocalizedTitle)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return e.reduce((function(e,t){return void 0!==t.AssetId&&(t.IsBlank=!1,e.push(t)),e}),[])},t.prototype.getUpdateStreamKey=function(e){return"templates-"+e},t.prototype.getUrl=function(e,n){var i=this.numTemplates;[p.b.VisioBusinessWac,p.b.VisioFlowChartWac,p.b.VisioGeneralWac,p.b.VisioNetworkWac,p.b.VisioSoftwareWac].lastIndexOf(e)>=0&&(i=this.templatesConfig.config.numVisioTemplates);var r=this.officeRouteService.getRouteItemForCurrentLocation(),o=!r||"Start"!==r.route&&"Templates"!==r.route?"Other":r.route+"Page",a=this.startupConfigService.config.authType===C.a.OrgId?2:1,l=this.startupConfigService.config.sharedClientStartupContext.flights.replace(/,\s*$/,""),s="&"+t.isIwArg+this.userContextService.user.isIw+"&"+t.isAdminArg+this.userContextService.user.isAdmin+"&"+t.isSmbArg+this.userContextService.user.isSmb+"&"+t.isEduFacultyArg+this.userContextService.user.isEduFaculty+"&"+t.isEduStudentArg+this.userContextService.user.isEduStudent+"&"+t.flightsArg+l+"&"+t.authIdArg+a+"&"+t.pageArg+o+"&"+t.firstVisitAgeInWeeksArg+Math.floor(this.userProfileService.fullDaysSinceFirstVisit()/7)+"&"+t.browserNameArg+m.a[this.deviceInfo.browser.browserType]+"&"+t.osNameArg+m.d[this.deviceInfo.platform.platformType]+"&"+t.osVersionArg+this.deviceInfo.platformVersion+"&"+t.deploymentEnvironmentArg+this.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment;return this.contextService.sharedContext.officeHomeApiRoot+"/"+n+"?"+t.appArg+p.b[e]+"&"+t.cultureArg+this.locale+"&"+t.limitArg+(i-1)+"&"+t.isEduArg+this.userContextService.user.isEdu+s},t.prototype.getTemplatesCollectionUrl=function(e){return this.contextService.sharedContext.officeHomeApiRoot+"/"+(this.templatesConfig.config.templatesApiEndpoint+t.TEMPLATES_COLLECTION_PATH)+"?"+t.collectionsArg+e+"&"+t.cultureArg+this.locale},t.prototype.getTemplatesRecommendedUrl=function(e){var n=this.startupConfigService.config.authType===C.a.OrgId?2:1,i=this.startupConfigService.config.sharedClientStartupContext.flights.replace(/,\s*$/,""),r="&"+t.browserNameArg+m.a[this.deviceInfo.browser.browserType]+"&"+t.flightsArg+i+"&"+t.isIwArg+this.userContextService.user.isIw+"&"+t.isAdminArg+this.userContextService.user.isAdmin+"&"+t.isSmbArg+this.userContextService.user.isSmb+"&"+t.isEduFacultyArg+this.userContextService.user.isEduFaculty+"&"+t.isEduStudentArg+this.userContextService.user.isEduStudent+"&"+t.authIdArg+n+"&"+t.firstVisitAgeInWeeksArg+Math.floor(this.userProfileService.fullDaysSinceFirstVisit()/7)+"&"+t.pageArg+"Create&"+t.deploymentEnvironmentArg+this.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment+"&"+t.osNameArg+m.d[this.deviceInfo.platform.platformType]+"&"+t.osVersionArg+this.deviceInfo.platformVersion;return this.contextService.sharedContext.officeHomeApiRoot+"/"+(this.templatesConfig.config.templatesApiEndpoint+t.TEMPLATES_RECOMMENDED_PATH)+"?"+t.cultureArg+this.locale+"&"+t.appsArg+e+"&"+t.limitArg+"200"+r},t.prototype.getCacheKey=function(e){return e+"_"+this.locale},t.TEMPLATES_COLLECTION_PATH="/collections",t.TEMPLATES_RECOMMENDED_PATH="/recommended",t.TEMPLATES_CONTENT_PATH="/content",t.collectionsArg="collections=",t.cultureArg="culture=",t.appArg="app=",t.appsArg="apps=",t.limitArg="show=",t.isEduArg="isEdu=",t.flightsArg="flights=",t.isIwArg="isIw=",t.isAdminArg="isAdmin=",t.isSmbArg="isSmb=",t.isEduFacultyArg="isEduFaculty=",t.isEduStudentArg="isEduStudent=",t.authIdArg="authId=",t.pageArg="page=",t.firstVisitAgeInWeeksArg="firstVisitAgeInWeeks=",t.browserNameArg="browserName=",t.osNameArg="osName=",t.osVersionArg="osVersion=",t.deploymentEnvironmentArg="deploymentEnvironment=",t.isPremiumString="&isPremium=1",t.templateIdArg="id=",t.templateBinaryUrlArg="templateBinaryUrl=",t.supportedEnterpriseFileTypes=new Set(["pptx","potx","dotx","xltx"]),t.templatesCollectionPersistenceKey="templates-collection-api",t.templatesCollectionPersistenceVersion=5,t.templatesPersistencePlugins=[Object(a.a)(7*r.a)],t.templatesRecommendedPersistenceKey="templates-recommended-api",t.templatesRecommendedPersistenceVersion=3,t.ɵprov=_.cc({factory:function(){return new t(_.dc(h.b),_.dc(C.b),_.dc(I.a),_.dc(T.a),_.dc(m.b),_.dc(l.b),_.dc(c.a),_.dc(u.a),_.dc(v.a),_.dc(b.a),_.dc(O.q),_.dc(C.b),_.dc(E.a),_.dc(y.a),_.dc(A.a),_.dc(d.b),_.dc(k.a),_.dc(g.a),_.dc(S.a))},token:t,providedIn:"root"}),t}(w.a)},cxfp:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},dFxn:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("lrJm"),r=n("ZJrL"),o=n("keVe"),a=function(){function e(e){this.globalErrorHandler=e}return e.prototype.parse=function(e){try{return r.a.parseJsonElementWithId(e)}catch(n){var t=new i.a("Failure to parse "+e+" from response",n);this.globalErrorHandler.handleError(t)}return null},e.ɵprov=o.cc({factory:function(){return new e(o.dc(o.m))},token:e,providedIn:"root"}),e}()},dOgD:function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));var i=n("lrJm"),r=n("hhzZ"),o=n("R7NL"),a=n("QOOv"),l=n("kpuN"),s=n("pd4Y"),c=n("Z0U4"),u=n("wwmn"),d=n("casz"),p=n("ZtId"),h=n("BMb5"),f=n("4/We"),m=n("cgnd"),b=n("/I02"),v=n("PBJH"),g=n("bb6g"),y=n("kaEK"),S=n("9260"),w=n("BaAg"),C=n("RR/o"),I=n("pOWU"),T=n("uUrA"),k=n("CVeG"),A=n("oAX+"),P=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p,h,f,m){var b=e.call(this,t,r,o,"Substrate",i,l,c,h)||this;b.capabilitiesService=n,b.locService=a,b.mruConfigService=s,b.globalErrorHandler=u,b.startupConfigService=d,b.updateContentService=p,b.dateService=f,b.windowService=m,b.fetchRequestIndex=0;var v=b.capabilitiesService.capabilities;return b.scenario=v.antpLoaded?"OfficeComANTP":v.suggestedActionsEnabled?"OfficeSuggestedActions":v.pwaEnabled?"OfficeComApp":"OfficeComHome",b.section=v.suggestedActionsEnabled?"OfficeSuggestedActions":"OfficeComHome",b.application=v.pwaEnabled?"OfficeComApp":"OfficeComHome",b.baseUrl=b.inMockMode?b.contextService.sharedContext.officeHomeApiRoot:""+b.mruConfigService.config.substrateApiEndpoint,b.officeFeedDataStreams=new Map,b.regExp=new RegExp("{([0-9]+)}"),b.feedFlight=b.mruConfigService.config.officeFeedFlightEnabled,b.startupConfig=b.startupConfigService.config,v.spNewsShadowCallEnabled&&!v.suggestedActionsEnabled&&b.fetchOfficeFeed("network-only",b.baseUrl+"/PeoplePredictionsB2/MicrosoftFeed?section=SharePointNewsFeed&scenario="+b.scenario+"SPNF",!1,4,"MicrosoftFeedSPNF"),b.tamyDataStreamMap=new Map,b}return Object(g.__extends)(t,e),t.prototype.getOfficeFeed=function(){var e=this,n="",i=this.mruConfigService.config;n=i.useFeedS2SApi?this.contextService.sharedContext.officeHomeApiRoot+"/api/officefeed?"+t.locParam+this.contextService.sharedContext.officeMarket+"&feedFlight="+this.getFeedFlight():this.baseUrl+"/PeoplePredictionsB2/MicrosoftFeed?section="+this.section+"&"+t.locParam+this.contextService.sharedContext.officeMarket+"&"+t.newSchema+this.mruConfigService.config.officeFeedNewSchemaEnabled;var r=this.startupConfig.sharedClientStartupContext.flights.toLowerCase(),o=[];if(i.officeFeedFlightControlName&&i.officeFeedFlightName&&(r.includes(i.officeFeedFlightControlName.toLowerCase())?o.push(i.officeFeedExperimentControlName):r.includes(i.officeFeedFlightName.toLowerCase())&&o.push(i.officeFeedExperimentName)),i.officeFeedFlight2ControlName&&i.officeFeedFlight2Name&&(r.includes(i.officeFeedFlight2ControlName.toLowerCase())?o.push(i.officeFeedExperiment2ControlName):r.includes(i.officeFeedFlight2Name.toLowerCase())&&o.push(i.officeFeedExperiment2Name)),i.officeFeedFlight3ControlName&&i.officeFeedFlight3Name&&(r.includes(i.officeFeedFlight3ControlName.toLowerCase())?o.push(i.officeFeedExperiment3ControlName):r.includes(i.officeFeedFlight3Name.toLowerCase())&&o.push(i.officeFeedExperiment3Name)),o.length>0&&(n+="&experiment="+o.join("&experiment=")),this.officeFeedDataStreams.has(n))return this.officeFeedDataStreams.get(n);var a=this.updateContentService.getOrAddUpdateStream("officefeed-"+n,(function(){return e.fetchOfficeFeed("network-first",n,i.useFeedS2SApi)})),l=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchOfficeFeed(n,i.useFeedS2SApi):this.fetchOfficeFeed("network-first",n,i.useFeedS2SApi),s=A.a.createResultsWithCacheObservable(this.fetchOfficeFeed("cache-only",n,i.useFeedS2SApi),l,a,(function(t){return e.officeFeedDataStreams.delete(n)}));return this.officeFeedDataStreams.set(n,s),s},t.prototype.getTamyDocuments=function(e,n){var i=this,r=this.mruConfigService.config.supportedFileTypes,o=n&&n.size?r.filter((function(e){return n.has(w.a.fileTypeNameToFileType(e))})):r,a=o.reduce((function(e,t,n){return e+(n>0?" or ":"")+"resourceVisualization/Type eq '"+t+"'"}),""),l=t.tamyPath,s="$top="+e+"&$filter="+encodeURIComponent(a),c="?"+t.tamyQueryParams+"&"+s,u=this.inMockMode?""+this.contextService.sharedContext.officeHomeApiRoot+l+"/trending"+c:""+this.mruConfigService.config.substrateApiEndpoint+l+c;if(this.tamyDataStreamMap.has(u))return this.tamyDataStreamMap.get(u);var d=this.fetchOfficeFeed("cache-only",u,!1,0,"Trending",!0,o),p=this.fetchOfficeFeed("network-first",u,!1,0,"Trending",!0,o),h=A.a.createResultsWithCacheObservable(d,p,null,(function(e){return i.tamyDataStreamMap.delete(u)}));return this.tamyDataStreamMap.set(u,h),h},t.prototype.logInstrumentation=function(e,t,n,i){var r=this;return new Promise((function(o,a){for(var l=(r.inMockMode?r.contextService.sharedContext.officeHomeApiRoot:r.mruConfigService.config.substrateApiEndpoint)+"/peoplepredictionsb2/Feedback",s=[],c=0;c<e.length;c++)s.push({FeedbackId:e[c],Action:t[c],ItemSource:n[c],Target:i?i[c]:"",Timestamp:new Date(Date.now()).toISOString()});var u={Actions:s},d=r.createRequestConfig(r.startupConfig.sharedClientStartupContext.correlationId,"Feedback");r.post("OfficeFeedInstrumentation",l,u,(function(e){e.instrument((function(e,t){t.params.ItemCategory=s.map((function(e){return e.Action})).join(","),t.params.RequestId=r.getRequestIdFromResponse(e)})).then((function(){return o(null)}))}),a,d,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,r.mruConfigService.config.deferFeedWrite?4:0)}))},t.prototype.performAction=function(e,t,n){var i=this;return new Promise((function(r,o){var a=(i.inMockMode?i.contextService.sharedContext.officeHomeApiRoot:i.mruConfigService.config.substrateApiEndpoint)+"/peoplepredictionsb2/v2/myanalyticsaction",l={FeedbackId:e,Action:t,ActionPayload:n},s=i.createRequestConfig(i.startupConfigService.config.sharedClientStartupContext.correlationId,"Feedback");i.post("OfficeFeedAction",a,l,(function(e){e.instrument((function(e,t){t.params.ItemCategory=l.Action})).then((function(){return r(!0)}))}),o,s,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,0)}))},t.prototype.getStreamsThumbnail=function(e){var t=this;this.inMockMode&&(e=this.contextService.sharedContext.officeHomeApiRoot+"/StreamsThumbnail");var n=new FileReader;return new Promise((function(i,r){var o=t.createRequestConfig(t.startupConfig.sharedClientStartupContext.correlationId,"StreamsThumbnail","blob");t.get("OfficeFeed_Stream_Thumbnail_Request",e,(function(e){e.then((function(e){e&&e.data?(n.onloadend=function(){var e=n.result&&"string"==typeof n.result&&n.result||"";i(e.length>0?e:null)},n.onerror=function(){return i(null)},n.onabort=function(){return i(null)},n.readAsDataURL(e.data)):i(null)})).catch((function(e){t.globalErrorHandler.handleError(e,"AfEUN")}))}),r,o,"network-only")}))},t.prototype.handleQueryParam=function(e,t,n){"mockofficefeed"===e&&this.mockRequestHeader&&n.headers.set(this.mockRequestHeader,t)},t.prototype.prefetchOfficeFeed=function(e,t){var n=this;return this.windowService.nativeWindow.prefetchRecommendedDataPromise?this.windowService.nativeWindow.prefetchRecommendedDataPromise.then((function(e){return e?{items:((n.mruConfigService.config.officeFeedNewSchemaEnabled?e.items:e)||[]).map((function(e){return n.convertItemToMruDataItem(e)})).filter((function(e){var t;return e&&(null===(t=e.Activity)||void 0===t?void 0:t.formatString)})),impressionId:e.recommendedRequestId||"",fromCache:!1}:Promise.reject("Prefetch failed")})):this.fetchOfficeFeed("network-first",e,t)},t.prototype.fetchOfficeFeed=function(e,n,i,o,a,l,s){var c=this;return new Promise((function(u,d){var p=T.a.createGuid(),h=c.createRequestConfig(p,a||"MicrosoftFeed"),f="MicrosoftFeedSPNF"===a;c.get(l?"Trending_Around_Me_Request":"OfficeFeedRequest",n,(function(i){i.instrument((function(i,o){if(o.params.RequestId=c.getRequestIdFromResponse(i),o.params.Index=(c.fetchRequestIndex++).toString(),o.params.ImpressionId=!!i.headers&&i.headers.get(S.a.clientRequestIdHeader)||p,o.params.ApiLatency=(!!i.headers&&i.headers.get(t.e2eLatencyHeader)||-1).toString(),i.ok&&i.data&&!f){var a=c.mruConfigService.config.officeFeedNewSchemaEnabled?i.data.items:i.data;if(a){var l=a.length;o.params.ResourceIdDistribution=a.map((function(e){return e.sharePointIds&&e.sharePointIds.listItemUniqueId?e.sharePointIds.listItemUniqueId:""})).toString(),o.params.OfficeFeedCategoryDistribution=a.map((function(e){return e.category})).toString(),o.params.ActualSize=l.toString()}}else"cache-only"===e&&401===i.status&&(o.params.OfficeFeedUrl=r.a.filterPii(n),o.params.OfficeFeedAuthenticateHeader=i.headers.get("WWW-Authenticate"))})).then((function(t){if(f)u(null);else{var n=t&&t.data&&(c.mruConfigService.config.officeFeedNewSchemaEnabled?t.data.items:t.data)||[];s&&s.length>0&&(n=n.filter((function(e){return s.includes(e.subCategory)})));var i=n.map((function(e){return c.convertItemToMruDataItem(e,l)})),r=l?i:i.filter((function(e){var t;return e&&(null===(t=e.Activity)||void 0===t?void 0:t.formatString)}));u({items:r,impressionId:!!t.headers&&t.headers.get(S.a.clientRequestIdHeader)||p,fromCache:"cache-only"===e})}})).catch((function(e){c.globalErrorHandler.handleError(e,"AfEUN")}))}),d,h,e,null,null,null,i?"OfficeHome":"Substrate",null,o)}))},t.prototype.createRequestConfig=function(e,t,n){var i={headers:new Map([["ScenarioTag",""+this.scenario+t],["Content-Type","application/json"],["X-OfficeFeedFlight",this.getFeedFlight()],["X-AnchorMailbox","Oid:"+this.startupConfig.objectId+"@"+this.startupConfig.tenantId],["X-Application",this.application],["X-ApplicationScenario",this.scenario],["X-RoutingParameter-SessionKey",this.startupConfig.objectId],[S.a.clientRequestIdHeader,e]])};return n&&(i.responseType=n),i},t.prototype.getFeedFlight=function(){return this.feedFlight?"experiment":"evaluation"},t.prototype.convertItemToMruDataItem=function(e,t){return void 0===t&&(t=!1),"file"===e.category.toLowerCase()||"video"===e.category.toLowerCase()?this.convertFileToMruDataItem(e,t):"newsarticle"===e.category.toLowerCase()?this.convertNewsItemToMruDataItem(e):"upcomingmeeting"===e.category.toLowerCase()&&this.mruConfigService.config.upcomingMeetingEnabled?this.convertUpcomingMeetingToMruDataItem(e):"myanalyticsinsight"===e.category.toLowerCase()&&this.mruConfigService.config.myAnalyticsEnabled?this.convertMyAnalyticsToMruDataItem(e):null},t.prototype.convertMyAnalyticsToMruDataItem=function(e){var t,n,i,r=(null===(t=(e.inclusionReasons&&e.inclusionReasons[0]).actors[0])||void 0===t?void 0:t.User)||{},o=r.DisplayName,a={formatString:o,plainText:o,people:[{upn:r.email,tag:"c0",name:r.DisplayName}],reasonType:y.a.MyAnalytics,timestamp:e.createdDateTime?new Date(e.createdDateTime):null},l='"'+(null===(n=e.previewInfo)||void 0===n?void 0:n.text)+'"',s=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):null;return{Application:null,Category:e.category,DocId:null,DriveId:null,FileName:e.name,Title:e.name,Url:e.webUrl,WebUrl:e.webUrl,LastAccessedTime:s,FileType:"MyAnalytics",PathArray:null,Provenance:w.c[w.c.Substrate],ResourceId:"",UrlAlreadyEncoded:!0,Activity:a,ThumbnailUrl:null,FeedbackId:e.feedbackId,TaskInsight:e.taskInsight,PotentialAction:e.potentialActions,Actor:r,InsightName:e.insightName,InsightDescription:l,InsightDescriptionPrefix:this.getInsightDescriptionPrefix(null===(i=e.taskInsight)||void 0===i?void 0:i.actionType)}},t.prototype.getInsightDescriptionPrefix=function(e){var t=this.locService.YouSaid;return"FollowUp"===e||"FollowUpActionRequest"===e||"FollowUpReplyRequest"===e?t=this.locService.YouAsked:"Commitment"===e?t=this.locService.YouSaid:"Request"===e&&(t=this.locService.TheyAsked),t},t.prototype.convertUpcomingMeetingToMruDataItem=function(e){var t,n,i,r,o,a,l,s,c=null!==(n=new Date(null===(t=e.upcomingMeetingInfo)||void 0===t?void 0:t.start))&&void 0!==n?n:null,u=this.dateService.timespanInSeconds(c),d=null!==(i=new Date(e.expiresAt))&&void 0!==i?i:null,p=new Date;if(d&&p>d)return null;var h=u>0,f=h?this.locService.OfficeFeedYourUpcomingMeetingStarted:this.locService.OfficeFeedYourUpcomingMeeting;!h&&u>-60&&(f=this.locService.OfficeFeedYourUpcomingMeetingHappeningNow);var m=this.locService.JoinTeamsMeeting,b={formatString:f,plainText:f,people:null,reasonType:y.a.Meeting,timestamp:null!==(o=new Date(null===(r=e.upcomingMeetingInfo)||void 0===r?void 0:r.start))&&void 0!==o?o:null};return{Application:null,Category:e.category,DocId:null,DriveId:null,FileName:null,Title:null===(a=e.previewInfo)||void 0===a?void 0:a.text,Url:e.webUrl,WebUrl:e.webUrl,LastAccessedTime:c,FileType:"UpcomingMeeting",PathArray:null,Provenance:w.c[w.c.Substrate],UrlAlreadyEncoded:!0,Activity:b,FeedbackId:e.feedbackId,Attendees:e.upcomingMeetingInfo.attendees,Subject:e.upcomingMeetingInfo.subject,JoinUrl:null===(l=e.upcomingMeetingInfo.onlineMeeting)||void 0===l?void 0:l.joinUrl,MeetingStart:this.locService.formatTimeFromDate(new Date(e.upcomingMeetingInfo.start)),MeetingEnd:this.locService.formatTimeFromDate(new Date(e.upcomingMeetingInfo.end)),Location:null===(s=e.upcomingMeetingInfo.location)||void 0===s?void 0:s.displayName,Organizer:e.upcomingMeetingInfo.organizer,JoinMeetingText:m}},t.prototype.convertNewsItemToMruDataItem=function(e){var t,n=this.locService.format(this.locService.OfficeFeedPostedBy,e.newsArticleInfo&&e.newsArticleInfo.byLine||""),i=this.locService.format(this.locService.OfficeFeedPostedBy,"<c0>"+(e.newsArticleInfo&&e.newsArticleInfo.byLine||"")+"</c0>"),r=e.createdBy&&e.createdBy.User||{},o={formatString:i,plainText:n,people:[{upn:r.Id,tag:"c0",name:r.DisplayName}],reasonType:y.a.News,timestamp:e.newsArticleInfo.firstPublishedDateTime?new Date(e.newsArticleInfo.firstPublishedDateTime):null},a=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):null;return{Application:null,Category:e.category,DocId:e.oneDriveItemInfo&&e.oneDriveItemInfo.itemId,DriveId:e.oneDriveItemInfo&&e.oneDriveItemInfo.driveId,FileName:e.name,Title:e.name,Url:e.uri,WebUrl:e.webUrl,LastAccessedTime:a,FileType:"NewsArticle",PathArray:e.containerInfo?[e.containerInfo.displayName]:null,Provenance:w.c[w.c.Substrate],ResourceId:e.sharePointIds?e.sharePointIds.listItemUniqueId:"",UrlAlreadyEncoded:!0,Activity:o,ThumbnailUrl:null===(t=e.previewInfo)||void 0===t?void 0:t.image,FeedbackId:e.feedbackId}},t.prototype.convertOfficeFeedActivityToActivityDescription=function(e){for(var t=e.reason||"",n=null,i=function(){var i=n[1];t=t.replace(n[0],(function(){return"<c"+i+">"+e.actors[i].User.DisplayName+"</c"+i+">"}))};null!==(n=this.regExp.exec(t));)i();return{formatString:t,plainText:k.a.stripTags(t),people:(e.actors||[]).map((function(e,t){return{upn:e&&e.User.email,tag:"c"+t,name:e.User.DisplayName}})),reasonType:"popularVideoInclusionReason"===e.kind?y.a.Trending:"meetingRecordingInclusionReason"===e.kind?y.a.Video:this.convertReasonTypeToActivityReason(e.inclusionKind),timestamp:e.dateTime?new Date(e.dateTime):null}},t.prototype.convertReasonTypeToActivityReason=function(e){return C.b.convertMruReasonTypeToActivityReason(C.a[e])},t.prototype.convertFileToMruDataItem=function(e,t){var n,i,r,o,a,l;void 0===t&&(t=!1);var s=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):null,c=e.sharePointIds,u=c&&{list_id:c.listId,list_item_unique_id:c.listItemUniqueId,site_id:c.siteId,site_url:null,web_id:c.webId},d=e.inclusionReasons&&e.inclusionReasons[0],p=void 0,h=void 0,f=void 0,m=!1,b=null;d&&!t&&(f=this.convertOfficeFeedActivityToActivityDescription(d),this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled&&(p=d.sharingWebUrl),this.capabilitiesService.capabilities.recommendedDeepLinkEnabled&&(h=d.navigationId),(m="EmailAttachment"===d.inclusionKind)&&(b={AttachmentType:1,ConversationId:"",Subject:d.conversationSubject||""}));var v=m,g=this.fileType(e);g!==w.b.MeetingNotes&&g!==w.b.Whiteboard||(v=!0);var y="video"===e.category.toLowerCase()?"StreamsVideo":"Document",S="StreamsVideo"===y?null===(n=e.video)||void 0===n?void 0:n.mediaDuration:void 0,C="StreamsVideo"===y||"Custom"===e.subCategory?e.previewInfo.image:void 0,I=v?e.webUrl:e.uri;return{Application:w.b[g],Category:y,DocId:e.oneDriveItemInfo&&e.oneDriveItemInfo.itemId,DriveId:e.oneDriveItemInfo&&e.oneDriveItemInfo.driveId,Extension:(null===(i=null==e?void 0:e.file)||void 0===i?void 0:i.extension)||w.a.getFileExtensionFromUrl(I),FileName:e.name,Title:e.name,Url:I,WebUrl:e.webUrl,LastAccessedTime:s,FileType:w.b[g],PathArray:null!==(a=this.getPathArray(null===(r=e.containerInfo)||void 0===r?void 0:r.kind,null===(o=e.containerInfo)||void 0===o?void 0:o.displayName))&&void 0!==a?a:null,Provenance:w.c[w.c.Substrate],ResourceId:e.sharePointIds?e.sharePointIds.listItemUniqueId:"",UrlAlreadyEncoded:!0,Activity:f,SharepointInfo:u,IsEmailAttachment:m,EmailReference:b,IsCollab:e.is_collab,FeedbackId:e.feedbackId,NavigationId:h,TeamsDeepLink:p,ThumbnailUrl:C,MediaDuration:S,IconUrl:null===(l=e.appInfo)||void 0===l?void 0:l.iconUrl}},t.prototype.fileType=function(e){var t,n,i=w.a.fileTypeNameToFileType(e.subCategory);return i===w.b.Fluid&&(null===(t=e.file.downloadUrl)||void 0===t?void 0:t.includes("Office%20Spaces"))?w.b.Spaces:(i&&i!==w.b.None?i===w.b.OneNote&&"note"===(null===(n=e.file)||void 0===n?void 0:n.extension)&&(i=w.b.MeetingNotes):i=w.b.Unknown,i)},t.prototype.getPathArray=function(e,t){return t?this.isOneDrive(e)&&t?[this.locService.format(this.locService.EdgeworthFilePathTitle,t)]:[t]:null},t.prototype.isOneDrive=function(e){var t=null==e?void 0:e.toLocaleLowerCase();return"onedrive"===t||"onedrivebusiness"===t},t.locParam="rs=",t.newSchema="forceNewSchema=",t.e2eLatencyHeader="x-end2endlatencyms",t.tamyPath="/PeoplePredictionsB2/MicrosoftFeed",t.tamyQueryParams="section=OfficeHomeTrending&scenario=OfficeHomeTrending",t}(I.a),E=n("keVe"),_=n("TOqr"),O=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,h,f,m){var b=this;this.officefeedService=new P(e,p,i,n,t,h,r,o,a,l,s,u,d,f,m),c.subscribeToRouteChangeStart((function(e){e.currentRoute&&(o.config.officeFeedControlEnabled||o.config.officeFeedFlightEnabled)&&b.warmDocumentCache(e.currentRoute)}))}return e.prototype.getOfficeFeedService=function(){return this.officefeedService},e.prototype.warmDocumentCache=function(e){switch(e.route){case"OfficeHome":case"Pwa":this.officefeedService.getOfficeFeed()}},e.ɵprov=E.cc({factory:function(){return new e(E.dc(l.b),E.dc(o.a),E.dc(r.a),E.dc(b.a),E.dc(u.a),E.dc(a.a),E.dc(_.q),E.dc(i.b),E.dc(m.b),E.dc(c.a),E.dc(p.a),E.dc(d.a),E.dc(f.a),E.dc(v.a),E.dc(s.a),E.dc(h.b))},token:e,providedIn:"root"}),e}(),F=function(){function e(){}return e.ɵprov=E.cc({factory:function(){return function(e){return e.getOfficeFeedService()}(E.dc(O))},token:e,providedIn:"root"}),e}()},dQLD:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("odspConfig")||{odspProvisioningCheckIntervals:null,odspProvisioningPendingImage:null,odspProvisioningStatusApiPath:null}}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},dmOj:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("BaAg"),r=n("dFxn"),o=n("keVe"),a=function(){function e(e){var t=this,n=e.parse("titlesConfig");this.appTitleInfo=new Map,n&&n.appTitleConfigs&&(this.defaultTitle=n.defaultTitle,this.defaultIcon=n.defaultIcon,this.galleryTitle=n.galleryTitle,n.appTitleConfigs.forEach((function(e){t.appTitleInfo.set(i.a.fileTypeNameToFileType(e.app),e)})))}return e.prototype.getTitle=function(e,t){return e&&e.app&&this.appTitleInfo.has(e.app)?t||this.appTitleInfo.get(e.app).title:"AppGallery"===e.route?this.galleryTitle:this.defaultTitle},e.prototype.getFavicon=function(e){return e&&e.app&&this.appTitleInfo.has(e.app)&&this.appTitleInfo.get(e.app).icon||this.defaultIcon},e.ɵprov=o.cc({factory:function(){return new e(o.dc(r.a))},token:e,providedIn:"root"}),e}()},dvrM:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var i=n("keVe"),r=n("pzhl"),o=n("PkQn"),a=n("4/We"),l=n("W0EU"),s=i.xb({encapsulation:2,styles:[],data:{}});function c(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"span",[["class","alert-message"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"ohp-icon-font",[["cssClass","alert-message__icon"],["iconFontName","Alert"]],null,null,null,r.b,r.a)),i.yb(2,638976,null,0,o.a,[a.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"]},null),(e()(),i.zb(3,0,null,null,1,"span",[["class","alert-message__text"]],null,null,null,null,null)),(e()(),i.Yb(4,null,["",""]))],(function(e,t){e(t,2,0,"alert-message__icon","Alert")}),(function(e,t){e(t,4,0,t.component.message)}))}i.vb("ohp-alert-message",l.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-alert-message",[],null,null,null,c,s)),i.yb(1,49152,null,0,l.a,[],null,null)],null,null)}),{message:"message"},{},[])},dx17:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("bb6g"),r=n("kaEK"),o=n("L/Tc"),a=n("QOOv"),l=n("pd4Y"),s=n("uH9+"),c=n("cgnd"),u=n("PBJH"),d=n("CVeG"),p=n("keVe"),h=function(){function e(e,t,n,i,r){this.timestampFormatService=t,this.locService=n,this.mruConfigService=i,this.dateService=r,this.userEmail=e.config.userPrincipalName}return e.prototype.activityDescription=function(e,t,n,i){if(void 0===i&&(i=!1),!e||0===e.length)return null;e=this.filterActivities(e,t);for(var r=new Map,a=0;a<e.length;a++){var l=e[a],s=l.action.type;r.has(s)?r.get(s).push(l):r.set(s,[l])}return r.has(o.a.Mention)?this.createMentionDescription(r.get(o.a.Mention),n,i):r.has(o.a.Comment)?this.createCommentDescription(r.get(o.a.Comment),n,i):r.has(o.a.Edit)?this.createEditDescription(r.get(o.a.Edit),n,i):null},e.prototype.displayedActivityType=function(e,t,n){if(!e||0===e.length)return o.a.None;n&&(e=this.filterActivities(e,t));for(var i=0,r=0,a=0,l=0;l<e.length;l++){var s=e[l].action.type;s===o.a.Mention?i++:s===o.a.Comment?r++:s===o.a.Edit&&a++}return i>0?o.a.Mention:r>0?o.a.Comment:a>0?o.a.Edit:o.a.None},e.prototype.filterActivities=function(e,t){var n=this;return e?e.filter((function(e){if(e&&e.action&&e.timestamp&&e.actor&&e.actor.user&&e.actor.user.email&&e.actor.user.displayName){var i=e.action;if(t&&e.timestamp<t)return!1;if(n.isCurrentUser(e.actor.user))return!1;if(i.type===o.a.Mention&&i.data){var r=i.data.mentionees;return r&&r.filter((function(e){return e&&e.user&&n.isCurrentUser(e.user)})).length>0}return i.type!==o.a.Unknown}return!1})):[]},e.prototype.isCurrentUser=function(e){return e&&(!!e.self||e.userPrincipalName===this.userEmail)},e.prototype.createMentionDescription=function(e,t,n){if(!e||!e.length)return null;var i=e[0],o=this.numDistinctActors(e),a=i.actor.user,l=i.timestamp,s=this.formatStringWithTime(l,"Mentioned",t,n,[a.displayName],o-1);return{formatString:s,plainText:d.a.stripTags(s),people:[{upn:a.email,tag:"c0",name:a.displayName},{upn:this.userEmail,tag:"c1",name:this.userEmail}],reasonType:r.a.Mention,timestamp:l}},e.prototype.createCommentDescription=function(e,t,n){if(0===e.length)return null;var i=e[0],o=i.action.data,a=i.actor.user,l=i.timestamp,s="",c=null;if(e.length>1){var u=this.numDistinctActors(e);s=this.formatStringWithTime(l,"Commented",t,n,[a.displayName],u-1),c=[{upn:a.email,tag:"c0",name:a.displayName}]}else if(o&&o.isReply&&o.parentAuthor&&o.parentAuthor.user.displayName&&o.parentAuthor.user.email){var p=o.parentAuthor.user;this.isCurrentUser(p)?(s=this.formatStringWithTime(l,"RepliedYourComment",t,n,[a.displayName],0),c=[{upn:a.email,tag:"c0",name:a.displayName},{upn:this.userEmail,tag:"c1",name:this.userEmail}]):(s=this.formatStringWithTime(l,"RepliedOtherComment",t,n,[a.displayName,p.displayName],0),c=[{upn:a.email,tag:"c0",name:a.displayName},{upn:p.email,tag:"c1",name:p.displayName}])}else s=this.formatStringWithTime(l,"Commented",t,n,[a.displayName],0),c=[{upn:a.email,tag:"c0",name:a.displayName}];return{formatString:s,plainText:d.a.stripTags(s),people:c,reasonType:r.a.Comment,timestamp:l}},e.prototype.createEditDescription=function(e,t,n){if(0===e.length)return null;var i=e[0],o=this.numDistinctActors(e),a=i.actor.user,l=i.timestamp,s=this.formatStringWithTime(l,"Edited",t,n,[a.displayName],o-1);return{formatString:s,plainText:d.a.stripTags(s),people:[{upn:a.email,tag:"c0",name:a.displayName}],reasonType:r.a.Edit,timestamp:l}},e.prototype.formatStringWithTime=function(e,t,n,r,o,a){var l,s=a<=0?"":1===a?"OneOther":"Others",c=t+s,u=r?"NoDate":this.getActivityTimestampType(e,n);c+="FullDateThisYear"===u?"FullDate":u;var d=this.getTimestampPlaceholders(e,u),p=this.mruConfigService.config.activityStrings[c];return"OneOther"===s||""===s||o.push(this.locService.localizedNumberString(a)),o=o.concat(d),(l=this.locService).format.apply(l,Object(i.__spread)([p],o))},e.prototype.getActivityTimestampType=function(e,t){switch(this.timestampFormatService.getTimestampType(e)){case 0:return"NoDate";case 1:return"JustNow";case 2:return"MinAgo";case 3:return"HoursAgo";case 4:return t?"Yesterday":"YesterdayAt";case 5:return t?"DayOfWeek":"DayAndTimeOfWeek";case 6:return"FullDateThisYear";case 7:return"FullDate"}},e.prototype.getTimestampPlaceholders=function(e,t){var n=this.dateService.timespanInSeconds(e);switch(t){case"NoDate":case"JustNow":case"Yesterday":return null;case"MinAgo":return[this.locService.localizedNumberString(Math.round(n/60))];case"HoursAgo":return[this.locService.localizedNumberString(Math.round(n/3600))];case"YesterdayAt":return[this.locService.formatTimeFromDate(e)];case"DayOfWeek":return[this.locService.localizedWeekday(e)];case"DayAndTimeOfWeek":return[this.locService.localizedWeekday(e),this.locService.formatTimeFromDate(e)];case"FullDateThisYear":return[this.locService.localizedMonthDate(e)];case"FullDate":return[this.locService.localizedDateStringMedium(e)]}},e.prototype.numDistinctActors=function(e){return new Set(e.map((function(e){return e.actor.user.email}))).size},e.ɵprov=p.cc({factory:function(){return new e(p.dc(c.b),p.dc(s.a),p.dc(u.a),p.dc(a.a),p.dc(l.a))},token:e,providedIn:"root"}),e}()},e3cR:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c}));var i=n("bb6g"),r=n("obr3");function o(e,t,n){return void 0===n&&(n=1),Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){return[2,Object(r.b)(e,n,t)]}))}))}function a(e,t,n,r,o){return Object(i.__awaiter)(this,void 0,void 0,(function(){var a,l;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return"replace"!==r?[3,2]:[4,e.clear(n)];case 1:i.sent(),i.label=2;case 2:return a=e.transaction(n,"readwrite"),l=t.map((function(e,t){return a.store.put(e,o[t])})),[4,Promise.all(l)];case 3:return i.sent(),[4,a.done];case 4:return i.sent(),[2]}}))}))}function l(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){return[2,e.get(t,n)]}))}))}function s(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){return[2,e.getAll(t)]}))}))}function c(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){return[2,e.delete(t,n)]}))}))}},ej7j:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},fKR7:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return h}));var i,r=n("bb6g"),o=n("UWom"),a=n("hhzZ"),l=n("BaAg"),s=n("p6Zr"),c=n("cgnd"),u=n("lwM0"),d=n("pjz5"),p=n("L/Tc");!function(e){e[e.Recent=0]="Recent",e[e.Shared=1]="Shared",e[e.Trending=2]="Trending",e[e.Recommended=3]="Recommended",e[e.ClassNoteBook=4]="ClassNoteBook",e[e.News=5]="News",e[e.NoteBook=6]="NoteBook",e[e.Form=7]="Form",e[e.OfficeFeedDocument=8]="OfficeFeedDocument",e[e.EdgeworthDocument=9]="EdgeworthDocument",e[e.SharedForm=10]="SharedForm",e[e.StreamsVideo=11]="StreamsVideo",e[e.UpcomingMeeting=12]="UpcomingMeeting",e[e.MyAnalytics=13]="MyAnalytics"}(i||(i={}));var h=function(e){function t(t,n,r,a,h,f,m,b,v,g,y,S,w,C,I,T,k,A,P,E,_,O,F,D,M,R,x,L,N,U,W,B,z,j,H,V,q,G,Z,Q,K,Y,J,X,$,ee,te,ne,ie,re,oe,ae,le,se,ce,ue,de,pe,he,fe,me,be,ve,ge,ye,Se,we,Ce,Ie,Te,ke,Ae,Pe,Ee,_e,Oe,Fe){void 0===D&&(D=!1),void 0===M&&(M=!1),void 0===R&&(R=null),void 0===x&&(x=null),void 0===L&&(L=null),void 0===N&&(N=null),void 0===U&&(U=null),void 0===W&&(W=null),void 0===B&&(B=!1),void 0===z&&(z=!1),void 0===j&&(j=null),void 0===H&&(H=null),void 0===pe&&(pe=!1);var De=e.call(this,n,r,a,h,f,m,b,v,g,y,S,w,C,T,k,A,D,R,x,B,G?G.AttachmentType:void 0,z,pe)||this;if(De.format=t,De.sharingType=I,De.fromCache=E,De.application=_,De.resourceId=O,De.storageHost=F,De.isPinned=M,De.mruV2Category=L,De.mruV2Type=N,De.mruV2Id=U,De.activity=W,De.isEmailAttachment=B,De.createdDate=j,De.sharepointIds=H,De.sharing=V,De.isNew=q,De.emailReference=G,De.sharedByUsername=Z,De.sharedByEmail=Q,De.sharedById=K,De.thumbnailInfo=Y,De.spoId=X,De.isCollab=$,De.navigationId=te,De.thumbnails=ne,De.feedbackId=ie,De.serverDocId=re,De.createdBy=oe,De.teamsDeepLink=ae,De.ownerType=le,De.ownerId=se,De.ownerTenantId=ce,De.isDeleted=ue,De.isHidden=de,De.isSafeLink=pe,De.streamsThumbnailUrl=he,De.startTime=fe,De.endTime=me,De.location=be,De.locations=ve,De.attendees=ge,De.joinUrl=ye,De.organizer=Se,De.joinMeetingText=we,De.mediaDuration=Ce,De.subType=Ie,De.subTypeCategory=Te,De.taskInsight=ke,De.potentialAction=Ae,De.activityUser=Pe,De.insightName=Ee,De.insightDescription=_e,De.insightDescriptionPrefix=Oe,De.meetingArtifacts=Fe,De.mediaDurationRegex=new RegExp(/PT(\d+H)?(\d+M)?(\d*).*S?/),H||(De.sharepointIds={listId:null,listItemId:null,listItemUniqueId:null,siteId:null,siteUrl:null,webId:null}),De.documentUrl=b,t===i.Trending){var Me=De.url.match(/file=([\S]+?)(&|$)/i);if(Me&&Me.length>=2){var Re=Me[1];De.canonicalUrl=u.a.encodeUrl(x)+"/"+Re}else De.canonicalUrl=De.url;De.sharing={shared:!0}}else De.canonicalUrl=De.url||t===i.EdgeworthDocument&&De.webUrl,t===i.Shared&&(De.sharing={shared:!0});if(De.format===i.StreamsVideo&&De.mediaDuration){var xe=De.mediaDurationRegex.exec(De.mediaDuration);if(xe){var Le=xe[1],Ne=xe[2],Ue=xe[3];Le&&Le.length<3&&(Le="0"+Le),Ne&&Ne.length<3&&(Ne="0"+Ne),Ue&&Ue.length<2&&(Ue="0"+Ue),De.mediaDuration=(Le?Le.substring(0,Le.length-1)+":":"")+(Ne?Ne.substring(0,Ne.length-1)+":":"")+(Ue||"")}}if(b){if(!De.sharepointIds.siteUrl){var We=b.match(/https?:\/\/.*?\.sharepoint(-df)?\.com\/.*?\/.*?\//);We&&We.length&&(De.sharepointIds.siteUrl=We[0])}De.isMsftDogfood=b.lastIndexOf("microsoft-my.sharepoint-df.com")>-1||b.lastIndexOf("microsoft.sharepoint-df.com")>-1}if(l.a.referralFromFileLocation(De.url)===s.a.SharePoint&&(De.sharing={shared:!0}),De.lastModifiedBy&&De.lastModifiedBy.fullName&&De.lastModifiedBy.email&&De.lastModifiedTime&&(De.lastModifiedActivity=[{action:{type:p.a.Edit,data:{}},actor:{user:{displayName:De.lastModifiedBy.fullName,email:De.lastModifiedBy.email,userPrincipalName:De.lastModifiedBy.email},id:null},timestamp:De.lastModifiedTime}]),De._initialInflationCompleted=new o.a,De.initialInflationCompleted=De._initialInflationCompleted.asObservable(),"string"==typeof J&&(De.attribution=J),P===c.a.MSA)De.isOnPremOrVanity=!1;else if(ee&&ee.lastIndexOf("ONPREM")>=0)De.isOnPremOrVanity=!0;else if(ee&&ee.lastIndexOf("O365")>=0||De.fileType===l.b.Sway||De.fileType===l.b.Forms)De.isOnPremOrVanity=!1;else{var Be=d.a.getHostName(De.url);De.isOnPremOrVanity=!(!Be||-1!==Be.lastIndexOf("sharepoint.com")||De.isMsftDogfood)}return De}return Object(r.__extends)(t,e),t.prototype.getFormEnumType=function(){if(this.subType)if("form"===this.subType.toLowerCase()&&this.subTypeCategory)switch(this.subTypeCategory.toLowerCase()){case"poll":case"teams poll":case"pptpoll":case"wordpoll":return"poll";case"assignments":return"assignments"}else if("poll"===this.subType.toLowerCase())return"poll";return"form"},t.prototype.getClickData=function(t,n,r){var o=e.prototype.getClickData.call(this,t,n,r,this.format===i.EdgeworthDocument);return o&&o.params&&(o.params.Area="Suggested_Action_Click"===t?a.b.SuggestedActions:"Recommended_Click"===t?a.b.Recommended:a.b.Documents,"boolean"==typeof this.isPinned&&(o.params.Pinned=this.isPinned.toString()),"boolean"==typeof this.isNew&&(o.params.ItemIsNew=this.isNew.toString()),this.sharing&&"boolean"==typeof this.sharing.shared&&(o.params.ItemIsShared=this.sharing.shared.toString())),o},t.prototype.getClickDataForPath=function(t,n,i){var r=e.prototype.getClickDataForPath.call(this,t,n,i);return r&&r.params&&(r.params.Area=a.b.Documents),r},t.prototype.copyInflationData=function(e,t){void 0===t&&(t=!1),e.activities&&!t&&(this.activities=e.activities.slice()),e.driveId&&(this.driveId=e.driveId),void 0===e.isNew||t||(this.isNew=e.isNew),e.sharepointIds.siteUrl&&(this.sharepointIds.siteUrl=e.sharepointIds.siteUrl),e.sharing&&!t&&(this.sharing=Object(r.__assign)({},e.sharing)),e.thumbnails&&(this.thumbnails=Object(r.__assign)({},e.thumbnails)),e.wopiData&&(this.wopiData=Object(r.__assign)({},e.wopiData))},t.prototype.inflationCompleted=function(){this._initialInflationCompleted.next(!0),this._initialInflationCompleted.complete()},t.prototype.shouldAddLoginHint=function(){return!this.isLocal&&!this.isOnPremOrVanity&&("OneDriveForBusiness"===this.source||"SharePoint"===this.source||"EmailAttachment"===this.source||this.fileType!==l.b.Sway&&this.fileType!==l.b.Forms&&this.fileType!==l.b.PowerBI)},t}(l.a)},"fVt+":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("zvoD"),r=n("3Vsh"),o=n("dFxn"),a=n("7Gwk"),l=n("uWZl"),s=n("4/We"),c=n("cgnd"),u=n("keVe"),d=function(){function e(e,t,n,i){this.capabilitiesService=e,this.configParserService=t,this.startupConfigService=n,this.eventService=i}return e.prototype.getConfig=function(){var e=this;if(!this.configPromise){if(this.startupConfigService.config.authType!==c.a.MSA)return Promise.reject();if(this.capabilitiesService.capabilities.isPwaInUwp)this.configPromise=Promise.resolve(this.configParserService.parse("consumerUserConsent"));else{var t=this.eventService.events.withScope(0).pipe(Object(i.a)((function(e){return"primaryTokensLoaded"===e.name})),Object(r.a)(1)).toPromise(),n=l.a.fullPageReady();this.configPromise=Promise.race([t,n]).then((function(){return e.configParserService.parse("consumerUserConsent")}))}}return this.configPromise},e.ɵprov=u.cc({factory:function(){return new e(u.dc(s.a),u.dc(o.a),u.dc(c.b),u.dc(a.a))},token:e,providedIn:"root"}),e}()},fpaX:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return b}));var i=n("31lE"),r=n("Uqr9"),o=n("re3B"),a=n("4/We"),l=n("cgnd"),s=n("JH4S"),c=n("twlh"),u=n("hhzZ"),d=n("Vwd8"),p=n("keVe"),h=n("OtXi"),f=function(){function e(t,n,i,r,o,a,l){var s=this;this.clientStartupConfigService=n,this.activitySessionService=r,this.sessionActive=!1,this.ariaLogger=e.createAriaLogger(n.config,i,o,l,t),this.ariaLogger&&(this.sessionActive=!0,a.addUnloadEvent((function(){s.endAppSession(!t.capabilities.pwaEnabled)}),!0))}return e.createAriaLogger=function(t,n,r,o,a){if(!t.sharedClientStartupContext.ariaTenant||!t.sharedClientStartupContext.ariaCollectorUrl)return null;var s=e.initializeAriaLogManager(t.sharedClientStartupContext.ariaTenant,t.sharedClientStartupContext.ariaCollectorUrl),c=t.puid,u=i.AWTUserIdType.Unknown;if(c?t.authType===l.a.OrgId?u=i.AWTUserIdType.OrgIdPUID:t.authType===l.a.MSA&&(u=i.AWTUserIdType.MSAPUID):c=e.unknownUserId,s.getSemanticContext().setUserId(c,i.AWTPiiKind.NotSet,u),s.setContext("UserInfo.OMSTenantId",t.tenantId),s.setContext("AuthType",t.authTypeString),s.setContext("AuthVer",t.authVersion),s.setContext("CorpNet",t.sharedClientStartupContext.corpNet),s.setContext("CorrelationId",t.sharedClientStartupContext.correlationId),s.setContext("DevEnvironment",t.sharedClientStartupContext.devEnvironment),s.setContext("DeploymentEnvironment",t.sharedClientStartupContext.deploymentEnvironment),s.setContext("Geo",t.sharedClientStartupContext.geoName),s.setContext("RequestOrigin",t.sharedClientStartupContext.requestOrigin),s.setContext("SessionId",t.sharedClientStartupContext.sessionId),s.setContext("TestTraffic",t.sharedClientStartupContext.testTraffic),s.setContext("Workload",a.getWorkload()),s.setContext("ServerBuildDate",t.sharedClientStartupContext.buildDateUtc),s.setContext("ServerBuildId",t.sharedClientStartupContext.buildId),s.setContext("BundleBuildDate","2021-12-08 03:41:54.441"),s.setContext("BundleBuildId","afcd95b4-8bb2-7c2b-6e99-d62061642275"),s.setContext("Flights",t.sharedClientStartupContext.flights+(t.sharedClientStartupContext.flights&&t.features?",":"")+t.features),n&&(s.setContext("Admin",n.user.isAdmin),s.setContext("IsSmb",n.user.isSmb),s.setContext("IsIw",n.user.isIw),s.setContext("IsEdu",n.user.isEdu),s.setContext("IsEduStudent",n.user.isEduStudent),s.setContext("IsEduFaculty",n.user.isEduFaculty),s.setContext("IsDynamics",n.user.isDynamics),s.setContext("ThemeId",n.user.themeId),s.setContext("IsFirstRelease",n.user.isFirstRelease)),r&&(s.setContext("FirstVisit",r.isFirstVisit()),s.setContext("FirstVisitAgeInDays",r.fullDaysSinceFirstVisit())),o&&s.setContext("WrapperVersion",o.major+"."+o.minor+"."+o.build+"."+o.revision),a&&a.capabilities.antpLoaded){var d=navigator.userAgent.match(new RegExp("Edg/([\\d,.]+)"));d&&(i.AWTLogManager.getSemanticContext().setDeviceBrowserName("Edg"),i.AWTLogManager.getSemanticContext().setDeviceBrowserVersion(d[1])),s.setContext("Channel",window.channel)}return e.startSession(s),s},e.endSession=function(t,n,r){window.disableLogs||(r=r||new i.AWTEventProperties,e.populateSessionProperties(r),t.logSession(i.AWTSessionState.Ended,r)),n?i.AWTLogManager.flushAndTeardown():i.AWTLogManager.flush(null)},e.prototype.trackEvent=function(t,n){if(this.ariaLogger){this.sessionActive||(e.startSession(this.ariaLogger),this.sessionActive=!0);var r=this.clientStartupConfigService.config,o=new i.AWTEventProperties;for(var a in o.setName(t),n)if(n.hasOwnProperty(a)){var l=n[a];l instanceof u.d?r.logPiiAllowed&&(r.logPiiInClearText?o.setProperty(a,l.value):o.setPropertyWithPii(a,l.value,l.kind)):o.setProperty(a,l)}this.ariaLogger.logEvent(o)}},e.prototype.endAppSession=function(t){if(this.ariaLogger&&this.sessionActive){var n=new i.AWTEventProperties,o=this.activitySessionService.endSession();if(o){var a=r.a.now()-o.inactivityStartTime;n.setProperty("ActivityDuration",Math.ceil(o.cumulativeDurationOfActivitySessions/1e3).toString()),n.setProperty("InactivityDuration",Math.ceil((o.cumulativeDurationBetweenActivitySessions+a)/1e3).toString()),n.setProperty("ItemCount",o.activitySessionsCount.toString()),n.setProperty("ClickCount",o.cumulativeClickCount.toString())}e.endSession(this.ariaLogger,t,n),this.sessionActive=!1}},e.startSession=function(t){if(!window.disableLogs){var n=new i.AWTEventProperties;e.populateSessionProperties(n),t.logSession(i.AWTSessionState.Started,n)}},e.populateSessionProperties=function(e){e.setProperty("LoggerId","Angular"),window.prelaunchMode&&e.setProperty("PrelaunchMode","true")},e.initializeAriaLogManager=function(t,n){var r={collectorUri:n,enableAutoUserSession:!1,propertyStorageOverride:{setProperty:function(t,n){return e.setProperty(t,n)},getProperty:function(t){return e.getProperty(t)}},disableCookiesUsage:!0};return document&&document.cookie&&e.legacyAriaCookies.forEach((function(t){document.cookie=t+e.removeCookieString})),i.AWTLogManager.initialize(t,r)},e.setProperty=function(t,n){e.propertyMap.set(t,n)},e.getProperty=function(t){return e.propertyMap.has(t)?this.propertyMap.get(t):""},e.unknownUserId="Unknown",e.legacyAriaCookies=["MicrosoftApplicationsTelemetryDeviceId","MicrosoftApplicationsTelemetryFirstLaunchTime"],e.removeCookieString="=;expires=Thu, 01 Jan 1970 00:00:01 GMT;",e.propertyMap=new Map,e.ɵprov=p.cc({factory:function(){return new e(p.dc(a.a),p.dc(l.b),p.dc(s.a),p.dc(c.a),p.dc(d.b),p.dc(o.a),p.dc(h.a,8))},token:e,providedIn:"root"}),e}(),m=function(){function e(e,t,n,i){this.ariaService=e,this.streamName=t,this.params=n,this.metrics=i}return e.prototype.record=function(){var e={};for(var t in this.params)e[t]=this.params[t];this.ariaService.trackEvent(this.streamName,e)},e}(),b=function(){function e(e){this.ariaService=e}return e.prototype.createEvent=function(e,t,n){return new m(this.ariaService,e,t,n)},e.prototype.flush=function(){this.ariaService.endAppSession(!0)},e.ɵprov=p.cc({factory:function(){return new e(p.dc(f))},token:e,providedIn:"root"}),e}()},"g/dT":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("kxm0"),r=n("W3Zz"),o=(n("hhzZ"),function(){function e(e,t){this.deviceDetector=e,this.instrumentationService=t}return e.prototype.ngOnInit=function(){var e={};e.DevicePlatform=r.d[this.deviceDetector.getDeviceInfo().platform.platformType],this.instrumentationService.logGenericEvent(this.pageName,e,[this.pageName]);var t=!0;window.prelaunchMode&&(t=!1),Object(i.d)({isIntentional:t})},e}())},g0MB:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("w1PR");var i=function(){function e(e,t,n){this.elementReference=e,this.renderer=t,this.themingService=n,this.toolTipSpan=null}return e.prototype.ngAfterViewInit=function(){var e=this;this.elementReference.nativeElement.onfocus=function(){e.onEvent()},this.elementReference.nativeElement.onblur=function(){e.toolTipSpan&&e.renderer.removeChild(e.elementReference.nativeElement,e.toolTipSpan),e.toolTipDelayTimeout&&(clearTimeout(e.toolTipDelayTimeout),e.toolTipDelayTimeout=null)}},e.prototype.onEvent=function(){var e=this;this.toolTipDelay().then((function(){e.toolTipSpan=document.createElement("span"),e.toolTipSpan.classList.add("ohp-keyboardfocus-tooltip"),e.toolTipSpan.classList.add("ohpAppTheme"),e.toolTipSpan.classList.add("ms-fcl-nd"),e.toolTipSpan.classList.add("ms-bgc-w"),e.toolTipSpan.innerText=e.elementReference.nativeElement.title,e.renderer.appendChild(e.elementReference.nativeElement,e.toolTipSpan)}))},e.prototype.toolTipDelay=function(){var e=this;return new Promise((function(t){e.toolTipDelayTimeout=setTimeout((function(){t()}),1e3)}))},e}()},gB6C:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var i=n("8wW2"),r=n("ndAY"),o=n("AGMK");function a(){return{cancel:function(){return null},cancelAndRunNow:function(){return null},adjustPriority:function(){return null}}}n("z0B0");var l,s=n("UY9y"),c=new(n.n(s).a)([],(function(e,t){return function(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0}(e,t)})),u=n("Zmq1"),d=n("VKX6"),p="Safari"===Object(u.a)().browser.browserType,h=p?function(e,t){return setTimeout((function(){var t=Object(d.a)();e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Object(d.a)()-t))}})}))}:requestIdleCallback,f=(p||cancelIdleCallback,n("pdjy")),m=Object(o.a)(),b=!0;function v(){l||(l=h((function(e){m&&(m=!1,Object(r.a)("First_Idle_React")),l=null,function(e){for(;e&&e.timeRemaining()>0;){var t=c.pop();if(!t)break;if(!t.cancelled)try{t.work(e),t.completed=!0}catch(e){Object(i.a)().handleError(e,"DXUlK")}}c.peek()&&v()}(e)})))}function g(e,t){if(t===f.d)return e(),a();b&&(b=!1,Object(r.a)("First_Schedule_React"));var n={work:e,priority:t,cancelled:!1,completed:!1},i=function(e){var t=function(){return e.cancelled=!0};return{cancel:t,cancelAndRunNow:function(){e.cancelled||(t(),e.completed||(e.work(),e.completed=!0))},adjustPriority:function(n){return t(),e.completed?a():g(e.work,n)}}}(n);return c.push(n),v(),i}},gktR:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("bb6g"),r=n("lrJm"),o=n("R7NL"),a=n("3GGT"),l=n("hhzZ"),s=n("kpuN"),c=n("uzn7"),u=n("wwmn"),d=n("casz"),p=n("xoWf"),h=n("pOWU"),f=n("/I02"),m=n("keVe"),b=n("TOqr"),v=function(e){function t(t,n,i,r,o,a,l,s,c,u){var d=e.call(this,t,i,n,"OfficeHome",r,o,a,l)||this;return d.localStorageService=s,d.userDataStorageService=c,d.globalErrorHandler=u,d.requestConfig={headers:new Map([["Accept","application/json"]])},d.alreadyCompleted=!1,d}return Object(i.__extends)(t,e),t.prototype.fetchFirstRunData=function(e,n,i){var r=this;return void 0===n&&(n=!1),new Promise((function(o){var a="_"+i,l=r.localStorageService.get(a)||r.createInitialFirstRunData(e);if(n)o(l);else{var s=!1;l.CompletedFirstRun&&(s=!0,o(l)),r.userDataStorageService.get(i,t.LoadFromUserStorageRemoteAttempts).then((function(e){e&&e.CompletedFirstRun?l.CompletedFirstRun||(s=!0,o(e),r.localStorageService.set(a,e)):l.CompletedFirstRun&&r.storeFirstRunDataInUserStorage(l,i)})).catch((function(e){r.globalErrorHandler.handleError(e,"oZtOo"),l.CompletedFirstRun&&r.storeFirstRunDataInUserStorage(l,i)})).then((function(){s||(s=!0,o(l))}))}}))},t.prototype.updateFirstRunData=function(e,t,n,i){var r=this;void 0===i&&(i=!0),this.fetchFirstRunData(e.Version,!1,t).then((function(o){var a="_"+t,l=e.CompletedFirstRun;(o.CompletedFirstRun||e.StepsCompleted>=e.TotalSteps)&&(e.CompletedFirstRun=!0),e.FurthestCompleted=o.FurthestCompleted,(void 0===o.FurthestCompleted||e.StepsCompleted>o.FurthestCompleted)&&(e.FurthestCompleted=e.StepsCompleted),r.localStorageService.set(a,e),r.storeFirstRunDataInUserStorage(e,t),i&&r.instrumentFirstRunData(e,n,l)}))},t.prototype.forceRefreshAndGetLicenseStatus=function(){var e=this;return new Promise((function(n,i){e.get("Office_Consumer_License_Fetch",e.contextService.sharedContext.officeHomeApiRoot+t.ConsumerLicenseStatusEndpoint+"?"+t.ConsumerLicenseStatusForceRefreshQuery,(function(e){e.instrument((function(e,t){e.ok?t.params.HttpCode=a.a.OK.toString():(t.params.HttpCode=a.a.UnexpectedResponse.toString(),t.params.Error=e.statusText)})).then((function(e){n(e.data)}))}),(function(t){e.globalErrorHandler.handleError(t,"wCBHa"),i(t)}),e.requestConfig,"network-only")}))},t.prototype.isRetriableError=function(e){return e===a.a.Throttled},t.prototype.createInitialFirstRunData=function(e){return{CompletedFirstRun:!1,StepsCompleted:0,Version:e}},t.prototype.storeFirstRunDataInUserStorage=function(e,t){this.userDataStorageService.set(t,e)},t.prototype.instrumentFirstRunData=function(e,t,n){var i={};i.FirstRunStepsCompleted=e.StepsCompleted.toString(),i.FirstRunTotalSteps=e.TotalSteps?e.TotalSteps.toString():"0",i.FirstRunVersion=e.Version.toString(),i.FirstRunFurthestCompleted=e.FurthestCompleted.toString(),i.FirstRunUserDismissedCallout=n.toString(),e.CompletedFirstRun&&!this.alreadyCompleted&&(this.instrumentationService.logGenericEvent("First_Run_Completed",i),this.alreadyCompleted=!0),e.CompletedFirstRun&&void 0===t||(i.ItemCategory=t,this.instrumentationService.logImpressionEvent("First_Run_Impression",i))},t.firstRunDataKey="FirstRunData",t.incrementalDataKey="IncrementalData",t.LoadFromUserStorageRemoteAttempts=2,t.ConsumerLicenseStatusEndpoint="/api/license/consumer",t.ConsumerLicenseStatusForceRefreshQuery="forceRefresh=true",t.ɵprov=m.cc({factory:function(){return new t(m.dc(s.b),m.dc(o.a),m.dc(l.a),m.dc(f.a),m.dc(u.a),m.dc(b.q),m.dc(d.a),m.dc(c.a),m.dc(p.a),m.dc(r.b))},token:t,providedIn:"root"}),t}(h.a)},gmml:function(e,t,n){"use strict";n.r(t);var i=n("keVe"),r=n("zvoD"),o=n("3Vsh"),a=n("0XE2"),l=n("lrJm"),s=n("bb6g"),c=n("hZW2"),u=n("wwmn"),d=n("BMb5"),p=n("cgnd"),h=n("6cfW"),f=new i.q("SERVICE_WORKER_REGISTRATION_HANDLERS"),m=n("+2OL"),b=n("JWB6"),v=n("xaJZ"),g=n("511z"),y=n("5MEU"),S=new i.q("SERVICE_WORKER_GET_REGISTRATION_BY_SCOPE"),w=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d){this.serviceWorkerConfigService=e,this.serviceWorkerEnabled=t,this.hasServiceWorkerApi=n,this.windowService=i,this.startupConfigService=r,this.globalErrorHandler=o,this.workloadQueryParameterValue=a,this.officeHomeApiConfig=l,this.serviceWorkerStateService=s,this.documentService=c,this.registrationHandlers=u,this.getRegistrationByScope=d}return e.prototype.initialize=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,t,n,i,r,o,a,l,c,u,d,p,f,m,b,v,g,y,S;return Object(s.__generator)(this,(function(w){switch(w.label){case 0:if(!this.hasServiceWorkerApi)return[2];this.serviceWorkerContainer=this.windowService.nativeWindow.navigator.serviceWorker,w.label=1;case 1:return w.trys.push([1,11,,12]),"Controlled"!==this.serviceWorkerStateService.currentState?[3,3]:[4,this.serviceWorkerContainer.getRegistration(this.getRegistrationByScope?this.serviceWorkerConfigService.config.scope:void 0)];case 2:e=w.sent(),w.label=3;case 3:if(!this.serviceWorkerEnabled)return[3,8];n=(t=this.serviceWorkerConfigService.config).scriptUrl,i=t.scope,(r=new URLSearchParams).append("cdnDomain",this.startupConfigService.config.cdnDomain),r.append(this.officeHomeApiConfig.config.workloadQueryParameter,this.workloadQueryParameterValue),o=new URLSearchParams(this.windowService.nativeWindow.location.search),"antp"===this.workloadQueryParameterValue&&(a=o.get("locale"),d=o.get("flight"),a&&r.append("locale",a),d&&r.append("flight",d)),l=this.getFlightsForRegistrationUrl();try{for(c=Object(s.__values)(l),u=c.next();!u.done;u=c.next())r.append("serviceWorkerFlight",d=u.value)}catch(e){y={error:e}}finally{try{u&&!u.done&&(S=c.return)&&S.call(c)}finally{if(y)throw y.error}}return this.startupConfigService.config.automatedTestRunning&&(p=o.get("envType"),r.append("envType",p)),f=n+"?"+r.toString(),e?(m=this.windowService.nativeWindow.location.origin,b=e.active.scriptURL.toLowerCase()!==(m+f).toLowerCase(),v=e.scope.toLowerCase()!==(m+i).toLowerCase(),b||v?[4,this.registerServiceWorker(f,i)]:[3,5]):[3,6];case 4:e=w.sent(),w.label=5;case 5:return[3,8];case 6:return[4,this.registerServiceWorker(f,i)];case 7:e=w.sent(),w.label=8;case 8:return e&&this.registrationHandlers?[4,Promise.all(this.registrationHandlers.map((function(t){return t.handleRegistration(e)})))]:[3,10];case 9:w.sent(),w.label=10;case 10:return[3,12];case 11:return g=w.sent(),Object(h.a)(g)?[2]:(this.globalErrorHandler.handleError(g,"qKgQM"),[3,12]);case 12:return[2]}}))}))},e.prototype.registerServiceWorker=function(e,t){var n=this;return new Promise((function(i){var r=function(){i(n.serviceWorkerContainer.register(e,{scope:t})),n.windowService.nativeWindow.removeEventListener("load",r)};"complete"===n.documentService.nativeDocument.readyState?r():n.windowService.nativeWindow.addEventListener("load",r)}))},e.prototype.getFlightsForRegistrationUrl=function(){var e=this.startupConfigService.config.sharedClientStartupContext.flights,t=this.serviceWorkerConfigService.config,n=t.serviceWorkerAllowedFlights,i=t.pilotFlights,r=new Set(Object(s.__spread)(e.split(","),i));return n.filter((function(e){return r.has(e)}))},e.ɵprov=i.cc({factory:function(){return new e(i.dc(m.a),i.dc(v.a),i.dc(g.a),i.dc(d.b),i.dc(p.b),i.dc(l.b),i.dc(y.a),i.dc(u.a),i.dc(b.a),i.dc(c.a),i.dc(f,8),i.dc(S,8))},token:e,providedIn:"root"}),e}(),C=n("31lE"),I=n("fpaX"),T=n("hhzZ"),k=n("Uqr9");function A(e,t,n){if(void 0===n&&(n=!0),n&&console.error(e),t){var i=I.b.createAriaLogger(t);if(i){var r=!1;try{Zone.assertZonePatched()}catch(e){r=!0}var o=window.queuedEvents||[],a=window.queuedMarks,l="number"==typeof window.windowsDataSecuritySetting?window.windowsDataSecuritySetting:3;if(k.b.performanceLoggingSupported(window)){var s=function(e,t,n){(n=n||{}).Latency=t.toString(),n.ItemCategory="Bootstrapper",o.push({streamName:"Performance_Dump",eventName:e,eventParams:n,metrics:[],securityThreshold:0})},c=function(e,t,n){(n=n||{}).Error=e,n.DebugInfo=t,n.ItemCategory="Bootstrapper",o.push({streamName:"Generic_Event",eventName:"Performance_Mark_Failure",eventParams:n,metrics:[],securityThreshold:0})};a&&a.splice(0,a.length).forEach((function(e){var t=e.measureFrom||"navigationStart";try{window.performance.measure(e.markName,t,e.markName)}catch(n){return void c(e.markName,"Failed to record <"+e.markName+"> starting from <"+t+">: exception is thrown",e.eventParams)}var n=window.performance.getEntriesByName(e.markName,"measure");if(n&&n.length){var i=Math.ceil(n[0].duration);s(e.markName,i,e.eventParams)}else c(e.markName,"Failed to record <"+e.markName+">: measure missing",e.eventParams)})),k.b.getBrowserTimingMeasures(window,(function(e,t){c(e,t)})).forEach((function(e){s(e.name,e.duration)}))}o.length>0&&(o.forEach((function(e){if(!((e.securityThreshold||0)>l)){var t=new C.AWTEventProperties,n=e.eventParams;if(n)for(var r in n)n.hasOwnProperty(r)&&t.setProperty(r,n[r]);t.setName(e.streamName),t.setProperty("EventName",e.eventName),t.setProperty("AppSecurityLevel",l),i.logEvent(t)}})),window.queuedEvents=[]);var u=e&&e.stack||"Browser did not provide stack trace",d=e&&e.message||"No Error Message Provided";d.lastIndexOf(".")!==d.length-1&&(d+=".");var p="Fatal error preventing Angular bootstrap: "+d+" Zone error: "+r,h=function(e){var t=new C.AWTEventProperties;return t.setName(e),t.setProperty("EventName","Unhandled_Exception"),t.setProperty("ItemCategory","Bootstrap"),t.setProperty("Error",T.a.filterPii(p)),t.setProperty("AppSecurityLevel",l),t},f=h("Generic_Event");t.logPiiAllowed&&f.setPropertyWithPii("DebugInfo",u,t.logPiiInClearText?C.AWTPiiKind.NotSet:C.AWTPiiKind.GenericData),i.logEvent(f);var m=h("Generic_Debug_Cache");m.setProperty("DebugInfo",u),i.logEvent(m),I.b.endSession(i,!0)}}}var P,E,_,O=n("twlh"),F=function(){function e(e,t,n,i){this.activitySessionService=e,this.streamName=t,this.params=n,this.metrics=i}return e.prototype.record=function(){"Generic_Click"===this.streamName&&this.activitySessionService.incrementClick()},e}(),D=function(){function e(e){this.activitySessionService=e}return e.prototype.createEvent=function(e,t,n){return new F(this.activitySessionService,e,t,n)},e.prototype.flush=function(){},e.ɵprov=i.cc({factory:function(){return new e(i.dc(O.a))},token:e,providedIn:"root"}),e}(),M=function(){function e(){}return e.setup=function(t){if(document.body&&document.body.addEventListener){var n=-1!==navigator.appVersion.toUpperCase().indexOf("MSIE")?"click":"mousedown";document.body.addEventListener(n,(function(n){e.processClick(n,t)}))}},e.processClick=function(t,n){for(var i=t.srcElement||t.target;i&&(!i.tagName||!e.supportedClickTargets.hasOwnProperty(i.tagName.toUpperCase()));)i=i.parentElement||i.parentNode;if(i){var r=i.getAttribute("data-clicklog");if(!r||"CUSTOM"!==r.toUpperCase()){var o=i.id||"Unknown",a=i.getAttribute("data-referral");null!=a&&0!==a.length||(a=e.referralFromElement(i));var l=i.getAttribute("data-referral-platform"),s=i.getAttribute("data-area");null!=s&&0!==s.length||(s=e.areaFromElement(i));var c=!!i.getAttribute("data-nav");e.logGenericClick(o,s,a,l,c,n)}}},e.logGenericClick=function(e,t,n,i,r,o){o.logClickEvent("Generic_Click",e,t,n,i,void 0,void 0,void 0,r)},e.areaFromElement=function(e){var t=e.id||null;if(t&&t.length){var n="O365_";if(0===t.lastIndexOf(n,n.length))return T.b.Shell;var i="obf-";if(0===t.lastIndexOf(i,i.length))return T.b.Feedback}var r=e.classList||null;if(r&&r.length)for(var o="o365cs-",a=0;a<r.length;a++)if(0===r.item(a).lastIndexOf(o,o.length))return T.b.Shell;return null},e.referralFromElement=function(e){var t=e.id||null;if(t&&t.length){var n="O365_AppTile_";if(0===t.lastIndexOf(n,n.length)){var i=t.substring(n.length),r="Shell";return 0===i.lastIndexOf(r,r.length)&&(i=i.substring(r.length)),i}var o=e.classList||null;if(o&&o.length&&o.contains("o365cs-nav-appTile"))return t}return null},e.supportedClickTargets={A:!0,IMG:!0,AREA:!0,INPUT:!0,BUTTON:!0},e}(),R=n("p6wn"),x=n("Vwd8"),L=n("9WrL"),N=n("kpuN"),U=n("R7NL"),W=n("/I02"),B=n("dFxn"),z=function(){function e(e){this.config=e.parse("authStateConfig")||{authTicketExpiryIntervalInMinutes:0,checkAuthStateEnabled:!1,checkAuthStateEndpoint:null,checkAuthStateIntervalInSeconds:0,reauthenticationForAccessTokenPermanentErrorIntervalInMinutes:0}}return e.ɵprov=i.cc({factory:function(){return new e(i.dc(B.a))},token:e,providedIn:"root"}),e}(),j=n("7Gwk"),H=n("Z0U4"),V=n("WLAd"),q=n("X+PR"),G=function(){function e(e,t,n,i,r,o,a,l,s,c,u){this.contextService=e,this.configService=t,this.officeHomeApiConfigService=n,this.instrumentationService=i,this.instrumentedHttp=r,this.eventService=o,this.pageVisibilityService=a,this.route=l,this.globalErrorHandler=s,this.windowService=c,this.routeService=u,this.currentState="SignedIn",this.initialized=!1,this.checkAuthStateTimeout=null,this.accessTokenService=null}return e.prototype.initialize=function(e){var t=this;if(this.initialized)throw new l.a("Not allowed to call AuthStateService.initialize() more than once");this.initialized=!0,this.accessTokenService=e;var n=this.configService.config;if(n.checkAuthStateEnabled&&n.checkAuthStateEndpoint){var i=this.contextService.sharedContext;this.checkAuthStateEndpoint=i.officeHomeApiRoot+"/"+n.checkAuthStateEndpoint,this.checkAuthStateRequestOptions={headers:new Map},this.queryParamProcessor=new Promise((function(e,n){i.inMockMode||e(),t.officeHomeApiConfigService.config.mockRequestHeader||e(),t.route.queryParams.pipe(Object(r.a)((function(e){return Object.keys(e).length>0})),Object(o.a)(1)).toPromise().then((function(n){for(var i in n)i&&n.hasOwnProperty(i)&&"mockchecklogin"===i.toLowerCase()&&t.checkAuthStateRequestOptions.headers.set(t.officeHomeApiConfigService.config.mockRequestHeader,n[i]);e()})).catch((function(e){t.globalErrorHandler.handleError(e,"Jrzf6"),n(e)}))})),this.watchAuthTicketExpiry(),this.watchAccessTokenPermanentError(),this.watchPageVisibilityChanges(),this.scheduleCheckAuthState(),this.setupActivityTimeoutSignoutListener()}},e.prototype.getCurrentState=function(){return this.currentState},e.prototype.watchAuthTicketExpiry=function(){var e=this;if(this.configService.config.authTicketExpiryIntervalInMinutes>0){var t,n=6e4*this.configService.config.authTicketExpiryIntervalInMinutes,i=Date.now();this.routeService.subscribeToRouteChangeEnd((function(r){if("Content"===r.currentRoute.route)t&&(e.windowService.nativeWindow.clearTimeout(t),t=void 0);else if(!t){var o=Math.max(n-(Date.now()-i),0);t=e.windowService.nativeWindow.setTimeout((function(){"SignedIn"===e.currentState&&e.updateCurrentState({LoginState:"Expired"})}),o)}}))}},e.prototype.watchAccessTokenPermanentError=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.accessTokenService.hasPermanentAuthError()];case 1:return n.sent()&&(e=this.configService.config.reauthenticationForAccessTokenPermanentErrorIntervalInMinutes)>0&&this.windowService.nativeWindow.setTimeout((function(){"SignedIn"===t.currentState&&t.updateCurrentState({LoginState:"ReauthenticationRequired"})}),6e4*e),[2]}}))}))},e.prototype.watchPageVisibilityChanges=function(){var e=this;this.windowService.nativeWindow.setTimeout((function(){e.pageVisibilityService.addOnVisibilityChanged((function(){e.pageVisibilityService.isVisible()&&e.checkAuthState()}))}),1e3*this.configService.config.checkAuthStateIntervalInSeconds)},e.prototype.scheduleCheckAuthState=function(){var e=this;"SignedIn"===this.currentState&&!this.checkAuthStateTimeout&&this.configService.config.checkAuthStateIntervalInSeconds>0&&(this.checkAuthStateTimeout=this.windowService.nativeWindow.setTimeout((function(){return e.checkAuthState()}),1e3*this.configService.config.checkAuthStateIntervalInSeconds))},e.prototype.checkAuthState=function(){var e=this;this.checkAuthStateTimeout&&(this.windowService.nativeWindow.clearTimeout(this.checkAuthStateTimeout),this.checkAuthStateTimeout=null),this.queryParamProcessor.then((function(){if("SignedIn"===e.currentState&&e.pageVisibilityService.isVisible())return e.instrumentedHttp.get("Check_Login_Request",e.checkAuthStateEndpoint,e.checkAuthStateRequestOptions,"network-only").then((function(t){var n=t.data;n&&"SignedIn"===e.currentState&&e.updateCurrentState(n)}))})).catch((function(t){e.globalErrorHandler.handleError(t,"QGMJO")})).then((function(){return e.scheduleCheckAuthState()}))},e.prototype.updateCurrentState=function(e){var t=e.LoginState;if(this.currentState!==t){this.currentState=t;var n={};n.State=this.currentState,this.instrumentationService.logGenericEvent("Auth_State_Changed",n),this.eventService.broadcastEvent({name:"authStateChanged",args:[e]})}},e.prototype.setupActivityTimeoutSignoutListener=function(){var e=this;this.windowService.nativeWindow.addEventListener("message",(function(t){if(t&&t.data){var n=void 0;try{n=JSON.parse(t.data)}catch(e){}n&&"abtSignOutEventForHost"===n.eventId&&e.updateCurrentState({LoginState:"SignedOutBasedOnActivityAuto"}),n&&"abtSignOutEventForHostUserGenerated"===n.eventId&&e.updateCurrentState({LoginState:"SignedOutBasedOnActivityUserClick"})}}))},e.ɵprov=i.cc({factory:function(){return new e(i.dc(W.a),i.dc(z),i.dc(u.a),i.dc(T.a),i.dc(U.a),i.dc(j.a),i.dc(V.a),i.dc(q.a),i.dc(l.b),i.dc(d.b),i.dc(H.a))},token:e,providedIn:"root"}),e}(),Z=n("4/We"),Q=n("uWZl"),K=(n("72nV"),0),Y=!1;function J(e){var t=e.injector,i=t.get(j.a),s=function(e){var r;try{if(0!==K)return!1;if(K=1,e&&!t.get(c.a).nativeDocument.getElementById("ShellInfoLoaded"))return K=0,!1;t.get(w).initialize();var o=t.get(H.a),a=t.get(b.a);o.start();var s=t.get(T.a);M.setup(s);var u=Math.ceil(P);s.logPerformanceEvent("App_Begin_Bootstrap",u),s.logPerformanceEvent("App_Complete_Bootstrap",Math.ceil(E)-u),t.get(O.a).initialize(s);var d=t.get(Z.a),h=d&&d.capabilities.otherFlights||"",f=Object(p.c)(),m=f&&f.sharedClientStartupContext.flights?f.sharedClientStartupContext.flights:"";if(f.sharedClientStartupContext.flights=m+(m?",":"")+h,s instanceof R.a){s.registerOfficeRouteService(o),s.registerServiceWorkerStateService(a,!0);var v=t.get(x.a),g=t.get(D),y=t.get(I.a);s.registerEventFactories([v,g,y])}f.sharedClientStartupContext.oTelEnabled&&t.get(L.a).bootstrapOfficeStart(),Y=!0;var S=t.get(N.b);if(t.get(G).initialize(S),(i=t.get(j.a)).broadcastEvent({name:"appInitialized",args:[]}),d.capabilities.edgeworthReactEnabled&&(t.get(L.a).bootstrapOfficeStart(),Promise.all([n.e(0),n.e(1),n.e(507)]).then(n.bind(null,"3xKL")).then((function(e){e.prefetchEdgeworthData()}))),d.capabilities.showSearch&&s.logGenericEvent("Search_Capability"),d.capabilities.supportCentralEnabled){var C=((r={}).State="Eligible",r);s.logGenericEvent("Support_Central_Enabled",C)}return t.get(x.b).isFirstVisit()&&s.logGenericEvent("First_Site_Visit"),K=2,!0}catch(e){K=0;var k=!1;if(Y){var F=t.get(l.b);F&&(F.handleError(e,"b0g6P"),k=!0)}return k||A(e,_),!1}};Object(a.a)()?s(!1):s(!0)||(i.events.withScope(0).pipe(Object(r.a)((function(e){return"shellInfoLoaded"===e.name})),Object(o.a)(1)).toPromise().then((function(){return s(!1)})),Q.a.shellAndConfigsReady().then((function(){return s(!1)})))}var X=n("l98w"),$=n("Ft/N"),ee=n("kvyl");function te(e,t,n,i){return Object(s.__awaiter)(this,void 0,void 0,(function(){var r,o;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return[4,i(t+n)];case 1:return r=a.sent(),[4,e.digest({name:"SHA-256"},r)];case 2:return o=a.sent(),[2,Object(ee.a)(new Uint8Array(o))]}}))}))}var ne=n("Epfv"),ie=n("pgLp"),re=n("bN7T"),oe=n("jsgn");function ae(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){switch(e.label){case 0:return[4,window.navigator.serviceWorker.getRegistration()];case 1:return[4,e.sent().unregister()];case 2:return e.sent(),window.location.reload(),[2]}}))}))}function le(e,t){var n=new URLSearchParams(window.location.search).get(t);n&&e.searchParams.set(t,n)}function se(e,t,n){return Object(s.__awaiter)(this,void 0,void 0,(function(){var i,r,o;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),le(i=new URL(window.location.origin+"/api/shellandconfigdata"),"mockauth"),le(i,"envType"),le(i,"flight"),i.searchParams.set("workload","officehome"),[4,fetch(i.toString(),{headers:(o={},o[X.b]=e,o[$.a]=t,o["X-OfficeHome-UserId"]=n,o)})];case 1:return[2,(r=a.sent()).ok?r:null];case 2:return a.sent(),[2,null];case 3:return[2]}}))}))}var ce=n("B9sP"),ue=n("W3Zz"),de=function(){function e(){}return e.prototype.runWhenIdle=function(e){return requestIdleCallback(e)},e.prototype.cancelIdleCallback=function(e){cancelIdleCallback(e)},e}(),pe=function(){function e(){}return e.prototype.runWhenIdle=function(e){var t=k.a.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(k.a.now()-t))}})}),1)},e.prototype.cancelIdleCallback=function(e){clearTimeout(e)},e}(),he=function(e){return e.config.automatedTestRunning?new ce.e:new ce.f},fe=function(){return function(){return E=k.a.now()}},me=function(){return window.queuedEvents||[]},be=function(){return window.queuedMarks||[]},ve=function(e,t){return e.config.automatedTestRunning||t.deviceInfo.browser.browserType===ue.a.Safari?new pe:new de},ge=function(){return function(){}}(),ye=n("XjVN"),Se=n("SPVw"),we=n("b7yv"),Ce=n("3g20"),Ie=n("vXf5"),Te=n("BaAg"),ke=n("3GGT"),Ae=n("casz"),Pe=function(){function e(e){this.config=e.parse("userStorageConfig")}return e.ɵprov=i.cc({factory:function(){return new e(i.dc(B.a))},token:e,providedIn:"root"}),e}(),Ee=function(){function e(e,t,n,i,r,o,a,l,s,c){this.accessTokenService=e,this.contextService=t,this.instrumentationService=n,this.instrumentedHttp=i,this.authStateService=r,this.officeHomeApiConfigService=o,this.userDataStorageConfigService=a,this.globalErrorHandler=s,this.scheduler=c,null!=t.sharedContext.officeHomeApiRoot&&a.config&&null!=a.config.userStorageEndpoint&&(this.serviceUrl=t.sharedContext.officeHomeApiRoot+"/"+a.config.userStorageEndpoint);var u=l.parse("userStorageCache")||{firstUse:!1,firstUseTimestamp:0,content:{}};this.firstUse=u.firstUse,this.firstUseTimestamp=u.firstUseTimestamp,this.masterCollection=u.content}return e.prototype.get=function(e,t){var n=this;return void 0===t&&(t=1),new Promise((function(i,r){if(n.masterCollection.hasOwnProperty(e)){var o=Object(s.__assign)({},n.masterCollection[e]);i(o)}else if(n.firstUse||t<1)i(void 0);else if("SignedIn"===n.authStateService.getCurrentState())if(n.serviceUrl){var a=0,l=function(o,s){n.instrumentedHttp.get(o,n.serviceUrl+"/"+e+"/",s||{},"network-only").instrument((function(t,n){n.params.ElementId=e,n.params.Retry=a.toString()})).then((function(e){return i(e.data)})).catch((function(c){n.globalErrorHandler.handleError(c,"Bn3rc"),c&&c.status===ke.a.NotFound?i(void 0):c.status!==ke.a.Forbidden&&a<t-1?(a++,l(o,s)):r("Failed to get value from user data storage for <"+e+"> key. Status code: "+c.status)}))};n.request(l,"OfficeHomeStorage_Read_Request",r)}else r("User storage does not support roaming");else r("User has to be signed in to access storage for <"+e+"> key.")}))},e.prototype.set=function(e,t){var n=this;return new Promise((function(i,r){"SignedIn"===n.authStateService.getCurrentState()?(n.masterCollection[e]=Object(s.__assign)({},t),n.serviceUrl?n.request((function(o,a){if((a=a||{}).headers||(a.headers=new Map),!n.officeHomeApiConfigService.config.jwtAuthEnabled){if(!n.contextService.getCsrfToken())return n.instrumentationService.logErrorEvent("Csrf_Token_Error"),void r("CSRF token missing");a.headers.set("AjaxSessionKey",n.contextService.getCsrfToken())}var l=function(){return n.instrumentedHttp.put(o,n.serviceUrl+"/"+e+"/",t,a).instrument((function(t,n){n.params.ElementId=e})).then((function(){return i(null)})).catch((function(t){n.globalErrorHandler.handleError(t,"J7GBR"),r("Failed to update or create value in roaming user data storage for <"+e+"> key. Status code: "+t.status)}))};n.userDataStorageConfigService.config.deferWrite?n.scheduler.scheduleWork((function(){l()}),4):l()}),"OfficeHomeStorage_Write_Request",r):r("User storage does not support roaming")):r("User has to be signed in to access storage for <"+e+"> key.")}))},e.prototype.request=function(e,t,n){var i=this;this.officeHomeApiConfigService.config.jwtAuthEnabled?this.accessTokenService.getAccessToken("OfficeHome").then((function(r){if(!r.success)return i.instrumentationService.logRequestEvent(t,ke.a.TokenUnavailable,-1,"string"==typeof r.error?r.error:""),void n("Token Unavailable");var o={headers:new Map([["Authorization","Bearer "+r.token]])};e(t,o)})):e(t)},e.prototype.isFirstUse=function(){return this.firstUse},e.prototype.getFirstUseTimestamp=function(){return this.firstUseTimestamp},e.ɵprov=i.cc({factory:function(){return new e(i.dc(N.b),i.dc(W.a),i.dc(T.a),i.dc(U.a),i.dc(G),i.dc(u.a),i.dc(Pe),i.dc(B.a),i.dc(l.b),i.dc(Ae.a))},token:e,providedIn:"root"}),e}(),_e=n("dmOj"),Oe=n("5aVq"),Fe=n("w1PR"),De=n("Ax7d"),Me=n("LQqy"),Re=n("PBJH"),xe=n("ufVG"),Le=n("fVt+"),Ne=n("JH4S"),Ue=n("k+kJ"),We=n("uUrA"),Be=function(){function e(e,t,n,i,r){this.documentService=e,this.uploadConfigService=t,this.uploadButtonService=n,this.accessTokenService=i,this.isConsumer=r,this.enabled=!!this.uploadConfigService.config&&this.uploadConfigService.config.dragAndDropEnabled}return e.prototype.onDragOver=function(e){var t=this;this.enabled&&this.isLocalFile(e.dataTransfer.types)?(e.dataTransfer.dropEffect="copy",this.showOutline(),clearTimeout(this.timeoutTracker),this.timeoutTracker=setTimeout((function(){t.hideOutline()}),300)):e.dataTransfer.dropEffect="none"},e.prototype.onDrop=function(e){var t=this;if(this.enabled&&this.isLocalFile(e.dataTransfer.types)&&e.dataTransfer.files.length>0){var n=e.dataTransfer.files;this.accessTokenService.getAccessToken(this.isConsumer?"OneDrive":"Graph",!1,null,this.isConsumer||this.uploadConfigService.config.capPopupEnabled,{category:"Upload"}).then((function(){t.uploadFiles(n)})),clearTimeout(this.timeoutTracker),this.hideOutline()}},e.prototype.uploadFiles=function(e){1===e.length?this.uploadButtonService.uploadFile(e[0],null,We.a.createGuid(),"upload-drop",Ue.d.DragAndDrop):this.uploadButtonService.uploadFiles(e,We.a.createGuid(),"upload-drop",Ue.d.DragAndDrop)},e.prototype.showOutline=function(){this.documentService.addCssClassToElement(this.documentService.nativeDocument.getElementById(e.ScrollContentId),e.DragAndDropStyle)},e.prototype.hideOutline=function(){this.documentService.removeCssClassFromElement(this.documentService.nativeDocument.getElementById(e.ScrollContentId),e.DragAndDropStyle)},e.prototype.isLocalFile=function(e){for(var t=0;t<e.length;t++){var n=e[t];if("Files"!==n&&"application/x-moz-file"!==n)return!1}return!0},e.ScrollContentId="officeHome__scroll-content",e.DragAndDropStyle="drag-and-drop--outline",e}(),ze=n("vHlr"),je=n("JScD"),He=n("c8Ce"),Ve=function(){function e(e,t,n,i,r,o,a){this.documentService=e,this.eventService=t,this.titleService=n,this.windowService=i,this.router=r,this.injector=o,this.changeDetectorRef=a,this.backgroundStyle={},this.isSearchPage=!1,this.officeHomeClass=[],this.searchUXGeneralFeedbackEnabled=!1,this.viewInitializationCompleted=!1,this.viewListenersInitialized=!1}return e.prototype.ngOnInit=function(){var e=this;this.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return"appInitialized"===e.name})),Object(o.a)(1)).toPromise().then((function(){var t=e.injector.get(ue.b),i=e.injector.get(je.a),a=e.injector.get(ze.a),l=e.injector.get(N.b);e.searchConfigService=e.injector.get(Ce.a),e.startupConfigService=e.injector.get(p.b),e.capabilitiesService=e.injector.get(Z.a),e.contextService=e.injector.get(W.a),e.instrumentationService=e.injector.get(T.a),e.officeRouteService=e.injector.get(H.a),e.officeTitleService=e.injector.get(_e.a),e.themingService=e.injector.get(Fe.b),e.userProfileService=e.injector.get(x.b),e.featureCalloutService=e.injector.get(Se.a),e.locService=e.injector.get(Re.a),e.reactShellConfigService=e.injector.get(xe.a);var s=e.injector.get(De.a),c=e.injector.get(Ne.a);e.userStorageService=e.injector.get(Ee),e.isStandalone=s.isStandalone,e.isMobile=t.isMobileDevice();var u=e.capabilitiesService.capabilities;e.showMobileAppBanner=e.isMobile||t.isTabletDevice(),e.uploadEnabled=(u.oneDriveUploadEnabled||u.swayCreateNewEnabled)&&!!i.config,e.supportCentralEnabled=u.supportCentralEnabled&&!e.isMobile,e.isConsumer=e.startupConfigService.config.authType===p.a.MSA,e.bottomTrayEnabled=u.bottomTrayEnabled,e.searchEnabled=u.showSearch&&!!e.searchConfigService.config&&!e.bottomTrayEnabled,e.fluidSupportEnabled=u.fluidSupportEnabled,e.showPremiumUpsellModal=!1,e.nativeSearchEnabled=e.searchEnabled&&u.nativeSearchInHeaderEnabled,e.leftNavReact=e.capabilitiesService.capabilities.leftNavReact&&!e.capabilitiesService.capabilities.appBarEnabled;var d=e.capabilitiesService.capabilities.leftNavReact||e.capabilitiesService.capabilities.appBarEnabled;if(e.appBarEnabled=e.capabilitiesService.capabilities.appBarEnabled,e.stayingAware=d&&e.capabilitiesService.capabilities.stayingAwareEnabled,e.spaces=d&&e.capabilitiesService.capabilities.spacesEnabled,e.customPivots=d&&e.capabilitiesService.capabilities.quickAccessV1CustomPivotEnabled,e.taskModule=e.capabilitiesService.capabilities.m365AppsEnabled,e.themeRootCssClass=Ie.b,e.toastContainer=e.capabilitiesService.capabilities.contentActionsEnabled,e.wacHostEnabled=e.capabilitiesService.openWithUIHost,e.isIE=t.deviceInfo.browser.browserType===ue.a.IE,e.createOneNotePageEnabled=e.capabilitiesService.capabilities.createOneNotePageEnabled,e.webVitalsEnabled=e.capabilitiesService.capabilities.webVitalsEnabled,e.memoryProfilingEnabled=e.capabilitiesService.capabilities.memoryProfilingEnabled,e.fluentThemeRefreshEnabled=e.capabilitiesService.capabilities.fluentRefresh,e.actionContextMenuEnabled=u.contentActionsEnabled&&e.capabilitiesService.capabilities.contentActionsOHomeEnabled,e.showNewUserShelf=(e.capabilitiesService.capabilities.newUserShelfOverride||e.capabilitiesService.capabilities.newUserShelfEnabled)&&!e.isConsumer&&!e.isMobile,e.showNewUserShelf){var h=e.userStorageService.isFirstUse();e.showNewUserShelfExpanded=h,h?e.userProfileService.incrementMetric("Impressions_Since_First_Visit"):e.userProfileService.doesMetricExist("Impressions_Since_First_Visit").then((function(t){if(t){e.userProfileService.incrementMetric("Impressions_Since_First_Visit");var n=e.userProfileService.getInitialMetric("Impressions_Since_First_Visit");n&&n.count<=5&&(e.showNewUserShelfCollapsed=!0)}}))}e.injector.get(we.a).getConfig().then((function(t){e.firstRunEnabled=!c.user.hasNoLicense&&!!t&&!!t.model,e.featureCalloutSubscription=e.featureCalloutService.callouts.subscribe((function(t){e.loadFeatureCalloutModule=t.length>0}))})),e.scheduler=e.injector.get(Ae.a),e.isConsumer?e.capabilitiesService.capabilities.userConsentCallEnabled?e.injector.get(Le.a).getConfig().then((function(t){e.feedbackEnabled=0===t.userConsent&&u.showFeedback&&!e.isMobile,0===t.userConsent&&e.prepareUpsellButton()})):(e.feedbackEnabled=u.showFeedback&&!e.isMobile,e.prepareUpsellButton()):e.feedbackEnabled=u.showFeedback&&!e.isMobile,u.filePicker&&(e.loadFilePicker=!0),e.officeHomeClass=["angular-root"],e.backgroundStyle["background-image"]="url("+e.contextService.sharedContext.fluentHeroImageUrl+")",e.setupNavigationHandler(),e.viewInitializationCompleted=!0,e.shellHeader=e.documentService.nativeDocument.getElementById("ReactShellHeader"),e.pullToRefreshEnabled=e.capabilitiesService.capabilities.pullToRefreshEnabled,e.mobileMenusEnabled=e.capabilitiesService.capabilities.mobileContextMenusEnabled,e.isMobile&&e.instrumentationService.logGenericEvent("Mobile_View",{},["Mobile_View"]),e.viewMetric=e.userProfileService.getInitialMetric(e.isMobile?"Mobile_View":"Home_PageView"),!e.isIE&&(e.eventService.events.withScope(1).pipe(Object(r.a)((function(e){return"firstRunModalOpen"===e.name})),Object(o.a)(1)).toPromise().then((function(){e.officeHomeClass.push("blur-background"),e.shellHeader.classList.add("blur-background")})),e.eventService.events.withScope(1).pipe(Object(r.a)((function(e){return"firstRunModalClosed"===e.name||"premiumTemplatesUpsellClosed"===e.name})),Object(o.a)(1)).toPromise().then((function(){var t=e.officeHomeClass.indexOf("blur-background");t>=0&&e.officeHomeClass.splice(t,1),e.shellHeader.classList.remove("blur-background")}))),e.fluentThemeRefreshEnabled&&(e.fluentProviderClassSubscription=e.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return"fluentClassNameChanged"===e.name}))).subscribe((function(t){e.themeRootCssClass=Ie.b+" "+t.args[0],e.changeDetectorRef.detectChanges()}))),e.dragAndDropUtility=new Be(e.documentService,i,a,l,e.isConsumer),e.injector.get(Oe.a).getShellShim().then((function(t){if(t.Header&&t.Header.OnShyHeaderModeChanged((function(t){if(t)e.officeHomeClass.push("angular-root--hidden-shell");else{var n=e.officeHomeClass.indexOf("angular-root--hidden-shell");n>=0&&e.officeHomeClass.splice(n,1)}e.changeDetectorRef.detectChanges()})),t.GetResourceLoader){var n=t.GetResourceLoader();u.nativeSearchInHeaderEnabled?n.registerResourceCallback((function(t){4!==t&&e.scheduler.scheduleWork((function(){n.loadNext()}),void 0===t||3===t?4:1)})):e.scheduler.scheduleWork((function(){n.loadAll()}),4)}})),e.isConsumer&&e.scheduler.scheduleWork((function(){Promise.all([n.e(6),n.e(537)]).then(n.bind(null,"T8N+")).then((function(t){e.meetNowButtonUtility=new t.MeetNowButton(e.contextService,e.eventService,e.injector,e.officeRouteService)}))}),4),e.changeDetectorRef.detectChanges()})),this.dialogOpenSubscription=this.eventService.events.withScope(1).pipe(Object(r.a)((function(e){return"premiumTemplatesUpsellStarted"===e.name}))).subscribe((function(){e.injector.get(He.a).getConfig().then((function(t){t&&t.model&&(e.showPremiumUpsellModal=!0)}))})),this.dialogCloseSubscription=this.eventService.events.withScope(1).pipe(Object(r.a)((function(e){return"premiumTemplatesUpsellClosed"===e.name}))).subscribe((function(){e.showPremiumUpsellModal=!1})),this.searchUXGeneralFeedbackSubscription=this.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return"searchUXGeneralFeedbackEnabled"===e.name}))).subscribe((function(){e.searchUXGeneralFeedbackEnabled=!0}))},e.prototype.ngDoCheck=function(){this.viewInitializationCompleted&&(this.viewListenersInitialized||(this.viewListenersInitialized=!0,this.setAuthStateListener()),this.router.navigated||this.router.initialNavigation())},e.prototype.ngOnDestroy=function(){var e;this.authStateChangeSubscription&&this.authStateChangeSubscription.unsubscribe(),this.routeChangeSubscription&&this.routeChangeSubscription.unsubscribe(),this.routeChangeEndSubscription&&this.routeChangeEndSubscription.unsubscribe(),this.backgroundImageSubscription&&this.backgroundImageSubscription.unsubscribe(),this.featureCalloutSubscription&&this.featureCalloutSubscription.unsubscribe(),this.upsellButtonUtility&&this.upsellButtonUtility.unsubscribe(),this.meetNowButtonUtility&&this.meetNowButtonUtility.unsubscribe(),this.dialogOpenSubscription&&this.dialogOpenSubscription.unsubscribe(),this.dialogCloseSubscription&&this.dialogCloseSubscription.unsubscribe(),this.searchUXGeneralFeedbackSubscription&&this.searchUXGeneralFeedbackSubscription.unsubscribe(),null===(e=this.fluentProviderClassSubscription)||void 0===e||e.unsubscribe()},e.prototype.onWindowResize=function(){this.eventService.broadcastEvent({name:"windowResized",args:[]})},e.prototype.onWindowFocus=function(){this.eventService.broadcastEvent({name:"windowFocused",args:[]})},e.prototype.onBeforeInstall=function(e){this.eventService.broadcastEvent({name:"beforeInstallPrompt",args:[e]})},e.prototype.onAppInstalled=function(){var e=this.isMobile?"App_Added_To_Home_Screen_Mobile":"App_Added_To_Home_Screen_Desktop";this.instrumentationService.logGenericEvent(e,{},[e])},e.prototype.onResize=function(e){var t=e.width,n=e.height;this.contentWidth!==t&&(this.contentWidth=t,this.eventService.broadcastEvent({name:"contentWidthChanged",args:[t]})),this.contentHeight!==n&&(this.contentHeight=n,this.eventService.broadcastEvent({name:"contentHeightChanged",args:[n]}))},e.prototype.dragoverHandler=function(e){e.preventDefault(),this.dragAndDropUtility.onDragOver(e)},e.prototype.dropHandler=function(e){e.preventDefault(),this.dragAndDropUtility.onDrop(e)},e.prototype.setAuthStateListener=function(){var e=this;this.authStateChangeSubscription=this.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return"authStateChanged"===e.name}))).subscribe((function(t){var n=t.args[0],i=null==n?void 0:n.LoginState;if(e.capabilitiesService.capabilities.accountSwitchingEnabled&&"AccountMismatch"===i){var r=e.windowService.nativeWindow;r.MastInteraction.UpdateAccount(n.CurrentAccountPuid,{authenticatedState:1,idp:n.CurrentAccountType,upn:n.CurrentAccountUpn},!0),r.MastInteraction.ShowPrompt("SwitchAccount")}else if(e.capabilitiesService.capabilities.redirectWhenSignedOutFromWorkloads&&"SignedOut"===i||!e.capabilitiesService.capabilities.accountSwitchingEnabled&&"AccountMismatch"===i){e.flushLogs();var o=e.getSignOutLandingUrl();o?e.windowService.nativeWindow.open(o,"_self"):e.windowService.nativeWindow.location.reload(!1)}else if(e.capabilitiesService.capabilities.reloadWhenAuthExpired&&"Expired"===i||e.capabilitiesService.capabilities.reloadWhenReauthRequired&&"ReauthenticationRequired"===i||e.capabilitiesService.capabilities.reloadWhenPolicyCheckFailed&&"PolicyCheckFailed"===i)e.onWacContentPage||(e.flushLogs(),e.windowService.nativeWindow.location.reload(!1));else if(e.capabilitiesService.capabilities.activityBasedTimeoutEnabled&&"SignedOutBasedOnActivityAuto"===i){e.flushLogs();var a=e.locService.format(e.contextService.sharedContext.signOutUrlTemplate,encodeURIComponent(e.contextService.sharedContext.abtSignoutPath+"?rs="+e.contextService.sharedContext.officeMarket+"&build="+e.startupConfigService.config.sharedClientStartupContext.buildId+"&ru="+encodeURIComponent(e.windowService.nativeWindow.location.pathname+e.windowService.nativeWindow.location.search)+"&upn="+e.startupConfigService.config.userPrincipalName));e.windowService.nativeWindow.open(a,"_self")}else e.capabilitiesService.capabilities.activityBasedTimeoutEnabled&&"SignedOutBasedOnActivityUserClick"===i&&(e.flushLogs(),e.windowService.nativeWindow.open(e.reactShellConfigService.reactShellConfig.logoutUrl,"_self"))}))},e.prototype.setupNavigationHandler=function(){var e=this,t=this.officeRouteService.getRouteChangeStartObservable(),n=this.officeRouteService.getRouteChangeEndObservable();this.routeChangeSubscription=t.subscribe((function(t){var n=t.currentRoute.route;if("Content"!==n){var i=e.officeTitleService.getTitle(t.currentRoute),r=void 0;"MyForms"===n?r=e.locService.MyFormsHeroTitle:"GroupForms"===n&&(r=e.locService.GroupFormsTitle),e.titleService.setTitle(r?i+" - "+r:i)}e.loadShareControlModuleForContentPage="Content"===n,e.capabilitiesService.capabilities.wacHostMoveToFolderEnabled&&(e.loadMoveToFolderModuleForContentPage="Content"===n),e.nativeSearchEnabled=("Content"!==n||!t.currentRoute.app||t.currentRoute.app!==Te.b.Fluid)&&e.searchEnabled&&e.capabilitiesService.capabilities.nativeSearchInHeaderEnabled,e.documentService.updateFavicon(e.officeTitleService.getFavicon(t.currentRoute)),e.isSearchPage="Search"===n||"SearchSiteScoped"===n,e.onSpacesPage="SpaceGallery"===n||"SpaceContent"===n,e.onAppGallery="AppGallery"===n,e.onHomePage="OfficeHome"===n,e.onMyContentPage="MyContent"===n,e.newOfficeHomePageExperience=e.onHomePage&&e.capabilitiesService.capabilities.quickAccessV1Enabled&&e.capabilitiesService.capabilities.edgeworthEnabled,e.sidePopUpEnabled="MyForms"===n||"GroupForms"===n,e.hideSearch=e.onWacContentPage&&e.capabilitiesService.capabilities.wacHeaderDisabled||e.searchConfigService.config&&e.capabilitiesService.capabilities.nativeSearchInHeaderEnabled,e.showFASTBreadcrumb="SearchSiteScoped"===n,e.showWorkspaceNav="AppGallery"===n})),this.routeChangeEndSubscription=n.subscribe((function(t){e.onContentPage="Content"===t.currentRoute.route,e.onWacContentPage=e.onContentPage&&t.currentRoute.app!==Te.b.Fluid,e.onFluidContentPage=e.onContentPage&&t.currentRoute.app===Te.b.Fluid})),this.backgroundImageSubscription=Object(ye.b)(this.themingService.themeShades,t).subscribe((function(t){var n=Object(s.__read)(t,2),i=n[0],r=n[1].currentRoute;e.showBackgroundImage=i.theme.reactShellTheme&&!i.theme.reactShellTheme.IsDarkMode&&("App"===i.theme.themeType||"Default"===i.theme.themeType)&&!!e.contextService.sharedContext.fluentHeroImageUrl&&!e.capabilitiesService.capabilities.leftNavReact&&!e.isConsumer&&!(r&&r.app)&&"AppGallery"!==r.route}))},e.prototype.flushLogs=function(){this.instrumentationService.flush()},e.prototype.getSignOutLandingUrl=function(){var e,t,n=this.contextService.sharedContext.signOutRedirectUrl;if(!n)return n;var i=this.windowService.nativeWindow.location.search;if(!i)return n;i.startsWith("?")&&(i=i.substr(1));var r=n.split("#"),o=2===r.length?r[1]:"",a=(r=r[0].split("?"))[0],l=2===r.length?r[1]:"",c=i.split("&");try{for(var u=Object(s.__values)(c),d=u.next();!d.done;d=u.next()){var p=d.value,h=p.split("=")[0].toLowerCase();"auth"!==h&&"mockauth"!==h&&(l+=(l?"&":"")+p)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}return n=a,l&&(n+="?"+l),o&&(n+="#"+o),n},e.prototype.prepareUpsellButton=function(){var e=this;this.scheduler.scheduleWork((function(){n.e(542).then(n.bind(null,"r8hs")).then((function(t){e.upsellButtonUtility=new t.UpsellButton(e.injector.get(Me.a),e.contextService,e.eventService,e.injector,e.officeRouteService)}))}),4)},e}(),qe=n("fYis"),Ge=n("TOqr"),Ze=n("dvrM"),Qe=n("W0EU"),Ke=n("pzhl"),Ye=n("PkQn"),Je=function(){function e(e){this.locService=e,this.fullBleedTheming=!1}return e.prototype.ngOnInit=function(){this.createPlaceholderText=this.locService.MruCreateTileText,this.createPlaceholderAriaLabel=this.locService.MruCreateLinkAriaLabelTitle},e}(),Xe=i.xb({encapsulation:2,styles:[],data:{}});function $e(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,9,"div",[["class","workload-item workload-item__link workload-item--fluent__link workload-item--provisioning ms-fcl-tp"]],[[1,"aria-label",0]],null,null,null,null)),i.yb(1,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"ms-bgc-w":0}),(e()(),i.zb(3,0,null,null,2,"span",[["class","workload-item__icon--fluent non-workload-item__icon ms-fcl-tp"]],null,null,null,null,null)),(e()(),i.zb(4,0,null,null,1,"ohp-icon-font",[["iconFontName","Add"],["size","32"]],null,null,null,Ke.b,Ke.a)),i.yb(5,638976,null,0,Ye.a,[Z.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null),(e()(),i.zb(6,0,null,null,3,"div",[["class","workload-item__name--fluent"]],null,null,null,null,null)),(e()(),i.zb(7,0,null,null,2,"div",[["class","workload-item__text--fluent non-workload-link__text ms-fcl-tp"]],null,null,null,null,null)),(e()(),i.zb(8,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),i.Yb(9,null,["",""]))],(function(e,t){var n=e(t,2,0,t.component.fullBleedTheming);e(t,1,0,"workload-item workload-item__link workload-item--fluent__link workload-item--provisioning ms-fcl-tp",n),e(t,5,0,"Add","32")}),(function(e,t){var n=t.component;e(t,0,0,n.createPlaceholderAriaLabel),e(t,9,0,n.createPlaceholderText)}))}i.vb("ohp-create-menu-placeholder-tile",Je,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-create-menu-placeholder-tile",[],null,null,null,$e,Xe)),i.yb(1,114688,null,0,Je,[Re.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{fullBleedTheming:"forceWhiteBackground"},{},[]);var et=n("7IJ8"),tt=n("QhWD"),nt=n("RsrG"),it=n("6Po3"),rt=n("sVeK"),ot=n("xSeq"),at=n("xJIt"),lt=n("cj6A"),st=n("R0N1"),ct=n("BJFG"),ut=n("ExL+"),dt=n("hoyd"),pt=n("pjz5"),ht=function(){function e(e){this.config=e.parse("appTilesConfig")||{appGalleryPathAndQuery:null,coreAppIds:[],deferThirdPartyIcons:!1,expirePromotedAppTileEnabled:!1,isPromotedAppTileExpired:!1,myAccountUrl:null,promotedAppTileId:null,resources:null,segmentSpecificAppIds:[],sortMobileTiles:!1,topAppIds:[],mobileAppIds:[],customTiles:!1,pinnedTilesEnabled:!1,hoverScalingEnabled:!1}}return e.ɵprov=i.cc({factory:function(){return new e(i.dc(B.a))},token:e,providedIn:"root"}),e}(),ft=function(){function e(e,t,n,r,o,a,l,s,c,u,d,p){this.appTilesConfigService=e,this.capabilitiesService=t,this.contextService=n,this.deviceDetector=r,this.eventService=o,this.instrumentationService=a,this.workloadsService=l,this.appLauncherService=s,this.locService=c,this.changeDetectorRef=u,this.themingService=d,this.shellService=p,this.unpinWorkload=new i.n}return Object.defineProperty(e.prototype,"forceWhiteBackground",{get:function(){return this._forceWhiteBackground},set:function(e){this._forceWhiteBackground=e,this.setBackgroundColor()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showHover",{get:function(){return this._showHover},set:function(e){this._showHover=e},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var e=this,t=this.appTilesConfigService.config;this.isProvisioned=!!this.workload.Url,this.promotedAppSectionDescription=t.resources&&t.resources.PromotedAppSectionDescription,this.ariaLabel=this.workload.Text,this.appTilesSwipeEnabled=this.deviceDetector.isMobileDevice(),this.thirdPartyIconAriaLabel=this.locService.format(this.locService.ThirdPartyIconAriaLabel,this.workload.Text),this.preloadPath=this.workload.InAppNav?"Start":pt.a.getOrigin(this.workload.Url),this.removeAppAriaLabel=this.locService.RemoveDocumentActionTitle,this.scaleTile=t.hoverScalingEnabled,this.isProvisioned?(this.capabilitiesService.capabilities.darkModeEnabled&&(this.themeShadesSubscription=this.themingService.darkModeSubscription.subscribe((function(t){e.appColor=t&&e.workload.ChangeColorInDarkMode?"white":""}))),this.setBackgroundColor()):this.provisioningText=t.resources&&t.resources.ProvisioningTileText},e.prototype.ngOnChanges=function(e){e.hasOwnProperty("workload")&&(this.elementId=e.workload.currentValue.Id+"_link",this.setBackgroundColor(),this.iconLoaded=this.iconLoaded&&e.workload.currentValue.ThirdPartyIcon===e.workload.previousValue.ThirdPartyIcon)},e.prototype.ngOnDestroy=function(){this.themeShadesSubscription&&this.themeShadesSubscription.unsubscribe()},e.prototype.mouseOverTile=function(){this.workload.Url&&(this.showHover=!0),this.checkedODSPProvisioningStatus||this.workload.FileType!==Te.b.SharePoint&&this.workload.FileType!==Te.b.OneDrive||(this.shellService.initializeProvisioningStatus(),this.checkedODSPProvisioningStatus=!0)},e.prototype.onTileClick=function(e){var t=this;if(this.showHover=!1,this.workload.Url||!e){var i="_blank"===this.contextService.sharedContext.defaultLinkTarget;i||this.instrumentTileClick("Web"),this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(n){n.launchApp(t.workload.AppId,t.workload.Url,{action:"OpenAppTile",inAppNavFileType:t.workload.FileType,event:e}).then((function(e){i&&t.instrumentTileClick(e.result)}))})):this.appLauncherService.launchApp(this.workload,e,"OpenAppTile").then((function(e){i&&t.instrumentTileClick(e)}))}else e.preventDefault()},e.prototype.unfocusTile=function(){this.showHover=!1},e.prototype.instrumentTileClick=function(e){var t=e?this.workload.Referral:"",n=T.b.AppTiles,i={};i.State=this.inExpandedView?"expanded":"reduced",i.ReferralType=this.workloadsService.getReferralType(this.workload).toString(),this.instrumentationService.logClickEvent("Generic_Click",this.elementId,n,t,"Native"===e?"Native":"Web",i,[],0,this.workload.InAppNav),this.eventService.broadcastEvent({name:"appTileClick",args:[this.workload.AppId]})},e.prototype.instrumentRightClick=function(){var e={};e.ElementId=this.elementId,this.instrumentationService.logGenericEvent("App_Tile_Right_Click",e)},e.prototype.onIconLoad=function(){var e=this;setTimeout((function(){e.iconLoaded=!0,e.changeDetectorRef.markForCheck()}))},e.prototype.onIconError=function(){var e=this;setTimeout((function(){e.iconLoaded=!1,e.changeDetectorRef.markForCheck()}))},e.prototype.unpinApp=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return e&&e.preventDefault(),this.unpinWorkload.emit({item:this.workload}),[2]}))}))},e.prototype.setBackgroundColor=function(){this.setWhiteBackground=this.forceWhiteBackground},e}(),mt=i.xb({encapsulation:2,styles:[],data:{}});function bt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-icon-font",[],null,null,null,Ke.b,Ke.a)),i.yb(1,638976,null,0,Ye.a,[Z.a],{iconFontCssClass:[0,"iconFontCssClass"],iconFontName:[1,"iconFontName"],isThirdParty:[2,"isThirdParty"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.workload.IconUnicodeCodepointCssClass+(n.appTilesSwipeEnabled?" app-tile-icon--small":""),n.workload.IconFont,n.workload.IsThirdParty)}),null)}function vt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,0,"img",[["aria-hidden","true"],["class","workload-item__icon--image"]],[[8,"hidden",0],[8,"src",4],[1,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,n){var i=!0,r=e.component;return"load"===t&&(i=!1!==r.onIconLoad()&&i),"error"===t&&(i=!1!==r.onIconError()&&i),i}),null,null))],null,(function(e,t){var n=t.component;e(t,0,0,!n.iconLoaded,n.workload.ThirdPartyIcon,n.thirdPartyIconAriaLabel)}))}function gt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"span",[["class","workload-item-text--provisioning--fluent"]],null,null,null,null,null)),(e()(),i.Yb(1,null,[" "," "]))],null,(function(e,t){e(t,1,0,t.component.provisioningText)}))}function yt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","promoted-tiles__text"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,3,"div",[["dir","ltr"]],[[1,"dir",0]],null,null,null,null)),i.Tb(6144,null,rt.c,null,[rt.b]),i.yb(3,1196032,null,0,rt.b,[],{dir:[0,"dir"]},null),(e()(),i.Yb(4,null,["",""]))],(function(e,t){e(t,3,0,"ltr")}),(function(e,t){var n=t.component;e(t,1,0,i.Ob(t,3)._rawDir),e(t,4,0,n.promotedAppSectionDescription)}))}function St(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"span",[["class","workload-item__unpin ms-fcl-nd ms-fcl-tp-h ms-fcl-tp-f ms-bgc-g40-h ms-bgc-g40-f"],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"keyup.space"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.unpinApp(n)&&i),"keyup.enter"===t&&(i=!1!==r.unpinApp(n)&&i),"keyup.space"===t&&(i=!1!==r.unpinApp(n)&&i),"focus"===t&&(i=!1!==r.mouseOverTile()&&i),"blur"===t&&(i=!1!==r.unfocusTile()&&i),i}),null,null)),(e()(),i.zb(1,0,null,null,1,"ohp-icon-font",[["iconFontName","X"]],null,null,null,Ke.b,Ke.a)),i.yb(2,638976,null,0,Ye.a,[Z.a],{iconFontName:[0,"iconFontName"]},null)],(function(e,t){e(t,2,0,"X")}),(function(e,t){var n=t.component;e(t,0,0,n.removeAppAriaLabel,n.removeAppAriaLabel)}))}function wt(e){return i.bc(2,[(e()(),i.zb(0,0,null,null,32,"div",[["class","workload-item"]],null,[[null,"mouseover"],[null,"contextmenu"],[null,"mouseleave"]],(function(e,t,n){var i=!0,r=e.component;return"mouseover"===t&&(i=!1!==r.mouseOverTile()&&i),"contextmenu"===t&&(i=!1!==r.instrumentRightClick()&&i),"mouseleave"===t&&(i=!1!==r.unfocusTile()&&i),i}),null,null)),i.yb(1,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"workload-item--fluent--promoted":0,"workload-item--fluent--touch":1,"animated-tile":2}),(e()(),i.zb(3,0,null,null,29,"a",[["class","o365cs-base workload-item__link ms-bgc-w-h ms-bgc-w-a ms-bgc-w-f"],["data-clicklog","custom"],["ohpDefaultLinkTarget",""],["rel","noopener"]],[[8,"id",0],[8,"href",4],[1,"aria-label",0],[8,"target",0]],[[null,"focus"],[null,"blur"],[null,"click"],[null,"mouseenter"],[null,"mouseleave"]],(function(e,t,n){var r=!0,o=e.component;return"mouseenter"===t&&(r=!1!==i.Ob(e,7).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==i.Ob(e,7).onMouseLeave()&&r),"focus"===t&&(r=!1!==o.mouseOverTile()&&r),"blur"===t&&(r=!1!==o.unfocusTile()&&r),"click"===t&&(r=!1!==o.onTileClick(n)&&r),r}),null,null)),i.yb(4,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(5,{"workload-item--provisioning":0,"workload-item--provisioned workload-item--fluent--provisioned":1,"workload-item--fluent__link":2,"workload-item--fluent--promoted__link":3,"workload-item--fluent__link--touch":4,"ms-bgc-w":5}),i.yb(6,4210688,null,0,ot.a,[i.l,i.h],{focusOnLoad:[0,"focusOnLoad"],detectChanges:[1,"detectChanges"]},null),i.yb(7,16384,null,0,at.a,[lt.a],{preloadPath:[0,"preloadPath"]},null),i.yb(8,81920,null,0,st.a,[W.a],null,null),(e()(),i.zb(9,0,null,null,8,"span",[],null,null,null,null,null)),i.yb(10,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(11,{"workload-item__icon--fluent":0,"workload-item__icon--fluent--promoted":1,"workload-item__icon--fluent--3rd-party-image":2,"workload-item__icon--touch":3}),i.yb(12,278528,null,0,Ge.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.Rb(13,{color:0}),(e()(),i.ib(16777216,null,null,1,null,bt)),i.yb(15,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,vt)),i.yb(17,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(18,0,null,null,10,"div",[["class","workload-item__name--fluent"]],[[8,"id",0]],null,null,null,null)),i.yb(19,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(20,{"workload-item__name--fluent--promoted":0,"workload-item__name--fluent--touch":1}),i.yb(21,278528,null,0,Ge.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.Rb(22,{color:0}),(e()(),i.zb(23,0,null,null,5,"div",[["class","workload-item__text--fluent"]],[[8,"title",0]],null,null,null,null)),i.yb(24,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(25,{"workload-item__text--fluent--third-party":0,"workload-item__text--fluent--touch":1,"ms-fcl-nd":2}),(e()(),i.Yb(26,null,[" "," "])),(e()(),i.ib(16777216,null,null,1,null,gt)),i.yb(28,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,yt)),i.yb(30,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,St)),i.yb(32,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.promotedAppTile,n.appTilesSwipeEnabled,n.scaleTile);e(t,1,0,"workload-item",i);var r=e(t,5,0,!n.isProvisioned,n.isProvisioned,!n.promotedAppTile,n.promotedAppTile,n.appTilesSwipeEnabled,n.setWhiteBackground);e(t,4,0,"o365cs-base workload-item__link ms-bgc-w-h ms-bgc-w-a ms-bgc-w-f",r),e(t,6,0,n.focusOnLoad,!0),e(t,7,0,n.preloadPath),e(t,8,0);var o=e(t,11,0,!n.promotedAppTile,n.promotedAppTile,n.workload.IsThirdParty,n.appTilesSwipeEnabled);e(t,10,0,o);var a=e(t,13,0,n.isProvisioned?n.appColor||n.workload.Color:"");e(t,12,0,a),e(t,15,0,!n.workload.ThirdPartyIcon||!n.iconLoaded),e(t,17,0,n.workload.ThirdPartyIcon);var l=e(t,20,0,n.promotedAppTile,n.appTilesSwipeEnabled);e(t,19,0,"workload-item__name--fluent",l);var s=e(t,22,0,n.showHover&&n.isProvisioned?n.appColor||n.workload.Color:"");e(t,21,0,s);var c=e(t,25,0,n.workload.IsThirdParty,n.appTilesSwipeEnabled,!n.showHover);e(t,24,0,"workload-item__text--fluent",c),e(t,28,0,!n.isProvisioned),e(t,30,0,n.promotedAppTile),e(t,32,0,n.pinnedApp)}),(function(e,t){var n=t.component;e(t,3,0,i.Gb(1,"",n.elementId,""),i.Gb(1,"",n.workload.Url,""),n.ariaLabel,i.Ob(t,8).target),e(t,18,0,i.Gb(1,"",n.elementId,"_text")),e(t,23,0,n.workload.Text),e(t,26,0,n.workload.Text)}))}i.vb("ohp-app-tile",ft,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-app-tile",[],null,null,null,wt,mt)),i.yb(1,770048,null,0,ft,[ht,Z.a,W.a,ue.b,j.a,T.a,dt.a,ct.a,Re.a,i.h,Fe.b,ut.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{workload:"workload",inExpandedView:"inExpandedView",focusOnLoad:"focusOnLoad",promotedAppTile:"promotedAppTile",pinnedApp:"pinnedApp",forceWhiteBackground:"forceWhiteBackground"},{unpinWorkload:"unpinWorkload"},[]);var Ct=n("gZ+X"),It=n("XWg3"),Tt=n("+ucO"),kt=n("+YV+"),At=n("7wk3"),Pt=n("6nG3"),Et=n("U8M1"),_t=n("uzn7"),Ot=n("9MHL"),Ft=(n("7uC2"),function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,h,f,m,b){this.appGalleryConfigService=e,this.appTilesConfigService=t,this.capabilitiesService=n,this.consumerInstallConfigService=i,this.deviceDetector=r,this.floodgateService=o,this.instrumentationService=a,this.performanceService=l,this.officeRouteService=s,this.startupConfigService=c,this.workloadsService=u,this.browserPaintMeasurementService=d,this.localStorageService=p,this.createMenuService=h,this.oneDriveUploadService=f,this.browserPaintService=m,this.changeDetector=b,this.fullBleedTheming=!1,this.fullBleedFontColor="",this.fullBleedBackplateEnabled=!1,this.fullBleedBackplateStyle={},this.rectangularMobileMaxInitialItems=4,this.appGalleryRoute="AppGallery",this.createMenuEnabled=!1}return e.prototype.ngAfterViewInit=function(){var t=this;e.loggedMarker||(this.performanceService.mark("App_Tiles_Ready"),e.loggedMarker=!0),this.previousRouteSubscription=this.officeRouteService.subscribeToRouteChangeEnd((function(e){return t.previousRoute=e.previousRoute?e.previousRoute.route:null})),this.appGalleryLinkSubscription=this.appGalleryLink.changes.subscribe((function(e){"AppGallery"===t.previousRoute&&e&&1===e.length&&t.browserPaintService.runAfterPaint((function(){e.first.nativeElement.focus(),t.appGalleryLinkSubscription.unsubscribe()}))})),this.browserPaintMeasurementService.recordWhenPainted("App_Tiles"),this.capabilitiesService.capabilities.leftNavReact||this.floodgateService.recordFloodgate(["SawLeftNav"])},e.prototype.ngOnInit=function(){var e=this;this.componentArea=T.b.AppTiles;var t=this.appTilesConfigService.config,n=t.resources;this.sectionTitle=n&&n.AppTilesHeader,this.provisioningAlertText=n&&n.ProvisioningAlertText,this.showLessAppTilesText=n&&n.ShowLessAppTiles,this.exploreYourAppsAriaLabel=n&&n.ExploreYourAppsAriaLabel,this.exploreYourAppsText=n&&n.ExploreYourAppsText,this.appGalleryTileText=n&&n.AppGalleryTileText,this.appTilesLandmarkAriaLabel=n&&n.AppTilesListLandmarkAriaLabel,this.myAccountLinkText=n&&n.MyAccountConsumerLinkText,this.myAccountUrl=this.appTilesConfigService.config.myAccountUrl,this.isConsumer=this.startupConfigService.config.authType===p.a.MSA,this.bottomTrayEnabled=this.capabilitiesService.capabilities.bottomTrayEnabled,this.isMobile=this.deviceDetector.isMobileDevice(),this.pinnedAppsEnabled=this.appTilesConfigService.config.pinnedTilesEnabled,this.scaleTile=t.hoverScalingEnabled,this.isConsumer&&this.consumerInstallConfigService.getConfig().then((function(t){var n=t&&t.currentSkuInfo?t.currentSkuInfo.skuType:Pt.b.NotDetected;e.isPaidConsumer=!(n===Pt.b.NotSubscribed||n===Pt.b.NonActive||n===Pt.b.NotDetected)})),this.capabilitiesService.capabilities.createButtonWithAnimationEnabled?(this.createMenuEnabled=!1,this.showCreatePlaceholder=!1):(this.createMenuService.createButtonEnabledPromise.then((function(t){e.createMenuEnabled=e.createMenuEnabled||t,e.showCreatePlaceholder=e.createMenuEnabled&&!e.showingCreateMenu})),this.oneDriveUploadService.uploadEnabledPromise.then((function(t){e.createMenuEnabled=e.createMenuEnabled||t,e.showCreatePlaceholder=e.createMenuEnabled&&!e.showingCreateMenu}))),this.initWorkloads()},e.prototype.ngOnDestroy=function(){this.appGalleryLinkSubscription&&this.appGalleryLinkSubscription.unsubscribe(),this.previousRouteSubscription&&this.previousRouteSubscription.unsubscribe(),this.thirdPartyWorkloadsSubscription&&this.thirdPartyWorkloadsSubscription.unsubscribe()},e.prototype.onUnpinWorkload=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.workloadsService.unpinWorkload(e.item)];case 1:return t.sent(),this.workloads=this.workloads.filter((function(t){return!(t.AppId===e.item.AppId&&t.CollectorId===e.item.CollectorId)})),this.changeDetector.detectChanges(),[2]}}))}))},e.prototype.trackByWorkloadId=function(e,t){return t.Id},e.prototype.isShowingReducedAppTiles=function(){return"Reduced"===this.appTilesState},e.prototype.getDisplayedAppTilesCount=function(){return this.isShowingReducedAppTiles()?Math.min(this.reducedTilesCount,this.workloads.length):this.workloads.length},e.prototype.navigateToAppsPage=function(){this.officeRouteService.navigateTo({route:"AppGallery"})},e.prototype.removePlaceholder=function(){this.showCreatePlaceholder=!1,this.showingCreateMenu=!0},e.prototype.initWorkloads=function(){var e=this;this.isConsumer?this.workloadsService.getCoreSegmentAndFrequentApps().then((function(t){return e.setupWorkloads(t)})):this.pinnedAppsEnabled?this.setupWorkloads(this.workloadsService.getPinnedWorkloads()):this.workloadsService.getWorkloads().then((function(t){return e.setupWorkloads(t)}))},e.prototype.setupWorkloads=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n,i=this;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return t=this.appTilesConfigService.config,this.workloads=e.map((function(e){return Object(s.__assign)({},e)})),this.appGalleryConfigService.config&&(this.workloads.length>0?this.showAppGalleryLink=!0:this.thirdPartyWorkloadsSubscription=this.workloadsService.getThirdPartyWorkloads().subscribe((function(e){e.length>0&&(i.showAppGalleryLink=!0,i.thirdPartyWorkloadsSubscription.unsubscribe())}))),this.showProvisioningAlert=this.workloads.some((function(e){return!e.Url})),this.promotedIndex=-1,n=!1,this.workloads.forEach((function(e,r){t.isPromotedAppTileExpired||!t.promotedAppTileId||e.Id.toLowerCase()!==t.promotedAppTileId.toLowerCase()||i.isMobile||(i.promotedIndex=r,i.setPromotedApp(e,t.resources&&t.resources.PromotedAppSectionTitle)),e.ClickCount>0&&i.capabilitiesService.capabilities.showFloodgate&&i.capabilitiesService.capabilities.officeHomeFloodgate&&!n&&(n=!0)})),n&&this.floodgateService.recordFloodgate(["ClickedOneApp"]),this.promotedAppTile&&(this.workloads.splice(this.promotedIndex,1),this.promotedIndex=-1,t.expirePromotedAppTileEnabled&&this.logPromotedAppTileImpression()),this.isMobile&&this.sortTiles(t.mobileAppIds),this.pinnedAppsEnabled?[3,2]:[4,this.setUpReducedTiles()];case 1:r.sent(),r.label=2;case 2:return this.isConsumer||this.showAppGalleryLink&&this.instrumentationService.logImpressionEvent("ExploreAllYourApps_Impression"),this.workloadsService.getAdditionalWorkloads().then((function(e){var t;e&&e.length>0&&(e=e.filter((function(e){return!e.IsNativeClientOnlyApp||i.localStorageService.get("AppClicked_"+e.Id)})),i.workloadsService.populateWorkloadFields(e),(t=i.workloads).splice.apply(t,Object(s.__spread)([i.reducedTilesCount,0],e)),i.reducedTilesCount+=e.length)})),[2]}}))}))},e.prototype.setUpReducedTiles=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(s.__generator)(this,(function(t){return this.workloads?[2,this.workloadsService.getCoreSegmentAndFrequentApps().then((function(t){e.appTilesState="Reduced",e.reducedTilesCount=t.length,e.logImpression(e.getDisplayedAppTilesCount())}))]:[2]}))}))},e.prototype.sortTiles=function(e){if(e){var t=this.workloads.slice(0,this.workloads.length);this.workloads=this.workloads.sort((function(n,i){for(var r=0;r<e.length;r++){var o=e[r];if(n.Id===o)return-1;if(i.Id===o)return 1}for(r=0;r<t.length;r++){if(t[r]===n)return-1;if(t[r]===i)return 1}return 0}))}},e.prototype.logImpression=function(e){var t=[];this.workloads&&(t=this.workloads.slice(0)),this.promotedAppTile&&(t.unshift(this.promotedAppTile),e++);var n=function(n){return t.reduce((function(t,i,r){return r<e&&(n&&i.Url||!n&&!i.Url)?t+(0===t.length?"":";")+i.Id:t}),"")},i={};i.RenderSize=e.toString(),i.Distribution=n(!0);var r=n(!1);i.Provisioning=r,i.State=this.isMobile?"Mobile":"Default",i.TotalSize=this.workloads?this.workloads.length.toString():"0",i.Action=this.appTilesState,this.instrumentationService.logImpressionEvent("App_Tiles_Impression",i)},e.prototype.logPromotedAppTileImpression=function(){var e={};e.State=this.isMobile?"Mobile":"Default",this.instrumentationService.logImpressionEvent("Promoted_App_Tile_Impression",e)},e.prototype.setPromotedApp=function(e,t){this.promotedAppTile=e,this.promotedAppTitle=t},e.loggedMarker=!1,e}()),Dt=i.xb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeOut",definitions:[{type:1,expr:":leave",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:1},offset:null},{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDuration:"100ms"}}},options:null},options:null}],options:{}}]}});function Mt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","tiles-section__alert--fluent ms-fcl-nd"]],null,null,null,null,null)),i.yb(1,278528,null,0,Ge.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.Rb(2,{color:0}),(e()(),i.zb(3,0,null,null,1,"ohp-alert-message",[],null,null,null,Ze.b,Ze.a)),i.yb(4,49152,null,0,Qe.a,[],{message:[0,"message"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.fullBleedFontColor);e(t,1,0,i),e(t,4,0,n.provisioningAlertText)}),null)}function Rt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-create-menu-placeholder-tile",[],null,null,null,$e,Xe)),i.yb(1,114688,null,0,Je,[Re.a],{fullBleedTheming:[0,"fullBleedTheming"]},null)],(function(e,t){e(t,1,0,t.component.fullBleedTheming)}),null)}function xt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,5,"div",[["class","tiles__container"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Rt)),i.yb(2,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(3,16777216,null,null,2,null,null,null,null,(function(e,t,n){var i=!0;return"ohpLazyViewComponentLoaded"===t&&(i=!1!==e.component.removePlaceholder()&&i),i}),null,null)),i.yb(4,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},{componentLoaded:"ohpLazyViewComponentLoaded"}),i.Rb(5,{tileView:0,componentArea:1,forceWhiteBackground:2,scaleTile:3})],(function(e,t){var n=t.component;e(t,2,0,n.showCreatePlaceholder);var i=e(t,5,0,!0,n.componentArea,n.fullBleedTheming,n.scaleTile);e(t,4,0,"create-menu#CreateMenuModule",i)}),null)}function Lt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-app-tile",[],null,[[null,"unpinWorkload"]],(function(e,t,n){var i=!0;return"unpinWorkload"===t&&(i=!1!==e.component.onUnpinWorkload(n)&&i),i}),wt,mt)),i.yb(1,770048,null,0,ft,[ht,Z.a,W.a,ue.b,j.a,T.a,dt.a,ct.a,Re.a,i.h,Fe.b,ut.a],{workload:[0,"workload"],inExpandedView:[1,"inExpandedView"],promotedAppTile:[2,"promotedAppTile"],pinnedApp:[3,"pinnedApp"],forceWhiteBackground:[4,"forceWhiteBackground"]},{unpinWorkload:"unpinWorkload"})],(function(e,t){var n=t.component;e(t,1,0,t.parent.context.$implicit,t.parent.context.index>=n.reducedTilesCount,t.parent.context.index===n.promotedIndex,n.pinnedAppsEnabled,n.fullBleedTheming)}),null)}function Nt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-app-tile",[],null,null,null,wt,mt)),i.yb(1,770048,null,0,ft,[ht,Z.a,W.a,ue.b,j.a,T.a,dt.a,ct.a,Re.a,i.h,Fe.b,ut.a],{workload:[0,"workload"],inExpandedView:[1,"inExpandedView"],promotedAppTile:[2,"promotedAppTile"]},null)],(function(e,t){e(t,1,0,t.parent.context.$implicit,!1,!1)}),null)}function Ut(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","tiles__container"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Lt)),i.yb(2,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Nt)),i.yb(4,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,!n.isConsumer),e(t,4,0,n.isConsumer)}),null)}function Wt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,12,"div",[["class","tiles__container"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,11,"div",[["class","workload-item"]],null,null,null,null,null)),i.yb(2,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(3,{"animated-tile":0}),(e()(),i.zb(4,0,[[1,0],["appGalleryLink",1]],null,8,"a",[["class","workload-item__link workload-item--provisioned workload-item--fluent--provisioned workload-item--fluent__link ms-fcl-tda ms-bgc-w-h ms-bgc-w-a ms-bgc-w-f"],["data-nav","1"],["href","javascript:void(0);"],["id","explore-your-apps"]],[[1,"aria-label",0],[1,"data-area",0]],[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.navigateToAppsPage()&&i),i}),null,null)),i.yb(5,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(6,{"ms-bgc-w":0}),(e()(),i.zb(7,0,null,null,2,"span",[["class","workload-item__icon--fluent non-workload-item__icon ms-fcl-tda"]],null,null,null,null,null)),(e()(),i.zb(8,0,null,null,1,"ohp-icon-font",[["cssClass","link-arrow--flip"],["iconFontName","ArrowRight"],["size","32"]],null,null,null,Ke.b,Ke.a)),i.yb(9,638976,null,0,Ye.a,[Z.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null),(e()(),i.zb(10,0,null,null,2,"div",[["class","workload-item__name--fluent"]],null,null,null,null,null)),(e()(),i.zb(11,0,null,null,1,"div",[["class","workload-item__text--fluent non-workload-link__text ms-fcl-tda"]],null,null,null,null,null)),(e()(),i.Yb(12,null,["",""]))],(function(e,t){var n=t.component,i=e(t,3,0,n.scaleTile);e(t,2,0,"workload-item",i);var r=e(t,6,0,n.fullBleedTheming);e(t,5,0,"workload-item__link workload-item--provisioned workload-item--fluent--provisioned workload-item--fluent__link ms-fcl-tda ms-bgc-w-h ms-bgc-w-a ms-bgc-w-f",r),e(t,9,0,"link-arrow--flip","ArrowRight","32")}),(function(e,t){var n=t.component;e(t,4,0,n.exploreYourAppsAriaLabel,n.componentArea),e(t,12,0,n.appGalleryTileText)}))}function Bt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,7,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,xt)),i.yb(2,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,2,null,Ut)),i.yb(4,278528,null,0,Ge.j,[i.O,i.L,i.s],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),i.Qb(0,Ge.r,[]),(e()(),i.ib(16777216,null,null,1,null,Wt)),i.yb(7,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,n.createMenuEnabled),e(t,4,0,i.Zb(t,4,0,i.Ob(t,5).transform(n.workloads,0,n.getDisplayedAppTilesCount())),n.trackByWorkloadId),e(t,7,0,n.showAppGalleryLink)}),null)}function zt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-app-tile",[],null,null,null,wt,mt)),i.yb(1,770048,null,0,ft,[ht,Z.a,W.a,ue.b,j.a,T.a,dt.a,ct.a,Re.a,i.h,Fe.b,ut.a],{workload:[0,"workload"],inExpandedView:[1,"inExpandedView"],promotedAppTile:[2,"promotedAppTile"],forceWhiteBackground:[3,"forceWhiteBackground"]},null)],(function(e,t){var n=t.component;e(t,1,0,t.parent.context.$implicit,t.parent.context.index>=n.reducedTilesCount,t.parent.context.index===n.promotedIndex,n.fullBleedTheming)}),null)}function jt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-app-tile",[],null,null,null,wt,mt)),i.yb(1,770048,null,0,ft,[ht,Z.a,W.a,ue.b,j.a,T.a,dt.a,ct.a,Re.a,i.h,Fe.b,ut.a],{workload:[0,"workload"],inExpandedView:[1,"inExpandedView"],promotedAppTile:[2,"promotedAppTile"]},null)],(function(e,t){e(t,1,0,t.parent.context.$implicit,!1,!1)}),null)}function Ht(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","tiles__content tiles__content--touch"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,zt)),i.yb(2,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,jt)),i.yb(4,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,!n.isConsumer),e(t,4,0,n.isConsumer)}),null)}function Vt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,8,null,null,null,null,null,null,null)),(e()(),i.zb(1,0,null,null,7,"cdk-virtual-scroll-viewport",[["class","virtual-scroll-tiles cdk-virtual-scroll-viewport"],["itemSize","100"],["maxBufferPx","100"],["minBufferPx","50"],["orientation","horizontal"]],[[2,"cdk-virtual-scroll-orientation-horizontal",null],[2,"cdk-virtual-scroll-orientation-vertical",null]],null,null,Ct.b,Ct.a)),i.Tb(6144,null,It.b,null,[It.d]),i.yb(3,540672,null,0,It.a,[],{itemSize:[0,"itemSize"],minBufferPx:[1,"minBufferPx"],maxBufferPx:[2,"maxBufferPx"]},null),i.Tb(1024,null,It.h,It.j,[It.a]),i.yb(5,245760,null,0,It.d,[i.l,i.h,i.z,[2,It.h],[2,rt.c],It.f,[2,It.i]],{orientation:[0,"orientation"]},null),(e()(),i.ib(16777216,null,0,2,null,Ht)),i.yb(7,409600,null,0,It.c,[i.O,i.L,i.s,[1,It.d],i.z],{cdkVirtualForOf:[0,"cdkVirtualForOf"],cdkVirtualForTrackBy:[1,"cdkVirtualForTrackBy"]},null),i.Qb(0,Ge.r,[])],(function(e,t){var n=t.component;e(t,3,0,"100","50","100"),e(t,5,0,"horizontal"),e(t,7,0,i.Zb(t,7,0,i.Ob(t,8).transform(n.workloads,0,n.getDisplayedAppTilesCount())),n.trackByWorkloadId)}),(function(e,t){e(t,1,0,"horizontal"===i.Ob(t,5).orientation,"horizontal"!==i.Ob(t,5).orientation)}))}function qt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Bt)),i.yb(2,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Vt)),i.yb(4,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,!n.isMobile),e(t,4,0,n.isMobile)}),null)}function Gt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"ohp-app-tile",[],null,null,null,wt,mt)),i.yb(2,770048,null,0,ft,[ht,Z.a,W.a,ue.b,j.a,T.a,dt.a,ct.a,Re.a,i.h,Fe.b,ut.a],{workload:[0,"workload"],inExpandedView:[1,"inExpandedView"],promotedAppTile:[2,"promotedAppTile"]},null)],(function(e,t){e(t,2,0,t.component.promotedAppTile,!1,!0)}),null)}function Zt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,12,"div",[["class","explore-apps--fluent"]],null,null,null,null,null)),i.yb(1,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"explore-apps--backplate":0}),(e()(),i.zb(3,0,[[1,0],["appGalleryLink",1]],null,9,"a",[["class","explore-apps__text--fluent ms-fcl-tda ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a"],["href","javascript:void(0);"],["id","explore-your-apps"]],[[1,"aria-label",0],[1,"data-area",0],[1,"data-nav",0]],[[null,"click"],[null,"mouseenter"],[null,"mouseleave"]],(function(e,t,n){var r=!0,o=e.component;return"mouseenter"===t&&(r=!1!==i.Ob(e,7).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==i.Ob(e,7).onMouseLeave()&&r),"click"===t&&(r=!1!==o.navigateToAppsPage()&&r),r}),null,null)),i.yb(4,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(5,{"explore-apps__text--backplate":0}),i.yb(6,278528,null,0,Ge.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.yb(7,16384,null,0,at.a,[lt.a],{preloadPath:[0,"preloadPath"]},null),(e()(),i.zb(8,0,null,null,4,"div",[["class","centered-flex-container"]],null,null,null,null,null)),(e()(),i.zb(9,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),i.Yb(10,null,["",""])),(e()(),i.zb(11,0,null,null,1,"ohp-icon-font",[["cssClass","link-arrow"],["iconFontName","ArrowRight"],["size","14"]],null,null,null,Ke.b,Ke.a)),i.yb(12,638976,null,0,Ye.a,[Z.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.fullBleedBackplateEnabled);e(t,1,0,"explore-apps--fluent",i);var r=e(t,5,0,n.fullBleedBackplateEnabled);e(t,4,0,"explore-apps__text--fluent ms-fcl-tda ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a",r),e(t,6,0,n.fullBleedBackplateStyle),e(t,7,0,n.appGalleryRoute),e(t,12,0,"link-arrow","ArrowRight","14")}),(function(e,t){var n=t.component;e(t,3,0,n.exploreYourAppsAriaLabel,n.componentArea,!0),e(t,10,0,n.exploreYourAppsText)}))}function Qt(e){return i.bc(0,[i.Ub(671088640,1,{appGalleryLink:1}),(e()(),i.zb(1,0,null,null,17,"div",[["class","app-tiles-list-component"],["role","navigation"]],[[1,"aria-label",0],[24,"@fadeOut",0]],null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Mt)),i.yb(3,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(4,0,null,null,14,"div",[["class","tiles-section__container"]],null,null,null,null,null)),i.yb(5,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(6,{"mobile-tiles-section__container":0}),(e()(),i.zb(7,0,null,null,9,"div",[],null,null,null,null,null)),i.yb(8,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(9,{"large-tiles-container":0,"mobile-tiles--outer mobile-tiles--virtual-outer":1}),(e()(),i.zb(10,0,null,null,4,"div",[["class","fluent-tiles"]],null,null,null,null,null)),i.yb(11,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(12,{"mobile-tiles--inner":0}),(e()(),i.ib(16777216,null,null,1,null,qt)),i.yb(14,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Gt)),i.yb(16,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Zt)),i.yb(18,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,3,0,n.showProvisioningAlert);var i=e(t,6,0,n.isMobile);e(t,5,0,"tiles-section__container",i);var r=e(t,9,0,!!n.promotedAppTile,n.isMobile);e(t,8,0,r);var o=e(t,12,0,n.isMobile);e(t,11,0,"fluent-tiles",o),e(t,14,0,n.workloads),e(t,16,0,!!n.promotedAppTile&&!n.isMobile),e(t,18,0,n.showAppGalleryLink&&!n.bottomTrayEnabled&&n.isMobile)}),(function(e,t){e(t,1,0,t.component.appTilesLandmarkAriaLabel,void 0)}))}i.vb("ohp-app-tiles-list",Ft,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-app-tiles-list",[],null,null,null,Qt,Dt)),i.yb(1,4440064,null,0,Ft,[Tt.a,ht,Z.a,Me.a,ue.b,Et.a,T.a,k.b,H.a,p.b,dt.a,At.a,_t.a,kt.a,Ot.a,it.a,i.h],null,null)],(function(e,t){e(t,1,0)}),null)}),{fullBleedTheming:"fullBleedTheming",fullBleedFontColor:"fullBleedFontColor",fullBleedBackplateEnabled:"fullBleedBackplateEnabled",fullBleedBackplateStyle:"fullBleedBackplateStyle"},{},[]);var Kt=function(){return function(e){this.isMobile=e.isMobileDevice()}}(),Yt=i.xb({encapsulation:2,styles:[],data:{}});function Jt(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,5,"div",[["class","tiles-section section--fluent consumer-tiles-section consumer-tiles-section--no-title"]],null,null,null,null,null)),i.yb(1,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"consumer-tiles-section--mobile":0}),(e()(),i.zb(3,0,null,null,2,"div",[["class","width-restrictor width-restrictor--responsive"]],null,null,null,null,null)),(e()(),i.zb(4,0,null,null,1,"ohp-app-tiles-list",[],null,null,null,Qt,Dt)),i.yb(5,4440064,null,0,Ft,[Tt.a,ht,Z.a,Me.a,ue.b,Et.a,T.a,k.b,H.a,p.b,dt.a,At.a,_t.a,kt.a,Ot.a,it.a,i.h],null,null)],(function(e,t){var n=e(t,2,0,t.component.isMobile);e(t,1,0,"tiles-section section--fluent consumer-tiles-section consumer-tiles-section--no-title",n),e(t,5,0)}),null)}i.vb("ohp-app-tiles-section",Kt,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-app-tiles-section",[],null,null,null,Jt,Yt)),i.yb(1,49152,null,0,Kt,[ue.b],null,null)],null,null)}),{},{},[]);var Xt=n("g/dT"),$t=n("QtYd"),en=n("OOtI"),tn=n("QOOv"),nn=n("7Rc8"),rn=n("dOgD"),on=n("RJiy"),an=n("mNaV"),ln=n("f0qX"),sn=n("W3xQ"),cn=n("vcPZ"),un=n("CVeG"),dn=n("gktR"),pn=n("sH0/"),hn=function(){function e(e,t,n,i,a,l,s,c,u,d,h,f,m,b,v,g,y,S,w,C,I,T){var k=this;this.capabilitiesService=e,this.consumerInstallConfigService=t,this.contextService=n,this.locService=i,this.eventService=a,this.firstRunCalloutsConfigService=l,this.firstRunConfigService=s,this.firstRunDataService=c,this.startupConfigService=u,this.userContextService=d,this.featureCalloutService=h,this.floodgateService=f,this.performanceService=b,this.windowService=v,this.documentService=g,this.globalErrorHandler=y,this.instrumentationService=S,this.userProfileService=w,this.uploadService=C,this.shellShimService=I,this.userConsentService=T,this.initialized=!1,this.disabled=!m.isDesktopDevice()||!l.config||l.config.hideInTestMode,this.disabled||(this.installButtonResponsePromise=this.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return"installButtonResponse"===e.name})),Object(o.a)(1)).toPromise().then((function(e){if(e.args&&e.args.length)return Promise.resolve(e.args[0])})),this.paidConsumerModalShown=!1,this.consumerSubscriptionStatusPromise=this.consumerInstallConfigService.getConfig().then((function(e){return e&&e.currentSkuInfo&&e.currentSkuInfo.skuType})),this.startupConfigService.config.authType===p.a.MSA&&this.consumerSubscriptionStatusPromise.then((function(e){k.paidConsumerModalShown=!(e===Pt.b.NotSubscribed||e===Pt.b.NonActive||e===Pt.b.NotDetected)})),this.isCommercialUser=this.startupConfigService.config.authType===p.a.OrgId,this.userConsentPromise=this.isCommercialUser?Promise.resolve(null):this.userConsentService.getConfig(),this.isTrialEligible=!1,this.modalFreClosedPromise=this.firstRunConfigService.getConfig().then((function(e){var t;return k.isTrialEligible=!!(null===(t=null==e?void 0:e.model)||void 0===t?void 0:t.isTrialEligible),k.showModalFre=!!e&&!!e.model&&!!e.model.slides,k.showModalFre?a.events.withScope(0).pipe(Object(r.a)((function(e){return"firstRunModalClosed"===e.name})),Object(o.a)(1)).toPromise().then((function(){return Promise.resolve()})):Promise.resolve()})),this.uploadButtonResponsePromise=this.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return"uploadButtonResponse"===e.name})),Object(o.a)(1)).toPromise().then((function(){return Promise.resolve()})),this.appBarShowingPromise=this.capabilitiesService.capabilities.appBarEnabled?this.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return"appBarReady"===e.name})),Object(o.a)(1)).toPromise().then((function(){return Promise.resolve()})):Promise.resolve(),this.leftNavShowing=this.capabilitiesService.capabilities.leftNavReact)}return e.prototype.initializeFirstRun=function(){var e=this;this.disabled||this.initialized||(this.initialized=!0,this.firstRunVersion=this.firstRunCalloutsConfigService.config.version,this.fetchFirstRun().then((function(t){(t.CompletedFirstRun?Promise.resolve(new Array):e.getFirstRunCallouts().then((function(n){if(!n.length)return n;e.initCalloutActions(n);for(var i=t.Version!==e.firstRunVersion?0:void 0!==t.FurthestCompleted&&t.FurthestCompleted<n.length?t.FurthestCompleted:t.StepsCompleted<n.length?t.StepsCompleted:0,r=0;r<i;r++)n[r].completed=!0;return e.performanceService.mark("FRE_Ready"),e.firstRunDataService.updateFirstRunData({CompletedFirstRun:!1,StepsCompleted:i+1,Version:e.firstRunVersion,TotalSteps:n.length},dn.a.firstRunDataKey,n[i].calloutType),n}))).then((function(t){t.length?e.featureCalloutService.addCallouts(t):e.getAfterFirstRunCallouts().then((function(t){t.length&&e.featureCalloutService.addCallouts(t)}))}))})))},e.prototype.fetchFirstRun=function(){return this.firstRunDataService.fetchFirstRunData(this.firstRunVersion,!1,dn.a.firstRunDataKey)},e.prototype.getFirstRunCallouts=function(){var t=this,n=this.userContextService.user.isEdu,i=this.firstRunCalloutsConfigService.config;return new Promise(this.capabilitiesService.capabilities.freNewCalloutsEnabled?function(e,r){Promise.all([t.shellShimService.afterShellPlusLoaded,t.modalFreClosedPromise,t.consumerSubscriptionStatusPromise,t.userConsentPromise,t.installButtonResponsePromise,t.appBarShowingPromise]).then((function(r){var o=Object(s.__read)(r,4),a=o[0],l=o[2],c=o[3],u=new Array,d=a,p=t.documentService.nativeDocument.getElementById("O365_MainLink_NavMenu");d&&p&&(u.push(new cn.a(p,"AppLauncher",T.b.FirstRun,t.locService.FirstRunFindMoreAppsTitle,t.isCommercialUser?t.locService.FirstRunFindMoreAppsSubtitleCommercial:t.locService.FirstRunFindMoreAppsSubtitleConsumer,null,null,null,null,null,!1,null,null,null,null,null,null,null,null,t.isCommercialUser?n?i.findMoreAppsEduSvg:i.findMoreAppsCommercialSvg:i.findMoreAppsConsumerSvg)),t.userContextService.user.isAdmin&&p&&u.push(new cn.a(p,"AppLauncher",T.b.FirstRun,n?t.locService.FirstRunManageSchoolTitle:t.locService.FirstRunManageOrganizationTitle,t.locService.FirstRunManageOrganizationSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,null,i.adminCenterSvg)));var h=t.documentService.nativeDocument.getElementById("83D3F491-B586-4266-8738-89776471BF21");h&&u.push(new cn.a(h,"NewButton",T.b.FirstRun,t.locService.FirstRunCreateHereTitle,t.locService.FirstRunCreateHereSubtitle,null,null,null,null,null,!0,null,null,null,null,null,null,null,null,i.createHereSvg));var f=t.documentService.nativeDocument.getElementById("F57D5D29-4967-495C-A648-F7AB66BF8572");f&&t.isCommercialUser&&u.push(new cn.a(f,"MyContent",T.b.FirstRun,t.locService.FirstRunManageContentTitle,t.locService.FirstRunManageContentSubtitle,null,null,null,null,null,!0,null,null,null,null,null,null,null,null,i.manageContentSvg));var m=t.documentService.nativeDocument.getElementById(t.isCommercialUser?"upload-button-QuickAccess":"upload-button");if(m&&u.push(new cn.a(m,"Upload",T.b.FirstRun,t.locService.FirstRunUploadExistingContentTitle,t.locService.FirstRunUploadExistingContentSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,null,i.uploadContentSvg)),!t.isCommercialUser&&l===Pt.b.NonActive||l===Pt.b.NotSubscribed&&(!c||0===c.userConsent)){var b=t.documentService.nativeDocument.getElementById("consumer-buy-button");b&&u.push(new cn.a(b,"BuyOffice",T.b.FirstRun,t.locService.FirstRunUpgradeAnyTimeTitle,t.locService.FirstRunUpgradeAnyTimeSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,null,i.upgradeSvg))}var v=t.documentService.nativeDocument.getElementById(t.isCommercialUser?"install-dropdown-link":"installbutton-MSA-RedirectToMyAccountPage");v&&u.push(new cn.a(v,"Install",T.b.FirstRun,t.locService.FirstRunDownloadAppsTitle,t.locService.FirstRunDownloadAppsSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,null,i.officeMobileAppSvg));var g=t.documentService.nativeDocument.getElementById("feedbackContainer");g&&u.push(new cn.a(g,"Feedback",T.b.FirstRun,t.locService.FirstRunYoureAllSetTitle,t.locService.FirstRunYoureAllSetSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,null,i.allSetSvg,!0)),t.userProfileService.incrementMetric("Fre_New_Callouts_Impression");var y={};y.FirstRunTotalSteps=u.length.toString(),y.State="first-run",t.instrumentationService.logGenericEvent("Fre_New_Callouts_Event",y),e(u)})).catch((function(e){t.globalErrorHandler.handleError(e,"LAtlv"),r()}))}:function(n,i){Promise.all([t.shellShimService.afterShellPlusLoaded,t.installButtonResponsePromise,t.modalFreClosedPromise,t.consumerSubscriptionStatusPromise,t.userConsentPromise]).then((function(i){var r=Object(s.__read)(i,5),o=r[0],a=r[1],l=r[3],c=r[4],u=new Array,d=t.capabilitiesService.capabilities.eduPageTourFreEnabled&&t.userContextService.user.isEdu;if(t.capabilitiesService.capabilities.pwaCommercialNonEduFreEnabled&&t.capabilitiesService.capabilities.pwaEnabled){var p=t.documentService.nativeDocument.querySelector(".fast-hero-search");p&&u.push(new cn.a(p,"SearchBar",T.b.FirstRun,un.a.stripTags(t.locService.FirstRunCommercialNonEduSearchBoxMessagePwa),"")),(m=t.documentService.nativeDocument.getElementById("create-menu-dropdown-link"))&&u.push(new cn.a(m,"NewButton",T.b.FirstRun,un.a.stripTags(t.locService.FirstRunCommercialNonEduCreateNewMessagePwa),""));var h=t.documentService.nativeDocument.querySelector(".list-header__title--carousel");h&&u.push(new cn.a(h,"Recommended",T.b.FirstRun,un.a.stripTags(t.locService.FirstRunCommercialNonEduRecommendedMessagePwa),""));var f=t.documentService.nativeDocument.getElementById("tab-list-header-link-shared-mru");return f&&u.push(new cn.a(f,"SharedTab",T.b.FirstRun,un.a.stripTags(t.locService.FirstRunCommercialNonEduSharedWithMeMessagePwa),"")),void n(u)}if(t.capabilitiesService.capabilities.pwaFreeConsumerFreEnabled&&t.capabilitiesService.capabilities.pwaEnabled&&(l===Pt.b.NonActive||l===Pt.b.NotSubscribed)){var m;(m=t.documentService.nativeDocument.getElementById("create-menu-dropdown-link"))&&u.push(new cn.a(m,"NewButton",T.b.FirstRun,un.a.stripTags(t.locService.FirstRunConsumerCreateNewCalloutPwa),"")),(I=t.documentService.nativeDocument.getElementById("ShellDocuments_link"))&&t.isElementInViewport(I)&&u.push(new cn.a(I,"OneDriveTile",T.b.FirstRun,un.a.stripTags(t.locService.FirstRunConsumerOneDriveCalloutPwa),"",["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing));var b=t.documentService.nativeDocument.getElementById("consumer-buy-button"),v=t.capabilitiesService.capabilities.altaBrandingChangesEnabled&&t.isTrialEligible?t.locService.FirstRunConsumerTryMicrosoft365CalloutMessage:"",g=t.capabilitiesService.capabilities.altaBrandingChangesEnabled&&t.isTrialEligible?t.locService.FirstRunConsumerTryMicrosoft365CalloutLegalText:"";!b||c&&0!==c.userConsent||u.push(new cn.a(b,"BuyOffice",T.b.FirstRun,un.a.stripTags(t.capabilitiesService.capabilities.altaBrandingChangesEnabled?t.isTrialEligible?t.locService.FirstRunConsumerTryMicrosoft365CalloutTitle:t.locService.FirstRunConsumerBuyOfficeCalloutPwaAlta:t.locService.FirstRunConsumerBuyOfficeCalloutPwa),un.a.stripTags(v),["generic-button--fluent--secondary","ms-bgc-w","ms-fcl-tp","box-shadow--major"],["generic-button--fluent--primary","ms-bgc-tp","ms-fcl-w"],null,!1,!1,!1,"",!1,null,null,null,un.a.stripTags(g)))}if(t.userContextService.user.isEdu){if(t.userContextService.user.isEduFaculty){if(d)return(w=t.documentService.nativeDocument.getElementById("ShellSkypeTeams_link"))&&t.isElementInViewport(w)&&u.push(new cn.a(w,"TeamsTile",T.b.FirstRun,un.a.stripTags(t.locService.FirstRunEduFacultyPageTourV2TeamsCallout),"",["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing)),void n(u);var y=t.documentService.nativeDocument.getElementById("ShellOfficeForms_link");y&&t.isElementInViewport(y)&&u.push(new cn.a(y,"FormsTile",T.b.FirstRun,un.a.stripTags(t.locService.FirstRunFacultyFormsMessageUpdated),"",["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing));var S=t.documentService.nativeDocument.getElementById("ShellOneNoteOnline_link");return S&&t.isElementInViewport(S)&&u.push(new cn.a(S,"OneNoteTile",T.b.FirstRun,un.a.stripTags(t.locService.FirstRunFacultyOneNoteMessageUpdated),"",["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing)),(I=t.documentService.nativeDocument.getElementById("ShellDocuments_link"))&&t.isElementInViewport(I)&&u.push(new cn.a(I,"OneDriveTile",T.b.FirstRun,un.a.stripTags(t.locService.FirstRunEduOneDriveMessageUpdated),"",["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing)),void n(u)}var w;if(t.userContextService.user.isEduStudent&&d)return(w=t.documentService.nativeDocument.getElementById("ShellSkypeTeams_link"))&&t.isElementInViewport(w)&&u.push(new cn.a(w,"TeamsTile",T.b.FirstRun,un.a.stripTags(t.locService.FirstRunEduStudentPageTourV2TeamsCallout),"",["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing)),void n(u)}if((t.isCommercialUser||t.paidConsumerModalShown)&&a&&a.length){var C=t.documentService.nativeDocument.querySelector(".install-button");if(C&&!t.capabilitiesService.capabilities.pwaEnabled&&u.push(new cn.a(C,"Install",T.b.FirstRun,a,t.paidConsumerModalShown?t.capabilitiesService.capabilities.altaBrandingChangesEnabled?t.locService.PageTourGetOfficeMessageAlta:t.locService.PageTourGetOfficeMessage:t.locService.FirstRunInstallSubtitle,["generic-button--fluent--primary","ms-bgc-tp","ms-fcl-w","box-shadow--major"],["generic-button--fluent--secondary","ms-bgc-w","ms-fcl-tp"])),t.paidConsumerModalShown&&!t.capabilitiesService.capabilities.pwaEnabled&&((I=t.documentService.nativeDocument.getElementById("ShellDocuments_link"))&&t.isElementInViewport(I)&&u.push(new cn.a(I,"OneDriveTile",T.b.FirstRun,t.locService.PageTourNewDocumentTitle,t.locService.PageTourNewDocumentMessage,["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing)),(k=t.documentService.nativeDocument.querySelector(".my-account__link"))&&u.push(new cn.a(k,"MyAccount",T.b.FirstRun,t.locService.PageTourMyAccountTitle,t.locService.PageTourMyAccountMessage,["my-account__link--hover-style"]))),t.paidConsumerModalShown&&t.capabilitiesService.capabilities.pwaEnabled){var I,k,A=t.documentService.nativeDocument.getElementById("ShellWordOnline_link");A&&t.isElementInViewport(A)&&u.push(new cn.a(A,"WordTile",T.b.FirstRun,t.locService.FirstRunPaidConsumerCallout1Title,t.locService.FirstRunPaidConsumerCallout1Subtitle,["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing)),(I=t.documentService.nativeDocument.getElementById("ShellDocuments_link"))&&t.isElementInViewport(I)&&u.push(new cn.a(I,"OneDriveTile",T.b.FirstRun,t.locService.FirstRunPaidConsumerCallout2Title,t.locService.FirstRunPaidConsumerCallout2Subtitle,["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing)),(k=t.documentService.nativeDocument.querySelector(".my-account__link"))&&u.push(new cn.a(k,"MyAccount",T.b.FirstRun,t.locService.FirstRunPaidConsumerCallout3Title,t.locService.FirstRunPaidConsumerCallout3Subtitle,["my-account__link--hover-style"]))}if(t.showModalFre||t.paidConsumerModalShown)return void n(u)}var P=o,E=t.windowService.innerWidth,_=t.documentService.nativeDocument.getElementById("O365_MainLink_NavMenu");if(P&&_&&E>e.minWidthForCalloutShell&&u.push(new cn.a(_,"AppLauncher",T.b.FirstRun,t.locService.FirstRunAppLauncherTitle,t.capabilitiesService.capabilities.altaBrandingChangesEnabled?t.locService.FirstRunAppLauncherAltaSubtitle:t.locService.FirstRunAppLauncherSubtitle)),t.userContextService.user.isAdmin){var O=t.documentService.nativeDocument.getElementById("ShellAdmin_link");O&&t.isElementInViewport(O)&&u.push(new cn.a(O,"AdminTile",T.b.FirstRun,t.locService.FirstRunAdminTitle,t.locService.FirstRunAdminSubtitle,null,null,null,null,null,t.leftNavShowing))}n(u)})).catch((function(e){t.globalErrorHandler.handleError(e,"k1Drr"),i()}))})},e.prototype.getAfterFirstRunCallouts=function(){var e=this,t=[this.shellShimService.afterShellPlusLoaded,this.modalFreClosedPromise],n=this.userProfileService.doesMetricExist("Fre_New_Callouts_Impression");return this.capabilitiesService.capabilities.freNewCalloutsEnabled&&t.push(this.consumerSubscriptionStatusPromise,this.userConsentPromise,n,this.appBarShowingPromise),new Promise((function(n,i){Promise.all(t).then((function(t){var i=Object(s.__read)(t,5),a=i[0],l=i[2],c=i[3],u=i[4],d=new Array;if(!e.capabilitiesService.capabilities.freNewCalloutsEnabled||u&&!e.contextService.sharedContext.inMockMode){if(a){var p=e.documentService.nativeDocument.querySelectorAll(e.contextService.sharedContext.inMockMode?"#O365_MainLink_Help":"#O365_MainLink_Settings"),h=p&&p.length?p[p.length-1]:null;e.capabilitiesService.capabilities.themingCalloutEnabled&&d.push(e.createThemingCallout(h,"PrideThemesCallout_Impression",e.capabilitiesService.capabilities.showThemingCallout,e.locService.ThemesCalloutTitle,e.locService.ThemesCalloutSubtitle,"callout-sprite")),e.capabilitiesService.capabilities.consumerThemesCalloutEnabled&&d.push(e.createThemingCallout(h,"Consumer_Themes_Callout_Impression",e.contextService.sharedContext.inMockMode,e.locService.ConsumerThemesCalloutTitle,null,null))}e.firstRunCalloutsConfigService.config.dragAndDropCalloutEnabled&&d.push(e.userProfileService.doesMetricExist("Upload_Button_DragAndDrop_Callout_Impression",!0).then((function(t){return t?Promise.reject():e.uploadService.uploadEnabledPromise})).then((function(t){return t?e.uploadButtonResponsePromise:Promise.reject()})).then((function(){var t=e.documentService.nativeDocument.getElementById("upload-button");if(t){var n=e.eventService.events.withScope(1).pipe(Object(r.a)((function(e){return"uploadButtonClick"===e.name})),Object(o.a)(1)),i=new cn.a(t,"DragAndDrop",e.contextService.isEdgeworth?T.b.Edgeworth:T.b.Documents,e.locService.FirstRunDragAndDropCalloutTitle,e.locService.FirstRunDragAndDropCalloutSubtitle,["generic-button--fluent--primary","ms-bgc-tp","ms-fcl-w","box-shadow--major"],["generic-button--fluent--secondary","ms-bgc-w","ms-fcl-tp"],null,null,null,null,null,null,n);return e.instrumentationService.logImpressionEvent("Upload_Button_DragAndDrop_Callout_Impression",{},["Upload_Button_DragAndDrop_Callout_Impression"]),i}return null})).catch((function(){return null})))}else{var f=e.firstRunCalloutsConfigService.config,m=e.documentService.nativeDocument.getElementById("O365_MainLink_NavMenu");if(d.push(Promise.resolve(new cn.a(m,"Welcome",e.contextService.isEdgeworth?T.b.Edgeworth:T.b.Documents,e.locService.FirstRunWelcomeBackTitle,e.locService.FirstRunWelcomeBackSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,null,f.welcomeBackSvg,!1,!0,"Returning_User_Callouts_Impression"))),a&&m){d.push(Promise.resolve(new cn.a(m,"AppLauncher",T.b.FirstRun,e.locService.FirstRunFindMoreAppsTitle,e.locService.FirstRunFindMoreAppsSubtitleReturningUser,null,null,null,null,null,!1,null,null,null,null,null,null,null,null,e.isCommercialUser?e.userContextService.user.isEdu?f.findMoreAppsEduSvg:f.findMoreAppsCommercialSvg:f.findMoreAppsConsumerSvg,!1,!1,"Returning_User_Callouts_Impression"))),e.userContextService.user.isAdmin&&m&&d.push(Promise.resolve(new cn.a(m,"AppLauncher",T.b.FirstRun,e.locService.FirstRunAdminCenterMovedTitle,e.locService.FirstRunAdminCenterMovedSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,null,f.adminCenterSvg,!1,!1,"Returning_User_Callouts_Impression")));var b=e.documentService.nativeDocument.getElementById("83D3F491-B586-4266-8738-89776471BF21");b&&d.push(Promise.resolve(new cn.a(b,"NewButton",T.b.FirstRun,e.locService.ExpandedCreateCapabilitiesTitle,e.locService.FirstRunExpandedCreateCapabilitiesSubittle,null,null,null,null,null,!0,null,null,null,null,null,null,null,null,f.createHereSvg,!1,!1,"Returning_User_Callouts_Impression")));var v=e.documentService.nativeDocument.getElementById("F57D5D29-4967-495C-A648-F7AB66BF8572");if(v&&e.isCommercialUser&&d.push(Promise.resolve(new cn.a(v,"MyContent",T.b.FirstRun,e.locService.FirstRunManageContentTitle,e.locService.FirstRunManageContentSubtitle,null,null,null,null,null,!0,null,null,null,null,null,null,null,null,f.manageContentSvg,!1,!1,"Returning_User_Callouts_Impression"))),!e.isCommercialUser&&l===Pt.b.NonActive||l===Pt.b.NotSubscribed&&(!c||0===c.userConsent)){var g=e.documentService.nativeDocument.getElementById("installbutton-MSA-RedirectToMyAccountPage");g&&d.push(Promise.resolve(new cn.a(g,"BuyOffice",T.b.FirstRun,e.locService.FirstRunUpgradeAnyTimeTitle,e.locService.FirstRunUpgradeAnyTimeSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,null,f.upgradeSvg,!1,!1,"Returning_User_Callouts_Impression")))}var y=e.documentService.nativeDocument.getElementById("feedbackContainer");y&&d.push(Promise.resolve(new cn.a(y,"Feedback",T.b.FirstRun,e.locService.FirstRunYoureAllSetTitle,e.locService.FirstRunYoureAllSetSubtitleReturningUser,null,null,null,null,null,!1,null,null,null,null,null,null,null,null,f.allSetSvg,!0,!1,"Returning_User_Callouts_Impression")))}var S={};S.FirstRunTotalSteps=d.length.toString(),S.State="after-first-run",e.instrumentationService.logGenericEvent("Fre_New_Callouts_Event",S),e.userProfileService.incrementMetric("Fre_New_Callouts_Impression")}Promise.all(d).then((function(e){return n(e.filter((function(e){return null!==e})))}))})).catch((function(t){e.globalErrorHandler.handleError(t,"Cgjwv"),i()}))}))},e.prototype.isElementInViewport=function(e){var t=e.getBoundingClientRect();return t.top+t.height<this.windowService.nativeWindow.innerHeight},e.prototype.createThemingCallout=function(e,t,n,i,a,l){var c=this;return this.userProfileService.doesMetricExist(t,!0).then((function(u){if((!u||n)&&e){var d=c.eventService.events.withScope(1).pipe(Object(r.a)((function(e){return"flexPaneOpen"===e.name})),Object(o.a)(1)),p=new cn.a(e,"NewThemes",T.b.Shell,i,a,null,null,"themes-callout",null,null,null,l,!0,d);return p.onAction=function(e){return Object(s.__awaiter)(c,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return 4!==e?[3,2]:[4,this.shellShimService.getShellShim()];case 1:t.sent().FlexPane.OpenFlexPaneForProvider("Settings"),t.label=2;case 2:return[2]}}))}))},c.instrumentationService.logImpressionEvent(t,{},[t]),p}return null}))},e.prototype.initCalloutActions=function(e){var t=this,n=e.length,i=function(i){var r=e[i];r&&t.firstRunDataService.updateFirstRunData({CompletedFirstRun:!1,StepsCompleted:i+1,Version:t.firstRunVersion,TotalSteps:n},dn.a.firstRunDataKey,r.calloutType)};e.forEach((function(e,r){e.buttonIdPrefix="first-run-step-"+r+"-"+e.calloutType.toLowerCase(),e.onAction=r===n-1?function(e){0!==e&&(3===e?i(r-1):(t.firstRunDataService.updateFirstRunData({CompletedFirstRun:!0,StepsCompleted:n,Version:t.firstRunVersion,TotalSteps:n},dn.a.firstRunDataKey),t.paidConsumerModalShown&&t.capabilitiesService.capabilities.showFloodgate&&t.capabilitiesService.capabilities.paidConsumerFreFloodgateEnabled&&t.floodgateService.recordFloodgate(["SawPaidConsumerFirstRun"])))}:function(e){0!==e&&(1===e?(t.firstRunDataService.updateFirstRunData({CompletedFirstRun:!0,StepsCompleted:r+1,Version:t.firstRunVersion,TotalSteps:n},dn.a.firstRunDataKey),t.paidConsumerModalShown&&t.capabilitiesService.capabilities.showFloodgate&&t.capabilitiesService.capabilities.paidConsumerFreFloodgateEnabled&&t.floodgateService.recordFloodgate(["SawPaidConsumerFirstRun"])):i(2===e?r+1:r-1))}}))},e.minWidthForCalloutShell=1024,e.ɵprov=i.cc({factory:function(){return new e(i.dc(Z.a),i.dc(Me.a),i.dc(W.a),i.dc(Re.a),i.dc(j.a),i.dc(pn.a),i.dc(we.a),i.dc(dn.a),i.dc(p.b),i.dc(Ne.a),i.dc(Se.a),i.dc(Et.a),i.dc(ue.b),i.dc(k.b),i.dc(d.b),i.dc(c.a),i.dc(l.b),i.dc(T.a),i.dc(x.b),i.dc(Ot.a),i.dc(Oe.a),i.dc(Le.a))},token:e,providedIn:"root"}),e}(),fn=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d){this.calendarConfigService=e,this.capabilitiesService=t,this.consumerInstallConfigService=n,this.eventService=i,this.firstRunConfigService=r,this.firstRunCalloutsService=o,this.instrumentationService=a,this.locService=l,this.mruConfigService=s,this.userContextService=c,this.workloadsService=u,this.clientStartupConfigService=d,this.coreWorkloadIds=["ShellWordOnline","ShellExcelOnline","ShellPowerPointOnline","ShellMail"]}return e.prototype.ngOnInit=function(){var e=this,t=this.capabilitiesService.capabilities,n=this.clientStartupConfigService.config.authType===p.a.MSA;this.showSuggestedActions=t.suggestedActionsEnabled,this.showTilesSection=!t.appsInHero&&!t.leftNavReact,this.showCalendar=!t.edgeworthEnabled&&t.calendarEnabled&&!!this.calendarConfigService.config,this.bottomTrayEnabled=t.bottomTrayEnabled,this.showPlaces=this.clientStartupConfigService.config.authType===p.a.OrgId&&!t.edgeworthEnabled,this.leftNavEmptyImage=t.leftNavEmptyImage,this.leftNavEmptyStateString=this.locService.LeftNavNonWXPEmptyStateString,this.leftNavEmptyStateSubtitle=this.locService.LeftNavNonWXPEmptyStateSubtitleString,Promise.all([this.firstRunConfigService.getConfig(),this.consumerInstallConfigService.getConfig()]).then((function(i){var r=Object(s.__read)(i,2),o=r[0],a=r[1],l=a&&a.currentSkuInfo?a.currentSkuInfo.skuType:Pt.b.NotDetected;if((!o||!o.model||t.modalFreCalloutEnabled||!(l===Pt.b.NonActive||l===Pt.b.NotSubscribed||l===Pt.b.NotDetected)||e.userContextService.user.isEduFaculty||t.eduPageTourFreEnabled&&e.userContextService.user.isEdu)&&!e.userContextService.user.hasNoLicense&&e.firstRunCalloutsService.initializeFirstRun(),n){var c={};c.SkuType=Pt.b[l],e.instrumentationService.logGenericEvent("ConsumerSkuLoaded",c)}}));var i,a=Promise.resolve(!1),l=this.mruConfigService.config;l.recommendedEnabled&&(a=this.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return"recommendedDataReady"===e.name})),Object(ln.a)((function(e){return e.args[0]>0})),Object(o.a)(1)).toPromise()),i=l.showZeroExperience?Promise.resolve(!0):this.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return"mruDataReady"===e.name})),Object(ln.a)((function(e){return e.args[0]>0})),Object(o.a)(1)).toPromise();var c=Promise.resolve(!1);this.showCalendar&&(c=this.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return"calendarDataReady"===e.name})),Object(ln.a)((function(e){return e.args[0]>0})),Object(o.a)(1)).toPromise());var u=Promise.resolve(!1);u=this.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return"announcementsReady"===e.name})),Object(ln.a)((function(e){return e.args[0]>0})),Object(o.a)(1)).toPromise();var d=this.workloadsService.getWorkloads().then((function(t){return t.filter((function(t){return e.coreWorkloadIds.indexOf(t.Id)>=0})).length>0}));Promise.all([a,i,d,c,u]).then((function(t){var n=Object(s.__read)(t,5);n[0]||n[1]||n[2]||n[3]||n[4]||(e.showEmptyNavState=!0)}))},e}(),mn=i.xb({encapsulation:2,styles:[],data:{}});function bn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-app-tiles-section",[],null,null,null,Jt,Yt)),i.yb(1,49152,null,0,Kt,[ue.b],null,null)],null,null)}function vn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","left-nav-empty-content-state__container"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,0,"img",[["class","left-nav-empty-content-state__image"]],[[8,"src",4]],null,null,null,null)),(e()(),i.zb(2,0,null,null,1,"div",[["class","left-nav-empty-content-state__text"]],null,null,null,null,null)),(e()(),i.Yb(3,null,["",""])),(e()(),i.zb(4,0,null,null,0,"div",[["class","left-nav-empty-content-state__subtitle ms-fcl-tp"]],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){var n=t.component;e(t,1,0,n.leftNavEmptyImage),e(t,3,0,n.leftNavEmptyStateString),e(t,4,0,n.leftNavEmptyStateSubtitle)}))}function gn(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"places#PlacesModule")}),null)}function yn(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"calendar#CalendarModule")}),null)}function Sn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,12,"div",[["ohpInstrumentPageView","Home_PageView"]],null,null,null,null,null)),i.yb(1,81920,null,0,Xt.a,[ue.b,T.a],{pageName:[0,"pageName"]},null),(e()(),i.ib(16777216,null,null,1,null,bn)),i.yb(3,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(4,0,null,null,8,"div",[["role","main"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,vn)),i.yb(6,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(7,0,null,null,1,"ohp-documents-component",[],null,null,null,$t.b,$t.a)),i.yb(8,245760,null,0,en.a,[Z.a,j.a,tn.a,Re.a,nn.a,rn.a,kt.a,on.a,Ot.a,je.a,p.b,p.b,an.a,W.a],{firstSection:[0,"firstSection"],headless:[1,"headless"],isSuggestedActions:[2,"isSuggestedActions"]},null),(e()(),i.ib(16777216,null,null,1,null,gn)),i.yb(10,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,yn)),i.yb(12,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,1,0,"Home_PageView"),e(t,3,0,n.showTilesSection),e(t,6,0,n.showEmptyNavState),e(t,8,0,!n.showTilesSection&&!n.bottomTrayEnabled,!0,n.showSuggestedActions),e(t,10,0,n.showPlaces),e(t,12,0,n.showCalendar)}),null)}var wn=i.vb("ohp-home",fn,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-home",[],null,null,null,Sn,mn)),i.yb(1,114688,null,0,fn,[sn.a,Z.a,Me.a,j.a,we.a,hn,T.a,Re.a,tn.a,Ne.a,dt.a,p.b],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),Cn=n("VrZ9"),In=n("MRNN"),Tn=n("rPZ4"),kn=n("Zy3K"),An=n("WJRI"),Pn=n("kVgv"),En=n("ICP0"),_n=n("Q6ee"),On=n("y3b+"),Fn=n("iX+N"),Dn=n("PTf4"),Mn=n("AlWG"),Rn=n("pd4Y"),xn=function(){function e(t,n,i){this.dateService=t,this.locService=n,this.userContextService=i,this.currentGreetingText=this.generateGreeting(),this.greetingSubject=new Mn.a(this.currentGreeting),this.setupTimer(e.MorningStartHour),this.setupTimer(e.AfternoonStartHour),this.setupTimer(e.EveningStartHour)}return Object.defineProperty(e.prototype,"greetingObservable",{get:function(){return this.greetingSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentGreeting",{get:function(){return this.currentGreetingText},enumerable:!0,configurable:!0}),e.prototype.setupTimer=function(e){var t=this,n=new Date,i=new Date(n.getFullYear(),n.getMonth(),n.getDate(),e,0,0,0);i<n&&i.setUTCDate(i.getUTCDate()+1);var r=i.getTime()-n.getTime();setTimeout((function(){t.updateGreeting(),t.setupTimer(e)}),r)},e.prototype.updateGreeting=function(){var e=this.generateGreeting();e!==this.currentGreetingText&&(this.currentGreetingText=e,this.greetingSubject.next(this.currentGreetingText))},e.prototype.generateGreeting=function(){var t,n=this.userContextService.user.displayName,i=this.dateService.getCurrentDate().getHours();return t=i>=e.MorningStartHour&&i<e.AfternoonStartHour?n?this.locService.WelcomeMorningWithName:this.locService.WelcomeMorningNoName:i>=e.AfternoonStartHour&&i<e.EveningStartHour?n?this.locService.WelcomeAfternoonWithName:this.locService.WelcomeAfternoonNoName:n?this.locService.WelcomeEveningWithName:this.locService.WelcomeEveningNoName,n&&(t=this.locService.format(t,n)),t},e.MorningStartHour=4,e.AfternoonStartHour=12,e.EveningStartHour=18,e.ɵprov=i.cc({factory:function(){return new e(i.dc(Rn.a),i.dc(Re.a),i.dc(Ne.a))},token:e,providedIn:"root"}),e}(),Ln=(n("xv22"),function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,h,f,m,b,v){this.activatedRoute=e,this.appGalleryConfigService=t,this.appTilesConfigService=n,this.capabilitiesService=i,this.consumerInstallConfigService=r,this.contextService=o,this.deviceDetector=a,this.eventService=l,this.installConfigService=s,this.locService=c,this.officeRouteService=u,this.searchConfigService=d,this.themingService=p,this.welcomeContentService=h,this.windowService=f,this.workloadsService=m,this.startupConfigService=b,this.wacStartConfigService=v,this.backgroundStyle={},this.bleedBackgroundStyle={},this.heroImageStyle={},this.heroLeftImageStyle={},this.heroRightImageStyle={},this.heroTitleGradient={},this.fullBleedBackplateStyle={},this.isSearchSiteScoped=!1}return e.prototype.ngOnInit=function(){var e=this,t=this.capabilitiesService.capabilities,n=!!this.appGalleryConfigService.config,i=t.wacStartPageEnabled;if(this.appsInHero=t.appsInHero,this.bottomTrayEnabled=t.bottomTrayEnabled,this.searchEnabled=t.showSearch&&!!this.searchConfigService.config,this.gradientEnabled=t.heroGradient,this.backgroundOptimizationEnabled=t.heroBackgroundOptimizationEnabled,this.pwaEnabled=t.pwaEnabled,this.isConsumer=this.startupConfigService.config.authType===p.a.MSA,this.isMobile=this.deviceDetector.isMobileDevice(),this.showCreateButtonWithAnimation=t.createButtonWithAnimationEnabled&&!this.isConsumer&&!this.isMobile,this.hideConsumerBackgroundImage=this.isConsumer&&!this.onHomePageOrPwa,this.showAppTilesHeroTitle=this.appsInHero&&!this.bottomTrayEnabled&&!this.showCreateButtonWithAnimation,this.myAccountLinkText=this.appTilesConfigService.config.resources.MyAccountConsumerLinkText,this.myAccountUrl=this.appTilesConfigService.config.myAccountUrl,this.leftNavReact=t.leftNavReact,this.quickAccessEnabled=t.quickAccessV1Enabled,this.fluentRefresh=t.fluentRefresh,this.appBarEnabled=t.appBarEnabled,this.announcementListenerAdded=!1,this.suggestedActions=t.suggestedActionsEnabled,this.isConsumer?this.consumerInstallConfigService.getConfig().then((function(t){var n=t&&t.currentSkuInfo?t.currentSkuInfo.skuType:Pt.b.NotDetected;e.isPaidConsumer=!(n===Pt.b.NotSubscribed||n===Pt.b.NonActive||n===Pt.b.NotDetected),n!==Pt.b.NotSubscribed&&n!==Pt.b.NonActive||e.installConfigService.config.dimeEnabled&&e.eventService.events.withScope(1).pipe(Object(r.a)((function(e){return"convertedToPaid"===e.name})),Object(o.a)(1)).toPromise().then((function(){e.isPaidConsumer=!0}))})):this.isPaidConsumer=!1,this.greetingSubscription=this.welcomeContentService.greetingObservable.subscribe((function(t){e.heroTitle&&(!e.currentRoute||"OfficeHome"===e.currentRoute||"Pwa"===e.currentRoute||"AppGallery"===e.currentRoute&&e.isConsumer)&&(e.heroTitle=t)})),this.searchEnabled||n||i){var a=void 0;a=this.officeRouteService.hasNavigated()?this.officeRouteService.getRouteChangeEndObservable():Object(En.a)(this.officeRouteService.getRouteChangeStartObservable().pipe(Object(o.a)(1)),this.officeRouteService.getRouteChangeEndObservable()),this.routeSubscription=a.subscribe((function(t){e.setHeroFlags(t)})),this.changeTitleSubscription=this.eventService.events.withScope(1).pipe(Object(r.a)((function(e){return"changeTitle"===e.name}))).subscribe((function(t){if(t&&t.args&&t.args.length){var n=t.args;e.heroTitle=e.isConsumer&&e.onAppGalleryPage?e.welcomeContentService.currentGreeting:n[0],e.accessibilityTitle=n.length>1?n[1]:e.heroTitle}}))}else this.showApps=this.appsInHero&&!this.leftNavReact,this.showInstall=!0,this.showInstallButton=!0,this.heroTitle=this.welcomeContentService.currentGreeting,this.accessibilityTitle=this.locService.AuthPageTitle;this.fullBleedSubscription=this.themingService.fullBleedTheming.subscribe((function(t){var n=t.bleedColor,i=t.themeData,r=t.bleedFontColor;e.fullBleedThemingEnabled=t.shouldFullBleed,e.fullBleedColor=n,e.fullBleedFontColor=e.fullBleedThemingEnabled?r:"",e.activeThemeId=i.theme.themeId;var o=i.theme.reactShellTheme;e.fullBleedImages=o?o.FullBleedImages:null,e.setResizeSubscription(),e.setFullBleedBackground(e.fullBleedThemingEnabled,e.fullBleedImages,e.fullBleedColor,e.windowService.innerWidth)}))},e.prototype.ngAfterViewInit=function(){var e=this.contextService.sharedContext;this.appsInHero||(e.heroImageUrl&&(this.backgroundStyle["background-image"]="url("+e.heroImageUrl+")"),this.heroTitleGradient["background-image"]="url("+e.heroTitleGradientImageUrl+")"),this.setResizeSubscription()},e.prototype.ngAfterViewChecked=function(){var e,t,n,i;if(!this.announcementListenerAdded){var r=null===(t=null===(e=this.heroAnnouncement)||void 0===e?void 0:e.nativeElement)||void 0===t?void 0:t.getElementsByClassName("new-stream-announcement"),o=null===(i=null===(n=this.heroAnnouncement)||void 0===n?void 0:n.nativeElement)||void 0===i?void 0:i.getElementsByClassName("classic-stream-announcement");r&&r[0]&&r[0].addEventListener("focus",(function(){r[0].scrollIntoView({behavior:"smooth",block:"nearest",inline:"end"})})),o&&o[0]&&(o[0].addEventListener("focus",(function(){o[0].scrollIntoView({behavior:"smooth",block:"nearest",inline:"end"})})),this.announcementListenerAdded=!0)}},e.prototype.ngOnDestroy=function(){this.greetingSubscription&&this.greetingSubscription.unsubscribe(),this.routeSubscription&&this.routeSubscription.unsubscribe(),this.changeTitleSubscription&&this.changeTitleSubscription.unsubscribe(),this.resizeSubscription&&this.resizeSubscription.unsubscribe(),this.fullBleedSubscription&&this.fullBleedSubscription.unsubscribe()},e.prototype.backToSearchPage=function(){this.officeRouteService.back({route:"Search"})},e.prototype.setResizeSubscription=function(){var e=this;this.resizeSubscription||(this.resizeSubscription=this.eventService.events.withScope(1).pipe(Object(r.a)((function(e){return"contentWidthChanged"===e.name||"windowResized"===e.name})),Object(_n.a)(10)).subscribe((function(t){e.setFullBleedBackground(e.fullBleedThemingEnabled,e.fullBleedImages,e.fullBleedColor,e.windowService.innerWidth)})))},e.prototype.setHeroFlags=function(e){var t=this,n=e.currentRoute;if(this.currentRoute=n?n.route:null,this.onCreatePage="Create"===this.currentRoute,this.onSearchPage="Search"===this.currentRoute||"SearchSiteScoped"===this.currentRoute||"SearchPersonScoped"===this.currentRoute,this.onAppGalleryPage="AppGallery"===this.currentRoute,this.onHomePageOrPwa=!this.currentRoute||"OfficeHome"===this.currentRoute||"Pwa"===this.currentRoute,this.showApps=this.onHomePageOrPwa&&this.appsInHero&&!this.leftNavReact,this.showFASTBreadcrumb="SearchSiteScoped"===this.currentRoute,this.appContext=n?n.app:null,this.hideConsumerBackgroundImage=this.isConsumer&&!this.onHomePageOrPwa,this.showCreateButtonWithAnimation=this.capabilitiesService.capabilities.createButtonWithAnimationEnabled&&this.onHomePageOrPwa&&!this.isConsumer&&!this.isMobile,this.announcementMarkup=Object(Dn.a)(this.locService,this.wacStartConfigService,this.appContext),this.onAppGalleryPage&&this.workloadsService.getWorkloads().then((function(e){t.store=e.find((function(e){return"ShellOfficeStore"===e.Id}))})),this.showInstall=this.onHomePageOrPwa||this.onAppGalleryPage,this.showInstallButton=this.capabilitiesService.capabilities.isPwaInUwp&&this.installConfigService.config.pwaInstallMoveEnabled?this.onAppGalleryPage:this.onHomePageOrPwa||this.onAppGalleryPage,this.showHeroButtons=this.onAppGalleryPage||this.onHomePageOrPwa,this.onSearchPage||!this.activatedRoute.snapshot.queryParams.q||this.isConsumer){var i=this.eventService.whenEventFired("exitSearchInSearchBox",0),r=this.eventService.whenEventFired("isContextualRailEnabled",0);this.backButtonId="back-button",this.backButtonAriaLabel="";var o=Promise.resolve(!1);switch(this.defaultBackRoute=null,this.onTemplatesPage=!1,this.currentRoute){case"Search":case"SearchPersonScoped":this.isConsumer&&(this.accessibilityTitle=this.locService.SearchResults),this.backButtonId="search-close-button",this.backButtonAriaLabel=this.locService.CloseSearchResultsAriaLabel,this.defaultBackRoute={route:this.pwaEnabled?"Pwa":"OfficeHome"},this.componentArea=T.b.SearchResults,o=i.then((function(e){return!e.args[0]}));break;case"SearchSiteScoped":this.backButtonId="search-site-scoped-close-button",this.backButtonAriaLabel=this.locService.CloseSearchResultsAriaLabel,this.defaultBackRoute={route:"Search"},o=i.then((function(e){return!e.args[0]}));break;case"AppGallery":this.accessibilityTitle=this.locService.AppGalleryHeroTitle,this.backButtonId="app-gallery-close-button",this.componentArea=T.b.AppGalleryHero;break;case"Templates":o=Promise.resolve(!0),this.defaultBackRoute={route:"Start",app:n.app},this.onTemplatesPage=!0,this.componentArea=T.b.Templates;break;case"MyForms":case"GroupForms":o=Promise.resolve(!0),this.defaultBackRoute={route:"Start",app:n.app};break;case"Start":break;default:this.componentArea=T.b.Hero}this.isSearchSiteScoped="SearchSiteScoped"===this.currentRoute,this.setShowBack(o),this.setContextualRail(r.then((function(e){return e.args[0]}))),this.heroTitle=this.onHomePageOrPwa?this.welcomeContentService.currentGreeting:this.accessibilityTitle,this.showCreateLocation=this.onTemplatesPage&&this.appContext!==Te.b.Sway&&this.appContext!==Te.b.Forms,this.noGutter=this.fluentRefresh||this.quickAccessEnabled&&"OfficeHome"===this.currentRoute&&!this.isConsumer}else this.officeRouteService.navigateTo({route:"Search"},!0)},e.prototype.setShowBack=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return t=this,[4,e];case 1:return t.showBackButton=n.sent(),this.showAppTilesHeroTitle=!this.bottomTrayEnabled&&(this.showBackButton||this.showFASTBreadcrumb||this.onHomePageOrPwa&&this.appsInHero&&!this.showCreateButtonWithAnimation),[2]}}))}))},e.prototype.setContextualRail=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return t=this,[4,e];case 1:return t.isContextualRailEnabled=n.sent(),[2]}}))}))},e.prototype.setFullBleedBackground=function(e,t,n,i){var r=Fe.b.eduThemeBackplateOverrides[this.activeThemeId];this.fullBleedBackplateEnabled=r&&i<640&&this.fullBleedThemingEnabled,this.fullBleedBackplateStyle=this.fullBleedBackplateEnabled?Object.assign({color:this.fullBleedFontColor},r):{color:this.fullBleedFontColor},this.bleedBackgroundStyle=e?{"background-color":n}:{};var o=e&&t?t.Type:null;this.isPatternImage=o===Fe.a.Pattern,this.hasSideImages=o===Fe.a.Side,this.heroLeftImageStyle=this.getBackgroundImageStyle(this.hasSideImages&&t?t.Side:null),this.heroRightImageStyle=this.getBackgroundImageStyle(this.hasSideImages&&t?t.Side:null),this.heroImageStyle=this.getBackgroundImageStyle(e&&t?this.themingService.getEduHeaderImageForWidth(t,i):null)},e.prototype.getBackgroundImageStyle=function(e){return e&&e.length?{"background-image":"url("+e+")"}:{}},e}()),Nn=i.xb({encapsulation:2,styles:[],data:{}});function Un(e){return i.bc(0,[(e()(),i.zb(0,0,[[1,0],["heroAnnouncement",1]],null,2,"div",[["class","hero-announcementMarkup  ms-fcl-ns"]],[[8,"innerHTML",1]],null,null,null,null)),i.yb(1,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"width-restrictor width-restrictor--responsive":0,"width-restrictor--no-gutter":1})],(function(e,t){var n=t.component,i=e(t,2,0,!n.noGutter,n.noGutter);e(t,1,0,"hero-announcementMarkup  ms-fcl-ns",i)}),(function(e,t){e(t,0,0,t.component.announcementMarkup)}))}function Wn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"div",[["class","hero-title-gradient"]],null,null,null,null,null)),i.yb(1,278528,null,0,Ge.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){e(t,1,0,t.component.heroTitleGradient)}),null)}function Bn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"div",[["class","hero-background__image hero-background__image--left"]],null,null,null,null,null)),i.yb(1,278528,null,0,Ge.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){e(t,1,0,t.component.heroLeftImageStyle)}),null)}function zn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"div",[["class","hero-background__image hero-background__image--right"]],null,null,null,null,null)),i.yb(1,278528,null,0,Ge.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){e(t,1,0,t.component.heroRightImageStyle)}),null)}function jn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,9,"div",[["class","hero-background--full-bleed"]],null,null,null,null,null)),i.yb(1,278528,null,0,Ge.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),(e()(),i.ib(16777216,null,null,1,null,Bn)),i.yb(3,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(4,0,null,null,3,"div",[["class","hero-background__image"]],null,null,null,null,null)),i.yb(5,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(6,{"hero-background__image--pattern":0,"hero-background__image--center":1}),i.yb(7,278528,null,0,Ge.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),(e()(),i.ib(16777216,null,null,1,null,zn)),i.yb(9,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.bleedBackgroundStyle),e(t,3,0,n.hasSideImages);var i=e(t,6,0,n.isPatternImage,!n.isPatternImage);e(t,5,0,"hero-background__image",i),e(t,7,0,n.heroImageStyle),e(t,9,0,n.hasSideImages)}),null)}function Hn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,"h1",[["class","ms-fontWeight-light welcome__title--consumer"]],null,null,null,null,null)),i.yb(1,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"welcome__title--fluent":0}),(e()(),i.Yb(3,null,[" "," "]))],(function(e,t){var n=e(t,2,0,t.component.fluentRefresh);e(t,1,0,"ms-fontWeight-light welcome__title--consumer",n)}),(function(e,t){e(t,3,0,t.component.heroTitle)}))}function Vn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-icon-font",[["cssClass","diamond-web"],["iconFontName","Diamond"]],null,null,null,Ke.b,Ke.a)),i.yb(1,638976,null,0,Ye.a,[Z.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"]},null)],(function(e,t){e(t,1,0,"diamond-web","Diamond")}),null)}function qn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,9,"a",[["class","widget-attribution__link my-account__link_new my-account__link_color my-account__link_new_hover_text_decoration my-account__link_margin"],["id","my-account-link"],["ohpDefaultLinkTarget",""]],[[8,"href",4],[1,"aria-label",0],[8,"target",0]],null,null,null,null)),i.yb(1,278528,null,0,Ge.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.Rb(2,{color:0}),i.yb(3,81920,null,0,st.a,[W.a],null,null),(e()(),i.ib(16777216,null,null,1,null,Vn)),i.yb(5,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(6,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),i.Yb(7,null,["",""])),(e()(),i.zb(8,0,null,null,1,"ohp-icon-font",[["cssClass","link-arrow"],["iconFontName","ArrowRight"],["size","14"]],null,null,null,Ke.b,Ke.a)),i.yb(9,638976,null,0,Ye.a,[Z.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.fullBleedFontColor);e(t,1,0,i),e(t,3,0),e(t,5,0,n.isPaidConsumer),e(t,9,0,"link-arrow","ArrowRight","14")}),(function(e,t){var n=t.component;e(t,0,0,n.myAccountUrl,n.myAccountLinkText,i.Ob(t,3).target),e(t,7,0,n.myAccountLinkText)}))}function Gn(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{componentArea:0,showInstallButton:1,appFilter:2}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.componentArea,n.showInstallButton,"Office");e(t,1,0,"install#InstallModule",i)}),null)}function Zn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","hero__buttons-container hero-button-section--consumer hero-button-section--consumer-new"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,qn)),i.yb(2,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Gn)),i.yb(4,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.isPaidConsumer),e(t,4,0,n.showInstall)}),null)}function Qn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,9,"div",[["class","hero-image-container__overlay"]],null,null,null,null,null)),i.yb(1,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"hero-image-container__overlay--consumer":0}),(e()(),i.zb(3,0,null,null,6,"div",[["class","hero-content--flex"]],null,null,null,null,null)),i.yb(4,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(5,{"width-restrictor width-restrictor--responsive":0,"width-restrictor--no-gutter":1,"hero-content--aligned":2}),(e()(),i.ib(16777216,null,null,1,null,Hn)),i.yb(7,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Zn)),i.yb(9,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.isConsumer);e(t,1,0,"hero-image-container__overlay",i);var r=e(t,5,0,!n.noGutter,n.noGutter,n.fluentRefresh);e(t,4,0,"hero-content--flex",r),e(t,7,0,!n.showCreateButtonWithAnimation),e(t,9,0,n.isConsumer&&!n.showCreateButtonWithAnimation)}),null)}function Kn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,9,"a",[["class","widget-attribution__link my-account__link ms-fcl-tda ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a"],["id","my-account-link"],["ohpDefaultLinkTarget",""]],[[8,"href",4],[1,"aria-label",0],[8,"target",0]],null,null,null,null)),i.yb(1,278528,null,0,Ge.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.Rb(2,{color:0}),i.yb(3,81920,null,0,st.a,[W.a],null,null),(e()(),i.zb(4,0,null,null,1,"ohp-icon-font",[["class","diamond"],["iconFontName","Diamond"]],null,null,null,Ke.b,Ke.a)),i.yb(5,638976,null,0,Ye.a,[Z.a],{iconFontName:[0,"iconFontName"]},null),(e()(),i.zb(6,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),i.Yb(7,null,["",""])),(e()(),i.zb(8,0,null,null,1,"ohp-icon-font",[["cssClass","link-arrow"],["iconFontName","ArrowRight"],["size","14"]],null,null,null,Ke.b,Ke.a)),i.yb(9,638976,null,0,Ye.a,[Z.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){var n=e(t,2,0,t.component.fullBleedFontColor);e(t,1,0,n),e(t,3,0),e(t,5,0,"Diamond"),e(t,9,0,"link-arrow","ArrowRight","14")}),(function(e,t){var n=t.component;e(t,0,0,n.myAccountUrl,n.myAccountLinkText,i.Ob(t,3).target),e(t,7,0,n.myAccountLinkText)}))}function Yn(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{componentArea:0,showInstallButton:1,appFilter:2}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.componentArea,n.showInstallButton,"Office");e(t,1,0,"install#InstallModule",i)}),null)}function Jn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,7,"div",[],null,null,null,null,null)),i.yb(1,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(2,{"width-restrictor width-restrictor--responsive":0,"width-restrictor--no-gutter":1}),(e()(),i.zb(3,0,null,null,4,"div",[["class","section__buttons-container hero__buttons-container hero__buttons-container-right"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,Kn)),i.yb(5,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Yn)),i.yb(7,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,!n.noGutter,n.noGutter);e(t,1,0,i),e(t,5,0,n.isPaidConsumer&&!n.onAppGalleryPage),e(t,7,0,n.showInstall)}),null)}function Xn(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,"div",[],null,null,null,null,null)),(e()(),i.zb(1,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(2,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(3,{withAnimation:0,tileView:1,componentArea:2})],(function(e,t){var n=e(t,3,0,!0,!1,t.component.componentArea);e(t,2,0,"create-menu#CreateMenuModule",n)}),null)}function $n(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-back-button",[],null,null,null,Cn.b,Cn.a)),i.yb(1,245760,null,0,In.a,[Z.a,W.a,Re.a,H.a],{elementId:[0,"elementId"],backButtonAriaLabel:[1,"backButtonAriaLabel"],defaultBackRoute:[2,"defaultBackRoute"],responsive:[3,"responsive"],focusOnLoad:[4,"focusOnLoad"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.backButtonId,n.backButtonAriaLabel,n.defaultBackRoute,n.onTemplatesPage,n.onAppGalleryPage)}),null)}function ei(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"bread-crumb#FastBreadcrumbModule")}),null)}function ti(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,7,"h1",[["class","ms-fontWeight-light welcome__title ms-fcl-nd"],["id","hero-heading"]],null,[[null,"click"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==(r.showFASTBreadcrumb&&r.backToSearchPage())&&i),i}),null,null)),i.yb(1,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"welcome__title--centered":0,"welcome__title--small":1,"welcome__title--responsive":2,"welcome__title--fluent":3}),i.yb(3,278528,null,0,Ge.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.Rb(4,{color:0}),(e()(),i.Yb(5,null,[" "," "])),(e()(),i.ib(16777216,null,null,1,null,ei)),i.yb(7,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.onTemplatesPage&&!n.fluentRefresh,n.onHomePageOrPwa&&!n.fluentRefresh,!n.fluentRefresh,n.fluentRefresh);e(t,1,0,"ms-fontWeight-light welcome__title ms-fcl-nd",i);var r=e(t,4,0,n.fullBleedFontColor);e(t,3,0,r),e(t,7,0,n.showFASTBreadcrumb)}),(function(e,t){e(t,5,0,t.component.heroTitle)}))}function ni(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"div",[["class","hero__create-location"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"ohp-create-location",[],null,null,null,Tn.b,Tn.a)),i.yb(2,114688,null,0,kn.a,[Z.a,Re.a],{app:[0,"app"]},null)],(function(e,t){e(t,2,0,t.component.appContext)}),null)}function ii(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,ni)),i.yb(2,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,2,0,t.component.showCreateLocation)}),null)}function ri(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,3,"a",[["class","generic-button generic-button--fluent generic-button--fluent--primary ms-bgc-tp ms-fcl-w ms-bgc-w-h ms-bgc-w-a ms-fcl-tp-h ms-fcl-tp-a ms-fcl-w-f"],["data-referral","OfficeStore"],["id","app-gallery-store-link"],["ohpDefaultLinkTarget",""],["rel","noopener"]],[[1,"data-area",0],[8,"href",4],[8,"target",0]],null,null,null,null)),i.yb(2,81920,null,0,st.a,[W.a],null,null),(e()(),i.zb(3,0,null,null,1,"b",[["class","generic-button__text"]],null,null,null,null,null)),(e()(),i.Yb(4,null,["",""]))],(function(e,t){e(t,2,0)}),(function(e,t){var n=t.component;e(t,1,0,n.componentArea,n.store.Url,i.Ob(t,2).target),e(t,4,0,n.store.Text)}))}function oi(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,9,"a",[["class","widget-attribution__link my-account__link ms-fcl-tda ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a"],["id","my-account-link"],["ohpDefaultLinkTarget",""]],[[8,"href",4],[1,"aria-label",0],[8,"target",0]],null,null,null,null)),i.yb(1,278528,null,0,Ge.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.Rb(2,{color:0}),i.yb(3,81920,null,0,st.a,[W.a],null,null),(e()(),i.zb(4,0,null,null,1,"ohp-icon-font",[["class","diamond-pwa ms-fcl-tda"],["iconFontName","Diamond"]],null,null,null,Ke.b,Ke.a)),i.yb(5,638976,null,0,Ye.a,[Z.a],{iconFontName:[0,"iconFontName"]},null),(e()(),i.zb(6,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),i.Yb(7,null,["",""])),(e()(),i.zb(8,0,null,null,1,"ohp-icon-font",[["cssClass","link-arrow"],["iconFontName","ArrowRight"],["size","14"]],null,null,null,Ke.b,Ke.a)),i.yb(9,638976,null,0,Ye.a,[Z.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){var n=e(t,2,0,t.component.fullBleedFontColor);e(t,1,0,n),e(t,3,0),e(t,5,0,"Diamond"),e(t,9,0,"link-arrow","ArrowRight","14")}),(function(e,t){var n=t.component;e(t,0,0,n.myAccountUrl,n.myAccountLinkText,i.Ob(t,3).target),e(t,7,0,n.myAccountLinkText)}))}function ai(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{componentArea:0,showInstallButton:1,appFilter:2}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.componentArea,n.showInstallButton,"Office");e(t,1,0,"install#InstallModule",i)}),null)}function li(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,8,null,null,null,null,null,null,null)),(e()(),i.zb(1,0,null,null,7,"div",[["class","section__buttons-container hero__buttons-container"]],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,ri)),i.yb(3,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,oi)),i.yb(5,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(6,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,ai)),i.yb(8,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,3,0,n.onAppGalleryPage&&n.store),e(t,5,0,n.isPaidConsumer&&!n.onAppGalleryPage),e(t,8,0,n.showInstall)}),null)}function si(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,10,"div",[["class","hero-content--flex"]],null,null,null,null,null)),i.yb(1,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"hero-content--centered":0,"hero-content--small":1,"hero-content":2,"hero-content--aligned":3,"hero-content--suggested-actions":4}),(e()(),i.ib(16777216,null,null,1,null,$n)),i.yb(4,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,ti)),i.yb(6,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,ii)),i.yb(8,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,li)),i.yb(10,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.onTemplatesPage&&!n.fluentRefresh,n.onHomePageOrPwa,!n.isSearchSiteScoped&&!n.fluentRefresh,n.fluentRefresh,n.suggestedActions);e(t,1,0,"hero-content--flex",i),e(t,4,0,n.showBackButton),e(t,6,0,n.heroTitle||n.showFASTBreadcrumb),e(t,8,0,!n.onAppGalleryPage),e(t,10,0,n.showHeroButtons&&!n.showCreateButtonWithAnimation)}),null)}function ci(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-app-tiles-list",[],null,null,null,Qt,Dt)),i.yb(1,4440064,null,0,Ft,[Tt.a,ht,Z.a,Me.a,ue.b,Et.a,T.a,k.b,H.a,p.b,dt.a,At.a,_t.a,kt.a,Ot.a,it.a,i.h],{fullBleedTheming:[0,"fullBleedTheming"],fullBleedFontColor:[1,"fullBleedFontColor"],fullBleedBackplateEnabled:[2,"fullBleedBackplateEnabled"],fullBleedBackplateStyle:[3,"fullBleedBackplateStyle"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.fullBleedThemingEnabled,n.fullBleedFontColor,n.fullBleedBackplateEnabled,n.fullBleedBackplateStyle)}),null)}function ui(e){return i.bc(0,[i.Ub(671088640,1,{heroAnnouncement:0}),(e()(),i.zb(1,0,null,null,1,"ohp-title-announcer",[],null,null,null,An.b,An.a)),i.yb(2,49152,null,0,Pn.a,[],{announcement:[0,"announcement"]},null),(e()(),i.zb(3,0,null,null,25,"div",[["class","hero-section"]],null,null,null,null,null)),i.yb(4,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(5,{"hero-section--padded":0,"hero-section__2dot0--padded":1,"hero-section__homepage--padded":2,"hero-section-mobile--padded":3}),i.yb(6,278528,null,0,Ge.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),(e()(),i.ib(16777216,null,null,1,null,Un)),i.yb(8,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Wn)),i.yb(10,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,jn)),i.yb(12,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Qn)),i.yb(14,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Jn)),i.yb(16,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Xn)),i.yb(18,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(19,0,null,null,9,"div",[],null,null,null,null,null)),i.yb(20,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(21,{"width-restrictor":0,"width-restrictor--responsive":1,"width-restrictor--no-gutter":2,"breadcrumb-width-restrictor":3,"breadcrumb-width-restrictor-fallback":4}),(e()(),i.zb(22,0,null,null,6,"div",[["class","hero-container"]],[[1,"role",0],[1,"aria-labelledby",0]],null,null,null,null)),i.yb(23,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(24,{"hero-image-container--fluent":0,"hero-image-container":1}),(e()(),i.ib(16777216,null,null,1,null,si)),i.yb(26,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,ci)),i.yb(28,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.accessibilityTitle);var i=e(t,5,0,(n.appsInHero||n.hideConsumerBackgroundImage)&&!(n.bottomTrayEnabled&&n.onAppGalleryPage)&&!n.onSearchPage&&!n.onCreatePage,n.onCreatePage||n.onHomePageOrPwa&&n.appBarEnabled,n.onHomePageOrPwa&&!n.leftNavReact,n.bottomTrayEnabled);e(t,4,0,"hero-section",i),e(t,6,0,n.hideConsumerBackgroundImage?"":n.backgroundStyle),e(t,8,0,void 0!==n.announcementMarkup),e(t,10,0,!n.appsInHero&&!n.hideConsumerBackgroundImage),e(t,12,0,n.fullBleedThemingEnabled),e(t,14,0,!n.appsInHero&&!n.hideConsumerBackgroundImage),e(t,16,0,n.showHeroButtons&&n.showCreateButtonWithAnimation),e(t,18,0,n.showCreateButtonWithAnimation);var r=e(t,21,0,!n.noGutter,!n.noGutter&&n.heroTitle,n.noGutter,!n.heroTitle,!n.isContextualRailEnabled);e(t,20,0,r);var o=e(t,24,0,!n.appsInHero&&!n.hideConsumerBackgroundImage,!n.appsInHero&&!n.hideConsumerBackgroundImage);e(t,23,0,"hero-container",o),e(t,26,0,n.showAppTilesHeroTitle),e(t,28,0,n.showApps)}),(function(e,t){var n=t.component;e(t,22,0,n.showAppTilesHeroTitle?"region":void 0,n.showAppTilesHeroTitle?"hero-heading":void 0)}))}i.vb("ohp-hero",Ln,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-hero",[],null,null,null,ui,Nn)),i.yb(1,12828672,null,0,Ln,[q.a,Tt.a,ht,Z.a,Me.a,W.a,ue.b,j.a,On.a,Re.a,H.a,Ce.a,Fe.b,xn,d.b,dt.a,p.b,Fn.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),n("jP3p");var di=function(){function e(e,t,n,i){var r=this;this.capabilitiesService=e,this.officeRouteService=t,this.themingService=n,this.locService=i;var o={id:"home",title:this.locService.HomeTabTitle,ariaLabel:this.locService.HomeTabAriaLabel,routes:["OfficeHome","Start","Templates"],iconClass:"Home"},a={id:"apps",title:this.locService.AppsTabTitle,ariaLabel:this.locService.AppsTabAriaLabel,routes:["AppGallery"],iconClass:"Waffle"};this.tabs=this.capabilitiesService.capabilities.showSearch?[o,{id:"search",title:this.locService.SearchTabTitle,ariaLabel:this.locService.SearchTabAriaLabel,routes:["Search"],iconClass:"Search"},a]:[o,a],this.activeTabId=t.getRouteChangeStartObservable().pipe(Object(ln.a)((function(e){var t=e.currentRoute.route,n=r.tabs.find((function(e){return r.isActive(e,t)}));return n?n.id:"Home"}))),this.isDarkMode=this.themingService.themeShades.pipe(Object(ln.a)((function(e){return!(!e.theme||!e.theme.reactShellTheme)&&e.theme.reactShellTheme.IsDarkMode})))}return e.prototype.trackByTabId=function(e,t){return t.id},e.prototype.navigateTo=function(t){this.officeRouteService.navigateTo({route:t.routes[0]},!1,null,e.LastBottomTrayTab)},e.prototype.isActive=function(e,t){return e.routes.indexOf(t)>=0},e.LastBottomTrayTab="LastBottomTrayTab",e}(),pi=i.xb({encapsulation:2,styles:[],data:{}});function hi(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,7,"button",[["class","bottom-tray__tab-button ms-fcl-nd"]],[[8,"id",0]],[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.navigateTo(e.context.$implicit)&&i),i}),null,null)),i.yb(1,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Qb(131072,Ge.b,[i.h]),i.Rb(3,{"ms-fcl-tp":0}),(e()(),i.zb(4,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,Ke.b,Ke.a)),i.yb(5,638976,null,0,Ye.a,[Z.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null),(e()(),i.zb(6,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),i.Yb(7,null,["",""]))],(function(e,t){var n=t.component,r=e(t,3,0,t.context.$implicit.id===i.Zb(t,1,1,i.Ob(t,2).transform(n.activeTabId)));e(t,1,0,"bottom-tray__tab-button ms-fcl-nd",r),e(t,5,0,t.context.$implicit.iconClass,"16")}),(function(e,t){e(t,0,0,"bottom-tray-tab-"+t.context.$implicit.id),e(t,7,0,t.context.$implicit.title)}))}function fi(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,5,"div",[["class","bottom-tray-container"],["role","navigation"]],null,null,null,null,null)),i.yb(1,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Qb(131072,Ge.b,[i.h]),i.Rb(3,{"ms-bgc-w":0}),(e()(),i.ib(16777216,null,null,1,null,hi)),i.yb(5,278528,null,0,Ge.j,[i.O,i.L,i.s],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null)],(function(e,t){var n=t.component,r=e(t,3,0,i.Zb(t,1,1,i.Ob(t,2).transform(n.isDarkMode)));e(t,1,0,"bottom-tray-container",r),e(t,5,0,n.tabs,n.trackByTabId)}),null)}i.vb("ohp-bottom-tray",di,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-bottom-tray",[],null,null,null,fi,pi)),i.yb(1,49152,null,0,di,[Z.a,H.a,Fe.b,Re.a],null,null)],null,null)}),{},{},[]);var mi=n("qSxk"),bi=function(){function e(e,t,n){this.elementRef=e,this.eventService=t,this.zone=n,this.eventName=this.eventName||"contentScrolled"}return e.prototype.ngDoCheck=function(){this.initialized||(this.initialized=!0,this.setScrollListener())},e.prototype.ngOnDestroy=function(){this.scrollEventSubscription&&this.scrollEventSubscription.unsubscribe()},e.prototype.setScrollListener=function(){var e=this;this.zone.runOutsideAngular((function(){e.scrollEventSubscription=Object(mi.a)(e.elementRef.nativeElement,"scroll").pipe(Object(_n.a)(10)).subscribe((function(){e.eventService.broadcastEvent({name:e.eventName,args:[]})}))}))},e}(),vi=n("KoFE"),gi=n("9c4X"),yi=n("y1jW"),Si=i.xb({encapsulation:2,styles:[],data:{}});function wi(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),i.zb(1,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(2,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null)],(function(e,t){e(t,2,0,"left-nav-react#LeftNavReactModule")}),null)}function Ci(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,"div",[],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,0,"div",[["class","ms-bgc-d appbar-placeholder"]],null,null,null,null,null)),(e()(),i.zb(2,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(3,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null)],(function(e,t){e(t,3,0,"appbar#AppBarModule")}),null)}function Ii(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{scrollElement:0}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=e(t,2,0,i.Ob(t.parent,19));e(t,1,0,"pull-to-refresh#PullToRefreshModule",n)}),null)}function Ti(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"feature-callout#FeatureCalloutModule")}),null)}function ki(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"workspace-nav#WorkspaceNavModule")}),null)}function Ai(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"mobile-app-banner#MobileAppBannerModule")}),null)}function Pi(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{viewMetric:0}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.viewMetric);e(t,1,0,"banner#BannerModule",n)}),null)}function Ei(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-hero",[],null,null,null,ui,Nn)),i.yb(1,12828672,null,0,Ln,[q.a,Tt.a,ht,Z.a,Me.a,W.a,ue.b,j.a,On.a,Re.a,H.a,Ce.a,Fe.b,xn,d.b,dt.a,p.b,Fn.a],null,null)],(function(e,t){e(t,1,0)}),null)}function _i(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{collapsed:0}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.showNewUserShelfCollapsed);e(t,1,0,"new-user-shelf#NewUserShelfModule",n)}),null)}function Oi(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"web-vitals#WebVitalsModule")}),null)}function Fi(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"feature-tooltip-container#FeatureTooltipContainerModule")}),null)}function Di(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"context-menu#ContextMenuModule")}),null)}function Mi(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"action-context-menu-react#ActionContextMenuReactModule")}),null)}function Ri(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{renderFluidDocument:0}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.onFluidContentPage);e(t,1,0,"fluid-content#FluidContentModule",n)}),null)}function xi(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"feedback#FeedbackModule")}),null)}function Li(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"support-central-react#SupportCentralReactModule")}),null)}function Ni(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"upload-dialog#UploadDialogModule")}),null)}function Ui(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"error-dialog-react#ErrorDialogReactModule")}),null)}function Wi(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"create-spaces-dialog-react#CreateSpacesDialogReactModule")}),null)}function Bi(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"task-module-dialog-react#TaskModuleDialogReactModule")}),null)}function zi(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"confirmation-dialog-react#ConfirmationDialogReactModule")}),null)}function ji(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"create-onenote-page-dialog-react#CreateOneNotePageDialogReactModule")}),null)}function Hi(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{showFASTBreadcrumb:0}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.showFASTBreadcrumb);e(t,1,0,"auto-suggest#AutoSuggestModule",n)}),null)}function Vi(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"side-popup-menu#SidePopupMenuModule")}),null)}function qi(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"toast-container-react#ToastContainerReactModule")}),null)}function Gi(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-bottom-tray",[],null,null,null,fi,pi)),i.yb(1,49152,null,0,di,[Z.a,H.a,Fe.b,Re.a],null,null)],null,null)}function Zi(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"first-run#FirstRunModule")}),null)}function Qi(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{bottomAligned:0,viewMetric:1,bottomTrayEnabled:2}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,!0,n.viewMetric,n.bottomTrayEnabled);e(t,1,0,"banner#BannerModule",i)}),null)}function Ki(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"context-menu#ContextMenuModule")}),null)}function Yi(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{mobileShareMenu:0,contentShareMenu:1}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.mobileMenusEnabled,n.loadShareControlModuleForContentPage);e(t,1,0,"share-control#ShareControlModule",i)}),null)}function Ji(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Rb(2,{mobileMoveToFolderMenu:0,contentMoveToFolderMenu:1}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.mobileMenusEnabled,n.loadMoveToFolderModuleForContentPage);e(t,1,0,"move-to-folder-control#MoveToFolderControlModule",i)}),null)}function Xi(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"search-preload#SearchPreloadModule")}),null)}function $i(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"wac-content#WacContentModule")}),null)}function er(e){return i.bc(0,[(e()(),i.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(1,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(0,null,null,0))],(function(e,t){e(t,1,0,"fluent-theme-provider#FluentThemeProviderModule")}),null)}function tr(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,94,"div",[["id","officeHomeRoot"]],null,null,null,null,null)),i.yb(1,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),(e()(),i.zb(2,0,null,null,75,"div",[["class","ms-fontWeight-regular ms-bgc-nla"],["id","officeHome"]],null,null,null,null,null)),i.yb(3,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(e()(),i.ib(16777216,null,null,1,null,wi)),i.yb(5,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Ci)),i.yb(7,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(8,16777216,null,null,1,"router-outlet",[["name","install-wizard"]],null,null,null,null,null)),i.yb(9,212992,null,0,q.p,[q.b,i.O,i.j,[8,"install-wizard"],i.h],null,null),(e()(),i.ib(16777216,null,null,1,null,Ii)),i.yb(11,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Ti)),i.yb(13,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(14,0,null,null,34,"div",[["class","o365cs-base o365cst"],["id","officeHome__container"]],null,null,null,null,null)),i.yb(15,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(16,{"left-nav-offset":0,"appbar-offset":1,"bottom-tray-navigation":2,"ms-bgc-nla":3,"fluent-background-color":4,"fluentvnext-background":5}),(e()(),i.ib(16777216,null,null,1,null,ki)),i.yb(18,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(19,0,[[1,0],["scrollElement",1]],null,29,"div",[["id","officeHome__scroll-content"],["ohpScrollListener",""]],null,[[null,"dragover"],[null,"drop"]],(function(e,t,n){var i=!0,r=e.component;return"dragover"===t&&(i=!1!==r.dragoverHandler(n)&&i),"drop"===t&&(i=!1!==r.dropHandler(n)&&i),i}),null,null)),i.yb(20,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(21,{"scroll-content":0,"scroll-content--transform":1,"app-gallery-workspace-nav-offset":2,"scroll-content--hide":3}),i.yb(22,409600,null,0,bi,[i.l,j.a,i.z],null,null),(e()(),i.zb(23,0,null,null,25,"div",[["id","officeHome__wrapper"]],null,null,null,null,null)),i.yb(24,278528,null,0,Ge.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(25,{"fluent-background":0}),i.yb(26,278528,null,0,Ge.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),(e()(),i.zb(27,0,null,null,21,"div",[["id","officeHome__content"]],null,[[null,"ohpResize"]],(function(e,t,n){var i=!0;return"ohpResize"===t&&(i=!1!==e.component.onResize(n)&&i),i}),null,null)),i.yb(28,4407296,null,0,vi.a,[gi.a,i.l,it.a],null,{resize:"ohpResize"}),(e()(),i.ib(16777216,null,null,1,null,Ai)),i.yb(30,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Pi)),i.yb(32,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Ei)),i.yb(34,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,_i)),i.yb(36,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Oi)),i.yb(38,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(39,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),i.yb(40,212992,null,0,q.p,[q.b,i.O,i.j,[8,null],i.h],null,null),(e()(),i.ib(16777216,null,null,1,null,Fi)),i.yb(42,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Di)),i.yb(44,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Mi)),i.yb(46,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Ri)),i.yb(48,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,2,null,xi)),i.yb(50,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),i.Qb(131072,Ge.b,[i.h]),(e()(),i.ib(16777216,null,null,1,null,Li)),i.yb(53,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Ni)),i.yb(55,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(56,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(57,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.zb(58,16777216,null,null,1,null,null,null,null,null,null,null)),i.yb(59,475136,null,0,et.a,[tt.a,i.O,l.b,p.b,Ae.a,nt.a,it.a,i.z,V.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.ib(16777216,null,null,1,null,Ui)),i.yb(61,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Wi)),i.yb(63,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Bi)),i.yb(65,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,zi)),i.yb(67,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,ji)),i.yb(69,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Hi)),i.yb(71,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Vi)),i.yb(73,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,qi)),i.yb(75,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Gi)),i.yb(77,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Zi)),i.yb(79,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Qi)),i.yb(81,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Ki)),i.yb(83,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Yi)),i.yb(85,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Ji)),i.yb(87,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Xi)),i.yb(89,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,2,null,$i)),i.yb(91,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),i.Qb(131072,Ge.b,[i.h]),(e()(),i.ib(16777216,null,null,1,null,er)),i.yb(94,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.themeRootCssClass),e(t,3,0,"ms-fontWeight-regular ms-bgc-nla",n.officeHomeClass),e(t,5,0,n.leftNavReact&&!n.onWacContentPage),e(t,7,0,n.appBarEnabled&&!n.onWacContentPage),e(t,9,0),e(t,11,0,n.pullToRefreshEnabled),e(t,13,0,n.loadFeatureCalloutModule);var r=e(t,16,0,n.leftNavReact&&!n.onWacContentPage,n.appBarEnabled&&!n.onWacContentPage,n.bottomTrayEnabled,!n.fluentThemeRefreshEnabled,!n.fluentThemeRefreshEnabled,n.fluentThemeRefreshEnabled);e(t,15,0,"o365cs-base o365cst",r),e(t,18,0,n.showWorkspaceNav);var o=e(t,21,0,!n.onContentPage,!n.onContentPage&&!n.onMyContentPage,n.showWorkspaceNav,n.onSpacesPage);e(t,20,0,o),e(t,22,0);var a=e(t,25,0,n.showBackgroundImage);e(t,24,0,a),e(t,26,0,n.showBackgroundImage?n.backgroundStyle:""),e(t,28,0),e(t,30,0,n.showMobileAppBanner),e(t,32,0,!n.onContentPage&&!n.onAppGallery&&!n.onSpacesPage),e(t,34,0,!n.onContentPage&&!n.onSpacesPage&&!n.onMyContentPage),e(t,36,0,n.showNewUserShelf&&(n.showNewUserShelfExpanded||n.showNewUserShelfCollapsed)&&n.onHomePage),e(t,38,0,n.webVitalsEnabled||n.memoryProfilingEnabled),e(t,40,0),e(t,42,0,!n.newOfficeHomePageExperience),e(t,44,0,!n.mobileMenusEnabled&&!n.actionContextMenuEnabled),e(t,46,0,!n.mobileMenusEnabled&&n.actionContextMenuEnabled),e(t,48,0,n.fluidSupportEnabled&&!n.isIE),e(t,50,0,n.feedbackEnabled&&!n.onWacContentPage&&!i.Zb(t,50,0,i.Ob(t,51).transform(n.isStandalone))&&!(n.isSearchPage&&n.searchUXGeneralFeedbackEnabled)),e(t,53,0,n.supportCentralEnabled&&!n.onContentPage),e(t,55,0,n.uploadEnabled&&!n.newOfficeHomePageExperience),e(t,57,0,"error-dialog#ErrorDialogModule"),e(t,59,0,"input-dialog#InputDialogModule"),e(t,61,0,n.stayingAware),e(t,63,0,n.spaces),e(t,65,0,n.taskModule),e(t,67,0,n.spaces||n.customPivots),e(t,69,0,n.createOneNotePageEnabled),e(t,71,0,n.searchEnabled&&!n.hideSearch),e(t,73,0,n.sidePopUpEnabled),e(t,75,0,n.toastContainer),e(t,77,0,n.bottomTrayEnabled&&!n.onFluidContentPage),e(t,79,0,n.firstRunEnabled||n.showPremiumUpsellModal),e(t,81,0,!n.onContentPage),e(t,83,0,n.mobileMenusEnabled),e(t,85,0,n.mobileMenusEnabled||n.loadShareControlModuleForContentPage),e(t,87,0,n.loadMoveToFolderModuleForContentPage),e(t,89,0,n.nativeSearchEnabled),e(t,91,0,i.Zb(t,91,0,i.Ob(t,92).transform(n.wacHostEnabled))),e(t,94,0,n.fluentThemeRefreshEnabled)}),null)}function nr(e){return i.bc(0,[i.Ub(671088640,1,{scrollElement:0}),(e()(),i.ib(16777216,null,null,1,null,tr)),i.yb(2,16384,null,0,Ge.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,2,0,t.component.viewInitializationCompleted)}),null)}var ir=i.vb("ohp-app",Ve,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-app",[],null,[["window","resize"],["window","focus"],["window","beforeinstallprompt"],["window","appinstalled"]],(function(e,t,n){var r=!0;return"window:resize"===t&&(r=!1!==i.Ob(e,1).onWindowResize()&&r),"window:focus"===t&&(r=!1!==i.Ob(e,1).onWindowFocus()&&r),"window:beforeinstallprompt"===t&&(r=!1!==i.Ob(e,1).onBeforeInstall(n)&&r),"window:appinstalled"===t&&(r=!1!==i.Ob(e,1).onAppInstalled()&&r),r}),nr,Si)),i.yb(1,507904,null,0,Ve,[c.a,j.a,yi.h,d.b,q.n,i.r,i.h],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),rr=n("ZJrL"),or=function(){function e(e){this.windowService=e,this.initialize()}return e.prototype.getShellAndConfigPromise=function(){return window.queuedMarks=window.queuedMarks||[],window.performance&&window.performance.mark&&window.performance.mark("App_Initialization_Complete"),window.queuedMarks.push({markName:"App_Initialization_Complete",measureFrom:"App_Begin_Bootstrap"}),this.shellAndConfigResponse},e.prototype.reset=function(){this.setShellAndConfigPromise()},e.prototype.initialize=function(){this.initialized||(this.initialized=!0,this.setShellAndConfigPromise())},e.prototype.fetchShellAndConfig=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.windowService.nativeWindow.shellAndConfigResponse];case 1:if(e=t.sent())try{this.shellAndConfigData=JSON.parse(e)}catch(t){this.shellAndConfigData=e}return[2]}}))}))},e.prototype.setShellAndConfigPromise=function(){this.shellAndConfigResponse=this.fetchShellAndConfig()},e.ɵprov=i.cc({factory:function(){return new e(i.dc(d.b))},token:e,providedIn:"root"}),e}(),ar=function(){function e(e,t){this.apiConfigurationDataService=e,this.globalErrorHandler=t,this.configMap=new Map(Object.entries(this.apiConfigurationDataService.shellAndConfigData))}return e.prototype.parse=function(e,t){void 0===t&&(t=!1);try{if(this.configMap.has(e)){if(t){var n=rr.a.decodeJsonString(this.configMap.get(e));return JSON.parse(n)}return JSON.parse(this.configMap.get(e))}return rr.a.parseJsonElementWithId(e)}catch(t){var i=new l.a("Failure to parse "+e+" from ShellConfig response",t);this.globalErrorHandler.handleError(i)}},e}(),lr=function(e){return Object(a.a)()?new or(e):null},sr=function(e){return Object(a.a)()?function(){return e.getShellAndConfigPromise()}:function(){return Promise.resolve()}},cr=function(e,t){return Object(a.a)()?new ar(e,t):new B.a(t)},ur=function(e,t,n){return Object(a.a)()?function(){var i=e.get(xe.a).reactShellConfig,r=e.get(Z.a).capabilities,o=document.createElement("script");o.src=i.resourceUrl,o.crossOrigin="anonymous",o.async=!0,o.type="text/javascript",o.onload=function(){if(HomePage.ShellUtil.BootstrapReactShell("IWApp",i,r),n.config.authType===p.a.OrgId){var e=t.parse("navBarData");HomePage.ShellUtil.HydrateCommercialReactShell(e,!1,i)}},document.body.appendChild(o)}:function(){}},dr=function(){return function(){}}();function pr(e,t){return t.open(e,"login_window","width=483,height=600,top="+(t.innerHeight/2-300+t.screenY)+",left="+(t.innerWidth/2-241.5+t.screenX))}function hr(e,t,n){var i=t.setInterval((function(){e&&!e.closed&&void 0!==e.closed||(t.clearInterval(i),n())}),100);return i}var fr=n("MFXD"),mr=n("EYcb"),br=function(e){function t(t,n,i){var r=this;try{r=e.call(this,n.config.puid,i.getStorage(d.a.SessionStorage))||this,i.isStorageAvailable(d.a.SessionStorage)||t.logGenericEvent("Session_Storage_Unavailable")}catch(e){}return r}return Object(s.__extends)(t,e),t.ɵprov=i.cc({factory:function(){return new t(i.dc(T.a),i.dc(p.b),i.dc(d.b))},token:t,providedIn:"root"}),t}(n("XV2T").a),vr=function(){function e(e,t,n,i,r,o,a,l){this.windowService=e,this.documentService=t,this.contextService=n,this.capabilitiesService=i,this.sessionStorageService=r,this.instrumentationService=o,this.clientStartupConfigService=a,this.errorDialogService=l,this._responses=new fr.a,this.supportedTokens=new Map,this.handlerErrorId="handler_error",this.init()}return e.prototype.supportsToken=function(e){return this.supportedTokens.has(e)},e.prototype.requiresInteractiveLogin=function(e){var t;if(this.capabilitiesService.capabilities.isPwaInUwp)return!1;var n=this.getTokenFromCache(e);return!(n&&n.success&&n.token&&n.expiryMs>Date.now())&&n&&!n.success&&this.isInteractiveErrorMessage(null===(t=n.error)||void 0===t?void 0:t.message)},e.prototype.fetchTokenInteractive=function(e){var t=this;return new Promise((function(n,i){t.showLoginDialog((function(){var r=t.supportedTokens.get(e),o=t.getState("popup"),a=t.windowService.nativeWindow,l=t.getTokenFetchUrl(r,o,"login"),s=k.a.now(),c=pr(l,a);if(!c){var u="Could not create login popup";return t.logFetchRequest(!1,!0,!1,-1,u),void i(u)}var d=hr(c,a,(function(){var e=k.a.now(),n="Popup closed by user";t.logFetchRequest(!1,!0,!1,Math.ceil(e-s),n),i(n)}));t.waitForToken(e,o,s,!1,!0).catch().then((function(e){a.clearInterval(d),c.close(),e&&e.success?n(e):i("Failed to fetch token through popup")}))}),(function(){var e="Verify dialog closed by user";t.logFetchRequest(!1,!0,!1,-1,e),i(e)}))}))},e.prototype.getAccessTokenResponse=function(e,t,n){var i=this;if(void 0===t&&(t=!1),void 0===n&&(n=!1),!this.supportsToken(e))return Promise.reject("token not supported");if(t&&this.requiresInteractiveLogin(e))return this.fetchTokenInteractive(e);var r=k.a.now();if(!n){var o=this.getTokenFromCache(e);if(o&&o.success&&o.token&&o.expiryMs>Date.now()){var a=k.a.now();return this.logFetchRequest(!0,!1,!0,Math.ceil(a-r)),Promise.resolve(o)}}var l=this.getState("iframe"),s=this.supportedTokens.get(e),c=this.getTokenFetchUrl(s,l,"none"),u=this.getIframeId(e),d=this.documentService.nativeDocument.getElementById(u);return d?d.setAttribute("src",c):this.documentService.addIframeToPage(c,u),this.waitForToken(e,l,r,!0,!1).then((function(n){var r;return!n.success&&t&&i.isInteractiveErrorMessage(null===(r=n.error)||void 0===r?void 0:r.message)?i.fetchTokenInteractive(e):n}))},e.prototype.waitForToken=function(e,t,n,i,a){var l=this,s=null,c=[];if(i){var u=new Promise((function(e){s=setTimeout((function(){e({success:!1,token:null,format:"RPSDelegation",error:new N.a("timeout"),source:"MSA"})}),l.contextService.sharedContext.msaTokenTimeoutMs)}));c.push(u)}var d=this.responses.withScope(1).pipe(Object(r.a)((function(e){return e.state===t||e.state===l.handlerErrorId})),Object(o.a)(1),Object(ln.a)((function(e){return e&&e.state!==l.handlerErrorId&&e.token&&e.token.TokenValue&&!e.error?{success:!0,token:e.token.TokenValue,format:"RPSDelegation",source:"MSA",expiryMs:e.token.ExpiryMs}:{success:!1,token:null,format:"RPSDelegation",error:new N.a(T.a.filterPii(e.error)),source:"MSA"}}))).toPromise();return c.push(d),Promise.race(c).then((function(t){var i,r=k.a.now();return l.logFetchRequest(!1,a,t.success,Math.ceil(r-n),null===(i=t.error)||void 0===i?void 0:i.message),s&&clearTimeout(s),l.saveTokenToCache(e,t),t}))},e.prototype.getTokenFromCache=function(e){var t=this.sessionStorageService.get(this.getCacheKey(e));try{var n=JSON.parse(t.error),i=new N.a(n.message,n.statusCode);return i.stack=n.stack,Object(s.__assign)(Object(s.__assign)({},t),{error:i})}catch(e){return t}},e.prototype.saveTokenToCache=function(e,t){var n,i=Object(s.__assign)(Object(s.__assign)({},t),{error:t.error?JSON.stringify({message:null===(n=t.error)||void 0===n?void 0:n.message,stack:t.error.stack,statusCode:t.error.statusCode}):void 0});this.sessionStorageService.set(this.getCacheKey(e),i)},e.prototype.getCacheKey=function(e){return"_msatoken_"+e},e.prototype.isInteractiveErrorMessage=function(e){return e&&(-1!==e.indexOf("login_required")||-1!==e.indexOf("interaction_required"))},Object.defineProperty(e.prototype,"responses",{get:function(){return this._responses.asScopableObservable()},enumerable:!0,configurable:!0}),e.prototype.init=function(){var e=this;this.capabilitiesService.capabilities.msaClientTokensEnabled&&(this.windowService.nativeWindow.addEventListener("message",(function(t){var n=t.data;e.windowService.sameOriginRegex.test(t.origin)&&e._responses.next(n)})),this.clientStartupConfigService.config.isV2Auth&&this.capabilitiesService.capabilities.graphApiForV2ConsumerEnabled||(this.supportedTokens.set("OneDrive","onedrive_implicit.access"),this.supportedTokens.set("Graph","Family.Read Files.ReadWrite People.Read User.Read Contacts.Read")),this.supportedTokens.set("Forms","Forms.ReadWrite"),this.supportedTokens.forEach((function(t,n){e.documentService.addIframeToPage(null,e.getIframeId(n))})))},e.prototype.getIframeId=function(e){return"ohpMSAToken_"+e},e.prototype.getInstrumentationParams=function(e,t){var n={};return n.State=e?"FromCache":"FromNetwork",n.Action=t?"interactive":"silent",n},e.prototype.logFetchRequest=function(e,t,n,i,r){var o=this.getInstrumentationParams(e,t);this.instrumentationService.logRequestEvent("Msa_Token_Fetch",n?200:500,i,r,e,o)},e.prototype.getTokenFetchUrl=function(e,t,n){var i=this.contextService.sharedContext.msaAppId,r=this.contextService.sharedContext.msaTokenRedirectUrl;return(this.contextService.sharedContext.inMockMode?this.contextService.sharedContext.officeHomeApiRoot+"/getMsaToken?mockmode="+this.getMockMode()+"&":"https://login.live.com/oauth20_authorize.srf?")+"client_id="+i+"&response_type=token&redirect_uri="+encodeURIComponent(r)+"&response_mode=fragment&scope="+encodeURIComponent(e)+"&state="+encodeURIComponent(t)+"&prompt="+n+"&username="+encodeURIComponent(this.clientStartupConfigService.config.userPrincipalName)},e.prototype.getState=function(e){return e+"|"+We.a.createGuid()},e.prototype.showLoginDialog=function(e,t){this.errorDialogService.showErrorDialog({category:"VerifyIdentity",error:"LoginRequired",onActionClicked:e,onClose:t})},e.prototype.getMockMode=function(){return pt.a.getQueryParams(this.windowService.nativeWindow.location.search).mockmsatoken||"default"},e.ɵprov=i.cc({factory:function(){return new e(i.dc(d.b),i.dc(c.a),i.dc(W.a),i.dc(Z.a),i.dc(br),i.dc(T.a),i.dc(p.b),i.dc(mr.a))},token:e,providedIn:"root"}),e}(),gr=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p,h,f,m){var b=e.call(this)||this;b.authStateService=t,b.contextService=n,b.capabilitiesService=i,b.instrumentedHttp=r,b.eventService=o,b.configParserService=a,b.instrumentationService=s,b.msaTokenService=c,b.windowService=u,b.reactShellConfigService=d,b.userContextService=p,b.errorDialogService=h,b.locService=f,b.clientStartupConfigService=m,b.tokensRequiringResourceUrl=new Set(["OneDrive","SharePoint","MetaOS"]),b._messageResponses=new fr.a,b.capDialogStartTime=0,b.init(l,"JWT","OfficeHome"),b.refreshApiUrls=new Map,b.accessTokens=new Map,b.pendingRefreshRequests=new Map,b.secondaryTokensEnabled=b.capabilitiesService.capabilities.secondaryTokensEnabled,b.msaClientTokensEnabled=b.capabilitiesService.capabilities.msaClientTokensEnabled,b.defaultResourceUrls=new Map,b.defaultResourceUrls.set("OneDrive",b.contextService.sharedContext.oneDriveResourceId),b.defaultResourceUrls.set("SharePoint",b.contextService.sharedContext.sharePointResourceId),b.msaClientTokensEnabled&&(b.clientStartupConfigService.config.isV2Auth&&b.capabilitiesService.capabilities.graphApiForV2ConsumerEnabled||(b.initializeAccessToken("OneDrive","",null),b.initializeAccessToken("Graph","",null))),b.capabilitiesService.capabilities.clientTokenFetchEnabled?(b.initializeSecondaryTokensPromise=Promise.resolve(),b.secondaryTokensEnabled&&b.initializeSecondaryTokens(null),b.initializePrimaryTokensPromise=new Promise((function(e){var t=b.contextService.sharedContext.officeHomeApiRoot+"/api/primaryTokens?pageUrl="+encodeURIComponent(b.windowService.nativeWindow.location.href),n={responseType:"json",headers:new Map};b.instrumentedHttp.get("Primary_Token_Fetch_Request",t,n,"network-only").then((function(t){var n=t.data;n&&n.ReauthRequired&&n.LoginUrl?b.windowService.nativeWindow.location.href=n.LoginUrl:(b.initializePrimaryTokens(n&&n.Tokens),e())})).catch((function(t){b.errorHandler.handleError(t,"Pno9F"),b.initializePrimaryTokens(null),e()}))}))):(b.initializePrimaryTokensPromise=b.initializeTokensPromise("primaryTokensInfo","primaryTokensLoaded",(function(e){e||b.instrumentationService.logGenericEvent("Tokens_Config_Missing",{ElementId:"primaryTokensInfo"}),b.initializePrimaryTokens(e),b.secondaryTokensEnabled||b.msaClientTokensEnabled||b.initializeSecondaryTokens(e)})),b.initializeSecondaryTokensPromise=b.secondaryTokensEnabled?b.initializeTokensPromise("secondaryTokensInfo","secondaryTokensLoaded",(function(e){e||b.instrumentationService.logGenericEvent("Tokens_Config_Missing",{ElementId:"secondaryTokensInfo"}),b.initializeSecondaryTokens(e)})):Promise.resolve());var v=b.windowService.nativeWindow.shellTokenRequestDictionary;return b.reactShellConfigService.reactShellConfig.consumerShellServiceEnabled&&v&&(v[b.contextService.sharedContext.consumerShellServiceEndpoint]=function(){return b.getAccessTokenResponse("ConsumerShellService").then((function(e){return e.token}))}),b.windowService.nativeWindow.addEventListener("message",(function(e){var t=e.data;b.windowService.sameOriginRegex.test(e.origin)&&b._messageResponses.next(t)})),b}return Object(s.__extends)(t,e),t.prototype.hasPermanentAuthError=function(){var e=this;return new Promise((function(t){e.initializePrimaryTokensPromise.then((function(){var n=e.accessTokens.size>0;e.accessTokens.forEach((function(e){n&&e.token&&!e.token.HasPermanentError&&(n=!1)})),t(n)}))}))},t.prototype.hasOneDriveToken=function(){var e=this.accessTokens.get(this.getTokenKey("OneDrive",null));return!!e&&!!e.token&&!!e.token.TokenValue},t.prototype.hasCAPError=function(e,t){var n=this.getTokenKey(e,t),i=this.accessTokens.get(n);return i&&i.token&&i.token.HasCAPError},t.prototype.getAccessTokenResponse=function(e,t,n,i,r,o,a){var l=this;void 0===t&&(t=!1),void 0===n&&(n=""),void 0===i&&(i=!1),void 0===r&&(r=null);var s=this.getTokenKey(e,n,a),c=this.pendingRefreshRequests.get(s);if(c&&c.pending&&(!i||c.allowInteractive))return c.result;var u={pending:!1,result:null,allowInteractive:i},d=new Promise((function(o,c){l.getInitializationPromise(e,i).then((function(){var u=l.accessTokens.get(s);if(u||(u={refreshEndpoint:l.refreshApiUrls.get(e),token:{TokenValue:"",ExpiryMs:l.getDefaultExpiry()},resourceUrl:n},l.accessTokens.set(s,u)),(t=t||u.forceRefresh)||!l.tokenIsValid(u)){var d=function(e,t,n,i,o){l.startCAPFlow(e,t,n,r).then((function(){l.accessTokens.forEach((function(e){e.forceRefresh=!0,e.token.TokenValue="",e.token.HasCAPError=!1,e.token.HasPermanentError=!1,e.token.CAPSubErrorCode=null})),o(!0,!0),l._reauth.next()})).catch(i)},p=0,h=function(t,s){var f=function(e,n,i){var r="string"==typeof e?new N.a(e,i):e;n&&p<l.contextService.sharedContext.accessTokenMaxRetryAttempts?(++p,h(t,s)):c(r)};if(l.useMsaTokenService(e))l.msaTokenService.getAccessTokenResponse(e,i).then((function(e){!e.error&&e.token?(l.refreshToken(u,e.token,e.expiryMs),o(e)):f(e.error,!1)})).catch((function(e){f(e,!1)}));else if(n||(n=u.resourceUrl),n||!l.tokensRequiringResourceUrl.has(e)){var m={responseType:"json",headers:new Map};n&&m.headers.set("X-OfficeHome-ResourceUrl",n);var b=null==r?void 0:r.category;l.instrumentedHttp.get("Refresh_Access_Token_Request",l.contextService.sharedContext.officeHomeApiRoot+"/"+u.refreshEndpoint+(t?"?bypassCache=true":"?bypassCache=false")+(void 0===a?"":"&scope="+a),m,"network-only").instrument((function(i,r){if(r.params.Action=s?"CAP_Retry":"Regular",r.params.State=t?"Bypass_Cache":"Regular",r.params.Consumer=e,r.params.Retry=p.toString(),n){r.params.ResourceUrl=new T.d(n);var o=Te.a.referralFromFileLocation(n);!o&&Te.a.isConsumerDocument(n)&&(o="Consumer"),r.params.DocumentType=o}})).then((function(e){var t=e.data;t&&t.TokenValue?(l.refreshToken(u,t.TokenValue,t.ExpiryMs),s&&l.logCAPDialogEvent("token refresh succeeded",b),o({success:!0,token:t.TokenValue,expiryMs:t.ExpiryMs,format:"JWT",source:"OfficeHome"})):(s&&l.logCAPDialogEvent("token refresh empty token",b),f("Response did not contain valid token",!0))})).catch((function(e){if(l.errorHandler.handleError(e,"SgxOi"),s&&l.logCAPDialogEvent("token refresh failed",b),e){var t=e.data,n=e.status;if(t&&t.HasCAPError){var o=function(){return f("CAP_Error",!1)};i&&l.capabilitiesService.capabilities.capPopupEnabled&&!s&&t.CAPSubErrorCode&&t.ResourceId&&r?d(t.ResourceId,t.Scopes,t.CAPSubErrorCode,o,h):o()}else f("Request failed with error code: "+n,n>=500&&n<600||0===n||707===n||706===n,n)}else f("Request failed",!0)}))}else f("Missing resource url, but is required for <"+e+">.",!1)};if(u.token&&u.token.HasCAPError){var f=function(){return c(new N.a("CAP_Error"))};return void(i&&l.capabilitiesService.capabilities.capPopupEnabled&&u.token.CAPSubErrorCode&&u.token.ResourceId&&r?d(u.token.ResourceId,u.token.Scopes,u.token.CAPSubErrorCode,f,h):f())}if(u.token&&u.token.HasPermanentError)return void c(new N.a("Permanent auth error has been detected; refresh token for <"+e+"> is aborted."));if("SignedIn"!==l.authStateService.getCurrentState())return void c(new N.a("User has to be signed in; refresh token for <"+e+"> is aborted."));if("OfficeHome"===e)return void c(new N.a("Not refreshing OfficeHome token"));h(t||!!u.token.TokenValue,!1)}else o({success:!0,token:u.token.TokenValue,expiryMs:u.token.ExpiryMs,format:"JWT",source:"OfficeHome"})})).catch((function(t){l.errorHandler.handleError(t,"FZWPi"),c(new N.a("Token for <"+e+"> does not have initialization info."))}))})).then((function(e){return u.pending=!1,e})).catch((function(e){throw u.pending=!1,e}));return u.pending=!0,u.result=d,this.pendingRefreshRequests.set(s,u),d},t.prototype.useMsaTokenService=function(e){return this.msaClientTokensEnabled&&this.msaTokenService.supportsToken(e)},t.prototype.getTokenKey=function(e,t,n){return void 0===n&&(n=".default"),!t&&this.defaultResourceUrls.has(e)&&(t=this.defaultResourceUrls.get(e)),e+(t?"_"+t:"")+"_"+n},t.prototype.tokenIsValid=function(e){return e&&e.token&&e.token.TokenValue&&e.token.ExpiryMs>(new Date).getTime()},t.prototype.refreshToken=function(e,t,n){e.token.TokenValue=t,e.token.ExpiryMs=n||this.getDefaultExpiry(),e.forceRefresh=!1},t.prototype.startCAPFlow=function(e,t,n,i){var r=this;return this.pendingInteractiveRequest=new Promise((function(o,a){var l=function(){r.pendingInteractiveRequest=null,o()},s=function(){r.pendingInteractiveRequest=null,a()};r.errorDialogService.showErrorDialog({category:null==i?void 0:i.category,error:"ConditionalAccess",fileType:null==i?void 0:i.fileType,errorInfo:{capErrorCode:n},onActionClicked:function(){return r.openCAPPopup(e,t,null==i?void 0:i.category,l,s)},onClose:s})})),this.pendingInteractiveRequest},t.prototype.openCAPPopup=function(e,t,n,i,a){var l=this,s=this.clientStartupConfigService.config.isV2Auth?encodeURIComponent(this.createResourceWithScopes(e,t)):e,c=this.locService.format(this.contextService.sharedContext.tokenLoginUrlTemplate,s);this.capDialogStartTime=k.a.now();var u=pr(c,this.windowService.nativeWindow);if(!u)return this.logCAPDialogEvent("Could not open popup",n),void a();this.logCAPDialogEvent("Popup opened",n);var d=hr(u,this.windowService.nativeWindow,(function(){l.logCAPDialogEvent("Popup closed by user",n),a()}));this.messageResponses.withScope(1).pipe(Object(r.a)((function(e){return!!e&&!!e.capLoginMessage})),Object(o.a)(1)).toPromise().then((function(e){l.windowService.nativeWindow.clearInterval(d),u.close(),l.logCAPDialogEvent(e.capLoginMessage,n),"CAP_LoginComplete"===e.capLoginMessage?i():a()}))},t.prototype.logCAPDialogEvent=function(e,t){var n={};n.ItemCategory=t,n.State=e,n.Latency=Math.ceil(k.a.now()-this.capDialogStartTime).toString(),this.instrumentationService.logGenericEvent("CAP_Popup",n)},t.prototype.getInitializationPromise=function(e,t){return this.useMsaTokenService(e)?Promise.resolve():(n=!this.secondaryTokensEnabled||"OneDrive"!==e&&"SharePoint"!==e&&"Exchange"!==e?this.initializePrimaryTokensPromise:this.initializeSecondaryTokensPromise,t&&this.pendingInteractiveRequest?Promise.all([n,this.pendingInteractiveRequest]).catch().then():n);var n},t.prototype.initializeTokensPromise=function(e,t,n){var i=this;return new Promise((function(a){var l=N.c.NotInitialized,s=function(t){if(l!==N.c.NotInitialized)return!1;if(t&&!document.getElementById(e))return!1;l=N.c.Initializing;var r=i.configParserService.parse(e);return n(r),a(),l=N.c.Initialized,!0};s(!0)||(i.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return e.name===t})),Object(o.a)(1)).toPromise().then((function(){return s(!1)})),Q.a.shellAndConfigsReady().then((function(){return s(!1)})))}))},t.prototype.initializePrimaryTokens=function(e){this.initializeAccessToken("BingAnswers","api/refreshBingAnswersToken/v2",e&&e.BingAnswers),this.initializeAccessToken("Graph","api/refreshGraphAccessToken/v2",e&&e.Graph),this.initializeAccessToken("Loki","api/refreshLokiToken/v2",e&&e.Loki),this.initializeAccessToken("MruPlusPlus","api/refreshMruPlusPlusToken/v2",e&&e.Mru),this.initializeAccessToken("OneNote","api/refreshOneNoteToken/v2",e&&e.OneNote),this.initializeAccessToken("Portal","api/refreshPortalToken/v2",e&&e.Portal),this.initializeAccessToken("QueryFormulation","api/refreshQueryFormulationToken/v2",e&&e.QueryFormulation),this.initializeAccessToken("Substrate","api/refreshSubstrateToken/v2",e&&e.Substrate),this.initializeAccessToken("Sway","api/refreshSwayToken/v2",e&&e.Sway),this.initializeAccessToken("Forms","api/refreshFormsToken/v2",e&&e.Forms),this.initializeAccessToken("MyApps","api/refreshMyAppsToken/v2",e&&e.MyApps),this.initializeAccessToken("ConsumerShellService","api/refreshConsumerShellServiceToken/v2",e&&e.ConsumerShellService),this.initializeAccessToken("FluidPushChannel","api/refreshFluidPushChannelToken/v2",e&&e.FluidPushChannel),this.initializeAccessToken("AugLoop","api/refreshAugLoopToken/v2",e&&e.AugLoop),!this.userContextService.user.isGcc&&this.initializeAccessToken("Ods","api/refreshOdsToken/v2",e&&e.Ods),this.initializeAccessToken("TenantFeedback","api/refreshTenantFeedbackToken/v2",e&&e.TenantFeedback),this.initializeAccessToken("Notify","api/refreshNotifyToken/v2",e&&e.Notify),this.initializeAccessToken("Yammer","api/refreshYammerToken/v2",e&&e.Yammer),this.initializeAccessToken("MetaOS","api/refreshMetaOSToken/v2",null),this.initializeAccessToken("MfsService","api/refreshMfsServiceToken/v2",e&&e.MfsService),this.initializeAccessToken("OfficeHome",null,e&&e.OfficeHome)},t.prototype.initializeSecondaryTokens=function(e){this.initializeAccessToken("OneDrive","api/refreshOneDriveToken/v2",e&&e.OneDrive,this.contextService.sharedContext.oneDriveResourceId),this.initializeAccessToken("SharePoint","api/refreshSharePointToken/v2",e&&e.SharePoint,this.contextService.sharedContext.sharePointResourceId),this.initializeAccessToken("Exchange","api/refreshExchangeToken/v2",e&&e.Exchange)},t.prototype.initializeAccessToken=function(e,t,n,i){void 0===i&&(i=""),(n=n||{TokenValue:""}).TokenValue&&!n.ExpiryMs&&(n.ExpiryMs=this.getDefaultExpiry());var r={refreshEndpoint:t,token:n,resourceUrl:i};this.accessTokens.set(this.getTokenKey(e,i),r),t&&this.refreshApiUrls.set(e,t)},Object.defineProperty(t.prototype,"messageResponses",{get:function(){return this._messageResponses.asScopableObservable()},enumerable:!0,configurable:!0}),t.prototype.createResourceWithScopes=function(e,t){return t&&0!==t.length?t.map((function(t){return e+"/"+t})).join(" "):e},t}(N.b),yr=n("xoWf"),Sr=n("Dpxn"),wr=n("n826"),Cr=n("Brer");function Ir(e,t,n){return e.capabilities.useVroomForOneDriveApis?n:t}var Tr,kr,Ar=function(){return function(){}}(),Pr=n("fuFU"),Er=n("Aqby"),_r=new i.q("DISK_PRELOAD_URL_PATTERNS"),Or=n("aQ3G"),Fr=window.diskPreloadRequestMap,Dr=function(e,t,n,i){var r;if(e.sharedContext.inMockMode)return[{pattern:new RegExp("/mock/v2/recent/docs","i"),markerName:"MRU"},{pattern:new RegExp("/mock/docs/recent","i"),markerName:"MRU"},{pattern:new RegExp("/mock/sites","i"),markerName:"SharePointSites"},{pattern:new RegExp("/mock/recommended/api","i"),markerName:"RecommendedDocs"},{pattern:new RegExp("/mock/(.*)/me/drive/root","i"),markerName:"OneDriveRoot"},{pattern:new RegExp("/mock/PeoplePredictionsB2/api","i"),markerName:"OfficeFeedDocs"},{pattern:new RegExp("/mock/PeoplePredictionsB2/MicrosoftFeed","i"),markerName:"OfficeFeedV2Docs"}];var o=[],a=!!(null===(r=null==i?void 0:i.capabilities)||void 0===r?void 0:r.edgeworthEnabled);if(t&&t.config){var l=t.config,s=l.substrateApiEndpoint,c=l.officeFeedApiRootPath,u=l.recommendedB2ApiFilesPath,d=l.recommendedB2ApiRootPath;a||o.push({pattern:new RegExp("^"+l.mruServiceRoot+"/v2/recent/docs","i"),markerName:"MRU"}),o.push({pattern:new RegExp("^"+s+"/"+d+"/"+u,"i"),markerName:"RecommendedDocsV1"},{pattern:new RegExp("^"+s+"/"+c+"/(.*)/insights/query\\(context=null,scenario='(.*)',target=null,section='(.*)'\\)","i"),markerName:"OfficeFeedDocs"},{pattern:new RegExp("^"+s+"/PeoplePredictionsB2/MicrosoftFeed\\?section=(.*)&rs=(.*)&forceNewSchema=true","i"),markerName:"OfficeFeedV2Docs"})}return a||(n&&n.config&&o.push({pattern:new RegExp("^"+n.config.sharePointServiceRoot,"i"),markerName:"SharePointSites"}),e&&e.sharedContext&&o.push({pattern:new RegExp("^"+e.sharedContext.graphApiRoot+"/("+Or.a.graphBeta+"|"+Or.a.graphV1+")/"+wr.a.myDriveEndpoint+"root$","i"),markerName:"OneDriveRoot"})),o},Mr=window.diskPreloadUrlStorageKey,Rr=window.diskPreloadUserIdStorageKey,xr=function(){return function(){}}(),Lr=n("/6za"),Nr=n("9h0M");function Ur(e){return function(){return Tr||(Tr=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){return[2,(t=e.config).tenantId+"_"+t.puid]}))}))}(e)),Tr}}var Wr,Br,zr=function(e,t,n){return n&&function(e,t){if(!Object(Ge.t)(t))return!1;try{var n=e.nativeWindow,i=n.navigator;if(!("serviceWorker"in i))return!1;var r=i.serviceWorker;return!(!r.getRegistration||!r.getRegistrations)&&"URL"in n&&URL.prototype.hasOwnProperty("searchParams")}catch(e){return!1}}(e,t)},jr=function(e,t){return function(){return kr||(kr=function(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return[4,Ur(e)()];case 1:return n=i.sent(),[2,t.saltedHash(n)]}}))}))}(e,t)),kr}},Hr=function(){return function(){}}(),Vr=n("oHg+"),qr=function(e,t){return t&&e.config.enabled},Gr=function(){return function(){}}(),Zr=n("DTNF"),Qr=n("kMgc"),Kr=n("FHrx"),Yr=n("COYM"),Jr=function(){function e(e,t,n){this.webCryptoService=e,this.encryptionConfigService=t,this.textEncodingService=n}return e.prototype.saltedHash=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(s.__generator)(this,(function(n){return[2,te(this.webCryptoService.crypto.subtle,e,this.encryptionConfigService.config.digestSaltBase64,(function(e){return t.textEncodingService.encode(e)}))]}))}))},e.ɵprov=i.cc({factory:function(){return new e(i.dc(Yr.b),i.dc(Kr.a),i.dc(Qr.a))},token:e,providedIn:"root"}),e}(),Xr=n("OPPn"),$r=n("cZRF"),eo=function(){function e(e){this.encryptionService=e}return e.prototype.decryptResponse=function(e,t,n){return Object(s.__awaiter)(this,void 0,void 0,(function(){var i,r,o,a,l,c,u;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:if("arraybuffer"===n||"blob"===n)throw this.generateError(ke.a.NotImplemented,"Unsupported Encrypted Cached Body Type: "+n);s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.encryptionService.decryptData(t)];case 2:return i=s.sent(),[3,4];case 3:throw s.sent(),this.generateError(ke.a.DecryptionError,"Failed to decrypt response.");case 4:if(r=i.body,o=i.headers,l=i.statusText,c=i.status,!(a=i.requestUrl)||a.toLowerCase()!==e.toLowerCase())throw this.generateError(ke.a.UnexpectedResponse,"Resource read from cache does not match the resource being used");if(!r)throw this.generateError(ke.a.EmptyResponse,"Received an empty response from cache. Cannot decrypt.");try{return u="json"===n?JSON.parse(r):r,[2,new Nr.l({body:u,headers:new Nr.i(JSON.parse(o)),statusText:l,status:c,url:e})]}catch(e){throw this.generateError(ke.a.UnexpectedResponse,"Failed to parse response")}return[2]}}))}))},e.prototype.generateError=function(e,t){return new Nr.f({error:t,status:e,statusText:t})},e}(),to=n("Qj1g"),no=function(){function e(e){this.serviceWorkerEnabled=e}return e.prototype.intercept=function(e,t){return this.serviceWorkerEnabled&&"cache-only"===e.headers.get($.a)?t.handle(e).pipe(Object(to.a)((function(e){if(!(e instanceof Nr.f))throw e;if(e.status!==ke.a.Unknown)throw e;throw new Nr.f({error:e.error,headers:e.headers,status:ke.a.CacheMiss,statusText:ke.a[ke.a.CacheMiss],url:e.url})}))):t.handle(e)},e}(),io=n("pIkI"),ro=n("ro+v"),oo=n("NLr0"),ao=n("JYvP"),lo=n("2dXW"),so=function(){function e(e,t,n){this.errorHandler=e,this.windowService=t,this.serviceWorkerApiAvailable=n,this._messages=new lo.a,this.initialized=this.initialize()}return e.prototype.waitForTransactionalMessageAndRespond=function(e,t){var n=this;if(e&&t&&this.initialized)return this._messages.pipe(Object(r.a)(e)).subscribe((function(e){t(e).then((function(t){e.ports&&e.ports.length?e.ports[0].postMessage(t):e.source.postMessage(t)})).catch((function(e){n.errorHandler.handleError(e)}))}))},e.prototype.initialize=function(){var e=this;if(!this.serviceWorkerApiAvailable)return!1;try{this.serviceWorkerContainer=this.windowService.nativeWindow.navigator.serviceWorker,this.serviceWorkerContainer.addEventListener("message",(function(t){e._messages.next(t)}))}catch(e){return!1}return!0},e.ɵprov=i.cc({factory:function(){return new e(i.dc(i.m),i.dc(d.b),i.dc(g.a))},token:e,providedIn:"root"}),e}(),co=function(){function e(e,t,n,i,r){this.encryptionService=e,this.serviceWorkerInitiatedMessageService=t,this.serviceWorkerUserIdFactory=n,this.serviceWorkerEnabled=i,this.decryptResponseService=r,this.initialize()}return e.prototype.intercept=function(e,t){var n=this;if(!this.decryptResponseService||"cache-only"!==e.headers.get($.a))return t.handle(e);var i=e.clone({responseType:"arraybuffer"});return t.handle(i).pipe(Object(ao.a)((function(t){if(t instanceof Nr.l){var i=t,r=new Uint8Array(i.body);if(!r.length)return Object(io.a)(n.generateError(ke.a.UnexpectedResponse,"Received an empty response from cache. Cannot decrypt."));if("application/octet-stream"!==i.headers.get("Content-Type"))return Object(io.a)(n.generateError(ke.a.UnexpectedResponse,"Data is not binary. Cannot decrypt."));var o=void 0;try{o=Object(ie.b)(r)}catch(e){return Object(io.a)(n.generateError(ke.a.DecryptionError,e.message))}return Object(ro.a)(n.decryptResponseService.decryptResponse(i.url,o,e.responseType))}return Object(oo.a)(t)})))},e.prototype.initialize=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return this.serviceWorkerEnabled?[4,this.serviceWorkerUserIdFactory()]:[2];case 1:return e=n.sent(),this.serviceWorkerInitiatedMessageService.waitForTransactionalMessageAndRespond((function(t){var n=t.data;if(!n||"encrypt"!==n.type||"request"!==n.meta)return!1;var i=n.payload;return i.userId===e&&i.encryptionVersion===ie.a}),(function(e){return Object(s.__awaiter)(t,void 0,void 0,(function(){var t,n,i;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return n=(t=e.data.payload).requestId,[4,this.encryptionService.encryptData(t.data)];case 1:return i=r.sent(),[2,{type:"encrypt",meta:"response",payload:{requestId:n,encryptedData:i,encryptionVersion:ie.a}}]}}))}))})),[2]}}))}))},e.prototype.generateError=function(e,t){return new Nr.f({error:t,status:e,statusText:t})},e}(),uo=n("Jcv4"),po=n("2q5z"),ho=new i.q("DISK_PRELOAD_USER_ID_STORAGE_KEY"),fo=new i.q("DISK_PRELOAD_STORAGE_KEY"),mo=new i.q("DISK_PRELOAD_REQUEST_MAP"),bo=function(){function e(e,t,n,i,r,o,a,l){this.localStorageService=e,this.userIdStorageKey=t,this.urlPatternStorageKey=n,this.urlPatternEntries=i,this.serviceWorkerUserIdFactory=r,this.diskPreloadRequestMap=o,this.serviceWorkerEnabled=a,this.serviceWorkerConfigService=l,this.diskPreloadEnabled=!0,this.diskPreloadStorageEntries=[],this.initialized=this.init()}return e.prototype.tryAddToPreloadList=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.initialized];case 1:return n.sent(),this.diskPreloadEnabled?(!(t=this.getMarkerName(e))||this.hasUrl(e)||this.updateStorageEntries(Object(s.__spread)(this.diskPreloadStorageEntries,[{url:e,markerName:t}])),[2]):[2]}}))}))},e.prototype.loadPreloadResponse=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.initialized];case 1:return t.sent(),this.diskPreloadEnabled?[2,this.diskPreloadRequestMap.get(e)]:[2,null]}}))}))},e.prototype.init=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,t,n,i=this;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:if(this.initialized)throw new Error("`init()` can only be called once.");return this.serviceWorkerConfigService.config.diskPreloadEnabled&&this.serviceWorkerEnabled?(e=this.localStorageService.getGlobal(this.userIdStorageKey),[4,this.serviceWorkerUserIdFactory()]):(this.diskPreloadEnabled=!1,[2]);case 1:return t=r.sent(),e!==t?(this.diskPreloadEnabled=!1,this.localStorageService.setGlobal(this.userIdStorageKey,t),this.updateStorageEntries([]),[2]):(n=this.localStorageService.getGlobal(this.urlPatternStorageKey))?(this.updateStorageEntries(n.filter((function(e){return!!i.getMarkerName(e.url)}))),[2]):[2]}}))}))},e.prototype.getMarkerName=function(e){try{return this.urlPatternEntries.find((function(t){return t.pattern.test(e)})).markerName}catch(e){return}},e.prototype.hasUrl=function(e){return this.diskPreloadStorageEntries.map((function(e){return e.url})).indexOf(e)>=0},e.prototype.updateStorageEntries=function(e){this.diskPreloadStorageEntries=e,this.localStorageService.setGlobal(this.urlPatternStorageKey,this.diskPreloadStorageEntries)},e.ɵprov=i.cc({factory:function(){return new e(i.dc(_t.a),i.dc(ho),i.dc(fo),i.dc(_r),i.dc(Zr.a),i.dc(mo),i.dc(v.a),i.dc(m.a))},token:e,providedIn:"root"}),e}(),vo=function(){function e(e){this.diskPreloadService=e}return e.prototype.intercept=function(e,t){var n=this;return"cache-only"===e.headers.get($.a)?Object(ro.a)(this.diskPreloadService.loadPreloadResponse(e.urlWithParams)).pipe(Object(uo.a)((function(i){return i?i.ok?Object(ro.a)(n.convertToAngularHttpResponse(i,e.responseType)):Object(io.a)(n.convertToAngularHttpErrorResponse(i)):t.handle(e)}))):t.handle(e).pipe(Object(po.a)((function(t){t instanceof Nr.l&&t.ok&&n.diskPreloadService.tryAddToPreloadList(e.urlWithParams)})))},e.prototype.convertToAngularHttpResponse=function(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:switch(t){case"json":return[3,1];case"text":return[3,3];case"arraybuffer":return[3,5];case"blob":return[3,7]}return[3,9];case 1:return[4,e.json()];case 2:return n=i.sent(),[3,9];case 3:return[4,e.text()];case 4:return n=i.sent(),[3,9];case 5:return[4,e.arrayBuffer()];case 6:return n=i.sent(),[3,9];case 7:return[4,e.blob()];case 8:return n=i.sent(),[3,9];case 9:return[2,new Nr.l({body:n,headers:this.convertToAngularHeaders(e.headers),status:e.status,statusText:e.statusText,url:e.url})]}}))}))},e.prototype.convertToAngularHttpErrorResponse=function(e){return new Nr.f({error:e.statusText,status:e.status,statusText:e.statusText,headers:this.convertToAngularHeaders(e.headers),url:e.url})},e.prototype.convertToAngularHeaders=function(e){var t=new Nr.i;return e.forEach((function(e,n){t=t.append(n,e)})),t},e}(),go=function(){function e(){}return e.prototype.getLicenses=function(){return null},e}(),yo=n("rBEp"),So=function(){function e(){}return e.prototype.registerRecommendedJumpList=function(){},e.prototype.registerRecentJumpList=function(){},e.prototype.getJumpListItemById=function(){return null},e}(),wo=n("Bc8L"),Co=function(){function e(){}return e.prototype.launchOfficeApp=function(e,t,n,i){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return[2,Promise.reject()]}))}))},e.prototype.launchOfficeAppWithTemplate=function(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return[2,Promise.reject()]}))}))},e.prototype.openPathInExplorer=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return[2,Promise.reject()]}))}))},e.prototype.shouldOpenInOfficeApp=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return[2,Promise.resolve(!1)]}))}))},e}(),Io=function(){return function(){}}(),To=function(){function e(){}return e.prototype.isEligibleToPin=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return[2,new Promise((function(e){return e(!1)}))]}))}))},e.prototype.pinToTaskbar=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return[2,new Promise((function(e){return e(!1)}))]}))}))},e}(),ko=n("TIi1"),Ao=function(){function e(e,t,n){this.capabilitiesService=e,this.contextService=t,this.windowService=n}return e.prototype.openUrl=function(e,t,i,r,o){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(a){return this.capabilitiesService.capabilities.contentLauncherEnabled?(Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(n){n.launchUrl(e,{action:t,linkTarget:i})})),[2,Promise.resolve()]):(this.windowService.nativeWindow.open(e,i||this.contextService.sharedContext.defaultLinkTarget,"number"==typeof r&&"number"==typeof o?"width="+r+",height="+o:""),[2,Promise.resolve()])}))}))},e.prototype.supportsProtocol=function(e){return Promise.reject("Method not implemented.")},e.ɵprov=i.cc({factory:function(){return new e(i.dc(Z.a),i.dc(W.a),i.dc(d.b))},token:e,providedIn:"root"}),e}(),Po=n("H90i"),Eo=n("ZBli"),_o=function(e){function t(t,n,i,r,o,a,l,s,c,u){var d=e.call(this)||this;return d.appTilesConfigService=t,d.capabilitiesService=n,d.configParserService=i,d.contextService=r,d.dateService=o,d.globalErrorHandler=a,d.startupConfigService=l,d.userDataStorageService=s,d.scheduler=c,d.shellShimService=u,d.nativeWorkloads=new Array,d.allWorkloads=d.configParserService.parse("workloadsData")||{nonCoreAndSegmentApps:[],coreAndSegmentApps:[],pinnedApps:[]},d.pinnedTilesEnabled=d.appTilesConfigService.config.pinnedTilesEnabled,d.shellPinEnabled=d.capabilitiesService.capabilities.shellPinEnabled,d.allWorkloads.pinnedApps&&d.populateWorkloadFields(d.allWorkloads.pinnedApps),d.allWorkloads.coreAndSegmentApps=d.allWorkloads.coreAndSegmentApps.filter((function(e){return d.filterLocalOnlyApps(e)})),d.usedThirdPartyWorkloads=[],d.thirdPartyWorkloads=[],d.thirdPartyWorkloadsSubject=new Mn.a([]),d.subscribeToThirdPartyAppUpdates(),d.getWorkloads().then((function(e){d.pinnedTilesEnabled||(d.usedThirdPartyWorkloads=e.filter((function(e){return e.IsThirdParty})),d.cleanUnusedThirdPartyWorkloads())})),d}return Object(s.__extends)(t,e),t.prototype.getProvisionedWorkloads=function(){var e=this;return new Promise((function(t,n){e.getWorkloads().then((function(e){var n=e.filter((function(e){return!!e.Url}));n.forEach((function(e){e.IsThirdParty||(e.AppId=e.Id.slice(5),e.CollectorId="FirstParty")})),t(n)})).catch((function(t){e.globalErrorHandler.handleError(t,"Dnsgi"),n("Failed to get workloads list")}))}))},t.prototype.getCoreSegmentAndFrequentApps=function(){var e=this;return this.coreSegmentAndOtherAppsPromise||(this.coreSegmentAndOtherAppsPromise=new Promise((function(t){var n=e.allWorkloads,i=e.getFrequentAppsWithAnyClicks(n.nonCoreAndSegmentApps),r=n.coreAndSegmentApps.concat(i);e.populateWorkloadFields(r),e.startupConfigService.config.authType===p.a.MSA?e.getMsaWorkloadsData(r).then(t):t(r)}))),this.coreSegmentAndOtherAppsPromise.then((function(e){return Object(s.__spread)(e)}))},t.prototype.getPinnedWorkloads=function(){return this.allWorkloads.pinnedApps},t.prototype.unpinWorkload=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return this.allWorkloads.pinnedApps=this.allWorkloads.pinnedApps.filter((function(t){return!(t.AppId===e.AppId&&t.CollectorId===e.CollectorId)})),[4,this.shellShimService.getShellShim()];case 1:return(t=n.sent())&&t.Apps.Unpin(e.CollectorId,e.AppId),[2]}}))}))},t.prototype.getWorkloads=function(){var e=this;return this.workloadsPromise||(this.workloadsPromise=new Promise((function(t){var n,i=e.allWorkloads;n=i.coreAndSegmentApps.concat(i.nonCoreAndSegmentApps),e.populateWorkloadFields(n),e.startupConfigService.config.authType===p.a.MSA?e.getMsaWorkloadsData(n).then(t):t(n)}))),this.workloadsPromise.then((function(e){return Object(s.__spread)(e)}))},t.prototype.getWorkloadId=function(e){return t.fileTypeToIdMap.has(e)?t.fileTypeToIdMap.get(e):""},t.prototype.getReferralType=function(e){var t=this.dateService.addDays(this.dateService.getCurrentDate(),-45);return e.ClickCount?e.LastOccurrence<t.getTime()?T.c.ResurrectedReferral:e.LastOccurrence>=t.getTime()?T.c.RepeatReferral:T.c.NotDetected:T.c.FirsttimeReferral},t.prototype.getDisplayedApps=function(e){var t,n,i,r,o,a,l=e,c=this.appTilesConfigService.config,u=c.coreAppIds&&c.segmentSpecificAppIds?c.coreAppIds.concat(c.segmentSpecificAppIds):c.coreAppIds||c.segmentSpecificAppIds,d=c.promotedAppTileId,p=new Array;if(!c.isPromotedAppTileExpired&&d&&(l=l.filter((function(e){return e.Id.toLowerCase()!==d.toLowerCase()})),p.push(c.promotedAppTileId)),u&&u.length){var h=l.filter((function(e){return u.indexOf(e.Id)>-1})),f=l.filter((function(e){return u.indexOf(e.Id)<0})),m=c.coreAppIds?l.filter((function(e){return c.coreAppIds.indexOf(e.Id)>-1})):[];if(!h.length||!f.length||m.length<3)try{for(var b=Object(s.__values)(l),v=b.next();!v.done;v=b.next())p.push(v.value.Id)}catch(e){t={error:e}}finally{try{v&&!v.done&&(n=b.return)&&n.call(b)}finally{if(t)throw t.error}}else{var g=this.getFrequentAppsWithAnyClicks(f);try{for(var y=Object(s.__values)(h),S=y.next();!S.done;S=y.next())p.push(S.value.Id)}catch(e){i={error:e}}finally{try{S&&!S.done&&(r=y.return)&&r.call(y)}finally{if(i)throw i.error}}if(g.length)try{for(var w=Object(s.__values)(g),C=w.next();!C.done;C=w.next())p.push(C.value.Id)}catch(e){o={error:e}}finally{try{C&&!C.done&&(a=w.return)&&a.call(w)}finally{if(o)throw o.error}}}return p.toString()}},t.prototype.getFrequentAppsWithAnyClicks=function(e){var t=this.dateService.addDays(this.dateService.getCurrentDate(),-45);return e.filter((function(e){return e.ClickCount>0&&e.LastOccurrence>=t.getTime()}))},t.prototype.getThirdPartyWorkloads=function(){return this.thirdPartyWorkloadsSubject.asObservable()},t.prototype.updateUsedThirdPartyApps=function(e){if(!this.pinnedTilesEnabled){var t=this.usedThirdPartyWorkloads.findIndex((function(t){return t.Id.toLowerCase()===e.Id.toLowerCase()})),n=t>=0?this.usedThirdPartyWorkloads[t]:void 0;n?this.areThirdPartyAppsEqual(n,e)||(this.usedThirdPartyWorkloads[t]=e,this.userDataStorageService.set("UsedThirdPartyApps",this.usedThirdPartyWorkloads)):(this.usedThirdPartyWorkloads.push(e),this.userDataStorageService.set("UsedThirdPartyApps",this.usedThirdPartyWorkloads))}},t.prototype.populateWorkloadFields=function(e){var n=this;e.forEach((function(e){e.getId=function(){return e.Id},e.Referral=e.IsThirdParty?e.Id:t.referralFromWorkloadId(e.Id),e.FileType=n.getFileType(e.Id),e.Url=n.getWorkloadCustomUrl(e.FileType,e.Url)}))},t.prototype.getAdditionalWorkloads=function(){return Promise.resolve([])},t.prototype.pinWorkload=function(e){this.shellPinEnabled&&this.shellShimService.getShellShim().then((function(t){var n=e.AppId,i=e.CollectorId;i&&n&&!t.Apps.IsPinned(i,n)&&t.Apps.Pin(i,n)}))},t.prototype.getInAppNav=function(e){var t=this.allWorkloads.coreAndSegmentApps.concat(this.allWorkloads.nonCoreAndSegmentApps).concat(this.allWorkloads.pinnedApps).find((function(t){return t.Id===e}));return!!t&&t.InAppNav},t.prototype.getFileType=function(e){return t.idToFileTypeMap.has(e)?t.idToFileTypeMap.get(e):Te.b.Unknown},t.prototype.getMsaWorkloadsData=function(e){var t=this;return this.getShellWorkloadsData().then((function(n){return t.populateMSAWorkloadFields(e,n),e}))},t.referralFromWorkloadId=function(e){return e&&e.length&&0===e.lastIndexOf(t.AppTileElementIdPrefix,t.AppTileElementIdPrefixLength)?e.substring(t.AppTileElementIdPrefixLength):null},t.prototype.filterLocalOnlyApps=function(e){return!e.IsNativeClientOnlyApp||(this.nativeWorkloads.push(e),!1)},t.prototype.populateMSAWorkloadFields=function(e,t){var n=this;e.forEach((function(e){for(var i=e.Id.toLowerCase(),r=0;r<t.length;r++){var o=t[r];if(o.Id.toLowerCase()===i){e.Color=o.BackgroundColor,e.FileType=n.getFileType(e.Id),e.Url&&(e.Url=n.getWorkloadCustomUrl(e.FileType,o.LaunchUrl));break}}}))},t.prototype.getWorkloadCustomUrl=function(e,t){switch(e){case Te.b.Forms:t=Eo.a.appendAndReplaceQueryParams(t,{origin:Po.a,lang:this.contextService.sharedContext.officeMarket,sessionId:this.startupConfigService.config.sharedClientStartupContext.sessionId},!1,!0)}return t},t.prototype.getShellWorkloadsData=function(){var e=this;return new Promise((function(t,n){return Object(s.__awaiter)(e,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.shellShimService.getShellShim()];case 1:return(e=i.sent())?e.Apps.OnAppsUpdated((function(e){if(e&&e.Apps){var i=e.Apps.map((function(e){return{BackgroundColor:e.BackgroundColor,FontIconCss:e.FontIconCss,Id:e.Id,LaunchUrl:e.LaunchFullUrl}}));t(i)}else n("Shell shim apps not available.")})):n("Shell shim is not available"),[2]}}))}))}))},t.prototype.subscribeToThirdPartyAppUpdates=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.shellShimService.getShellShim()];case 1:return e=i.sent(),[4,this.shellShimService.afterShellPlusLoaded];case 2:return i.sent(),[4,new Promise((function(i){var r=0,o=0,a=!1;e.Apps.OnAppsUpdated((function(l){if(l&&l.Apps){var c=l.Apps.filter((function(e){return"FirstParty"!==e.CollectorId&&!n.thirdPartyWorkloads.find((function(t){return t.Id===e.Id}))}));n.pinnedTilesEnabled||(c=c.filter((function(e){return"LineOfBusiness"!==e.CollectorId||n.appTilesConfigService.config.customTiles}))),n.capabilitiesService.capabilities.showBusinessApps||(c=c.filter((function(e){return"Dynamics"!==e.CollectorId}))),c.forEach((function(t){var l=t.LaunchFullUrl;n.thirdPartyWorkloads.push({ChangeColorInDarkMode:"Dynamics"===t.CollectorId,Color:t.BackgroundColor,Id:t.Id,AppId:t.Id,CollectorId:t.CollectorId,Title:t.AriaLabel?t.AriaLabel:"",SubText:t.Subtitle,Text:t.Title,IsNativeClientOnlyApp:t.isNativeClientOnlyApp,Url:l?l.trim():"",IconUnicodeCodepointCssClass:"ms-fcl-tp ms-Icon ms-Icon--OfficeAddinsLogo",ThirdPartyIcon:t.IconAnonymousUrl?t.IconAnonymousUrl:null,Referral:t.Id,IsThirdParty:!0,getId:function(){return t.Id}}),t.IconAnonymousUrl||(++r,n.scheduler.scheduleWork((function(){e.Apps.GetAuthenticatedAppIcon(t,(function(e){if(++o,e){var l=n.thirdPartyWorkloads.findIndex((function(e){return e.Id.toLowerCase()===t.Id.toLowerCase()})),c=n.thirdPartyWorkloads[l];n.thirdPartyWorkloads[l]=Object(s.__assign)(Object(s.__assign)({},c),{ThirdPartyIcon:"data:"+e.MimeType+";base64,"+e.Base64EncodedImage}),n.thirdPartyWorkloadsSubject.next(n.thirdPartyWorkloads)}a&&r===o&&i()}))}),3))})),n.thirdPartyWorkloadsSubject.next(n.thirdPartyWorkloads),(a=l.DataSource===t.AppsShimDataSourceAppCollectors||l.DataSource===t.AppsShimDataSourceShellDataComplete)&&r===o&&i()}}))}))];case 3:return i.sent(),this.invalidateThirdPartyAppCache(),[2]}}))}))},t.prototype.cleanUnusedThirdPartyWorkloads=function(){if(0!==this.usedThirdPartyWorkloads.length){var e=this.dateService.addDays(this.dateService.getCurrentDate(),-45).getTime(),t=this.usedThirdPartyWorkloads.length;this.usedThirdPartyWorkloads=this.usedThirdPartyWorkloads.filter((function(t){return t.LastOccurrence>=e})),t!==this.usedThirdPartyWorkloads.length&&this.userDataStorageService.set("UsedThirdPartyApps",this.usedThirdPartyWorkloads)}},t.prototype.areThirdPartyAppsEqual=function(e,t){return e.Text===t.Text&&e.Url===t.Url&&e.ThirdPartyIcon===t.ThirdPartyIcon&&e.Title===t.Title},t.prototype.invalidateThirdPartyAppCache=function(){var e=this;if(0!==this.usedThirdPartyWorkloads.length){var t=[],n=!1;this.usedThirdPartyWorkloads.forEach((function(i){var r=e.thirdPartyWorkloads.find((function(e){return e.Id===i.Id}));r?e.areThirdPartyAppsEqual(r,i)||(t.push(r),n=!0):n=!0})),n&&(this.usedThirdPartyWorkloads=t,this.userDataStorageService.set("UsedThirdPartyApps",this.usedThirdPartyWorkloads))}},t.AppTileElementIdPrefixLength=(t.AppTileElementIdPrefix="Shell").length,t.AppsShimDataSourceAppCollectors=3,t.AppsShimDataSourceShellDataComplete=4,t.idToFileTypeMap=new Map([["ShellWordOnline",Te.b.Word],["ShellExcelOnline",Te.b.Excel],["ShellPowerPointOnline",Te.b.PowerPoint],["ShellOneNoteOnline",Te.b.OneNote],["ShellClassNotebook",Te.b.OneNoteClassNoteBook],["ShellVisioOnline",Te.b.Visio],["ShellSway",Te.b.Sway],["ShellOfficeForms",Te.b.Forms],["ShellDocuments",Te.b.OneDrive],["ShellSites",Te.b.SharePoint],["ShellMicrosoftStream",Te.b.Stream]]),t.fileTypeToIdMap=new Map([[Te.b.Word,"ShellWordOnline"],[Te.b.Excel,"ShellExcelOnline"],[Te.b.PowerPoint,"ShellPowerPointOnline"],[Te.b.OneNote,"ShellOneNoteOnline"],[Te.b.Visio,"ShellVisioOnline"],[Te.b.Sway,"ShellSway"],[Te.b.Forms,"ShellOfficeForms"],[Te.b.OneDrive,"ShellSway"],[Te.b.SharePoint,"ShellOfficeForms"],[Te.b.Stream,"ShellMicrosoftStream"]]),t}(dt.a),Oo=n("Xc4i"),Fo=n("UWom"),Do=n("SQAW");!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(Wr||(Wr={})),function(e){e.AccessToken="AccessToken",e.FileGetUrl="FileGetUrl"}(Br||(Br={}));var Mo=n("idgT"),Ro=n("IBRu"),xo=n("y9oG"),Lo=function(e){function t(t,n,i,r,o,a,l,s){var c=e.call(this,t,n,i,"Graph",r,o,a,s)||this;return c.globalErrorHandler=l,c.requestConfig={headers:new Map([["content-type","application/x-www-form-urlencoded"]])},c}return Object(s.__extends)(t,e),t.prototype.postPreboot=function(t,n,i){var r=this;return new Promise((function(o,a){e.prototype.post.call(r,t,n,i,(function(e){e.instrument((function(e,t){t.params.RequestId=r.getRequestIdFromResponse(e)})).then((function(){return o(null)}))}),(function(e){a(e)}),r.requestConfig,void 0,void 0,void 0,void 0,"None")}))},t.ɵprov=i.cc({factory:function(){return new t(i.dc(N.b),i.dc(T.a),i.dc(U.a),i.dc(W.a),i.dc(u.a),i.dc(Ge.q),i.dc(l.b),i.dc(Ae.a))},token:t,providedIn:"root"}),t}(n("pOWU").a),No=function(e){function t(t,n,i,r,o,a,l,s,c,u,d){var p=e.call(this,t,n,i,r,o,a,l,s)||this;return p.webPwaService=c,p.windowService=u,p.wacPrebootService=d,p.prebootedApplications=new Map,p.bootstrappedDocuments=new Map,p.prebootedDocuments=new Map,p.prebootedWopiFetchData=new Map,p.prebootedSessionId=new Map,p.webPwaService.isStandalone.subscribe((function(e){p.isStandalone=e,p.uihit=p.getUihit(e),p.uih="officecom"+p.uihit})),p}return Object(s.__extends)(t,e),t.prototype.prebootDocument=function(e){var t=this;if(e.driveId&&e.docId&&!this.prebootedDocuments.has(this.getPrebootKey(e))){var n=this.getWopiData(e,!1,!1,!0);n.then((function(i){var r=We.a.createGuid(),o=t.index++,a=t.getPrebootKey(e);t.prebootedDocuments.set(a,o),t.prebootedWopiFetchData.set(a,n),t.prebootedSessionId.set(a,r);var l="access_token="+encodeURIComponent(i.wopiHostData.wac.accessToken)+"&access_token_ttl="+encodeURIComponent(i.wopiHostData.wac.accessTokenExpiry)+"&bundleSrc="+encodeURIComponent(i.wopiHostData.bundleUrl)+"&fileExtension="+encodeURIComponent(Te.a.getFileExtension(i.wopiHostData.fileName))+"&user_id="+encodeURIComponent(i.wopiHostData.wac.userId);t.wacPrebootService.postPreboot("WacDocument_Preboot",t.getPrebootUrl(i.wopiHostData.wac.applicationUrl)+"?op=preboot&usid="+encodeURI(r),l)}))}},t.prototype.bootstrapItem=function(e,t,n){var i,r,o,a=this;this.prebootedApplications.clear();var l=!1;if(this.capabilitiesService.wacHostHoverPrebootEnabledForFileType(e.fileType)&&e.driveId&&e.docId){var c=this.getPrebootKey(e);r=this.prebootedDocuments.get(c),i=this.prebootedWopiFetchData.get(c),o=this.prebootedSessionId.get(c),(l=Number.isInteger(r))&&(this.prebootedDocuments.delete(c),this.prebootedSessionId.delete(c))}var u=Object(s.__read)(this.generateCorrelationAndBootId(r),2),d=u[0],p=u[1];this.logPerformanceBootStart(p,d,e.wdOrigin,e.fileType);var h=new Fo.a;this.logPerformanceEventFromClick(p,"WacContent_Document_Wopi_Fetch_Start",e.fileType);var f=null!=i?i:n||this.getWopiData(e,!1,!1,!0);f.then((function(n){a.logPerformanceEventFromClick(p,"WacContent_Document_Wopi_Fetch_End",e.fileType),a.bootstrapFile(h,p,e,n.wopiHostData,d,t,n.fetchDiagnostics,!0,l?o:void 0)})).catch((function(e){a.sendBootError("WacDocument_Vroom_Error",e,h)}));var m=e.fileName,b={correlationId:d,bootstrapperObservable:h.asObservable(),fileNamePromise:m?Promise.resolve(Te.a.fileNameWithoutExtension(m)):f.then((function(e){return Te.a.fileNameWithoutExtension(e.wopiHostData.fileName)})),documentIdentifierPromise:f.then((function(e){return e.fetchedDocumentInfo}))},v={correlationId:d,bootedDocumentInfo:{bootId:p,documentInfo:e},data:b};return this.bootstrappedDocuments.set(p,v),v},t.prototype.bootstrapZeroByteDocument=function(e,t,n,i,r){var o=this,a=this.prebootedApplications.get(e.fileType);Date.now()>(null==a?void 0:a.expirationTime)&&(a=void 0,this.prebootedApplications.clear());var l=Object(s.__read)(a?a.correlationAndBoot:this.generateCorrelationAndBootId(),2),c=l[0],u=l[1];this.logPerformanceBootStart(u,c,e.wdOrigin,e.fileType);var d=a?a.loadFunctionSubject:new Fo.a,p=n.then((function(t){return o.logPerformanceEventFromClick(u,"WacContent_Document_Wopi_Fetch_Start",e.fileType),o.getWopiData(t,!0,!1,!0)}));p.then((function(n){return Object(s.__awaiter)(o,void 0,void 0,(function(){var o,l;return Object(s.__generator)(this,(function(p){switch(p.label){case 0:return this.logPerformanceEventFromClick(u,"WacContent_Document_Wopi_Fetch_End",e.fileType),[4,n.fetchedDocumentInfo];case 1:return o=p.sent(),l=r?Object(s.__assign)(Object(s.__assign)({},o.applicationUrlParams),{templateItemId:i,templateDriveId:r}):i?Object(s.__assign)(Object(s.__assign)({},o.applicationUrlParams),{wdTpl:i}):o.applicationUrlParams,a?a.finishLoad(n.wopiHostData,o.newFileInfo):this.bootstrapFile(d,u,Object(s.__assign)(Object(s.__assign)({},o),{applicationUrlParams:l}),n.wopiHostData,c,t,Object(s.__assign)(Object(s.__assign)({},n.fetchDiagnostics),{endTime:Date.now()})),[2]}}))}))})).catch((function(e){o.sendBootError("WacDocument_Vroom_Error",e,d)}));var h=p.then((function(e){return e.fetchedDocumentInfo})),f={bootstrapperObservable:d.asObservable(),fileNamePromise:h.then((function(e){return Te.a.fileNameWithoutExtension(e.fileName)})),documentIdentifierPromise:h},m={bootId:u,documentInfo:Object(s.__assign)(Object(s.__assign)({},e),{newFile:!0,templateId:i})},b={correlationId:c,bootedDocumentInfo:m,data:f};return this.bootstrappedDocuments.set(u,b),a&&this.prebootedApplications.clear(),b},t.prototype.bootstrapApplication=function(e,t){var n=this;if(this.capabilitiesService.capabilities.wacHostPrebootApps.has(e)&&!this.prebootedApplications.has(e)){var i=Object(s.__read)(this.getOfficeBootstrapper(e),2),r=i[0];if(r&&!i[1]){var o=Object(s.__read)(this.generateCorrelationAndBootId(),2),a=o[0],l=o[1],c=new Fo.a,u=Object(s.__read)(Object(Ro.a)(),3),d=u[0],p=u[1],h=u[2];c.next((function(i){var o=i.container,a=i.flushTime,c=i.loadCorrelationId;return new Do.a((function(i){var u=n.getInitParams(e,c,t,o.nativeElement,a,a,(function(t){return Object(s.__awaiter)(n,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return this.logPerformanceEventFromClick(l,"WacContent_Document_Load_End",e),[4,d];case 1:return n=s.__read.apply(void 0,[r.sent(),1]),i.next({wopiHostData:n[0],officeApplication:t}),i.complete(),[2]}}))}))}),(function(e){n.sendBootError("WacDocument_JsApi_Error",e,i)}),void 0,void 0,void 0,void 0,void 0,{wdasp:1});n.logPerformanceEventFromClick(l,"WacContent_Document_InitializeWopiPending",e);var p=r.Application.InitializeWopiPending(u);p?d.then((function(e){var t=Object(s.__read)(e,2),i=t[1],r=n.getWopiInfo(t[0].wac);p.Complete(r,i)})).catch((function(){})):n.sendBootError("Initialize_Wopi_Pending_Failed",fail,i)}))})),c.complete();var f=h,m={bootstrapperObservable:c.asObservable(),fileNamePromise:d.then((function(e){return Object(s.__read)(e,1)[0].fileName}))},b={finishLoad:function(e,t){return p([e,t])},cancelLoad:f,loadData:{correlationId:a,bootedDocumentInfo:{bootId:l,documentInfo:{fileType:e,wdOrigin:t}},data:m},loadFunctionSubject:c,expirationTime:Date.now()+this.contextService.sharedContext.wacHostAppPrebootTimeout,correlationAndBoot:[a,l]};return this.prebootedApplications.set(e,b),b}}},t.prototype.bootstrapFile=function(e,t,n,i,r,o,a,l,c){var u=this;void 0===l&&(l=!0);var d=n.fileType,p=null==i?void 0:i.wac,h=0;try{h=(null==p?void 0:p.accessTokenExpiry)?parseInt(p.accessTokenExpiry):0}catch(e){}if(!(null==p?void 0:p.bootstrapperUrl)||h<Date.now())l?this.getWopiData(n,n.newFile,!0).then((function(i){i?u.bootstrapFile(e,t,n,i.wopiHostData,r,o,i.fetchDiagnostics,!1):u.sendBootError("WacDocument_Generic_Boot_Error","Error occurred while trying to fetch wopi data",e)})).catch((function(t){u.sendBootError("WacDocument_Vroom_Error",t,e)})):this.sendBootError("WacDocument_Vroom_Error","Failed to get wopi data for the item",e);else{var f=i.wac.bootstrapperUrl,m=i.wac.applicationUrl;this.logPerformanceEventFromClick(t,"WacContent_Document_Bootstrapper_Load_Start",d),this.loadBootstrapper(f,m,d).then((function(){var l=Object(s.__read)(u.getOfficeBootstrapper(d),2),p=l[0],h=l[1];if(h)u.sendBootError("WacHost_Bootstrapper_Load_Error",h,e);else{u.logPerformanceEventFromClick(t,"WacContent_Document_Bootstrapper_Load_End",d);var m=u.getWopiInfo(i.wac);e.next((function(e){var l=e.container,s=e.flushTime,h=e.loadCorrelationId;return new Do.a((function(e){var b=setTimeout((function(){u.logError(r,n,"WacDocument_JsApi_Timeout")}),15e4),v=u.getInitParams(n.fileType,h,n.wdOrigin,l.nativeElement,r!==h?s:o,s,(function(a,l){clearTimeout(b),u.logPerformanceEventFromClick(t,"WacContent_Document_Load_End",d),u.logBootPerformance(r,n,l,o),e.next({wopiHostData:i,officeApplication:a}),e.complete()}),(function(t){clearTimeout(b),u.sendBootError("WacDocument_JsApi_Error",t,e)}),n.docId,i,m,f,a,n.applicationUrlParams,n.rebootOverrideData);u.logPerformanceEventFromClick(t,"WacContent_Document_InitializeWopiPending",d);var g=p.Application.InitializeWopiPending(v,void 0,c);g?g.Complete(m):u.sendBootError("Initialize_Wopi_Pending_Failed",fail,e)}))})),e.complete()}})).catch((function(){u.sendBootError("WacHost_Bootstrapper_Load_Error","Failed to load the bootstrapper",e)}))}},t.prototype.getOfficeBootstrapper=function(e){var t=this.windowService.nativeWindow.Microsoft;if(void 0===t)return[null,"Microsoft is undefined"];var n=t.Office,i=Te.b[e];return n&&n[i]?[n[i],null]:[null,"Failed to find bootstrapper for app: "+i]},t.prototype.getSessionContext=function(){return{pmo:this.windowService.nativeWindow.location.origin,pmshare:!0,surl:void 0,curl:void 0,vurl:void 0,eurl:this.windowService.nativeWindow.location.href}},t.prototype.getSessionInformation=function(e,t,n){void 0===n&&(n={});var i=this.contextService.sharedContext.officeMarket,r=this.capabilitiesService.capabilities;return{HostName:"office.com",HostSessionId:t,UserId:e,OwnerId:void 0,UiLocale:i,DataLocale:i,DisableChat:!0,CookieCompliant:!0,WdParams:n,DisableFocusOnBoot:!1,SessionContext:JSON.stringify(this.getSessionContext()),HideHeader:this.capabilitiesService.capabilities.wacHeaderDisabled||this.capabilitiesService.capabilities.isEmbedMode,SupportsDocReboot:r.wacHostDocRebootEnabled?Wr.AnyDoc|Wr.OtherMode:Wr.AnyDoc,SupportsCreateNewDocument:r.wacHostCreateNewEnabled,SupportsAuthToken:r.wacHostGetAuthTokenEnabled,UiHostIntegrationType:this.uihit,SupportsAtMentions:!0,SupportsCustomAuthConfig:r.wacHostGetCustomAuthConfigEnabled,SupportsExcelExternalLinks:r.wacHostExternalLinkEnabled,SupportsMoveToFolder:r.wacHostMoveToFolderEnabled}},t.prototype.getOrCreateDefaultPrecheckInfo=function(e,t){var n,i;return e?Object(s.__assign)({FileName:e.fileName,FileGetUrl:e.downloadUrl||e.wac.fileGetUrl,FileSize:e.fileSize,BundleInfo:{Url:e.bundleUrl,MajorVersion:e.bundleVersion},ReadOnly:null!==(n=e.readOnly)&&void 0!==n&&n,IrmEnabled:null!==(i=e.irmEnabled)&&void 0!==i&&i,ETag:e.eTag,ClientThrottlingProtection:e.wac.clientThrottlingProtection,RequestedCallThrottling:e.wac.requestedCallThrottling,IsNewFile:e.isNewFile},t&&{DocUniqueId:t}):{FileName:""}},t.prototype.getWopiInfo=function(e){return{WopiSrc:e.wopiSrc,AccessToken:e.accessToken,AccessTokenExpiry:new Date(parseInt(e.accessTokenExpiry))}},t.prototype.getDiagnostics=function(e,t,n,i,r){void 0===i&&(i={startTime:0,endTime:0});var o=r?this.bootstrapperDiagnostics.get(r):{startTime:0,endTime:0},a=Math.max(this.performanceService.navigationStart,e),l=Math.max(i.startTime?i.startTime:0,a),s=Math.max(i.endTime?i.endTime:0,l),c=Math.max(t,s),u=Math.max(o?o.startTime:0,c);return{entryPoint:n,userClickTime:e,hostPageNavigationStartTime:a,hostPageFetchStartTime:l,hostPageFetchEndTime:s,hostPageFirstFlushTime:c,officeBootstrapperStartTime:u,officeBootstrapperEndTime:Math.max(o?o.endTime:0,u),officeInitializationTime:Date.now()}},t.prototype.getInitParams=function(e,t,n,i,r,o,a,l,c,u,d,p,h,f,m){var b=this.applicationUrls.get(e),v=b.bootstrapperUrl,g=u?u.wac.applicationUrl||u.wac.editUrl:Eo.a.removeQueryParams(b.applicationUrl,["wopisrc"],!1),y=Object(s.__assign)(Object(s.__assign)({},f),{uiEmbed:1,uih:this.uih}),S=Eo.a.appendQueryParams(g,y),w={},C=this.capabilitiesService.capabilities.scenarioId;return C&&(w.wdscenarioId=C),Object(s.__assign)({BootstrapperUrl:p||v,Container:i,SessionInformation:this.getSessionInformation(u?u.wac.userId:this.clientStartupConfigService.config.puid,t,w),ApplicationUrl:S,WopiPrecheckInfo:this.getOrCreateDefaultPrecheckInfo(u,c),ApplicationCustomSettings:{HostUIControls:[{id:"close",visibility:0},{id:"share",visibility:1}]},Diagnostics:this.getDiagnostics(r,o,n,h,v),FnOnInitializeSuccess:a,FnOnInitializeFailure:l,FnIsFeatureEnabled:this.createIsFeatureEnabledCallback(e),RebootOverrideData:m},d?{WopiInfo:d}:{})},t.prototype.createIsFeatureEnabledCallback=function(e){var t=this;return function(n){switch(n){case"OfficeComUiHost":return!t.isStandalone&&!t.capabilitiesService.capabilities.isPwaInUwp;case"OfficeHwaUiHost":return t.capabilitiesService.capabilities.isPwaInUwp;case"OfficeComPreboot":return!(!t.capabilitiesService.wacHostEnabledForFileType(e)||!t.capabilitiesService.wacHostHoverPrebootEnabledForFileType(e))||!t.capabilitiesService.capabilities.wacHostHoverPrebootControlFlight&&void 0;default:return}}},t.prototype.logError=function(e,t,n,i){var r,o=((r={}).Error=i,r);this.instrumentationService.logErrorEvent(n,Object(xo.a)(e,t,o))},t.prototype.sendBootError=function(e,t,n){n.error({instrumentationEvent:e,error:t})},t.prototype.getUihit=function(e){return void 0===e&&(e=!1),this.capabilitiesService.capabilities.isPwaInUwp?t.uihitOfficeComHwa:e?t.uihitOfficeComPwa:""},t.prototype.getPrebootUrl=function(e){if(!e)return null;var t=pt.a.getLocation(e),n=t.path.substring(0,t.path.lastIndexOf("/"))+"/preboot.ashx";return pt.a.getOrigin(e)+n},t.prototype.getPrebootKey=function(e){return e.driveId+"_"+e.docId},t.uihitOfficeComPwa="pwa",t.uihitOfficeComHwa="hwa",t}(Oo.a),Uo=function(e){function t(t,n,i,r,o,a,l){var s=e.call(this,o)||this;return s.errorHandler=t,s.contextService=n,s.serviceWorkerEnabled=i,s.serviceWorkerUserIdFactory=r,s.officeHomeApiConfigService=a,s.clientStartupConfigService=l,s.messageSent=!1,s}return Object(s.__extends)(t,e),t.prototype.handleRegistration=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n,i=this;return Object(s.__generator)(this,(function(r){if(!this.serviceWorkerEnabled)return[2];try{t=this.contextService.sharedContext.serviceWorkerIntervalUpdateEnabled,n=function(){e.addEventListener("updatefound",(function(){i.postAuthorizedInstallMessage(e.installing)}))},e.installing?(this.postAuthorizedInstallMessage(e.installing),t&&n()):n()}catch(e){this.errorHandler.handleError(e,"OGBGO")}return[2]}))}))},t.prototype.postAuthorizedInstallMessage=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return this.messageSent?[2]:(n={token:null},[4,this.serviceWorkerUserIdFactory()]);case 1:return n.userId=r.sent(),n.apiPath="api/shellandconfigdata",n.apiHeaders=((i={})[this.officeHomeApiConfigService.config.userIdHeader]=this.clientStartupConfigService.config.puid,i),t=n,this.contextService.sharedContext.inMockMode&&(this.addParamFromWindow(t,"mockauth"),this.addParamFromWindow(t,"envType")),this.addParamFromWindow(t,"flight"),e.postMessage({type:"OFFICECOM_AUTH_WARMUP",meta:"installation-credentials",payload:t}),this.messageSent=!0,[2]}}))}))},t}(function(){function e(e){this.windowService=e}return e.prototype.addParamFromWindow=function(e,t){var n,i=new URL(this.windowService.nativeWindow.location.href).searchParams.get(t);i&&(e.apiQsParams?e.apiQsParams[t]=i:e.apiQsParams=((n={})[t]=i,n))},e}()),Wo=function(){function e(e){this.serviceWorkerEnabled=e}return e.prototype.handleRegistration=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return this.serviceWorkerEnabled?[3,2]:[4,e.unregister()];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},e}(),Bo=function(){function e(e,t){this.windowService=e,this.serviceWorkerApiAvailable=t}return e.prototype.sendTransactionalMessage=function(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return this.serviceWorkerApiAvailable&&"undefined"!=typeof MessageChannel?(n=t)?[3,2]:[4,this.getServiceWorker()]:[2];case 1:n=i.sent(),i.label=2;case 2:return(t=n)?[2,new Promise((function(n){var i=new MessageChannel;i.port1.onmessage=function(e){n(e),i.port1.close(),i.port2.close()},t.postMessage(e,[i.port2])}))]:[2]}}))}))},e.prototype.sendUnidirectionMessage=function(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return this.serviceWorkerApiAvailable?(n=t)?[3,2]:[4,this.getServiceWorker()]:[2];case 1:n=i.sent(),i.label=2;case 2:return(t=n)&&t.postMessage(e),[2]}}))}))},e.prototype.getServiceWorker=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.windowService.nativeWindow.navigator.serviceWorker.ready];case 1:return[2,e.sent().active];case 2:return e.sent(),[2,null];case 3:return[2]}}))}))},e.ɵprov=i.cc({factory:function(){return new e(i.dc(d.b),i.dc(g.a))},token:e,providedIn:"root"}),e}(),zo=function(){function e(e,t,n,i,r){this.errorHandler=e,this.contextService=t,this.instrumentationService=n,this.serviceWorkerEnabled=i,this.serviceWorkerMessageService=r}return e.prototype.handleRegistration=function(e){var t=this;if(this.serviceWorkerEnabled)try{var n=this.contextService.sharedContext.serviceWorkerIntervalUpdateEnabled,i=function(){e.addEventListener("updatefound",(function(){t.subscribeToInstallingServiceWorkerActivationTelemetry(e.installing)}))};e.installing?(this.subscribeToInstallingServiceWorkerActivationTelemetry(e.installing),n&&i()):i()}catch(e){this.errorHandler.handleError(e)}},e.prototype.subscribeToInstallingServiceWorkerActivationTelemetry=function(e){var t=this;this.serviceWorkerMessageService.sendTransactionalMessage({type:"OFFICECOM_SW_TELEMETRY",meta:"activation"},e).then((function(e){var n=e.data;"OFFICECOM_SW_TELEMETRY"===n.type&&"activation"===n.meta&&t.instrumentationService.logGenericEvent(n.payload.eventName,n.payload.params)}))},e}(),jo=n("PZOQ"),Ho=n("1Bt+"),Vo=n("uH9+"),qo=n("jidT"),Go=n("qfyf"),Zo=n("x+6c"),Qo=n("ZtId"),Ko=function(){function e(e){void 0===e&&(e=!1),this.id=We.a.createGuid(),this.startTime=k.a.now(),e&&this.complete()}return e.prototype.complete=function(){this.endTime=k.a.now()},e.prototype.timeSinceUpdate=function(){return this.endTime?k.a.now()-this.endTime:0},e}(),Yo=function(){function e(t,n,i){this.globalErrorHandler=n,this.officeRouteService=i,this.updates=new Map,this.defaultUpdateTimeout=t.sharedContext.dataUpdateTimeoutInSeconds*e.MsPerSecond,this.defaultUpdateCooldown=t.sharedContext.dataUpdateCooldownInSeconds*e.MsPerSecond,this.defaultUpdateFailures=t.sharedContext.dataUpdateMaxConsecutiveFailures}return e.prototype.getOrAddUpdateStream=function(e,t,n,i,r,o){void 0===o&&(o=!1);var a=this.officeRouteService.getRouteItemForCurrentLocation();return this.updates.has(e)||this.updates.set(e,{consecutiveFailures:0,cooldown:i||this.defaultUpdateCooldown,lastUpdate:o?null:new Ko(!0),maxFailures:n||this.defaultUpdateFailures,operation:t,route:a,subject:new lo.a,timeout:r||this.defaultUpdateTimeout}),this.updates.get(e).subject.asObservable()},e.prototype.pushUpdate=function(e){return this.updates.has(e)?this.safeUpdate(this.updates.get(e),e):Promise.resolve()},e.prototype.updateAllowed=function(e){if(!e.lastUpdate)return!0;var t=e.lastUpdate.timeSinceUpdate();return t>0?t>e.cooldown:e.timeout&&e.lastUpdate.startTime+e.timeout<=k.a.now()},e.prototype.safeUpdate=function(e,t){var n=this;if(!this.updateAllowed(e))return Promise.resolve();var i=new Ko;return e.lastUpdate=i,e.operation().then((function(t){i.id===e.lastUpdate.id&&(e.subject.next(t),e.consecutiveFailures=0)})).catch((function(r){n.globalErrorHandler.handleError(r,"my2Kq"),i.id===e.lastUpdate.id&&(e.consecutiveFailures++,e.consecutiveFailures>=e.maxFailures&&n.updates.delete(t))})).then((function(){i.complete()}))},e.MsPerSecond=1e3,e}(),Jo=function(e){function t(){return e.call(this)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(t){var n=t.split("?");n[0]=n[0].toLowerCase();var i=n.join("?").replace(/\+/g,"%20");return e.prototype.parse.call(this,i)},t.prototype.serialize=function(t){return e.prototype.serialize.call(this,t).replace(/%20/g,"+")},t}(q.c),Xo=n("tv+F"),$o=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r.localStorageService=i,r}return Object(s.__extends)(t,e),t.prototype.canActivate=function(e){var t=this.capabilitiesService.capabilities.bottomTrayEnabled?this.getStickyTab():void 0;return t?this.checkEnabledAndRedirect("home"===t,t,e.queryParams):this.checkEnabledAndRedirect(!0)},t.prototype.getStickyTab=function(){return this.router.navigated?void 0:this.localStorageService.get(di.LastBottomTrayTab)},t.ɵprov=i.cc({factory:function(){return new t(i.dc(q.n),i.dc(Z.a),i.dc(_t.a))},token:t,providedIn:"root"}),t}(Xo.a),ea=function(e){function t(t,n,i){var r=e.call(this,n,t)||this;return r.searchEnabled=t.capabilities.showSearch&&!!i.config,r}return Object(s.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.searchEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.searchEnabled)},t.ɵprov=i.cc({factory:function(){return new t(i.dc(Z.a),i.dc(q.n),i.dc(Ce.a))},token:t,providedIn:"root"}),t}(Xo.a),ta=function(e){function t(t,n,i){var r=e.call(this,i,n)||this;return r.appGalleryConfigService=t,r.appGalleryEnabled=!!r.appGalleryConfigService.config,r}return Object(s.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.appGalleryEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.appGalleryEnabled)},t.ɵprov=i.cc({factory:function(){return new t(i.dc(Tt.a),i.dc(Z.a),i.dc(q.n))},token:t,providedIn:"root"}),t}(Xo.a),na=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.spaceContentPageEnabled=i.capabilitiesService.capabilities.spacesEnabled&&!i.capabilitiesService.capabilities.renderSpaceAsFluid,i}return Object(s.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.spaceContentPageEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.spaceContentPageEnabled)},t.ɵprov=i.cc({factory:function(){return new t(i.dc(Z.a),i.dc(q.n))},token:t,providedIn:"root"}),t}(Xo.a),ia=function(e){function t(t,n,i){var r=e.call(this,n,t)||this;return r.unsupportedBrowsers=new Map,r.setupUnsupportedBrowsers(),r.fluidSupportEnabled=t.capabilities.fluidSupportEnabled,r.isSupportedBrowser=r.supportedBrowserCheck(i.getDeviceInfo()),r}return Object(s.__extends)(t,e),t.prototype.canActivate=function(){return this.isSupportedBrowser?this.checkEnabledAndRedirect(this.fluidSupportEnabled):this.checkEnabledAndRedirect(!1,"launch/fluid/unsupported",void 0,!0)},t.prototype.canLoad=function(){return this.isSupportedBrowser?this.checkEnabledAndRedirect(this.fluidSupportEnabled):this.checkEnabledAndRedirect(!1,"launch/fluid/unsupported",void 0,!0)},t.prototype.supportedBrowserCheck=function(e){var t=this.unsupportedBrowsers.get(e.browser.browserType);return!(null==t?void 0:t.includes(e.platform.platformType))},t.prototype.setupUnsupportedBrowsers=function(){this.unsupportedBrowsers.set(ue.a.Edge,[ue.d.Chromebook]),this.unsupportedBrowsers.set(ue.a.EdgeLegacy,[ue.d.PC,ue.d.Mac,ue.d.Chromebook,ue.d.iPhone,ue.d.iPad,ue.d.AndroidPhone,ue.d.AndroidTablet,ue.d.Linux]),this.unsupportedBrowsers.set(ue.a.Firefox,[ue.d.Chromebook]),this.unsupportedBrowsers.set(ue.a.Safari,[ue.d.PC,ue.d.Chromebook,ue.d.AndroidTablet,ue.d.AndroidPhone,ue.d.Linux]),this.unsupportedBrowsers.set(ue.a.IE,[ue.d.PC,ue.d.Mac,ue.d.Chromebook,ue.d.iPhone,ue.d.iPad,ue.d.AndroidPhone,ue.d.AndroidTablet,ue.d.Linux]),this.unsupportedBrowsers.set(ue.a.Opera,[ue.d.Chromebook]),this.unsupportedBrowsers.set(ue.a.WebView,[ue.d.PC,ue.d.Mac,ue.d.Chromebook,ue.d.iPhone,ue.d.iPad,ue.d.AndroidPhone,ue.d.AndroidTablet,ue.d.Linux])},t.ɵprov=i.cc({factory:function(){return new t(i.dc(Z.a),i.dc(q.n),i.dc(ue.b))},token:t,providedIn:"root"}),t}(Xo.a),ra=n("EUVs"),oa=function(e){function t(t,n,i){var r=e.call(this,n,t)||this;return r.wacContentService=i,r}return Object(s.__extends)(t,e),t.prototype.canActivate=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.wacContentService.bootstrapDocumentFromLoader(this.wacContentService.getDocumentInfoFromParams(e.queryParams,Te.a.fileTypeNameToFileType(e.params.app)),Date.now(),!0)];case 1:return t.sent(),[4,this.wacContentService.awaitUnblockedRouted()];case 2:return t.sent(),[2,this.checkEnabledAndRedirect(this.capabilitiesService.wacHostEnabled())]}}))}))},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.capabilitiesService.wacHostEnabled())},t.ɵprov=i.cc({factory:function(){return new t(i.dc(Z.a),i.dc(q.n),i.dc(ra.a))},token:t,providedIn:"root"}),t}(Xo.a),aa=function(e){function t(t,n,i,r,o,a){var l=e.call(this,i,t)||this;return l.shellService=n,l.urlLauncherService=r,l.workloadService=o,l.instrumentationService=a,l}return Object(s.__extends)(t,e),t.prototype.canActivate=function(e){return this.provisioningCheckHelper(e.data.fileType)},t.prototype.canLoad=function(e){return this.provisioningCheckHelper(e.data.fileType)},t.prototype.provisioningCheckHelper=function(e){var t=this,n=this.router.navigated?"_blank":"_self";return!!this.checkEnabledAndRedirect(this.capabilitiesService.capabilities.startPageApps.has(e))&&new Promise((function(i){t.shellService.checkInAppNavEnabled(e).then((function(r){r?t.shellService.getOdspProvisioningStatus(0,1e3).then((function(r){var o=e===Te.b.OneDrive?r.OneDriveUrl:r.SharepointUrl;o?(i(!1),t.instrumentationService.logGenericEvent("ODSP_Insta_Provisioned_Redirect"),t.urlLauncherService.openUrl(o,"ODSP_Redirect",n)):i(!0)})).catch((function(){i(!0)})):t.workloadService.getWorkloads().then((function(r){var o=r.find((function(t){return t.FileType===e}));t.urlLauncherService.openUrl(o.Url,"ODSP_Redirect",n),i(!1)}))}))}))},t.ɵprov=i.cc({factory:function(){return new t(i.dc(Z.a),i.dc(ut.a),i.dc(q.n),i.dc(ko.a),i.dc(dt.a),i.dc(T.a))},token:t,providedIn:"root"}),t}(Xo.a),la=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.createCenterEnabled=i.capabilitiesService.capabilities.createCenterEnabled,i}return Object(s.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.createCenterEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.createCenterEnabled)},t.ɵprov=i.cc({factory:function(){return new t(i.dc(Z.a),i.dc(q.n))},token:t,providedIn:"root"}),t}(Xo.a),sa=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.m365AppsNavigationEnabled=i.capabilitiesService.capabilities.leftNavReact&&i.capabilitiesService.capabilities.m365AppsEnabled,i}return Object(s.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.m365AppsNavigationEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.m365AppsNavigationEnabled)},t.ɵprov=i.cc({factory:function(){return new t(i.dc(Z.a),i.dc(q.n))},token:t,providedIn:"root"}),t}(Xo.a),ca=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.myContentPageEnabled=i.capabilitiesService.capabilities.myContentEnabled,i}return Object(s.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.myContentPageEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.myContentPageEnabled)},t.ɵprov=i.cc({factory:function(){return new t(i.dc(Z.a),i.dc(q.n))},token:t,providedIn:"root"}),t}(Xo.a),ua=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.spacesPageEnabled=i.capabilitiesService.capabilities.spacesEnabled,i}return Object(s.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.spacesPageEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.spacesPageEnabled)},t.ɵprov=i.cc({factory:function(){return new t(i.dc(Z.a),i.dc(q.n))},token:t,providedIn:"root"}),t}(Xo.a),da=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.templatesEnabled=t.capabilities.templatesEnabled&&t.capabilities.wacStartPageEnabled,i}return Object(s.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.templatesEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.templatesEnabled)},t.ɵprov=i.cc({factory:function(){return new t(i.dc(Z.a),i.dc(q.n))},token:t,providedIn:"root"}),t}(Xo.a),pa=n("OWzB"),ha=function(e){function t(t,n,i,r){var o=e.call(this,t,n)||this;return o.createDocumentService=i,o.instrumentationService=r,o.startEnabled=n.capabilities.wacStartPageEnabled,o}return Object(s.__extends)(t,e),t.prototype.canActivate=function(e){var t=e.queryParams["ms.url"];return t?this.checkAndNavigateToCreateNew(t,e.queryParams.templateId):this.checkEnabledAndRedirect(this.startEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.startEnabled)},t.prototype.checkAndNavigateToCreateNew=function(e,n){var i=this;return e=e.toLowerCase(),new Promise((function(r){var o=t.CREATE_NEW_REDIRECTS[e];if(o){var a=void 0;0===e.lastIndexOf("templates.")&&n&&(a={AssetId:n}),i.createDocumentService.createItem(o,null,a,(function(t){var n,o=((n={}).MsNewParam=e,n.Action=t&&t.type||"",n);t&&"Error"!==t.type&&"CreatePending"!==t.type?(i.instrumentationService.logGenericEvent("Create_New_Redirect_Success",o),r(!1)):(i.instrumentationService.logGenericEvent("Create_New_Redirect_Fail",o),r(!0))}),null,null,"_self")}}))},t.CREATE_NEW_REDIRECTS={"word.new":Te.b.Word,"templates.word.new":Te.b.Word,"powerpoint.new":Te.b.PowerPoint,"templates.powerpoint.new":Te.b.PowerPoint,"excel.new":Te.b.Excel,"templates.excel.new":Te.b.Excel,"sway.new":Te.b.Sway},t.ɵprov=i.cc({factory:function(){return new t(i.dc(q.n),i.dc(Z.a),i.dc(pa.a),i.dc(T.a))},token:t,providedIn:"root"}),t}(Xo.a),fa={fileType:Te.b.SharePoint},ma={fileType:Te.b.OneDrive},ba=function(){return function(){}}(),va=function(){function e(){}return e.prototype.shouldReuseRoute=function(e,t){return e.routeConfig===t.routeConfig&&e.paramMap.get("app")===t.paramMap.get("app")&&e.paramMap.get("spaceId")===t.paramMap.get("spaceId")&&e.paramMap.get("appId")===t.paramMap.get("appId")&&e.paramMap.get("entityId")===t.paramMap.get("entityId")&&e.paramMap.get("subEntityId")===t.paramMap.get("subEntityId")},e.prototype.shouldDetach=function(e){return!1},e.prototype.store=function(e,t){},e.prototype.shouldAttach=function(e){return!1},e.prototype.retrieve=function(e){return null},e}(),ga=n("xIlw"),ya=n("+a0u"),Sa=n("lQwO"),wa=n("sCgQ"),Ca=n("izKO"),Ia=n("D6F8"),Ta=n("+5ti"),ka=n("+P5Z"),Aa=n("CfLe"),Pa=n("ej7j"),Ea=n("VY7U"),_a=n("GPFm"),Oa=new i.q("INSTRUMENTATION_QUEUE"),Fa=n("AXqk"),Da=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),Object.defineProperty(t.prototype,"securityLevel",{get:function(){return 3},enumerable:!0,configurable:!0}),t}(Fa.a),Ma=function(){return function(){}}(),Ra=n("EuUe"),xa=function(){return function(){}}(),La=n("+I3G"),Na=n("Bmgn"),Ua=n("32VK"),Wa=n("L9A/"),Ba=n("T6pR"),za=n("T/SX"),ja=n("up2P"),Ha=n("D8EG"),Va=n("cxfp"),qa=n("9InZ"),Ga=n("upmJ"),Za=n("ci1G"),Qa=n("M3TP"),Ka=n("XQbr"),Ya=function(){return function(){}}(),Ja=n("vW6f"),Xa=i.wb(ge,[Ve],(function(e){return i.Lb([i.Mb(512,i.j,i.Z,[[8,[qe.a,wn,ir]],[3,i.j],i.x]),i.Mb(5120,q.a,q.z,[q.n]),i.Mb(4608,q.f,q.f,[]),i.Mb(6144,q.i,null,[q.f]),i.Mb(135680,q.q,q.q,[q.n,i.w,i.i,i.r,q.i]),i.Mb(4608,q.h,q.h,[]),i.Mb(5120,q.E,q.v,[q.n,Ge.s,q.j]),i.Mb(5120,q.k,q.C,[q.A]),i.Mb(5120,B.a,cr,[or,i.m]),i.Mb(5120,i.b,(function(e,t,n,i){return[e,ur(t,n,i),fe()]}),[q.k,i.r,B.a,p.b]),i.Mb(5120,i.u,i.mb,[[3,i.u]]),i.Mb(4608,Ge.m,Ge.l,[i.u]),i.Mb(4608,N.b,gr,[G,W.a,Z.a,U.a,j.a,B.a,l.b,T.a,vr,d.b,xe.a,Ne.a,mr.a,Re.a,p.b]),i.Mb(4608,yr.a,Ee,[N.b,W.a,T.a,U.a,G,u.a,Pe,B.a,l.b,Ae.a]),i.Mb(5120,Sr.a,Ir,[Z.a,wr.a,Cr.a]),i.Mb(5120,i.pb,i.nb,[i.z]),i.Mb(5120,i.c,i.jb,[]),i.Mb(5120,i.s,i.kb,[]),i.Mb(5120,i.t,i.lb,[]),i.Mb(4608,yi.b,yi.l,[Ge.d]),i.Mb(6144,i.G,null,[yi.b]),i.Mb(4608,yi.e,yi.g,[]),i.Mb(5120,yi.c,(function(e,t,n,i,r,o,a,l){return[new yi.j(e,t,n),new yi.o(i),new yi.n(r,o,a,l)]}),[Ge.d,i.z,i.B,Ge.d,Ge.d,yi.e,i.ab,[2,yi.f]]),i.Mb(4608,yi.d,yi.d,[yi.c,i.z]),i.Mb(135680,yi.m,yi.m,[Ge.d]),i.Mb(4608,yi.k,yi.k,[yi.d,yi.m,i.c]),i.Mb(5120,ce.a,he,[p.b]),i.Mb(5120,ce.c,Pr.e,[]),i.Mb(4608,ce.b,Pr.d,[Ge.d,ce.a,ce.c]),i.Mb(5120,i.E,Pr.f,[yi.k,ce.b,i.z]),i.Mb(6144,yi.p,null,[yi.m]),i.Mb(4608,i.M,i.M,[i.z]),i.Mb(4608,Er.b,Pr.c,[i.E,Ge.d]),i.Mb(5120,_r,Dr,[W.a,tn.a,Lr.a,Z.a]),i.Mb(4608,Nr.n,Nr.t,[Ge.d,i.B,Nr.r]),i.Mb(4608,Nr.u,Nr.u,[Nr.n,Nr.s]),i.Mb(5120,g.a,zr,[d.b,i.B,Vr.a]),i.Mb(5120,v.a,qr,[m.a,g.a]),i.Mb(5120,Zr.a,jr,[p.b,Jr]),i.Mb(4608,Xr.a,eo,[$r.a]),i.Mb(5120,Nr.a,(function(e,t,n,i,r,o,a,l,s,c,u,d){return[e,new no(t),new X.a(n,i,r,o),new co(a,l,s,c,u),new vo(d)]}),[Nr.u,v.a,v.a,Zr.a,b.a,l.b,$r.a,so,Zr.a,v.a,[2,Xr.a],bo]),i.Mb(4608,Nr.q,Nr.q,[]),i.Mb(6144,Nr.o,null,[Nr.q]),i.Mb(4608,Nr.m,Nr.m,[Nr.o]),i.Mb(6144,Nr.b,null,[Nr.m]),i.Mb(4608,Nr.h,Nr.p,[Nr.b,i.r]),i.Mb(4608,Nr.c,Nr.c,[Nr.h]),i.Mb(4608,Pt.a,go,[]),i.Mb(4608,yo.a,So,[]),i.Mb(4608,wo.a,Co,[]),i.Mb(4608,Io,To,[]),i.Mb(6144,ko.a,null,[Ao]),i.Mb(4608,dt.a,_o,[ht,Z.a,B.a,W.a,Rn.a,l.b,p.b,yr.a,Ae.a,Oe.a]),i.Mb(4608,Oo.a,No,[Z.a,p.b,W.a,c.a,T.a,k.b,Mo.a,Cr.a,De.a,d.b,Lo]),i.Mb(5120,f,(function(e,t,n,i,r,o,a,l,s,c,u,d,p){return[new Uo(e,t,n,i,r,o,a),new Wo(l),new zo(s,c,u,d,p)]}),[l.b,W.a,v.a,Zr.a,d.b,u.a,p.b,v.a,i.m,W.a,T.a,v.a,Bo]),i.Mb(4608,jo.a,jo.a,[Re.a]),i.Mb(4608,Ho.a,Ho.a,[Rn.a,Re.a,Vo.a]),i.Mb(4608,qo.a,qo.a,[Ge.d,i.B]),i.Mb(5120,Go.a,be,[]),i.Mb(5120,Zo.a,ve,[p.b,ue.b,i.z]),i.Mb(4608,Qo.a,Yo,[W.a,l.b,H.a]),i.Mb(1024,q.t,q.x,[[3,q.n]]),i.Mb(512,q.s,Jo,[]),i.Mb(512,q.b,q.b,[]),i.Mb(256,Ge.a,"/",[]),i.Mb(256,q.j,{enableTracing:!1,initialNavigation:!1,useHash:!1},[]),i.Mb(1024,Ge.h,q.w,[Ge.q,[2,Ge.a],q.j]),i.Mb(512,Ge.g,Ge.g,[Ge.h,Ge.q]),i.Mb(512,i.i,i.i,[]),i.Mb(512,i.w,i.J,[i.i,[2,i.K]]),i.Mb(1024,q.l,(function(){return[[{path:"",component:fn,canActivate:[$o]},{path:"home",redirectTo:""},{path:"search",loadChildren:"./search-results/search-results.module#SearchResultsModule",canActivate:[ea],canLoad:[ea]},{outlet:"install-wizard",path:"",children:[{path:"open",loadChildren:"./install/install-wizard/install-wizard.module#InstallWizardModule"}]},{path:"apps",loadChildren:"./app-gallery/app-gallery.module#AppGalleryModule",canActivate:[ta],canLoad:[ta]},{path:"spaces/:spaceId",loadChildren:"./space-content/space-content.module#SpaceContentModule",canActivate:[na],canLoad:[na]},{path:"launch/fluid/content",children:[],canActivate:[ia],canLoad:[ia]},{path:"launch/fluid/unsupported",loadChildren:"./fluid-unsupported-page/fluid-unsupported-page.module#FluidUnsupportedPageModule"},{path:"launch/:app/content",loadChildren:"./wac-content/wac-content.module#WacContentModule",canActivate:[oa],canLoad:[oa]},{path:"launch/sharepoint",loadChildren:"./odsp-start/sharepoint-start/sharepoint-start.module#SharePointStartModule",canActivate:[aa],canLoad:[aa],data:fa},{path:"launch/onedrive",loadChildren:"./odsp-start/onedrive-start/onedrive-start.module#OnedriveStartModule",canActivate:[aa],canLoad:[aa],data:ma},{path:"launch/:app",loadChildren:"./wac-start/wac-start.module#WacStartModule",canActivate:[ha],canLoad:[ha]},{path:"template/:app",loadChildren:"./templates/templates.module#TemplatesModule",canActivate:[da],canLoad:[da]},{path:"m365apps",loadChildren:"./m365-apps/m365-apps.module#M365AppsModule",canActivate:[sa],canLoad:[sa]},{path:"create",loadChildren:"./create-center/create-center.module#CreateCenterModule",canActivate:[la],canLoad:[la]},{path:"spaces",loadChildren:"./spaces/spaces.module#SpacesModule",canActivate:[ua],canLoad:[ua]},{path:"mycontent",loadChildren:"./my-content/my-content.module#MyContentModule",canActivate:[ca],canLoad:[ca]}]]}),[]),i.Mb(512,q.m,va,[]),i.Mb(1024,q.n,q.y,[q.s,q.b,Ge.g,i.r,i.w,i.i,q.l,q.j,[2,q.r],[2,q.m]]),i.Mb(1073742336,q.o,q.o,[[2,q.t],[2,q.n]]),i.Mb(1073742336,ba,ba,[]),i.Mb(1073742336,Ge.c,Ge.c,[]),i.Mb(1073742336,ga.a,ga.a,[]),i.Mb(1073742336,ya.a,ya.a,[]),i.Mb(1073742336,Sa.a,Sa.a,[]),i.Mb(1073742336,wa.a,wa.a,[]),i.Mb(1073742336,Ca.a,Ca.a,[]),i.Mb(1073742336,Ia.a,Ia.a,[]),i.Mb(1073742336,rt.a,rt.a,[]),i.Mb(1073742336,Ta.b,Ta.b,[]),i.Mb(1073742336,It.g,It.g,[]),i.Mb(1073742336,ka.a,ka.a,[]),i.Mb(1073742336,Aa.a,Aa.a,[]),i.Mb(1073742336,Pa.a,Pa.a,[]),i.Mb(1073742336,Ea.a,Ea.a,[]),i.Mb(1073742336,_a.a,_a.a,[]),i.Mb(1073742336,Ar,Ar,[]),i.Mb(1024,Oa,me,[]),i.Mb(512,Fa.a,Da,[]),i.Mb(512,T.a,R.a,[[2,Oa],Fa.a,ue.b]),i.Mb(512,i.m,l.b,[T.a,d.b]),i.Mb(512,q.A,q.A,[i.r]),i.Mb(1024,i.y,(function(){return[q.u()]}),[]),i.Mb(1024,or,lr,[d.b]),i.Mb(1024,i.d,(function(e,t,n){return[q.B(e),yi.q(t),sr(n)]}),[q.A,[2,i.y],or]),i.Mb(512,i.e,i.e,[[2,i.d]]),i.Mb(131584,i.g,i.g,[i.z,i.ab,i.r,i.m,i.j,i.e]),i.Mb(1073742336,i.f,i.f,[i.g]),i.Mb(1073742336,yi.a,yi.a,[[3,yi.a]]),i.Mb(1073742336,Pr.b,Pr.b,[]),i.Mb(1073742336,Ma,Ma,[]),i.Mb(1073742336,xr,xr,[]),i.Mb(1073742336,Ra.a,Ra.a,[]),i.Mb(1073742336,xa,xa,[]),i.Mb(1073742336,La.b,La.b,[]),i.Mb(1073742336,Na.a,Na.a,[]),i.Mb(1073742336,Ua.a,Ua.a,[]),i.Mb(1073742336,Wa.a,Wa.a,[]),i.Mb(1073742336,Ba.a,Ba.a,[]),i.Mb(1073742336,za.a,za.a,[]),i.Mb(1073742336,ja.a,ja.a,[]),i.Mb(1073742336,Ha.a,Ha.a,[]),i.Mb(1073742336,Va.a,Va.a,[]),i.Mb(1073742336,qa.a,qa.a,[]),i.Mb(1073742336,Ga.a,Ga.a,[]),i.Mb(1073742336,Za.a,Za.a,[]),i.Mb(1073742336,Qa.a,Qa.a,[]),i.Mb(1073742336,Ka.a,Ka.a,[]),i.Mb(1073742336,Nr.e,Nr.e,[]),i.Mb(1073742336,Nr.d,Nr.d,[]),i.Mb(1073742336,Ya,Ya,[]),i.Mb(1073742336,Gr,Gr,[]),i.Mb(1073742336,Hr,Hr,[]),i.Mb(1073742336,dr,dr,[]),i.Mb(1073742336,ge,ge,[]),i.Mb(256,i.k,i.ob,[]),i.Mb(256,i.cb,"root",[]),i.Mb(256,Pr.a,"BrowserAnimations",[]),i.Mb(256,mo,Fr,[]),i.Mb(256,fo,Mr,[]),i.Mb(256,ho,Rr,[]),i.Mb(256,Nr.r,"XSRF-TOKEN",[]),i.Mb(256,Nr.s,"X-XSRF-TOKEN",[]),i.Mb(256,Ja.a,50,[]),i.Mb(256,y.a,"officehome",[])])}));try{window.ohpAppBundleParsingSuccessFlag=!0;var $a=function(){return yi.i().bootstrapModuleFactory(Xa,{preserveWhitespaces:!1})};Object(a.a)()?function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,t,n,i,r,o,a,l,c,u,d,p,h,f;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,20,,22]),function(e,t){void 0===t&&(t=[]),new URLSearchParams(window.location.search).forEach((function(n,i){t.includes(i)||e.searchParams.set(i,n)}))}(e=new URL(window.location.origin+"/api/identity")),[4,fetch(e.toString())];case 1:return(t=s.sent()).ok?[3,3]:[4,ae()];case 2:return s.sent(),[2];case 3:return[4,t.json()];case 4:return n=s.sent(),i=n.puid,r=n.encryptionConfig,[4,te(window.crypto.subtle,n.tenantId+"_"+i,r.digestSaltBase64,(function(e){return Object(ne.b)(e,window)}))];case 5:return[4,se(o=s.sent(),"cache-only",i)];case 6:if(!(a=s.sent()))return[3,14];s.label=7;case 7:return s.trys.push([7,13,,14]),[4,a.arrayBuffer()];case 8:return l=s.sent(),(c=Object(ie.b)(new Uint8Array(l)))?[4,Object(oe.a)(r.cryptoKey,window.crypto.subtle)]:[3,12];case 9:return u=s.sent(),[4,Object(re.a)(c,u,window.crypto,(function(e){return Object(ne.a)(e,window)}))];case 10:return d=s.sent(),[4,new Response(d.body,{headers:new Headers(JSON.parse(d.headers)),status:d.status,statusText:d.statusText}).json()];case 11:f=s.sent(),window.shellAndConfigResponse=Promise.resolve(f),s.label=12;case 12:return[3,14];case 13:return s.sent(),a=null,[3,14];case 14:return p=se(o,"network-first",i),a?[3,19]:[4,p];case 15:return(h=s.sent())?[3,17]:[4,ae()];case 16:return s.sent(),[3,19];case 17:return[4,h.json()];case 18:f=s.sent(),window.shellAndConfigResponse=Promise.resolve(f),s.label=19;case 19:return document.getElementById("splash-screen").remove(),[3,22];case 20:return s.sent(),[4,ae()];case 21:return s.sent(),[3,22];case 22:return[2]}}))}))}().then($a).then(J).catch(ae):(function(){(_=Object(p.c)()).angularDebugInfoEnabled||Object(i.T)(),P=k.a.now()}(),$a().then(J).catch((function(e){return A(e,Object(p.c)())})))}catch(e){Object(a.a)()?ae():A(e,Object(p.c)())}},hZW2:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("keVe"),r=n("dFxn"),o=function(){function e(e){this.configParserService=e}return e.prototype.getConfig=function(){return this.config||(this.config=this.configParserService.parse("documentConfig")),this.config||{mockUploadFile:null}},e.ɵprov=i.cc({factory:function(){return new e(i.dc(r.a))},token:e,providedIn:"root"}),e}(),a=function(){function e(e){this.documentConfigService=e}return e.prototype.addScriptToPage=function(e,t,n,i,r,o){void 0===i&&(i=!1),void 0===o&&(o=!1);var a=this.getDocument();if(a)if(this.findScript(r))t&&t();else{var l=a.createElement("script");if(l.src=e,l.id=r,t&&(l.onload=t),n&&(l.onerror=n),i){var s=a.getElementsByTagName("script")[0];if(s&&s.parentNode)return void s.parentNode.insertBefore(l,s)}o&&(l.crossOrigin="anonymous"),a.body.appendChild(l)}},e.prototype.addIframeToPage=function(e,t){if(e||t){var n=this.getDocument();if(!(!n||t&&n.getElementById(t)||n.querySelector('iframe[src="'+e+'"]'))){var i=n.createElement("iframe");e&&i.setAttribute("src",e),t&&(i.id=t),i.style.display="none",n.body.appendChild(i)}}},e.prototype.selectFile=function(t){var n=this;this.selectFilePromiseRejector&&this.selectFilePromiseRejector();var i=this.getDocument();this.fileInputElement&&i.body.removeChild(this.fileInputElement);var r=this.documentConfigService.getConfig().mockUploadFile;if(r){var o=this.createMockFileList(r.name,r.size);return Promise.resolve(o)}return this.fileInputElement=i.createElement("input"),this.fileInputElement.type="file",this.fileInputElement.id=e.fileInputId,this.fileInputElement.accept=t.join(","),i.body.appendChild(this.fileInputElement),new Promise((function(e,t){n.selectFilePromiseRejector=t;var r=function(o){var a=o.target.files;a&&a.length?e(a):t(),n.selectFilePromiseRejector=null,n.fileInputElement&&(n.fileInputElement.removeEventListener("change",r),i.body.removeChild(n.fileInputElement),n.fileInputElement=null)};n.fileInputElement.addEventListener("change",r),n.fileInputElement.click()}))},e.prototype.updateFavicon=function(e){this.addOrUpdateLink(e,"shortcut icon","image/x-icon",'link[rel="shortcut icon"]')},e.prototype.addOrUpdateStylesheet=function(e,t){this.addOrUpdateLink(e,"stylesheet","text/css","#"+t,t)},e.prototype.addCssClassToElement=function(e,t){e&&e.classList.add(t)},e.prototype.removeCssClassFromElement=function(e,t){e&&e.classList.remove(t)},e.prototype.addOrUpdateStyleTag=function(e,t){var n=this.getDocument();if(n){var i=n.getElementById(e);i&&i.parentNode&&i.parentNode.removeChild(i),(i=n.createElement("style")).id=e,i.type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(n.createTextNode(t)),n.head.appendChild(i)}},e.prototype.addLinkTag=function(e){var t=this.getDocument();if(t){var n=t.createElement("link");e.forEach((function(e,t){return n.setAttribute(t,e)})),t.head.appendChild(n)}},e.prototype.appendHTMLToElement=function(e,t){e&&t&&e.insertAdjacentHTML("beforeend",t)},e.prototype.getOffset=function(e){var t=(e instanceof i.l?e.nativeElement:e).getBoundingClientRect();return{top:t.top+this.nativeDocument.body.scrollTop,left:t.left+this.nativeDocument.body.scrollLeft}},e.prototype.disableTouchMove=function(){this.getDocument().addEventListener("touchmove",this.preventDefault,{passive:!1})},e.prototype.enableTouchMove=function(){this.getDocument().removeEventListener("touchmove",this.preventDefault)},e.prototype.updateThemeColor=function(e){var t=this.getDocument();if(t){var n=t.querySelector('meta[name="theme-color"]');if(n)n.content!==e&&(n.content=e);else{var i=t.createElement("meta");i.name="theme-color",i.content=e,t.head.appendChild(i)}}},e.prototype.preventDefault=function(e){e.preventDefault()},Object.defineProperty(e.prototype,"nativeDocument",{get:function(){return this.getDocument()},enumerable:!0,configurable:!0}),e.prototype.getDocument=function(){return document},e.prototype.findScript=function(e){if(!e)return!1;var t=this.getDocument();return!!t&&!!t.getElementById(e)},e.prototype.addOrUpdateLink=function(e,t,n,i,r){if(e){var o=this.getDocument();if(o){var a=o.querySelector(i);a?a.href!==e&&(a.href=e):((a=o.createElement("link")).rel=t,a.type=n,a.href=e,r&&(a.id=r),o.head.appendChild(a))}}},e.prototype.createMockFileList=function(e,t){var n=new Blob([new Uint8Array(t)],{type:""});return n.name=e,[n]},e.fileInputId="select-file",e.ɵprov=i.cc({factory:function(){return new e(i.dc(o))},token:e,providedIn:"root"}),e}()},hhzZ:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return l}));var i=n("31lE"),r=function(){function e(){}return e.FirsttimeReferral="First time",e.ResurrectedReferral="Resurrected",e.RepeatReferral="Repeat",e.NotDetected="NotDetected",e}(),o=function(){function e(){}return e.AllMyDocuments="AllMyDocuments",e.AppCategory="AppCategory",e.AppGalleryHero="AppGalleryHero",e.AppList="AppList",e.AppTiles="AppTiles",e.BackstageMru="BackstageMru",e.Banner="Banner",e.Calendar="Calendar",e.CreateCenter="CreateCenter",e.CreateFlyOut="CreateFlyOut",e.CreateGallery="CreateGallery",e.CreateModal="CreateModal",e.Documents="Documents",e.DocumentTitleComponent="DocumentTitleComponent",e.Edgeworth="Edgeworth",e.EnterpriseTemplates="EnterpriseTemplates",e.ErrorDialog="ErrorDialog",e.FeaturedDocs="FeaturedDocs",e.Feedback="Feedback",e.FirstRun="FirstRun",e.FluidContent="FluidContent",e.Folders="Folders",e.FormsGroups="FormsGroups",e.Hero="Hero",e.Incremental="Incremental",e.InputDialog="InputDialog",e.InstallWizard="InstallWizard",e.LeftNav="LeftNav",e.LeftNavCallout="LeftNavCallout",e.MobileAppBanner="MobileAppBanner",e.PeopleCard="PeopleCard",e.PwaDialog="PwaDialog",e.Recommended="Recommended",e.SearchResults="SearchResults",e.SearchSuggestions="SearchSuggestions",e.Shell="Shell",e.SideMenu="SideMenu",e.Sites="Sites",e.SuggestedActions="SuggestedActions",e.Templates="Templates",e.UploadDialog="UploadDialog",e.Upsell="Upsell",e}(),a=function(){return function(e,t){void 0===t&&(t=i.AWTPiiKind.GenericData),this.value=e,this.kind=t}}(),l=function(){function e(){}return e.filterPii=function(e){return e?(e.replace("\n","").replace("\r","").replace("\t","").replace("\b",""),e.replace(this.emailRegex,"email_removed").replace(this.localFileRegex,"file_removed").replace(this.searchQueryRegex,"$1query_removed")):e},e.emailRegex=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,63}","gm"),e.localFileRegex=new RegExp("file(:|%3A|%253A).*","gim"),e.searchQueryRegex=new RegExp("([&?]q=)(.+?)(?=[&].*| |, |$)","gmi"),e}()},hoyd:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"iX+N":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("wacStartPageConfig")||{featuredDocumentsEnabled:!1,maxInitialDocuments:0,maxTotalDocuments:0,startPageNumTemplatesToShow:0,visioMoreTemplatesUrl:null,moreTemplatesRedirectionEnabled:!1,streamCrossLinkUrl:null,streamDocumentationUrl:null,resources:null}}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},idgT:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("bb6g"),r=n("zvoD"),o=n("3Vsh"),a=n("BaAg"),l=n("dFxn"),s=n("hZW2"),c=n("7Gwk"),u=n("/I02"),d=n("uWZl"),p=n("ZBli"),h=n("keVe"),f=function(){function e(t,n,i,r){var o=this;this.configParserService=t,this.contextService=n,this.documentService=i,this.eventService=r;var l=this.configParserService.parse(e.configElementId);this.config=l||{createLcidEnabled:!1,enterpriseTemplatesEnabled:!1,exploreTemplatesUrlFormat:null,exploreTemplatesUrlLocale:null,numTemplates:0,numVisioTemplates:0,premiumTemplatesDiamondCorner:null,premiumTemplatesUpsellEnabled:!1,sharePointAuthFrameUrl:null,templatesApiEndpoint:null,excelOrgTemplatesEnabled:!1,templatesFormsEnabled:!1,createTemplatesEnabled:!1,wordOrgTemplatesEnabled:!1,templatesRecommendedApps:[],templatesCollectionsCommercial:[],templatesCollectionsConsumer:[],templatesCollectionsEdu:[],templatesRecommendedApiEnabled:!1,visioUnsupportedTemplatesLocales:[]},this.commonResources=l&&l.appResources?l.appResources.common:{},this.resourceVariants=new Map,l&&l.appResources&&l.appResources.variants&&l.appResources.variants.forEach((function(e){var t=a.a.fileTypeNameToFileType(e.app);t&&o.resourceVariants.set(t,e.resources)})),this.resourceMap=new Map}return e.prototype.resources=function(e){void 0===e&&(e=a.b.Word);var t=a.a.fileTypeToApp(e);if(this.resourceMap.has(t))return this.resourceMap.get(t);if(!this.resourceVariants.has(t))return this.commonResources;var n=this.resourceVariants.get(t),r=Object(i.__assign)(Object(i.__assign)({},this.commonResources),n);return this.resourceMap.set(t,r),r},e.prototype.getTemplatesInfoPromise=function(){var e=this;if(!this.templatesInfoPromise){var t=this.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return"primaryTokensLoaded"===e.name})),Object(o.a)(1)).toPromise(),n=d.a.fullPageReady();this.templatesInfoPromise=Promise.race([t,n]).then((function(){return e.configParserService.parse("templatesInfo")}))}return this.templatesInfoPromise},e.prototype.prefetchStaticResources=function(e){var t=this.resources(e);(null==t?void 0:t.PrefetchUrl)&&this.documentService.addIframeToPage(p.a.appendQueryParam(t.PrefetchUrl,"ui",this.contextService.sharedContext.officeMarket))},e.configElementId="templatesPageConfig",e.ɵprov=h.cc({factory:function(){return new e(h.dc(l.a),h.dc(u.a),h.dc(s.a),h.dc(c.a))},token:e,providedIn:"root"}),e}()},izKO:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"j7b/":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o}));var i=864e5,r=7*i,o=30*i},jCfB:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),function(e){e.ItemId="item",e.DriveId="drive",e.DocUrl="file",e.ContentUri="contenturi",e.NewFile="newfile",e.BootId="bootid",e.Nav="nav"}(i||(i={}));var r="WacContent_Document_Boot_Diagnostics"},jP3p:function(e,t,n){},jrGV:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("2dXW"),r=n("zvoD"),o=n("f0qX"),a=n("keVe"),l=function(){function e(){this.actionContextMenu=new i.a}return e.prototype.closeMenu=function(e){this.updateNext(e,0)},e.prototype.openMenu=function(e){this.updateNext(e,1)},e.prototype.subscribeToCloseEvents=function(e){return this.actionContextMenu.asObservable().pipe(Object(r.a)((function(e){return e&&0===e.type})),Object(o.a)((function(e){return{id:e.id,itemIndex:e.itemIndex,actions:e.actions,groupInfo:e.groupInfo,mouseEvent:e.mouseEvent,targetElement:e.targetElement}}))).subscribe(e)},e.prototype.subscribeToOpenEvents=function(e){return this.actionContextMenu.asObservable().pipe(Object(r.a)((function(e){return e&&1===e.type})),Object(o.a)((function(e){return{id:e.id,itemIndex:e.itemIndex,actions:e.actions,groupInfo:e.groupInfo,mouseEvent:e.mouseEvent,targetElement:e.targetElement}}))).subscribe(e)},e.prototype.updateNext=function(e,t){e&&this.actionContextMenu.next({type:t,id:e.id,itemIndex:e.itemIndex,actions:e.actions,groupInfo:e.groupInfo,mouseEvent:e.mouseEvent,targetElement:e.targetElement})},e.ɵprov=a.cc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},jsgn:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("bb6g");function r(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){return[2,t.importKey("jwk",e,"AES-GCM",!1,["encrypt","decrypt"])]}))}))}},"k+kJ":function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o}));var i,r,o,a=n("bb6g"),l=n("AlWG"),s=n("Uqr9"),c=n("IAGz"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t}(function(){function e(e,t,n,r,o,a,u,d,p){void 0===r&&(r=null),void 0===o&&(o=0),void 0===a&&(a=i.Started),void 0===u&&(u=null),void 0===d&&(d=null),void 0===p&&(p=null),this.sessionId=e,this.file=t,this.uploadSource=n,this.cancellationToken=r,this.bytesUploaded=o,this.state=a,this.error=u,this.sessionUrl=d,this.markCompletedAndOpenedInOfficeHome=p,this.startTime=s.a.now(),this.fileSize=t.size,this.lastLoaded=o,this.progress=new l.a(this.progressState()),this.cancellationToken=r||new c.a}return e.prototype.finished=function(){return this.state===i.Completed||this.state===i.Cancelled||this.state===i.Failed||this.state===i.CompletedAndOpened},e.prototype.updateProgress=function(e){void 0!==e&&(this.lastLoaded=Math.min(Math.max(this.lastLoaded,e),this.fileSize),this.progress.next(this.progressState()))},e.prototype.getProgress=function(){return this.progress.asObservable()},Object.defineProperty(e.prototype,"duration",{get:function(){return s.a.now()-this.startTime},enumerable:!0,configurable:!0}),e.prototype.progressState=function(){return{percentage:Math.floor(100*this.lastLoaded/this.fileSize),loaded:this.lastLoaded,total:this.fileSize}},e}());!function(e){e[e.Unknown=0]="Unknown",e[e.Started=1]="Started",e[e.Completed=2]="Completed",e[e.CompletedAndOpened=3]="CompletedAndOpened",e[e.Cancelled=4]="Cancelled",e[e.Failed=5]="Failed"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.FileTooLarge=1]="FileTooLarge",e[e.OutOfSpace=2]="OutOfSpace",e[e.InvalidFileType=3]="InvalidFileType",e[e.BadConnection=4]="BadConnection",e[e.Timeout=5]="Timeout",e[e.Auth=6]="Auth",e[e.MultipleFiles=7]="MultipleFiles"}(r||(r={})),function(e){e[e.Button=0]="Button",e[e.DragAndDrop=1]="DragAndDrop",e[e.CreateMenu=2]="CreateMenu"}(o||(o={}))},kJkW:function(e,t,n){var i={"../app-gallery/app-gallery.module.ngfactory":["6nNX",61],"../create-center/create-center.module.ngfactory":["V4ay",6,0,1,7,8,9,10,12,13,15,18,16,22,28,32,33,34,35,503,155],"../fluid-unsupported-page/fluid-unsupported-page.module.ngfactory":["OZAL",5,181],"../home/home.module.ngfactory":["tGFC",272],"../install/install-wizard/install-wizard.module.ngfactory":["MPfF",450],"../m365-apps/m365-apps.module.ngfactory":["S91J",5,6,0,1,7,29,42,43,51,455],"../my-content/my-content.module.ngfactory":["+ilh",6,0,1,7,8,9,10,12,11,13,14,15,2,18,16,20,19,3,22,456],"../odsp-start/onedrive-start/onedrive-start.module.ngfactory":["1TjK",5,463],"../odsp-start/sharepoint-start/sharepoint-start.module.ngfactory":["MxpO",5,464],"../search-results/search-results.module.ngfactory":["+OTV",6,27,522,26,478],"../space-content/space-content.module.ngfactory":["hAWa",5,6,0,1,7,8,9,10,12,13,2,17,16,19,21,52,526,484],"../spaces/spaces.module.ngfactory":["3nf6",5,6,0,1,7,8,9,10,12,13,2,17,19,21,52,527,485],"../templates/templates.module.ngfactory":["+eAU",31,46,494],"../wac-content/wac-content.module.ngfactory":["005W",5,56],"../wac-start/wac-start.module.ngfactory":["DLYR",38,31,46,532],"./app-gallery/app-gallery.module.ngfactory":["6nNX",61],"./create-center/create-center.module.ngfactory":["V4ay",6,0,1,7,8,9,10,12,13,15,18,16,22,28,32,33,34,35,503,155],"./fluid-unsupported-page/fluid-unsupported-page.module.ngfactory":["OZAL",5,181],"./install/install-wizard/install-wizard.module.ngfactory":["MPfF",450],"./m365-apps/m365-apps.module.ngfactory":["S91J",5,6,0,1,7,29,42,43,51,455],"./my-content/my-content.module.ngfactory":["+ilh",6,0,1,7,8,9,10,12,11,13,14,15,2,18,16,20,19,3,22,456],"./odsp-start/onedrive-start/onedrive-start.module.ngfactory":["1TjK",5,463],"./odsp-start/sharepoint-start/sharepoint-start.module.ngfactory":["MxpO",5,464],"./officeforms/group-forms.module.ngfactory":["2wU0",23,467],"./officeforms/my-forms.module.ngfactory":["1YR/",5,23,468],"./search-results/search-results.module.ngfactory":["+OTV",6,27,522,26,478],"./space-content/space-content.module.ngfactory":["hAWa",5,6,0,1,7,8,9,10,12,13,2,17,16,19,21,52,526,484],"./spaces/spaces.module.ngfactory":["3nf6",5,6,0,1,7,8,9,10,12,13,2,17,19,21,52,527,485],"./templates/templates.module.ngfactory":["+eAU",31,46,494],"./wac-content/wac-content.module.ngfactory":["005W",5,56],"./wac-start/wac-start.module.ngfactory":["DLYR",38,31,46,532],"action-context-menu-react.ngfactory":["JJsp",6,8,9,12,13,18,32,59],"appbar.ngfactory":["fdWd",0,1,7,12,13,2,18,22,501,62],"auto-suggest.ngfactory":["tDVW",6,27,26,63],"banner.ngfactory":["QOI9",5,65],"bread-crumb.ngfactory":["PaRP",5,6,27,26,66],"calendar.ngfactory":["q48a",23,67],"confirmation-dialog-react.ngfactory":["uaMB",6,0,1,7,8,9,10,12,13,504,157],"context-menu.ngfactory":["aBzG",158],"create-menu.ngfactory":["EA+W",5,31,162],"create-onenote-page-dialog-react.ngfactory":["uENI",6,0,1,7,33,505,163],"create-spaces-dialog-react.ngfactory":["PY03",6,0,1,7,8,9,10,12,11,13,14,17,20,21,24,36,506,165],"edgeworth.ngfactory":["MZ9O",5,38,509,168],"error-dialog-react.ngfactory":["Lpnb",6,0,7,8,9,10,510,172],"error-dialog.ngfactory":["oDVq",5,171],"ew-react.ngfactory":["cjNM",6,0,1,7,8,9,10,12,11,13,14,15,2,18,16,20,3,22,24,173],"feature-callout.ngfactory":["6lH3",176],"feature-tooltip-container.ngfactory":["Vbec",177],"feedback.ngfactory":["UHVx",5,178],"file-card.ngfactory":["Olmx",6,8,9,10,15,17,16,19,21,25,39,40,34,41,48,175],"file-picker-modal.ngfactory":["Vhng",5,6,8,9,10,15,17,16,19,21,25,39,40,34,41,48,513,271],"first-run.ngfactory":["AzcM",179],"fluent-theme-provider.ngfactory":["wMw5",12,13,269],"fluid-content.ngfactory":["4Tvn",5,6,8,9,10,17,19,25,42,39,511,45,180],"forms-group.ngfactory":["oA+b",23,270],"input-dialog.ngfactory":["4csf",5,38,448],"install.ngfactory":["T4V2",5,449],"left-nav-react.ngfactory":["46Tl",6,16,516,454],"mobile-app-banner.ngfactory":["1jme",5,459],"move-to-folder-control.ngfactory":["PsH8",460],"mru.ngfactory":["GHXR",23,461],"new-user-shelf.ngfactory":["hPLh",5,462],"places.ngfactory":["wK/J",5,23,469],"pull-to-refresh.ngfactory":["NIgm",5,472],"quick-access.ngfactory":["leWi",6,0,1,7,8,9,10,12,11,13,14,15,2,18,16,20,3,22,24,473],"recommended-react.ngfactory":["+luH",6,0,1,7,8,9,10,12,11,13,15,2,18,16,3,22,28,32,33,474],"search-preload.ngfactory":["01Cu",5,6,27,521,26,477],"share-control.ngfactory":["Uv8L",45,479],"side-popup-menu.ngfactory":["8KAq",5,483],"support-central-react.ngfactory":["tbFl",6,0,1,530,492],"task-module-dialog-react.ngfactory":["C0gm",6,0,1,7,29,42,43,51,493],"toast-container-react.ngfactory":["G/jE",0,1,7,12,13,18,496],"upload-button.ngfactory":["WbHY",5,497],"upload-dialog.ngfactory":["ynE4",5,498],"wac-content.ngfactory":["005W",5,56],"web-vitals.ngfactory":["/Fzb",533],"workspace-nav.ngfactory":["r3HZ",5,534]};function r(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],r=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(r)}))}r.keys=function(){return Object.keys(i)},r.id="kJkW",e.exports=r},kMgc:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("bb6g"),r=n("Epfv"),o=n("BMb5"),a=n("keVe"),l=function(){function e(e){this.windowService=e}return e.prototype.decode=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return[2,Object(r.a)(e,this.windowService.nativeWindow)]}))}))},e.prototype.encode=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return[2,Object(r.b)(e,this.windowService.nativeWindow)]}))}))},e.ɵprov=a.cc({factory:function(){return new e(a.dc(o.b))},token:e,providedIn:"root"}),e}()},kVgv:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("1A1F");var i=function(){return function(){}}()},kaEK:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Open=2]="Open",e[e.Edit=3]="Edit",e[e.Comment=4]="Comment",e[e.Mention=5]="Mention",e[e.Share=6]="Share",e[e.Attachment=7]="Attachment",e[e.SnoozeExpiry=8]="SnoozeExpiry",e[e.Trending=9]="Trending",e[e.News=10]="News",e[e.Meeting=11]="Meeting",e[e.Video=12]="Video",e[e.MyAnalytics=13]="MyAnalytics",e[e.Task=14]="Task"}(i||(i={}))},kfAr:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n("bb6g"),r=n("lrJm"),o=n("Ry9Z"),a=n("BaAg"),l=n("QOOv"),s=n("fKR7"),c=n("pd4Y"),u=n("TDzr"),d=n("n826"),p=n("m+UP"),h=n("BJbw"),f=n("Brer"),m=n("4/We"),b=n("/I02"),v=n("cgnd"),g=n("keVe"),y=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d){this.capabilitiesService=e,this.dateService=n,this.formsService=i,this.oneDriveGraphService=o,this.vroomService=a,this.swayService=l,this.analyticsService=s,this.urlAuthenticatorService=c,this.globalErrorHandler=u,this.clientStartupConfigService=d,this.isAntpExperience=this.capabilitiesService.capabilities.antpLoaded,this.config=r.config,this.lifecycleEventsEnabled=this.config.isNewLifecycleEventEnabled,this.inflationsInProgress=new Array,this.inMockMode=t.sharedContext.inMockMode,this.highResRecThumbnails=this.capabilitiesService.capabilities.highResRecThumbnailsEnabled,this.thumbnailApiEnabled=this.capabilitiesService.capabilities.thumbnailEndpointEnabled}return e.prototype.inflateItem=function(t,n,i,r){var o=this;if(t.isLocal||e.disableInflation.has(t.fileType))return Promise.resolve(t);var a=this.fetchItemInflationData(t,t.fromCache?"cache-only":"network-first",n,i,r);return this.inflationsInProgress.push(a.then((function(e){return e}),(function(){return null}))),this.waitOnInflations().then((function(){return o.inflationsInProgress.splice(0)})),a},e.prototype.inflateThumbnails=function(t){var n=this;if(!e.thumbnailFileTypes.has(t.fileType)||t.thumbnails)return Promise.resolve(t);var i=t.fromCache?"cache-only":"network-first";return new Promise((function(e){if(t.fileType!==a.b.Sway)return t.fileType===a.b.Forms?(t.thumbnails={},void n.formsService.fetchFormThumbnail(t).then((function(){return e(t)}))):void(t.driveId&&t.docId||n.isAntpExperience?n.thumbnailApiEnabled&&t.format!==s.a.News&&t.format!==s.a.StreamsVideo?(n.populateThumbnailWithUrl(t,n.getThumbnailUrlForItem(t.driveId,t.docId)),e(t)):n.oneDriveGraphService.getThumbnailsForItem(t.driveId,t.docId,i,2).then((function(e){e&&e.value&&e.value.length&&n.populateThumbnails(t,e.value[0])})).catch((function(e){n.globalErrorHandler.handleError(e,"ZYaIo")})).then((function(){return e(t)})):n.chooseSharesCall(t,i,!0).then((function(e){e.thumbnails&&e.thumbnails.length&&n.populateThumbnails(t,e.thumbnails[0])})).catch((function(e){n.globalErrorHandler.handleError(e,"hKd6C")})).then((function(){return e(t)})));n.fetchSwayThumbnail(t,i).then((function(){e(t)}))}))},e.prototype.waitOnInflations=function(){var e=this,t=this.inflationsInProgress.length;return Promise.all(this.inflationsInProgress).then((function(){if(!(e.inflationsInProgress.length<=t))return e.waitOnInflations()}))},e.prototype.fetchItemInflationData=function(e,t,n,r,o){var l=this;return e.format===s.a.Recommended||e.format===s.a.OfficeFeedDocument||e.format===s.a.News?this.fetchRecommendedItemInflationData(e,t):new Promise((function(c){var u=[],d=l.config.shareControlEnabled&&e.fileType!==a.b.Sway,p=l.capabilitiesService.wacHostEnabledForFileType(e.fileType);if(e.format===s.a.Trending&&e.driveId&&e.docId)l.tileViewEnabledForItem(e)&&n&&u.push(p?l.chooseService(e).getItemWithWacDataAndThumbnails(e,t,!1,2).then((function(t){l.populateMruItemFromDriveItem(e,t),l.thumbnailApiEnabled&&e.format!==s.a.News&&e.format!==s.a.StreamsVideo&&l.populateThumbnailWithUrl(e,l.getThumbnailUrlForItem(e.driveId,e.docId))})).catch((function(e){l.globalErrorHandler.handleError(e,"WF9ix")})):l.oneDriveGraphService.getThumbnailsForItem(e.driveId,e.docId,t,2).then((function(t){t&&t.value&&t.value.length&&l.populateThumbnails(e,t.value[0])})).catch((function(e){l.globalErrorHandler.handleError(e,"iZlQF")}))),e.fileType!==a.b.OneNote&&u.push(l.setupActivity(e,t)),(d||l.lifecycleEventsEnabled)&&u.push(l.oneDriveGraphService.getItemWithIds(e.driveId,e.docId,"sharepointIds,createdDateTime",t).then((function(t){l.setupShareControl(e,t),l.setupLifecycleEvents(e,t)})).catch((function(e){l.globalErrorHandler.handleError(e,"wUAkv")})));else if((l.tileViewEnabledForItem(e)||l.config.activityEnabled||l.config.permissionsEnabled||d||p)&&f.a.sharesFileTypes.has(e.fileType)&&(1===e.sharingType||4===e.sharingType||0===e.sharingType)){var h=l.checkAllDataIsPresentForInflation(e);if(h){l.setupLifecycleEvents(e,null);var m=(e.fileType!==a.b.OneNote?l.setupActivity(e,t):Promise.resolve()).then((function(){return Promise.resolve()}));u.push(m),n&&e.driveId&&e.docId&&u.push(l.oneDriveGraphService.getThumbnailsForItem(e.driveId,e.docId,t,2).then((function(t){t&&t.value&&t.value.length&&l.populateThumbnails(e,t.value[0])})).catch((function(e){l.globalErrorHandler.handleError(e,"iZlQF")})))}l.isAntpExperience||h||u.push(l.chooseSharesCall(e,t,n).then((function(n){return n?(l.populateMruItemFromDriveItem(e,n),l.thumbnailApiEnabled&&e.format!==s.a.News&&e.format!==s.a.StreamsVideo&&l.populateThumbnailWithUrl(e,l.getThumbnailUrlForItem(e.driveId,e.docId)),l.setupShareControl(e,n),l.setupLifecycleEvents(e,n),e.docId=n.id,n.parentReference&&(e.driveId=n.parentReference.driveId),e.fileType!==a.b.OneNote?l.setupActivity(e,t):Promise.resolve()):Promise.resolve()})).catch((function(e){l.globalErrorHandler.handleError(e,"EgyA3")})))}if(l.config.analyticsEnabled&&r){var b=l.analyticsService.getAnalytics(e,t).then((function(t){e.analytics=t})).catch((function(e){l.globalErrorHandler.handleError(e,"gBfeR")}));u.push(b)}u.push.apply(u,Object(i.__spread)(l.setupSwayData(e,t,n))),u.push.apply(u,Object(i.__spread)(l.setupFormData(e,n,o))),Promise.all(u).then((function(){e.inflationCompleted(),c(e)}),(function(){e.inflationCompleted(),c(e)}))}))},e.prototype.fetchRecommendedItemInflationData=function(e,t){var n=this;return new Promise((function(i){e.driveId&&e.docId?n.fetchAndPopulateWacDataAndThumbnails(e,t).catch((function(e){n.globalErrorHandler.handleError(e,"rm3f5")})).then((function(){return i(e)})):i(e)}))},e.prototype.getThumbnailUrlForItem=function(e,t){if(e&&t){var n="drives/"+encodeURIComponent(e)+"/items/"+encodeURIComponent(t)+"/thumbnails/0/c400x99999/content?prefer=noredirect,closestavailablesize,extendCacheMaxAge";return this.inMockMode?"thumbnails?itemUrl="+encodeURIComponent(n):n}},e.prototype.fetchAndPopulateWacDataAndThumbnails=function(e,t){var n=this;return this.capabilitiesService.wacHostEnabledForFileType(e.fileType)&&!this.inMockMode?this.chooseService(e).getItemWithWacDataAndThumbnails(e,t).then((function(t){n.populateMruItemFromDriveItem(e,t),n.thumbnailApiEnabled&&e.format!==s.a.News&&e.format!==s.a.StreamsVideo&&n.populateThumbnailWithUrl(e,n.getThumbnailUrlForItem(e.driveId,e.docId))})):this.thumbnailApiEnabled&&e.format!==s.a.News&&e.format!==s.a.StreamsVideo?(this.populateThumbnailWithUrl(e,this.getThumbnailUrlForItem(e.driveId,e.docId)),Promise.resolve()):(e.driveId&&e.docId?this.oneDriveGraphService.getThumbnailsForItem(e.driveId,e.docId,t).then((function(e){return null==e?void 0:e.value})):this.chooseSharesCall(e,t,!0).then((function(e){return null==e?void 0:e.thumbnails}))).then((function(t){(null==t?void 0:t.length)&&n.populateThumbnails(e,t[0])}))},e.prototype.populateMruItemFromDriveItem=function(e,t){!this.thumbnailApiEnabled&&t&&t.thumbnails&&t.thumbnails.length&&this.populateThumbnails(e,t.thumbnails[0]),t&&t.openWith&&t.openWith.wac&&this.populateWopiHostData(e,t)},e.prototype.populateThumbnails=function(e,t){e.thumbnails={small:t.small?t.small.url:null,medium:t.medium?t.medium.url:null,large:t.large?t.large.url:null,recommendedThumbnail:e.format!==s.a.Recommended&&e.format!==s.a.News&&e.format!==s.a.OfficeFeedDocument||!t.large?null:this.getRecommendedThumbnail(t.large.url)}},e.prototype.populateThumbnailWithUrl=function(e,t){t&&(e.thumbnails={large:t,recommendedThumbnail:t})},e.prototype.populateWopiHostData=function(e,t){e.wopiData=f.a.getWopiHostDataFromItem(t)},e.prototype.getRecommendedThumbnail=function(e){var t=this.highResRecThumbnails;return e.replace(/&width=\d+/,"&width="+(t?"999":"350")).replace(/&height=\d+/,"&height="+(t?"999":"400"))},e.prototype.setupActivity=function(e,t){var n=this;return!this.config.activityEnabled||e.format===s.a.Recent&&this.config.mruActivityEnabled&&this.config.onlyMruActivityEnabled?Promise.resolve():this.vroomService.getDocumentActivity(e,t,2).then((function(t){return e.activities=t})).catch((function(e){n.globalErrorHandler.handleError(e,"SluwI")}))},e.prototype.chooseSharesCall=function(e,t,n){var i=this.chooseService(e),r=this.capabilitiesService.wacHostEnabledForFileType(e.fileType);return n?i.getSharedItemWithThumbnail(e.canonicalUrl,e.fileType,s.a[e.format],t,r,!1,2):i.getSharedItemWithoutThumbnail(e.canonicalUrl,e.fileType,s.a[e.format],t,r,void 0,!1,2)},e.prototype.chooseService=function(e){return e.isMsftDogfood?this.vroomService:this.oneDriveGraphService},e.prototype.setupShareControl=function(e,t){t&&t.sharepointIds&&t.sharepointIds.siteUrl&&(e.sharepointIds.siteUrl=t.sharepointIds.siteUrl)},e.prototype.setupLifecycleEvents=function(e,t){if(this.lifecycleEventsEnabled&&!this.config.mruActivityEnabled){var n=e.createdDate;!n&&t&&t.createdDateTime&&(n=new Date(t.createdDateTime)),n&&(e.isNew=this.dateService.addHours(this.dateService.getCurrentDate(),-1*this.config.isNewTimeWindowInHours).getTime()<=n.getTime())}},e.prototype.setupFormData=function(e,t,n){var i=this,r=[];return e.fileType!==a.b.Forms||(n===a.b.Forms&&r.push(new Promise((function(t,n){var r=function(t){void 0===t&&(t=0),e.metaData||(e.metaData={}),e.metaData.formsResponseCount=t};e.ownerId===i.clientStartupConfigService.config.objectId||i.clientStartupConfigService.config.authType===v.a.MSA?i.formsService.getMyFormsResponses().then((function(n){var i=n.find((function(t){return t.id===e.serverDocId}));r(null==i?void 0:i.responseCount),t()})).catch(n):i.formsService.getForm(e.serverDocId,e.ownerType,e.ownerId).then((function(e){r(e?e.rowCount:null),t()})).catch(n)}))),this.tileViewEnabledForItem(e)&&t&&r.push(this.inflateThumbnails(e).then((function(){})))),r},e.prototype.setupSwayData=function(e,t,n){var i=[];return e.fileType!==a.b.Sway||(this.tileViewEnabledForItem(e)&&this.swayService.swayConfig.thumbnailsEnabled&&n&&i.push(this.fetchSwayThumbnail(e,t)),e.url=this.urlAuthenticatorService.appendPvrAndUpnAuthParams(e.url)),i},e.prototype.fetchSwayThumbnail=function(e,t){var n=this;return this.swayService.getThumbnail(e.url,e.thumbnailInfo?e.thumbnailInfo.thumbnailId:null,t).then((function(t){t&&(e.thumbnails={small:t,medium:t,large:t,recommendedThumbnail:t})})).catch((function(e){n.globalErrorHandler.handleError(e,"cm5b1")}))},e.prototype.checkAllDataIsPresentForInflation=function(e){return!!(e.sharepointIds&&e.createdDate&&e.driveId&&e.docId)},e.prototype.tileViewEnabledForItem=function(e){return this.config.tileViewEnabled||e.fileType===a.b.Forms},e.thumbnailFileTypes=new Set([a.b.PowerPoint,a.b.Visio,a.b.Word,a.b.Sway,a.b.Pdf,a.b.Forms,a.b.Stream]),e.disableInflation=new Set([a.b.Project,a.b.ProjectOperations,a.b.Portfolio]),e.ɵprov=g.cc({factory:function(){return new e(g.dc(m.a),g.dc(b.a),g.dc(c.a),g.dc(u.a),g.dc(l.a),g.dc(d.a),g.dc(f.a),g.dc(p.a),g.dc(o.a),g.dc(h.a),g.dc(r.b),g.dc(v.b))},token:e,providedIn:"root"}),e}()},kpuN:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return l}));var i,r=n("bb6g"),o=n("2dXW");!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(i||(i={}));var a=function(e){function t(t,n,i){void 0===i&&(i=!0);var r=e.call(this,t)||this;return r.statusCode=n,r.shouldSwallow=i,r}return Object(r.__extends)(t,e),t}(Error),l=function(){function e(){}return e.prototype.init=function(e,t,n){this.errorHandler=e,this.defaultTokenFormat=t,this.defaultTokenSource=n,this._reauth=new o.a,this.reauthComplete=this._reauth.asObservable()},e.prototype.getDefaultExpiry=function(){return(new Date).getTime()+36e5},e.prototype.getAccessToken=function(e,t,n,i,o,a,l){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s=this;return Object(r.__generator)(this,(function(r){return e?[2,this.getAccessTokenResponse(e,t,n,i,o,a,l).then((function(e){return e&&e.token?e:{success:!1,token:"",format:s.defaultTokenFormat,source:s.defaultTokenSource,error:new Error("Empty token returned")}})).catch((function(e){return s.errorHandler.handleError(e,"SuNwZ"),{success:!1,token:"",format:s.defaultTokenFormat,source:s.defaultTokenSource,error:e}}))]:[2,Promise.resolve({success:!1,token:"",format:this.defaultTokenFormat,source:this.defaultTokenSource,error:new Error("invalid tokenConsumer")})]}))}))},e}()},kq70:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("bb6g"),r=(n("EUVs"),n("4/We"),function(e){function t(t,n){var i=e.call(this,(function(){return i.wacContentService.prebootDocument(i.itemInfo.item,i.itemInfo.wdOriginType)}))||this;return i.capabilitiesService=t,i.wacContentService=n,i}return Object(i.__extends)(t,e),t.prototype.enabled=function(){return this.capabilitiesService.wacHostEnabledForFileType(this.itemInfo.item.fileType)&&this.capabilitiesService.wacHostHoverPrebootEnabledForFileType(this.itemInfo.item.fileType)},t}(n("adME").a))},ksTh:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a}));var i="client-request-id",r="x-correlationid",o="_Edgeworth"+window.ewWorkload+"LastSyncTimestamp",a="rs="},kvyl:function(e,t,n){"use strict";function i(e){for(var t=[],n=0;n<e.length;++n){var i=("00"+e[n].toString(16)).slice(-2);t.push(i)}return t.join("")}function r(e){void 0===e&&(e="");for(var t=[],n=0;n<e.length;)t.push(parseInt(e.substring(n,n+2),16)),n+=2;return new Uint8Array(t)}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}))},kxm0:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var i=n("ZBSS"),r=n("zGJG"),o=n("uqr+"),a=n("uV9m");function l(e){var t={};t[i.k]="PageView";var n=void 0;(Object(a.c)()||e.pageName)&&(n=u(d(t=c(t,e.pageName)))),t[Object(o.a)([i.A,i.u])]=e.isIntentional,Object(a.d)(n,t)}function s(e){return"PageView"===e[i.k]}function c(e,t){if(e[Object(o.a)([i.A,i.y])])return e;var n=t||function(e){var t="Pwa"===(null==e?void 0:e.route)?"OfficeHome":null==e?void 0:e.route,n=void 0!==t?""+((null==e?void 0:e.app)?e.app:"")+t:void 0;return void 0!==n?n:"Unknown"}(Object(a.a)());return e[Object(o.a)([i.A,i.y])]=n,e[Object(o.a)([i.A,i.z])]=function(e){return e?e.endsWith("Start")?"Start":e.endsWith("Templates")?"Templates":e.endsWith("Content")?"Content":"SearchPersonScoped"===e?"Person":"SearchSiteScoped"===e?"Site":"FormsGroupForms"===e?"GroupForms":"FormsMyForms"===e?"MyForms":"Default":"Other"}(n),e[Object(o.a)([i.A,i.x])]=function(e){return e?e.endsWith("Start")||e.endsWith("Templates")||e.endsWith("Content")?e.replace("Start","").replace("Templates","").replace("Content",""):e.startsWith("Search")?"Search":e.startsWith("Forms")?"Forms":"OfficeHome"===e?"Home":e:""}(n),e}function u(e){return["PageView",e].join(r.a)}function d(e){return e[Object(o.a)([i.A,i.y])]}},l98w:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return h}));var i=n("9h0M"),r=n("ro+v"),o=n("pIkI"),a=n("NLr0"),l=n("f0qX"),s=n("Qj1g"),c=n("Jcv4"),u=(n("lrJm"),n("3GGT")),d=n("Ft/N"),p=(n("JWB6"),"X-SW-OHP-UserCacheId"),h=function(){function e(e,t,n,i){this.serviceWorkerEnabled=e,this.serviceWorkerUserIdFactory=t,this.serviceWorkerStateService=n,this.globalErrorHandler=i}return e.prototype.intercept=function(e,t){var n=this;if(!this.serviceWorkerEnabled)return t.handle(e);if("Controlled"!==this.serviceWorkerStateService.currentState)return t.handle(e);var h=e.headers.get(d.a);if(!h)return t.handle(e);if("network-only"===h)return t.handle(e.clone({headers:e.headers.delete(d.a)}));if(e.reportProgress){var f="Cannot report progress for non-NetworkOnly requests";throw new i.f({error:f,statusText:f,status:u.a.NotImplemented,url:e.urlWithParams})}return Object(r.a)(this.serviceWorkerUserIdFactory()).pipe(Object(l.a)((function(t){return e.clone({headers:e.headers.append(p,t)})})),Object(s.a)((function(t){return n.globalErrorHandler.handleError(t,"j9XG4"),"cache-only"===h?Object(o.a)(new i.f({error:"Could not send CacheOnly request without a service worker user cache ID",status:u.a.Cancelled,statusText:"CacheOnly request cancelled"})):Object(a.a)(e.clone({headers:e.headers.delete(d.a)}))})),Object(c.a)((function(e){return t.handle(e)})))},e}()},lQwO:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},lrJm:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return s}));var i=n("bb6g"),r=n("keVe"),o=n("hhzZ"),a=n("BMb5"),l=function(e){function t(n,i){var r=e.call(this,n)||this;return r.message=n,r.originalError=i,r.name="ApplicationError",Object.setPrototypeOf&&Object.setPrototypeOf(r,t.prototype),r}return Object(i.__extends)(t,e),t}(Error),s=function(e){function t(t,n){var i=e.call(this)||this;return i.instrumentationService=t,i.windowService=n,i.loggedErrors=new Map,i.unknownError="UnknownError",i.mutateGlobalWindowErrorHandler(),i}return Object(i.__extends)(t,e),t.prototype.handleError=function(e,t){this.shouldSwallow(e)||(this.setErrorId(e,t),this.logError(e,"Angular2"))},t.prototype.handleCacheObservableError=function(e,t,n){e&&(e.networkError&&this.handleError(e.networkError,n),e.cacheError&&this.handleError(e.cacheError,t))},t.prototype.setErrorId=function(e,t){e&&"object"==typeof e&&t&&(e.id=t)},t.prototype.mutateGlobalWindowErrorHandler=function(){var e=this.windowService.nativeWindow,t=e.onerror,n=this;e.onerror=function(i,r,o,a,l){var s=null;if("object"==typeof i&&i.type&&"error"===i.type.toLowerCase()?s=i:l?((s=l).message=l.message||i,Object.assign&&Object.assign(s,{filename:r,lineno:o,colno:a})):"string"==typeof i?(s=new Error(i||n.unknownError),Object.assign&&Object.assign(s,{filename:r,lineno:o,colno:a})):(s=new Error(n.unknownError),Object.assign&&Object.assign(s,{filename:r,lineno:o,colno:a})),n.logError(s,"Global"),t)try{t.apply(e,arguments)}catch(e){n.handleError(e)}}},t.prototype.logError=function(t,n){var i="",r="";t=t||new Error(this.unknownError);try{var o=t.filename;i=o?"Error location: "+(o=o.replace(/^.*[\\\/]/,""))+", line: "+t.lineno+", col: "+t.colno:t.id?"Error id: "+t.id:"Error location: unknown";var a=t.error||t;a.originalError?(i+="\nHandled error is a wrapper with message: "+a.message,r="Wrapper call stack: "+(a.stack||"Call stack trace is not available"),r+="\nOriginal call stack: "+((a=a.originalError).stack||"Call stack trace is not available")):r="Call stack: "+(a.stack||"Call stack trace is not available"),a.message&&(i+="\nError message: "+a.message).indexOf("Invalid calling object")>0&&(i+="\nShellver: "+window.O365ShellVerStr)}catch(t){i="Error caught inside error logger: "+(t&&t.message||this.unknownError),r="Call stack: "+(t&&t.stack||"Call stack trace is not available"),n="Angular2",e.prototype.handleError.call(this,t)}finally{this.safeLogErrorData(i,r,n),e.prototype.handleError.call(this,t)}},t.prototype.safeLogErrorData=function(t,n,i){var r;try{var o=this.determineOccurrence(t);if(this.loggedErrors.set(t,o),this.shouldLogBasedOnOccurrence(o)){var a=((r={}).ItemCategory=i,r.ItemCount=o.toString(),r);this.instrumentationService.logGenericEvent("Unhandled_Exception",a),a.Error=t,a.DebugInfo=n,this.instrumentationService.logDebugCacheEvent("Unhandled_Exception",a)}}catch(t){e.prototype.handleError.call(this,t)}},t.prototype.shouldSwallow=function(e){if(null==e?void 0:e.shouldSwallow)return!0;if(e&&e.stack&&!e.promise)return!1;if(e&&e.promise&&e.rejection){var t=e.rejection;if(t.stack&&"Error"!==t.name)return!1}return!0},t.prototype.determineOccurrence=function(e){var t=1;return this.loggedErrors.has(e)&&(t=this.loggedErrors.get(e)+1),t},t.prototype.shouldLogBasedOnOccurrence=function(e){var t=e.toString().length,n=Math.pow(10,t-1);return n<2||e%n==0},t.ɵprov=r.cc({factory:function(){return new t(r.dc(o.a),r.dc(a.b))},token:t,providedIn:"root"}),t}(r.m)},lwM0:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("pjz5"),r=function(){function e(){}return e.encodeUrl=function(e,t){if(!e)return"";if(t){var n=i.a.getLocation(e),r=function(e){if(!e)return"";var t=e.substring(1).split("&"),n=0,i=t.reduce((function(e,t){var i=t.split("="),r=n>0?"&":"";return n++,e+r+(i[0]&&i[1]?i[0]+"="+encodeURIComponent(i[1]):i[0]+(""===i[1]?"=":""))}),"");return e[0]+i};return encodeURI(n.protocol+"//"+n.host)+encodeURI(n.path)+r(n.search)+r(n.hash)}return encodeURI(e).replace(/#/g,"%23")},e.decodeUrl=function(e){if(!e)return"";try{return decodeURIComponent(e)}catch(e){return""}},e}()},lwUs:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("bb6g"),r=n("YnSq");function o(e){var t=this;return{onBeforeWriteValue:function(e){return Object(i.__awaiter)(t,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return e?[2,{item:e,persistedAtTimeMs:(new Date).getTime()}]:[2,e]}))}))},onAfterReadValue:function(n,o,a){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t,l,s;return Object(i.__generator)(this,(function(i){return n?e+n.persistedAtTimeMs<n.persistedAtTimeMs?(t=a.userId,l=a.collectionName,s=a.collectionVersion,Object(r.a)(t,l,s,o),[2,null]):[2,n.item]:[2,n]}))}))}}}},"m+UP":function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var i=n("bb6g"),r=n("AlWG"),o=n("lrJm"),a=n("k+kJ"),l=n("JScD"),s=n("3GGT"),c=n("PZOQ"),u=n("hhzZ"),d=n("R7NL"),p=n("BaAg"),h=n("H90i"),f=n("cgnd"),m=n("/I02"),b=n("PBJH"),v=n("pjz5"),g=n("kpuN"),y=n("wwmn"),S=n("casz"),w=n("6GOa"),C=n("BJbw"),I=n("pOWU"),T=n("keVe"),k=n("TOqr"),A=function(){function e(){this.cachedResponsePromises=new Map}return e.prototype.set=function(e,t,n){var i=this.key(t,n);this.cachedResponsePromises.set(i,e)},e.prototype.has=function(e,t){var n=this.key(e,t);return this.cachedResponsePromises.has(n)},e.prototype.get=function(e,t){var n=this.key(e,t);return this.cachedResponsePromises.get(n)},e.prototype.delete=function(e,t){var n=this.key(e,t);return this.cachedResponsePromises.delete(n)},e.prototype.key=function(e,t){return"/"+t+"/"+e},e}(),P=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p,h,f){var m=e.call(this,n,i,r,"Sway",o,a,l,f)||this;m.globalErrorHandler=s,m.urlAuthenticatorService=c,m.uploadConfigService=d,m.locService=p,m.localDataSizePipe=h,m.cachedResponsePromises=new A,m.swayConfig=t.config;var b=u.config;return m.requestConfig={headers:new Map([["X-UserSessionId",b.sharedClientStartupContext.correlationId],["X-OHP-CorrelationId",b.sharedClientStartupContext.correlationId]])},m}return Object(i.__extends)(t,e),t.prototype.createNew=function(){var e=this,t=this.swayConfig.apiUrl+"/json/createStory";return new Promise((function(n,i){e.post("Sway_Create_Request",t,void 0,(function(t){t.instrument((function(t,n){!t.ok||t.data&&t.data.url||(n.params.HttpCode=s.a.UnexpectedResponse.toString()),e.instrumentResponse(t.headers,n)})).then((function(t){t&&t.data?n(e.urlAuthenticatorService.appendPvrAndUpnAuthParams(t.data.url)):i(new I.b(t,"Could not parse Sway creation response"))})).catch((function(t){e.globalErrorHandler.handleError(t,"WlqQb")}))}),i,e.requestConfig)}))},t.prototype.upload=function(e,n){var i=this,o=new a.b(n,e,a.d.Button),l=new r.a(o),s=function(e){o.state=e,l.next(o)};return o.cancellationToken.onCancel((function(){return s(a.c.Cancelled)})),this.verifyFileForUpload(e).then((function(){return s(a.c.Started)})).then((function(){return t.readBase64(e)})).then((function(e){return i.uploadFile({docBase64:e,documentName:o.file.name,world:"VerticalWorld",enhancementId:"",otsClient:h.a},o)})).then((function(e){o.result=e,s(a.c.Completed)})).catch((function(e){o.error=i.createUploadError(e),s(a.c.Failed)})),l.asObservable()},t.prototype.getThumbnail=function(e,n,i){var r=this;if(!this.swayConfig.thumbnailsEnabled||!n)return Promise.resolve("");var o=this.swayConfig.apiUrl+"/sway/v1.0/"+t.extractLookupId(e)+"/croppedThumbnailImage?imageId="+n+"&width=198&height=111";return new Promise((function(e,n){r.swayGet("Sway_Get_Thumbnail_Request",o,i,"blob",!0).then((function(i){i&&i.data?t.readAsDataUrl(i.data).then(e,n):e(null)}),n)}))},t.prototype.getAnalytics=function(e,n){var i=t.extractLookupId(e);return this.fetchAnalyticsForBatch([i],n).then((function(e){return t.findAnalytics(e.data,i)}))},t.prototype.prefetchAnalytics=function(e,n){var i=this;if(e&&0!==e.length)for(var r=e.map(t.extractLookupId).sort(),o=t.splitToBatches(r,this.swayConfig.analyticsBatchSize),a=0;a<o.length;a++)for(var l=o[a],s=this.fetchAnalyticsForBatch(l,n),c=function(e){var t=u.buildUrlForAnalytics([l[e]]);u.cachedResponsePromises.set(s,t,n),s.catch((function(){return i.cachedResponsePromises.delete(t,n)}))},u=this,d=0;d<l.length;d++)c(d)},t.prototype.handleQueryParam=function(t,n){e.prototype.handleQueryParam.call(this,t,n),"mocksway"===t&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,n)},t.findAnalytics=function(e,t){if(e)for(var n=0;n<e.length;n++)if(e[n]&&e[n].id===t)return e[n].analytics},t.extractLookupId=function(e){return v.a.getLocation(e).path.split("/").filter((function(e){return e}))[0]},t.splitToBatches=function(e,t){for(var n=[],i=e.slice();i&&i.length&&t;)n.push(i.splice(0,t));return n},t.readAsDataUrl=function(e){return new Promise((function(t,n){var i=new FileReader;i.addEventListener("loadend",(function(){t(i.result)})),i.addEventListener("abort",(function(){n()})),i.addEventListener("error",(function(){n()})),i.readAsDataURL(e)}))},t.readBase64=function(e){return new Promise((function(n,i){t.readAsDataUrl(e).then((function(e){var t=e.indexOf(",");t>=0?n(e.substring(t+1)):i(a.a.Unknown)})).catch((function(){return i(a.a.Unknown)}))}))},t.prototype.createUploadError=function(e){var t=this.uploadConfigService.config.swayResources;switch(e){case a.a.FileTooLarge:return{title:t.errorTitle,type:e,message:this.locService.format(t.largeFile,this.localDataSizePipe.transform(this.swayConfig.uploadMaxFileSize))};case a.a.InvalidFileType:return{title:t.errorTitle,type:e,message:t.unsupportedFile};default:return{title:t.errorTitle,type:e,message:""}}},t.prototype.verifyFileForUpload=function(e){var t=p.a.getFileExtension(e.name.toLowerCase());return-1===this.swayConfig.uploadSupportedExtensions.indexOf(t)?Promise.reject(a.a.InvalidFileType):e.size>this.swayConfig.uploadMaxFileSize?Promise.reject(a.a.FileTooLarge):Promise.resolve()},t.prototype.uploadFile=function(e,t){var n=this,i=this.swayConfig.apiUrl+"/publishtosway/createstoryandpublishdocument";return new Promise((function(r,o){n.post("Sway_Create_Story_And_Publish_Document_Request",i,e,(function(e){e.instrument((function(e,t){!e.ok||e.data&&e.data.pollingUrl||(t.params.HttpCode=s.a.UnexpectedResponse.toString()),n.instrumentResponse(e.headers,t)})).then((function(e){e&&e.data?r(e.data):o(a.a.Unknown)}))}),o,n.requestConfig,(function(e){return t.updateProgress(e.loaded)}),null,t.cancellationToken)}))},t.prototype.fetchAnalyticsForBatch=function(e,t){return this.swayGet("Sway_Get_Analytics_Request",this.buildUrlForAnalytics(e),t,"json",!0)},t.prototype.swayGet=function(t,n,r,o,a){var l=this;if(void 0===a&&(a=!1),a&&this.cachedResponsePromises.has(n,r))return this.cachedResponsePromises.get(n,r);var s=new Promise((function(s,c){var u=Object(i.__assign)({},l.requestConfig);u.responseType=o,e.prototype.get.call(l,t,n,(function(e){e.instrument((function(e,t){l.instrumentResponse(e.headers,t)})).then(s).catch((function(e){l.globalErrorHandler.handleError(e,"cwHpN")}))}),(function(e){a&&l.cachedResponsePromises.delete(n,r),c(e)}),u,r)}));return a&&this.cachedResponsePromises.set(s,n,r),s},t.prototype.buildUrlForAnalytics=function(e){var t=encodeURIComponent(e.join(","));return this.swayConfig.apiUrl+"/api/v1.0/batchanalytics?ids="+t},t.prototype.instrumentResponse=function(e,t){e&&(t.params.RequestId=e.get("X-CorrelationId"),t.params.PartnerGeo=e.get("X-OfficeCluster"))},t.ɵprov=T.cc({factory:function(){return new t(T.dc(w.a),T.dc(g.b),T.dc(u.a),T.dc(d.a),T.dc(m.a),T.dc(y.a),T.dc(k.q),T.dc(o.b),T.dc(C.a),T.dc(f.b),T.dc(l.a),T.dc(b.a),T.dc(c.a),T.dc(S.a))},token:t,providedIn:"root"}),t}(I.a)},mNaV:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var i=n("bb6g"),r=n("AlWG"),o=n("2dXW"),a=n("1zhX"),l=n("3Vsh"),s=n("cZRF"),c=n("hhzZ"),u=n("1Hgo"),d=n("7Gwk"),p=n("uzn7"),h=n("casz"),f=n("BMb5"),m=n("4/We"),b=n("cgnd"),v=n("3iMk"),g=n("IA5y"),y=function(){return function(){}}(),S=n("3XMr"),w=n("lrJm"),C=n("R7NL"),I=n("BaAg"),T=n("7ma0"),k=n("kpuN"),A=n("wwmn"),P=n("pOWU"),E=n("/I02"),_=n("uUrA"),O=n("ksTh"),F=n("keVe"),D=n("TOqr"),M=function(e){function t(t,n,i,r,o,a,l,s,c,u,d){var p=e.call(this,t,i,r,"Substrate",n,o,a,c)||this;p.globalErrorHandler=l,p.aadAppId=u,p.edgeworthConfigService=d,p.fetchRequestIndex=0,p.startupConfig=s.config;var h=p.edgeworthConfigService.config;if(h){var f="top="+h.recentItemsCount+"&"+O.c+p.contextService.sharedContext.officeMarket;p.endpoint=h.edgeworthS2SRecentEnabled?n.sharedContext.officeHomeApiRoot+"/api/ew/recent?"+f:""+h.substrateApiEndpoint+h.edgeworthApiRootPath+h.recentApiPath+"?"+f,h.userActionSortOrderEnabled&&(p.endpoint+="&order=UserActions")}return p}return Object(i.__extends)(t,e),t.prototype.fetchEdgeworthSubstrateRecent=function(e){var t=this;return this.cachedResponse||(this.cachedResponse=new Promise((function(n,i){var r=_.a.createGuid(),o=t.edgeworthConfigService.config.edgeworthS2SRecentEnabled?Object(g.b)(r):Object(g.a)(t.startupConfig.objectId+"@"+t.startupConfig.tenantId,t.contextService.sharedContext.recommendedIceApplicationId.toString(),t.startupConfig.objectId,t.aadAppId,r,t.contextService.getCurrentPageForLogging()),a=e?Array.from(e.values()):[],l=new Set;a.forEach((function(e){var n=t.getRecentAppParam(e);e&&l.add(n)}));var s=l.size?Array.from(l.values()).join(","):"";t.get("EdgeworthSubstrateRecentRequest",s?t.endpoint+"&apps="+s:t.endpoint,(function(e){e.instrument((function(e,n){var i;n.params.ActualSize=((null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.files)?e.data.files.length:-1).toString(),n.params.RequestId=t.getRequestIdFromResponse(e),n.params.DebugInfo=Object(g.f)(e),n.params.Index=(t.fetchRequestIndex++).toString(),n.params.ImpressionId=!!e.headers&&e.headers.get(O.a)||r})).then((function(e){n({data:t.parse(e.data),impressionId:!!e.headers&&e.headers.get(O.a)||r})})).catch((function(e){t.globalErrorHandler.handleError(e)}))}),i,o,"network-only",null,null,null,t.edgeworthConfigService.config.edgeworthS2SRecentEnabled?"OfficeHome":"Substrate")}))),this.cachedResponse},t.prototype.handleQueryParam=function(e,t,n){"mockmru"===e&&this.mockRequestHeader&&n.headers.set(this.mockRequestHeader,t)},t.prototype.parse=function(e){var t=e.files?e.files.map((function(e){var t=e.user_relationship,n=e.activity_badge?Object(i.__assign)(Object(i.__assign)({},e.activity_badge),{timestamp:Object(g.j)(e.activity_badge.timestamp)}):void 0;return Object(i.__assign)(Object(i.__assign)({},e),{last_recommended_modified_datetime:e.last_recommended_modified_datetime,last_store_modified_datetime:e.last_store_modified_datetime,user_relationship:Object(g.i)(t),created_datetime:Object(g.j)(e.created_datetime),creation_info:e.creation_info?Object(i.__assign)(Object(i.__assign)({},e.creation_info),{timestamp:Object(g.j)(e.creation_info.timestamp)}):null,activity_badge:n,indexed:!1,server_last_recommended_modified_datetime:e.last_recommended_modified_datetime,server_last_store_modified_datetime:e.last_recommended_modified_datetime})})):[];return{diagnostics_data:e.diagnostics_data,files:t,is_complete:e.is_complete}},t.prototype.getRecentAppParam=function(e){switch(e){case I.b.Word:return"Word";case I.b.PowerPoint:return"PowerPoint";case I.b.Excel:return"Excel";case I.b.Video:case I.b.Stream:case I.b.StreamsVideo:return"Video";case I.b.Visio:case I.b.VisioSoftwareWac:case I.b.VisioBusinessWac:case I.b.VisioFlowChartWac:case I.b.VisioGeneralWac:case I.b.VisioNetworkWac:case I.b.VisioStartWac:return"Visio";default:return null}},t.ɵprov=F.cc({factory:function(){return new t(F.dc(k.b),F.dc(E.a),F.dc(c.a),F.dc(C.a),F.dc(A.a),F.dc(D.q),F.dc(w.b),F.dc(b.b),F.dc(h.a),F.dc(T.a),F.dc(u.a))},token:t,providedIn:"root"}),t}(P.a),R=n("S8t+"),x=function(){function e(e,t,n,i,s,c,u,d,p,h,f,m,b,v){this.capabilitiesService=e,this.clientStartupConfigService=t,this.edgeworthDeltaSyncService=n,this.edgeworthRecentService=i,this.instrumentationService=s,this.windowService=c,this.localStorageService=u,this.edgeworthConfigService=d,this.scheduler=p,this.edgeworthUiTimestampService=h,this.eventService=f,this.ngZone=m,this.encryptionService=b,this.edgeworthLocalFilesService=v,this._allFilesMap=new Map,this._dataSource=new r.a(void 0),this._dataSourceObservable=this._dataSource.asObservable().pipe(Object(a.a)(1)),this._hasFailures=new o.a,this._hasFailuresObservable=this._hasFailures.asObservable().pipe(Object(l.a)(1)),this._isInitialStable=new o.a,this._isInitialStableObservable=this._isInitialStable.asObservable(),this.uiFeatureEnabled=this.capabilitiesService.capabilities.edgeworthEnabled,this.writeInProgress=null,this.writeScheduled=null,this.hasDoneBulkRead=!1,this.isTopCacheReadStable=!1,this.isBulkCacheReadStable=!1,this.isRecentFetchStable=!1,this.isSyncStable=!1,this.isInitialized=!1,this.dateProperties=new Set(["t","useractions_datetime","last_access_datetime","last_modified_datetime","last_shared_datetime","save_for_later_datetime","created_datetime","timestamp","last_action_datetime"]),this.secondaryFilesBuffer=[]}return Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSourceObservable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasFailures",{get:function(){return this._hasFailuresObservable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInitialStable",{get:function(){return this._isInitialStableObservable},enumerable:!0,configurable:!0}),e.prototype.doBulkRead=function(){var e;return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,a,l,s;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(this.hasDoneBulkRead)return[2];this.loadLocalDocuments(),this.hasDoneBulkRead=!0,t={},n=!1,i.label=1;case 1:return i.trys.push([1,4,,5]),r=this.windowService.nativeWindow.performance.now(),[4,this.windowService.nativeWindow.ewIdb.readCache()];case 2:return o=i.sent(),a=Math.ceil(this.windowService.nativeWindow.performance.now()-r),[4,this.convertCacheEntriesToFiles(o)];case 3:return l=i.sent(),this.updateAllFiles(l,"Cached"),(n=l.length>0)&&(t.State="Succeeded",t.ActualSize=l.length.toString(),t.Latency=a.toString()),this.isBulkCacheReadStable=!0,this.updateIsStable(),[3,5];case 4:return s=i.sent(),t.State="Failed",t.Error=(null===(e=null==s?void 0:s.toString)||void 0===e?void 0:e.call(s))||"",n=!0,this.hasDoneBulkRead=!1,this.isBulkCacheReadStable=!0,this.updateIsStable(),[3,5];case 5:return n&&this.instrumentationService.logGenericEvent("EdgeworthBulkCacheRead",t),[2]}}))}))},e.prototype.startPeriodicSync=function(){var e=this;this.syncIntervalHandle&&this.clearPeriodicSync(),this.syncIntervalHandle=setInterval((function(){return e.syncDocuments()}),6e4*this.edgeworthConfigService.config.periodicSyncIntervalInMin)},e.prototype.clearPeriodicSync=function(){this.syncIntervalHandle&&(clearInterval(this.syncIntervalHandle),this.syncIntervalHandle=void 0)},e.prototype.syncDocuments=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return Object(i.__generator)(this,(function(n){return e=!1,this.isSyncStable=!1,this.shouldRebuildClientCache&&this.edgeworthDeltaSyncService.resetTimestamp(),[2,new Promise((function(n,r){t.edgeworthDeltaSyncService.syncDocuments().subscribe((function(n){var r;t.updateAllFiles(n.items,"Network"),e=e||n.hasPluginFailures,t.shouldRebuildClientCache&&(r=t.secondaryFilesBuffer).push.apply(r,Object(i.__spread)(n.items))}),(function(n){e=!0,t._hasFailures.next(!0),t.isSyncStable=!0,t.updateIsStable(),r()}),(function(){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t,r=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this._hasFailures.next(e),this.isSyncStable=!0,this.updateIsStable(),this.shouldRebuildClientCache?[4,this.rebuildCache()]:[3,2];case 1:i.sent(),i.label=2;case 2:return[4,this.writeIntoCache()];case 3:return t=i.sent(),!e&&t&&this.edgeworthDeltaSyncService.markSyncCompleted(),this.scheduler.scheduleWork((function(){r.detectDuplicateFiles()}),4),n(),[2]}}))}))}))}))]}))}))},e.prototype.init=function(e){var t,n=this;if(!this.isInitialized){if(this.shouldRebuildClientCache=!this.isVisitWithinValidTimeWindow(),this.uiFeatureEnabled){var i={},r=!1;this.localStorageService.getGlobal(this.windowService.nativeWindow.ewPreloadUserIdStorageKey)===this.clientStartupConfigService.config.puid?this.windowService.nativeWindow.ewUserActionsPreloadData.then((function(e){return n.convertCacheEntriesToFiles(e)})).then((function(e){var t;if((null==e?void 0:e.length)>0){n.updateAllFiles(e,"Cached");var o=n.windowService.nativeWindow.ewUserActionsPreloadDuration;i.State="Succeeded",i.ActualSize=e.length.toString(),i.Latency=(null===(t=null==o?void 0:o.toString)||void 0===t?void 0:t.call(o))||"",r=!0}n.isTopCacheReadStable=!0,n.updateIsStable()})).catch((function(e){var t;i.State="Failed",i.Error=(null===(t=null==e?void 0:e.toString)||void 0===t?void 0:t.call(e))||"",r=!0,n.isTopCacheReadStable=!0,n.updateIsStable()})).then((function(){r&&n.scheduler.scheduleWork((function(){n.instrumentationService.logGenericEvent("EdgeworthCacheRead",i)}),4)})):null===(t=this.windowService.nativeWindow.ewIdb)||void 0===t||t.initDb(this.clientStartupConfigService.config.puid)}var o=this.edgeworthRecentService.fetchEdgeworthSubstrateRecent(e).then((function(e){n.updateAllFiles(e.data.files,"Network"),n.writeIntoCache(!0),n.isRecentFetchStable=!0,n.updateIsStable()}),(function(e){n._hasFailures.next(!0),n.isRecentFetchStable=!0,n.updateIsStable()}));e?o.then((function(){return n.syncDocuments()})):this.syncDocuments(),this.isInitialized=!0}},e.prototype.updateIsStable=function(){this.isTopCacheReadStable&&this.isBulkCacheReadStable&&this.isRecentFetchStable&&this.isSyncStable&&(this._isInitialStable.next(),this._isInitialStable.complete())},e.prototype.updateAllFiles=function(e,t){var n,r,o,a,l,s,c,u=this,d=function(e){if(e.is_deleted)return p._allFilesMap.has(e.id)&&p._allFilesMap.delete(e.id),"continue";if(p.shouldIgnore(e))return"continue";var t=p._allFilesMap.get(e.id),n=Object(g.g)(e),r=null==n?void 0:n.getTime(),d=r?-r:0;if(t){var h=e.activities&&!t.activities||e.subject&&!t.subject||(null===(o=e.user_relationship)||void 0===o?void 0:o.last_shared_by_history)&&!(null===(a=t.user_relationship)||void 0===a?void 0:a.last_shared_by_history),f=e.last_store_modified_datetime>t.last_store_modified_datetime||e.last_recommended_modified_datetime>t.last_recommended_modified_datetime||(e.last_recommended_modified_datetime===t.last_recommended_modified_datetime||e.last_store_modified_datetime===t.last_store_modified_datetime)&&h,m=t,b=null===(l=e.data_source)||void 0===l?void 0:l.includes("Mru"),v=t.meeting_artifacts;if("MeetingObject"===t.type&&(null===(s=e.meeting_artifacts)||void 0===s||s.forEach((function(e){v.find((function(t){return e.id===t.id}))||(v.push(e),f=!0)}))),f){(m=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},t),e),{useractions_datetime:n,indexed:!1,useractions_datetime_inverse_time_in_ms:d,meeting_artifacts:v})).user_relationship.save_for_later_datetime=e.user_relationship.save_for_later_datetime,b||(m.is_pinned=e.is_pinned),p._allFilesMap.set(t.id,m);var y=null===(c=t.meetings)||void 0===c?void 0:c.filter((function(t){var n;return!(null===(n=e.meetings)||void 0===n?void 0:n.includes(t))}));y&&y.forEach((function(e){u._allFilesMap.delete(e)}))}b&&(m.mru_id=m.mru_id||e.mru_id,m.mru_type=m.mru_type||e.mru_type,m.mru_url=m.mru_url||e.mru_url,void 0!==e.is_pinned&&(m.is_pinned=e.is_pinned))}else"Mail"!==e.reference_type&&p._allFilesMap.set(e.id,Object(i.__assign)(Object(i.__assign)({},e),{indexed:!1,useractions_datetime:n,useractions_datetime_inverse_time_in_ms:d}))},p=this;try{for(var h=Object(i.__values)(e),f=h.next();!f.done;f=h.next())d(f.value)}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}this._dataSource.next({files:Array.from(this._allFilesMap.values()),source:t}),this.eventService.broadcastEvent({name:"edgeworthFilesUpdated",args:[this._allFilesMap.values()]})},e.prototype.writeIntoCache=function(e){return void 0===e&&(e=!1),Object(i.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(n){return this.uiFeatureEnabled?this.writeInProgress?(this.writeScheduled||(this.writeScheduled=this.writeInProgress.then((function(){return t.writeIntoCache(e)}))),[2,this.writeScheduled]):(this.writeScheduled=null,this.writeInProgress=new Promise((function(n){t.scheduler.scheduleWork((function(){!function(){Object(i.__awaiter)(t,void 0,void 0,(function(){var t,r,o,a,l,s,c=this;return Object(i.__generator)(this,(function(u){switch(u.label){case 0:t={},r=Array.from(this._allFilesMap.values()).filter((function(e){return"LocalBridgeFile"!==e.source})),o=!1,u.label=1;case 1:return u.trys.push([1,7,,8]),this.encryptionService?[4,Promise.all(r.map((function(e){return new Promise((function(t,n){c.scheduler.scheduleWork((function(){var r=Object(i.__assign)(Object(i.__assign)({},e),{indexed:!1});c.ngZone.runOutsideAngular((function(){c.encryptionService.encryptData(r).then((function(e){return t({id:r.id,useractions_datetime:r.useractions_datetime,useractions_datetime_inverse_time_in_ms:r.useractions_datetime_inverse_time_in_ms,item:e})})).catch(n)}))}),4)}))})))]:[3,4];case 2:return a=u.sent(),[4,this.doWriteScheduled(a)];case 3:return u.sent(),[3,6];case 4:return[4,this.doWriteScheduled(r.map((function(e){return{id:e.id,item:Object(i.__assign)(Object(i.__assign)({},e),{indexed:!1}),useractions_datetime:e.useractions_datetime,useractions_datetime_inverse_time_in_ms:e.useractions_datetime_inverse_time_in_ms}})))];case 5:u.sent(),u.label=6;case 6:return this.localStorageService.setGlobal(this.windowService.nativeWindow.ewPreloadUserIdStorageKey,this.clientStartupConfigService.config.puid),t.State="Succeeded",[3,8];case 7:return l=u.sent(),t.State="Failed",t.Error=(null===(s=null==l?void 0:l.toString)||void 0===s?void 0:s.call(l))||"",t.DebugInfo="fromDeltaSync:"+e+", itemCount:"+r.length,o=!0,[3,8];case 8:return this.instrumentationService.logGenericEvent("EdgeworthCacheWrite",t),this.writeInProgress=null,n(!o),[2]}}))}))}()}),4)})),[2,this.writeInProgress]):[2]}))}))},e.prototype.shouldIgnore=function(e){var t;return!!("Image"===e.type&&Object(g.h)(e)||"ics"===e.extension||"spsite"===e.type||"WebLink"===e.type||"LocalFile"===e.source&&(!Object(g.e)(Object(g.d)(e))||this.capabilitiesService.capabilities.isPwaInUwp)||"Video"===e.type&&0===(null===(t=e.id)||void 0===t?void 0:t.indexOf("STREAMS")))},e.prototype.doWriteScheduled=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return t=[],Object(v.a)(e,10,(function(e){t.push(new Promise((function(t,i){n.scheduler.scheduleWork((function(){n.ngZone.runOutsideAngular((function(){return n.windowService.nativeWindow.ewIdb.writeIntoCache(e).then(t).catch(i)}))}),4)})))})),[4,Promise.all(t)];case 1:return i.sent(),[2]}}))}))},e.prototype.convertCacheEntriesToFiles=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(n){return[2,this.ngZone.runOutsideAngular((function(){return Promise.all(e.map((function(e){return t.convertCachedEntry(e)})))}))]}))}))},e.prototype.convertCachedEntry=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return e.item instanceof ArrayBuffer?(t=function(e,t){return n.dateProperties.has(e)?Object(g.j)(t):t},[4,this.encryptionService.decryptData(new Uint8Array(e.item),t)]):[3,2];case 1:return[2,i.sent()];case 2:return[2,e.item]}}))}))},e.prototype.isVisitWithinValidTimeWindow=function(){var e=this.edgeworthUiTimestampService.getLastUiSyncTimestamp();if(!e)return!0;var t=((new Date).getTime()-e.getTime())/864e5<=this.edgeworthConfigService.config.reindexThresholdInDays;return t||this.instrumentationService.logGenericEvent("EdgeworthRebuildRequired"),t},e.prototype.rebuildCache=function(){var e;return Object(i.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(e){t.eventService.broadcastEvent({name:"edgeworthRebuildNeeded",args:[e]})}))];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,null===(e=window.ewIdb)||void 0===e?void 0:e.eraseStore()];case 3:return n.sent(),this._allFilesMap.clear(),this.updateAllFiles(this.secondaryFilesBuffer,"Network"),this.secondaryFilesBuffer.length=0,this.shouldRebuildClientCache=!1,this.instrumentationService.logGenericEvent("EdgeworthRebuildCompleted"),[3,5];case 4:return n.sent(),this.instrumentationService.logErrorEvent("EdgeworthRebuildError"),[3,5];case 5:return[2]}}))}))},e.prototype.detectDuplicateFiles=function(){var e,t=Array.from(this._allFilesMap.values()),n=0,i=new Set;t.forEach((function(e){var t=e.mru_id;t&&(i.has(t)?n++:i.add(t))})),n>0&&this.instrumentationService.logGenericEvent("EdgeworthDuplicateFilesDetected",((e={}).ItemCount=n.toString(),e))},e.prototype.loadLocalDocuments=function(){var e=this;this.edgeworthLocalFilesService&&this.edgeworthLocalFilesService.getLocalMru().subscribe((function(t){e.updateAllFiles(t,"HwaLocalBridge")}))},e.ɵprov=F.cc({factory:function(){return new e(F.dc(m.a),F.dc(b.b),F.dc(S.a),F.dc(M),F.dc(c.a),F.dc(f.b),F.dc(p.a),F.dc(u.a),F.dc(h.a),F.dc(R.a),F.dc(d.a),F.dc(F.z),F.dc(s.a,8),F.dc(y,8))},token:e,providedIn:"root"}),e}()},mu6k:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return l}));var i=n("keVe"),r=n("lrJm"),o=(n("W3Zz"),n("hZW2"),n("BMb5"),n("PBJH"),n("24t9")),a=function(){return function(e){this.templateRef=e}}(),l=function(){function e(e,t,n,r,o,a,l){this.deviceDetector=e,this.documentService=t,this.changeDetectorRef=n,this.locService=r,this.renderer=o,this.elementRef=a,this.windowService=l,this.leftAlignedCard=!1,this.multiSelect=!1,this.contextAriaLabel="",this.ariaRole="listitem",this.selectItem=new i.n,this.closeMenu=new i.n}return e.prototype.ngOnInit=function(){var e=this;this.focusActive=!1,this.closeByKey=!1,this.activeIndex=-1,this.menuItemClickHandler=function(t){e.elementRef.nativeElement.contains(t.target)||(e.mobileMenu&&t.preventDefault(),e.close())},this.animationState=this.mobileMenu?"openMobile":"open",this.open=!0,this.destroyed=!1,this.menuAriaLabel=this.locService.format(this.locService.MenuAriaLabel,this.contextAriaLabel),this.selectedIndex>=0&&(this.menuModel.items[this.selectedIndex].ariaChecked=!0),this.mobileMenu&&this.documentService.disableTouchMove()},e.prototype.ngAfterViewInit=function(){var e=this;if(1!==this.menuItems.length)throw new r.a("Must have exactly 1 *ohpMenuItemContent in a Menu as a child");this.menuItemTemplate=this.menuItems.first.templateRef,this.changeDetectorRef.detectChanges(),setTimeout((function(){if(e.deviceDetector.isDesktopDevice()){e.setActiveIndex(0,!0);var t=e.documentService.nativeDocument.activeElement;setTimeout((function(){var n=t.getBoundingClientRect();n.top+n.height>e.windowService.nativeWindow.innerHeight&&t.scrollIntoView()}),100)}e.destroyed||(e.menuItemClickListener=e.renderer.listen(e.documentService.nativeDocument,"click",e.menuItemClickHandler),e.menuItemTouchListener=e.renderer.listen(e.documentService.nativeDocument,"touchend",e.menuItemClickHandler),e.menuItemContextListener=e.renderer.listen(e.documentService.nativeDocument,"contextmenu",e.menuItemClickHandler),e.menuItemKeyListener=e.renderer.listen(e.documentService.nativeDocument,"keydown",(function(t){3===o.a.getKey(t)&&e.close(!0)})))}),0)},e.prototype.ngOnDestroy=function(){this.destroyed=!0,this.menuItemClickListener&&this.menuItemClickListener(),this.menuItemTouchListener&&this.menuItemTouchListener(),this.menuItemContextListener&&this.menuItemContextListener(),this.menuItemKeyListener&&this.menuItemKeyListener(),this.documentService.enableTouchMove()},e.prototype.onAnimationCompleted=function(e){"closing"===e.toState&&this.completeClose()},e.prototype.onSelectItem=function(e,t,n){if(this.menuModel.announceItemIsSelected)if("radio"===this.ariaRole||"menuitemcheckbox"===this.ariaRole)if(this.multiSelect){var i=this.menuModel.items.find((function(t){return e.getId()===t.getId()}));i.ariaChecked=!i.ariaChecked}else this.menuModel.items.forEach((function(t){return t.ariaChecked=e.getId()===t.getId()}));else this.menuModel.items.forEach((function(t){return t.ariaSelected=e.getId()===t.getId()}));this.selectItem.emit({item:e,index:t,nativeDomEvent:n}),n.preventDefault(),this.multiSelect||this.close()},e.prototype.close=function(e){if(void 0===e&&(e=!1),!this.closed){if(this.closed=!0,this.closeByKey=e,this.animateClose)return void(this.animationState="closing");this.completeClose()}},e.prototype.handleKey=function(t){var n=o.a.getKey(t);if(-1!==e.expectedKeys.indexOf(n))if(t.preventDefault(),2===n&&this.activeIndex>=0)this.onSelectItem(this.menuModel.items[this.activeIndex],this.activeIndex,t);else{var i=this.menuModel.items.length-1;switch(n){case 1:case 3:this.close(!0);break;case 4:this.focusActive=!0,this.setActiveIndex(this.activeIndex>0?this.activeIndex-1:i);break;case 5:this.focusActive=!0,this.setActiveIndex((this.activeIndex+1)%(i+1))}}},e.prototype.setActiveIndex=function(e,t){var n=this;if(t&&(this.focusActive=!0),this.activeIndex=e,this.focusActive){var i=this.dropdownItems.find((function(t){return t.nativeElement.id===n.getIdForItem(n.menuModel.items[e])}));i&&i.nativeElement.focus()}},e.prototype.getIdForItem=function(e){return this.menuModel.id+"-item--"+e.getId()},e.prototype.trackById=function(e,t){return t.getId()},e.prototype.completeClose=function(){this.open=!1,this.documentService.enableTouchMove(),this.closeMenu.emit(this.closeByKey),this.closeByKey=!1},e.expectedKeys=[1,2,3,4,5],e}()},n826:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var i=n("bb6g"),r=n("3Vsh"),o=n("lrJm"),a=n("3GGT"),l=n("hhzZ"),s=n("R7NL"),c=n("BaAg"),u=n("4/We"),d=n("/I02"),p=n("pjz5"),h=n("kpuN"),f=n("oAX+"),m=n("uzn7"),b=n("keVe"),v=function(){function e(e,t){this.storageService=e,this.capabilitiesService=t}return e.prototype.makeRequest=function(e,t,n,i,r,o){var a=this;if(this.capabilitiesService.capabilities.limitNetworkRequests&&t){var l=this.getKey(e),s=this.storageService.get(l),c=!0;s&&s+1e3*t>=Date.now()&&(c=!1);var u=function(){a.storageService.set(l,Date.now())};if(c){var d=i().then((function(e){return e&&u(),e}));return f.a.createResultsWithCacheObservable(n(),d,r,o)}return f.a.createResultsCacheFirstObservable(n,i,u,r,o)}return f.a.createResultsWithCacheObservable(n(),i(),r,o)},e.prototype.getKey=function(e){return"network_ts_"+e},e.ɵprov=b.cc({factory:function(){return new e(b.dc(m.a),b.dc(u.a))},token:e,providedIn:"root"}),e}(),g=n("pd4Y"),y=n("aQ3G"),S=n("wwmn"),w=(n("Dpxn"),n("casz")),C=n("Brer"),I=n("pOWU"),T=n("TOqr"),k=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p){var h=e.call(this,n,i,r,o,a,l,s,d)||this;return h.capabilitiesService=t,h.dateService=c,h.vroomService=u,h.cachedRequestService=p,h.batchEnabled=t.capabilities.batchGraphEnabled,n.reauthComplete.subscribe((function(){h.myDriveRootAuthErrorCached&&(h.myDriveRootUrlStream=null,h.myDriveRootUrlPromise=null)})),h}return Object(i.__extends)(t,e),t.prototype.getItemWithIds=function(e,t,n,i,r,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1);var l=this.getItemLocation(e,t),s=n?"?$select="+n:"",c=this.inMockMode?l+"?currentDate="+this.dateService.getCurrentDateMinuteGranularity().toISOString():""+l+s;return this.getOneDriveItem("OneDrive_Graph_Item_Request",c,i,r,o,null,a)},t.prototype.getMyDriveRootUrl=function(e){var t=this;if(void 0===e&&(e=0),!this.capabilitiesService.capabilities.oneDriveApisEnabled)return Promise.resolve(null);if(!this.myDriveRootUrlPromise){var n=new Promise((function(n,i){var o=t.getMyDriveRootUrlStream(e);o.results.pipe(Object(r.a)(1)).toPromise().then((function(e){e&&e.userRoot?n(e):i("No/Incomplete data returned.")})),o.initialCompletion.then((function(e){e&&(t.globalErrorHandler.handleCacheObservableError(e,"Evsnp","SiCWx"),e.cacheError&&e.networkError&&i(e))}))}));this.myDriveRootAuthErrorCached=!1,this.myDriveRootUrlPromise=n}return this.myDriveRootUrlPromise},t.prototype.getMyDriveRootUrlStream=function(e){var t=this;if(void 0===e&&(e=0),this.myDriveRootUrlStream)return this.myDriveRootUrlStream;var n=this.cachedRequestService.makeRequest("my-drive-root",this.contextService.sharedContext.graphApiRootRefreshIntervalInSeconds,(function(){return t.getMyDriveRootUrlInternal("cache-only",e)}),(function(){return t.getMyDriveRootUrlInternal("network-first",e)}),null,(function(e){e&&e.httpResponse&&(401===e.httpResponse.status||e.httpResponse.status===a.a.TokenUnavailable&&"CAP_Error"===e.httpResponse.data)?t.myDriveRootAuthErrorCached=!0:(t.myDriveRootUrlStream=null,t.myDriveRootUrlPromise=null)}));return this.myDriveRootAuthErrorCached=!1,this.myDriveRootUrlStream=n,this.myDriveRootUrlStream},t.prototype.getSiteTitle=function(e){var n=this,i=""+t.sitesEndpoint+e;return this.getGraph("Get_Site_Title_Request",i,"cache-only",null,!0,null,null,null,!1,"json",0).then((function(e){var t;return null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.displayName})).catch((function(){return n.getGraph("Get_Site_Title_Request",i,"network-first",null,!0,null,null,null,!1,"json",0).then((function(e){var t;return null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.displayName}))}))},t.prototype.getFileListingVersions=function(e){return this.getGraph("File_Version_List_Fetch",e,"network-only").then((function(e){return e.data.value}))},t.prototype.getSharedItemsWithThumbnails=function(e){var t=this;return new Promise((function(n,i){var r=!0,o=e.map((function(e){var n=t.vroomService.getSharesUrl(e);return n?n=t.inMockMode?"shares?itemUrl="+encodeURIComponent(n)+"&currentDate="+t.dateService.getCurrentDateMinuteGranularity().toISOString():n+"?$expand=thumbnails&$select=id,sharepointIds,parentReference,createdDateTime,shared":r=!1,{eventName:"OneDrive_Graph_Shares_Request",endpoint:n,method:"GET",cacheResult:!0,instrumentCallback:function(e,t){if(e.ok){var n=e.data,i=(n&&n.thumbnails?n.thumbnails.length:0).toString();t.params.ItemCount=i}}}}));r?t.batchGraph(o,"OneDrive_Graph_Batch_Shares_Request").then((function(e){return n((e||[]).map((function(e){return e&&e.ok?e.data:null})))}),i):i(new I.b(null,"Unable to parse share id"))}))},t.prototype.getSharedItemWithThumbnail=function(e,t,n,i,r,o,a){return void 0===o&&(o=!1),void 0===a&&(a=0),this.getSharedItemWithParams(e,t,n,C.a.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],r,!0),i,o,a)},t.prototype.getSharedItemWithoutThumbnail=function(e,t,n,i,r,o,a,l){return void 0===o&&(o="open"),void 0===a&&(a=!1),void 0===l&&(l=0),this.getSharedItemWithParams(e,t,n,C.a.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],r,!1,"",o),i,a,l)},t.prototype.getSharedItemWithThumbnailAndIds=function(e,t,n,i,r,o,a){return void 0===o&&(o=!1),void 0===a&&(a=0),this.getSharedItemWithParams(e,t,n,C.a.getItemParams(["sharepointIds"],r,!0),i,o,a)},t.prototype.getItemWithWacDataAndThumbnails=function(e,t,n,i){void 0===n&&(n=!1),void 0===i&&(i=0);var r=this.getItemLocation(e.driveId,e.docId),o=C.a.getItemParams([],!0,!0);return this.getOneDriveItem("OneDrive_Graph_Item_With_Wac_Data_And_Thumb_Request",r+"?"+o,t,null,null,i,n)},t.prototype.getItemWithWacData=function(e,t,n,i,r,o,a){void 0===r&&(r="open"),void 0===o&&(o=!1),void 0===a&&(a=0);var l=this.getItemLocation(t,n),s=C.a.getItemParams([],!0,!1,"",r);return this.getOneDriveItem("OneDrive_Graph_Item_With_Wac_Data_Request",l+"?"+s,i,null,null,a,o)},t.prototype.getThumbnailsForItem=function(e,t,n,i){var r=this;void 0===i&&(i=0);var o=this.getItemLocation(e,t)+"/thumbnails";return"network-first"===n?this.getThumbnails("OneDrive_Graph_Thumbnail_Request",o,"cache-only",i).catch((function(){return r.getThumbnails("OneDrive_Graph_Thumbnail_Request",o,"network-first",i)})):this.getThumbnails("OneDrive_Graph_Thumbnail_Request",o,n,i)},t.prototype.getThumbnailString=function(e){var t=this,n=new FileReader;return new Promise((function(i,r){t.getGraph("OneDrive_Graph_Thumbnail_String_Request",e,"network-only",(function(e,n){n.params.RequestId=t.getRequestIdFromResponse(e)}),!0,null,null,null,!1,"blob",0).then((function(e){e&&e.data?(n.onloadend=function(){var e=n.result&&"string"==typeof n.result&&n.result||"";e.length>0?i(e):r()},n.onerror=r,n.onabort=r,n.readAsDataURL(e.data)):r()})).catch((function(e){t.globalErrorHandler.handleError(e,"AfEUN"),r()}))}))},t.prototype.createNewFile=function(e,n,i){var r=this;void 0===i&&(i=!1);var o=t.myDriveEndpoint+"root/children?select=webDavUrl,"+(i?"openwith,":"")+"*",l={name:e,file:{},"@microsoft.graph.conflictBehavior":"rename"},s=new Map([["accept","application/json"],["Prefer","allow-zerobyte"],["application","officehome"]]);return new Promise((function(e,t){r.postGraph("OneDrive_Graph_Create_File_Request",o,l,(function(n){n.instrument((function(e,t){if(t.params.RequestId=r.getRequestIdFromResponse(e),e.ok){var n=e.data;n&&n.id&&n.webUrl||(t.params.HttpCode=a.a.UnexpectedResponse.toString())}})).then((function(n){var i=n.data;i&&i.id&&i.webUrl?e(i):t(new I.b(n,"Could not parse drive item from Graph response"))})).catch((function(e){r.globalErrorHandler.handleError(e,"MCFQq")}))}),(function(e){e&&e.httpResponse?t(e.httpResponse.data?{error:{code:""+e.httpResponse.status,data:""+e.httpResponse.data}}:{error:{code:""+e.httpResponse.status}}):t()}),null,null,null,null,!1,!0,{category:"CreateFile",fileType:n},s)}))},t.prototype.renameFile=function(e,n,i){var r,o=this;r=i?this.getItemLocation(i,n):t.myDriveEndpoint+"items/"+n;var l={name:e},s=this.getRequestConfig();return s.headers.set("Content-Type","application/json"),new Promise((function(e,t){o.patchGraph("Document_Title_Rename_File",r,JSON.stringify(l),(function(n){n.instrument((function(e,t){if(t.params.RequestId=o.getRequestIdFromResponse(e),e.ok){var n=e.data;n&&n.id&&n.webUrl||(t.params.HttpCode=a.a.UnexpectedResponse.toString())}})).then((function(n){var i=n.data;i&&i.id&&i.webUrl?e(i):t(new I.b(n,"Could not parse drive item from Graph response"))}))}),(function(e){e&&e.httpResponse?t(e.httpResponse.data?{error:{code:""+e.httpResponse.status,data:""+e.httpResponse.data}}:{error:{code:""+e.httpResponse.status}}):t()}),s,null,null,null,null,void 0,null)}))},t.prototype.uploadFile=function(e,n,i,r,o,a,l){var s=this;return new Promise((function(c,u){e&&e.name||u(new I.b(null,"Invalid file"));var d=s.vroomService.getUploadLocation(t.myDriveEndpoint,e,i,r)+"content?@microsoft.graph.conflictBehavior=rename&select=webDavUrl,*";s.putGraph("OneDrive_Graph_Upload_File_Request",d,e,(function(t){t.instrument((function(t,i){return s.vroomService.instrumentUploadResponse(t,i,e,n)})).then((function(e){var t=e.data;t&&t.id?c(t):u(new I.b(e,"Could not parse drive item from Graph response"))})).catch((function(e){s.globalErrorHandler.handleError(e,"NWgrO")}))}),u,o,null,a,l)}))},t.prototype.createUploadSession=function(e,n,i,r,o){var a=this;return new Promise((function(l,s){e&&e.name||s(new I.b(null,"Invalid file"));var c=a.vroomService.getUploadLocation(t.myDriveEndpoint,e,i,r)+"createUploadSession";a.postGraph("OneDrive_Graph_Create_Upload_Session_Request",c,{item:{"@microsoft.graph.conflictBehavior":"rename"}},(function(t){t.instrument((function(t,i){if(a.vroomService.instrumentUploadResponse(t,i,e,n),t.ok){var r=t.data;i.params.Length=r&&r.uploadUrl?r.uploadUrl.length.toString():"0"}})).then((function(e){var t=e.data;t&&t.uploadUrl?l(t):s(new I.b(e,"Could not parse upload session from Graph response"))})).catch((function(e){a.globalErrorHandler.handleError(e,"Nt3wB")}))}),s,null,null,o)}))},t.prototype.cancelUploadSession=function(e,t,n){return this.vroomService.cancelUploadSessionInternal(e,t,n,"Graph")},t.prototype.uploadFragment=function(e,t,n,i,r,o,a,l,s){return this.vroomService.uploadFragment(e,t,n,i,r,o,a,l,s)},t.prototype.getUploadSessionStatus=function(e,t,n){return this.vroomService.getUploadSessionStatusInternal(e,t,n,"Graph")},t.prototype.getMyDriveRoot=function(e,t){return void 0===t&&(t=0),this.getMyDriveItem("root",e,t)},t.prototype.isRetriableError=function(e){return e===a.a.Throttled},t.prototype.handleQueryParam=function(t,n,i){e.prototype.handleQueryParam.call(this,t,n,i),"mockonedrive"===t&&this.mockRequestHeader&&(null==i||i.headers.set(this.mockRequestHeader,n))},t.prototype.getSharedItemWithParams=function(e,t,n,i,r,o,a){var s=this;return void 0===o&&(o=!1),void 0===a&&(a=0),new Promise((function(u,d){var h=s.vroomService.getSharesUrl(e);if(h){var f=s.inMockMode?"shares?itemUrl="+encodeURIComponent(h)+"&currentDate="+s.dateService.getCurrentDateMinuteGranularity().toISOString():h+(i?"?"+i:""),m=i.includes("openwith");s.getOneDriveItem(m?"OneDrive_Graph_Shares_With_Wac_Data_Request":"OneDrive_Graph_Shares_Request",f,r,(function(i,r){if(i.ok){var o=i.data,a=o?o.thumbnails:null;r.params.ItemCount=(a?a.length:0).toString()}var u=p.a.getLocation(e);if(u&&u.protocol&&u.host){var d=u.protocol+"//"+u.host;r.params.ResourceUrl=new l.d(d),r.params.ItemIsShared=(!(d===s.contextService.sharedContext.sharePointResourceId||d===s.contextService.sharedContext.oneDriveResourceId)).toString()}r.params.ItemCategory=c.a.referralFromFileLocation(e),r.params.DocumentType=c.b[t],n&&(r.params.FileFormat=n)}),s.batchEnabled,a,o).then(u,d)}else d(new I.b(null,"Unable to parse share id"))}))},t.prototype.getItemLocation=function(e,n){return""+t.drivesEndpoint+encodeURIComponent(e)+"/items/"+encodeURIComponent(n)},t.prototype.getMyDriveItem=function(e,n,i){return this.getOneDriveItem("OneDrive_Graph_Item_Request",""+t.myDriveEndpoint+e,n,null,!1,i)},t.prototype.getOneDriveItem=function(e,t,n,i,r,o,a){return void 0===r&&(r=!1),void 0===o&&(o=0),void 0===a&&(a=!1),this.getGraph(e,t,n,(function(e,t){i&&i(e,t)}),!0,null,null,null,r,"json",o,a).then((function(e){return e.data}))},t.prototype.getThumbnails=function(e,t,n,i){void 0===i&&(i=0);var r=this.inMockMode?"thumbnails?itemUrl="+encodeURIComponent(t):t;return this.getGraph(e,r,n,(function(e,t){if(e.ok){var n=e.data,i=(n&&n.value?n.value.length:0).toString();t.params.ItemCount=i}}),!0,null,null,null,!1,"json",i).then((function(e){return e.data}))},t.prototype.getMyDriveRootUrlInternal=function(e,t){var n=this;return this.getMyDriveRoot(e,t).then((function(t){return n.vroomService.getRootUrlsFromRootItem(t,e)}))},t.myDriveEndpoint="me/drive/",t.drivesEndpoint="drives/",t.sitesEndpoint="sites/",t.itemsEndpoint="items/",t.ɵprov=b.cc({factory:function(){return new t(b.dc(u.a),b.dc(h.b),b.dc(l.a),b.dc(s.a),b.dc(d.a),b.dc(S.a),b.dc(T.q),b.dc(o.b),b.dc(g.a),b.dc(C.a),b.dc(w.a),b.dc(v))},token:t,providedIn:"root"}),t}(y.a)},nbPN:function(e,t,n){"use strict";function i(){var e=window.performance;return!!(e&&e.now&&e.mark&&e.timing&&e.timing.navigationStart&&e.measure&&e.getEntriesByType)}n.d(t,"a",(function(){return i}))},ndAY:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"d",(function(){return b})),n.d(t,"c",(function(){return v}));var i,r=n("8/lW"),o=n("AGMK"),a=n("z0B0"),l=n("Ihso"),s=n("1rn/"),c=n("HCeo"),u=n("cOkY"),d=n("nbPN"),p=new Set,h=!1;function f(e,t,n,i){if(void 0===t&&(t=2),void 0===n&&(n=r.a.Security),Object(d.a)()){var o=e,a=Object(u.b)();a&&(o=e+"_"+a);var l=o,p=u.d.get(l);if(p){var h=p+1;u.d.set(l,h),l=o+"."+h}else u.d.set(l,1);window.performance.mark(l);var f=Object(u.c)()||"navigationStart";"App_Navigation_Start"===e&&Object(u.g)(l);var m="navigationStart";return 2===t?m=f:0===t?m="":"string"==typeof t&&(m=t),function(e,t,n,i,r,o){if(n&&!u.e.has(e)){u.e.add(e);try{window.performance.measure(e,n,t)}catch(i){return void Object(c.a)(e,"Failed to record <"+e+"> for <"+t+"> starting from <"+n+">: exception is thrown")}!function(e,t,n,i){var r=window.performance.getEntriesByName(e,"measure");if(r){var o=Math.ceil(r[0].duration);Object(s.a)(t,o,i,n)}}(e,r||e,i,o)}}(o,l,m,n,e,i),l}}function m(e){return new Promise((function(t){Object(l.b)((function(){t(f(e))}))}))}function b(e,t){Object(u.f)(e),f("App_Navigation_Start",Object(u.c)()?0:t||"responseStart")}function v(e){h||(function(){Object(a.a)((function(e){"hidden"===e&&function(){i&&Object(l.a)(i),g()}()}))}(),h=!0),p.add(e),i||(i=Object(l.b)((function(){Object(o.a)()&&p.forEach((function(e){f(e)})),g()})))}function g(){p.clear(),i=null}},o2Lt:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}));var i="/Pages/MobileDesignPage.aspx",r="/Pages/DesignPage.aspx",o="/Pages/DesignPageV2.aspx"},"oAX+":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("SQAW"),r=n("Tc/Q"),o=n("1zhX"),a=function(){function e(){}return e.createResultsWithCacheObservable=function(e,t,n,a,l){var s,c=new Promise((function(n){s=i.a.create((function(i){var r=null,o=!1,s=null,c=!1,u=!1,d=function(){l&&s&&r&&i.next(l),n(s||r?{cacheError:s,networkError:r}:null),i.complete()};e&&e.then((function(e){u=!0,e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!0),i.next(e),o&&d()})).catch((function(e){s=e,c=!0,o&&d()})),t&&t.then((function(e){e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!1),i.next(e),d()})).catch((function(e){r=e,o=!0,a&&a(e),(u||c)&&d()}))}))}));return n&&(s=s.pipe(Object(r.a)(n))),{results:s=s.pipe(Object(o.a)(1)),initialCompletion:c}},e.createResultsCacheFirstObservable=function(e,t,n,a,l){var s,c=new Promise((function(r){s=i.a.create((function(i){var o=null,a=null,s=function(){r(a||o?{cacheError:a,networkError:o}:null),i.complete()};e&&e().then((function(e){e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!0),i.next(e),s()})).catch((function(e){a=e,t().then((function(e){e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!1),n(),i.next(e),s()})).catch((function(e){o=e,l&&l(e),s()}))}))}))}));return a&&(s=s.pipe(Object(r.a)(a))),{results:s=s.pipe(Object(o.a)(1)),initialCompletion:c}},e}()},"oHg+":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("keVe"),r=n("BMb5"),o=n("bb6g"),a=n("TOqr"),l=new i.q("CRYPTO_API_AVAILABLE",{providedIn:"root",factory:function(){return function(e,t){var n,i;if(!Object(a.t)(t))return!1;var r=e.nativeWindow.crypto;if(!r)return!1;if(!r.getRandomValues)return!1;var l=r.subtle;if(!l)return!1;try{for(var s=Object(o.__values)(["encrypt","decrypt","importKey","digest"]),c=s.next();!c.done;c=s.next())if(!(c.value in l))return!1}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return!0}(Object(i.V)(r.b),Object(i.V)(i.B))}})},oKW8:function(e,t,n){"use strict";function i(){return new Date}n.d(t,"a",(function(){return i}))},p3Wk:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var i="length",r=function(e){return e.Space="Space",e.Section="Section",e.Document="Document",e.Link="Link",e.CalendarEvent="CalendarEvent",e.Other="Other",e}({})},p6Zr:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.Calendar="Calendar",e.Excel="ExcelOnline",e.Forms="OfficeForms",e.Mail="Mail",e.OneDrive="Documents",e.OneNote="OneNoteOnline",e.PowerPoint="PowerPointOnline",e.Project="Project",e.SharePoint="Sites",e.Skype="Skype",e.Sway="Sway",e.Visio="VisioOnline",e.Word="WordOnline",e.PowerBI="PowerBIv2",e}()},p6gk:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var i=n("bb6g"),r=n("SQAW"),o=n("lrJm"),a=n("hhzZ"),l=n("R7NL"),s=n("BaAg"),c=n("/I02"),u=n("oAX+"),d=n("kpuN"),p=n("aQ3G"),h=n("wwmn"),f=n("casz"),m=n("pOWU"),b=n("keVe"),v=n("TOqr"),g=function(e){function t(t,n,i,r,o,a,l,s){return e.call(this,t,n,i,r,o,a,l,s)||this}return Object(i.__extends)(t,e),t.prototype.createNewNotebook=function(e){var n=this,i=t.myOneNoteEndpoint+"notebooks",r={displayName:e};return new Promise((function(e,t){n.postGraph("OneNote_Graph_Create_NoteBook_Request",i,r,(function(i){i.instrument((function(e,t){t.params.RequestId=n.getRequestIdFromResponse(e)})).then((function(n){var i=n.data;i&&i.links&&i.links.oneNoteWebUrl?e(i):t(new m.b(n,"Could not parse notebook item from Graph response"))})).catch((function(e){n.globalErrorHandler.handleError(e,"vFlcr")}))}),(function(e){e&&e.httpResponse?t(e.httpResponse.data?{error:{code:""+e.httpResponse.status,data:""+e.httpResponse.data}}:{error:{code:""+e.httpResponse.status}}):t()}),null,null,null,null,null,!0,{category:"CreateFile",fileType:s.b.OneNote})}))},t.prototype.getNoteBooks=function(e){var t=this;if("stale-while-revalidate"===e){var n=this.fetchNoteBooks("cache-only"),i=this.fetchNoteBooks("network-first");return u.a.createResultsWithCacheObservable(n,i)}return"cache-first-network-onmiss"===e?{results:r.a.create((function(e){t.fetchNoteBooks("cache-only").then((function(t){e.next(t),e.complete()})).catch((function(){t.fetchNoteBooks("network-first").then((function(t){e.next(t),e.complete()}))}))})),initialCompletion:null}:{results:r.a.create((function(n){t.fetchNoteBooks(e).then((function(e){n.next(e),n.complete()}))})),initialCompletion:null}},t.prototype.fetchNoteBooks=function(e){var n=this;return this.getGraph("OneNote_Graph_Get_NoteBooks_Request",t.myOneNoteEndpoint+"notebooks?orderby=lastModifiedTime%20desc",e,(function(e,t){t.params.RequestId=n.getRequestIdFromResponse(e)})).then((function(e){return Object.assign(e.data,{fromCache:e.fromCache})}))},t.prototype.handleQueryParam=function(e,t){"mockgetnotebooks"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)},t.myOneNoteEndpoint="me/onenote/",t.ɵprov=b.cc({factory:function(){return new t(b.dc(d.b),b.dc(a.a),b.dc(l.a),b.dc(c.a),b.dc(h.a),b.dc(v.q),b.dc(o.b),b.dc(f.a))},token:t,providedIn:"root"}),t}(p.a)},p6wn:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("lrJm"),r=n("BaAg"),o=(n("AXqk"),n("W3Zz")),a=n("Uqr9"),l=n("hhzZ"),s=function(){function e(e,t,n,i,r){this.instrumentationService=e,this.streamName=t,this.params=n,this.metrics=i,this.securityThreshold=r}return e.prototype.record=function(){this.instrumentationService.recordEvent(this)},e}(),c={0:"focused",1:"inspirational",2:"informational",3:"custom"},u=function(){function e(e,t,n){this.queuedEvents=e,this.dataSecurityService=t,this.deviceDetector=n,this.registeredEventFactories=[],this.initialPage="Unknown",this.serviceWorkerStateService=null,this.lastPageNav={time:0,from:void 0,to:void 0}}return e.prototype.registerServiceWorkerStateService=function(e,t){var n=this;if(this.serviceWorkerStateService)throw new i.a("DispatcherInstrumentationService.registerServiceWorkerStateService is not allowed to be called more than once");if(!e)throw new i.a("Must specify valid ServiceWorkerStateService when calling DispatcherInstrumentationService.registerServiceWorkerStateService");this.serviceWorkerStateService=e,t&&this.queuedEvents.forEach((function(e){return e.eventParams.ServiceWorkerState=n.serviceWorkerStateService.currentState}))},e.prototype.registerOfficeRouteService=function(e){var t=this;if(this.routeSubscriptionInitialized)throw new i.a("DispatcherInstrumentationService.registerOfficeRouteService is not allowed to be called more than once");if(!e)throw new i.a("Must specify valid OfficeRouteService when calling DispatcherInstrumentationService.registerOfficeRouteService");this.routeSubscriptionInitialized=!0,e.subscribeToRouteChangeStart((function(e){var n=!!e.currentRoute&&!!e.currentRoute.route,i=n?""+(e.currentRoute.app?r.b[e.currentRoute.app]:"")+e.currentRoute.route:"Unknown";t.lastPageNav={time:a.a.now(),from:t.lastPageNav.to,to:i},"Unknown"===t.initialPage&&"Unknown"!==i&&(t.initialPage=i),!t.queuedEventsPopulatedWithRoute&&n&&(t.queuedEvents.forEach((function(e){return e.eventParams.Page=i})),t.queuedEvents.forEach((function(e){return e.eventParams.InitialPage=t.initialPage})),t.queuedEventsPopulatedWithRoute=!0)}))},e.prototype.registerEventFactories=function(e){if(this.registeredEventFactories.length>0)throw new i.a("DispatcherInstrumentationService.registerEventFactories is not allowed to be called more than once");if(!e||0===e.length)throw new i.a("Must specify at least one event factory when calling DispatcherInstrumentationService.registerEventFactories");this.registeredEventFactories=e.slice(),this.drainQueuedEvents()},e.prototype.logGenericEvent=function(e,t,n,i){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===i&&(i=0),this.generateEvent(e,"Generic_Event",i,t,n,!0)},e.prototype.logImpressionEvent=function(e,t,n,i){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===i&&(i=0),this.generateEvent(e,"Generic_Impression",i,t,n,!0)},e.prototype.logRequestEvent=function(e,t,n,i,r,o,a,l){void 0===r&&(r=!1),void 0===o&&(o={}),void 0===a&&(a=[]),void 0===l&&(l=0),this.generateRequestEvent(e,t,n,i,r,o,a,l).record()},e.prototype.logClickEvent=function(t,n,i,r,o,l,s,c,u){void 0===l&&(l={}),void 0===s&&(s=[]),void 0===c&&(c=0),void 0===u&&(u=!1),s=s||[],i&&n&&"Unknown"!==n&&s.push(t+"."+i+"."+n),l.ElementId=n,r&&(l.Referral=r,s.push("Referral."+r),l.ReferralPlatform=o&&this.dataSecurityService.securityLevel>=2?o:"Web"),i&&(l.Area=i),u&&this.lastPageNav&&this.lastPageNav.from&&a.a.now()-this.lastPageNav.time<e.lastPageNavTimeout&&(l.Page=this.lastPageNav.from),this.generateEvent(t,"Generic_Click",c,l,s,!0)},e.prototype.logErrorEvent=function(e,t,n,i){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===i&&(i=0),this.generateEvent(e,"App_Error",i,t,n,!0)},e.prototype.logPerformanceEvent=function(e,t,n,i){return void 0===n&&(n={}),void 0===i&&(i=0),n.Latency=t.toString(),this.generateEvent(e,"Performance_Dump",i,n,[],!0)},e.prototype.logDebugCacheEvent=function(e,t,n,i){return void 0===t&&(t={}),void 0===n&&(n=[]),void 0===i&&(i=0),this.generateEvent(e,"Generic_Debug_Cache",i,t,n,!0)},e.prototype.applyGlobalStateParams=function(e,t){window.prelaunchMode&&(e.PrelaunchMode="true"),!t&&e.hasOwnProperty("Page")||(e.Page=this.lastPageNav.to||"Unknown"),!t&&e.hasOwnProperty("InitialPage")||(e.InitialPage=this.initialPage),!t&&e.hasOwnProperty("ServiceWorkerState")||(e.ServiceWorkerState=this.serviceWorkerStateService?this.serviceWorkerStateService.currentState:"Unknown"),!t&&e.hasOwnProperty("AppSecurityLevel")||(e.AppSecurityLevel=this.dataSecurityService.securityLevel.toString()),!t&&e.hasOwnProperty("NetworkType")||(e.NetworkType=o.c[this.deviceDetector.getNetworkInfo()]),window.initialPageLayout&&(e.InitialPageLayout=c[window.initialPageLayout]),window.pageLayout&&(e.CurrentPageLayout=window.pageLayout),window.hostSessionId&&(e.HostSessionId=window.hostSessionId),window.ringId&&(e.Ring=window.ringId)},e.prototype.flush=function(){this.drainQueuedEvents(),this.registeredEventFactories.forEach((function(e){return e.flush()}))},e.prototype.recordEvent=function(e){var t=e&&e.params&&(e.params.EventName&&e.params.EventName.indexOf("Error")>-1||e.params.Error&&"OK"!==e.params.Error);this.dataSecurityService.securityLevel<e.securityThreshold||window.disableLogs&&!t||(this.registeredEventFactories.length>0?this.registeredEventFactories.forEach((function(t){return t.createEvent(e.streamName,e.params,e.metrics).record()})):this.queuedEvents.push({streamName:e.streamName,eventName:e.params.EventName,eventParams:e.params,metrics:e.metrics,securityThreshold:e.securityThreshold}))},e.prototype.generateEvent=function(e,t,n,i,r,o){void 0===r&&(r=[]),void 0===o&&(o=!1),i.EventName=e,this.applyGlobalStateParams(i,!1);var a=i&&i.Error;a&&"string"==typeof a&&(i.Error=l.a.filterPii(a));var c=i&&i.DebugInfo;c&&"string"==typeof c&&(i.DebugInfo=l.a.filterPii(c)),"Performance_Dump"===t&&void 0!==window.startedFromServiceWorker&&(i.CachedPage=window.startedFromServiceWorker.toString()),"Generic_Click"===t&&(i.ReportingEnabled=window.isMetricsReportingEnabled?window.isMetricsReportingEnabled.toString():"false");var u=new s(this,t,i,r,n);return o&&u.record(),u},e.prototype.generateRequestEvent=function(e,t,n,i,r,o,a,l){return void 0===r&&(r=!1),void 0===o&&(o={}),void 0===a&&(a=[]),void 0===l&&(l=0),o.HttpCode=t.toString(),o.Latency=n.toString(),o.FromServiceWorkerCache=r.toString(),i&&(o.Error=i),this.generateEvent(e,"Generic_Request",l,o,a)},e.prototype.drainQueuedEvents=function(){var e=this;this.queuedEvents&&this.queuedEvents.splice(0,this.queuedEvents.length).forEach((function(t){e.generateEvent(t.eventName,t.streamName,t.securityThreshold,t.eventParams||{},t.metrics,!0)}))},e.lastPageNavTimeout=1e3,e}()},pOWU:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var i=n("3GGT"),r=n("pjz5"),o=function(){return function(e,t){this.httpResponse=e,this.clientError=t}}(),a=function(){function e(e,t,n,i,o,a,l,s,c){void 0===c&&(c=""),this.accessTokenService=e,this.instrumentationService=t,this.instrumentedHttp=n,this.tokenConsumer=i,this.contextService=o,this.officeHomeApiConfigService=a,this.scheduler=s,this.rpsCompactAuthHeaderPrefix=c,this.retryIntervalsInMs=[0,11,22,33],this.inMockMode=o.sharedContext.inMockMode,this.mockRequestHeader=a.config.mockRequestHeader,this.queryParams=r.a.getQueryParams(l.search)}return e.getErrorTypeFromServiceError=function(e){switch(e&&e.httpResponse&&e.httpResponse.status){case i.a.OK:case i.a.Created:case i.a.NoContent:return"None";case i.a.Unauthorized:case i.a.Forbidden:case i.a.TokenRefreshFailed:case i.a.TokenUnavailable:return"Unauthorized";case i.a.NotFound:return"NotFound";case i.a.RequestTimeout:case i.a.GatewayTimeout:case i.a.Timeout:return"Timeout";case i.a.Offline:return"Offline"}return"Generic"},e.prototype.handleQueryParam=function(e,t,n){},e.prototype.get=function(e,t,n,i,r,o,a,l,s,c,u,d){var p=this;void 0===d&&(d=0),"cache-only"===o&&(c="None"),this.scheduler.scheduleWork((function(){return p.request((function(n){return p.instrumentedHttp.get(e,t,n,o,a,l,s)}),e,n,i,r,c,u,null,"cache-only"===o)}),d)},e.prototype.getFromCache=function(e,t,n,i,r){void 0===r&&(r={}),this.get(e,t,n,i,r,"cache-only",null,null,null,"None")},e.prototype.post=function(e,t,n,i,r,o,a,l,s,c,u,d,p,h,f,m,b){var v=this;void 0===o&&(o={}),void 0===f&&(f=!1),void 0===m&&(m=null),void 0===b&&(b=0),"cache-only"===h&&(u="None"),this.scheduler.scheduleWork((function(){return v.request((function(i){return v.instrumentedHttp.post(e,t,n,i,a,l,s,c,h)}),e,i,r,o,u,d,p,!1,f,m)}),b)},e.prototype.put=function(e,t,n,i,r,o,a,l,s,c,u,d){var p=this;void 0===o&&(o={}),this.request((function(i){return p.instrumentedHttp.put(e,t,n,i,a,l,s,c)}),e,i,r,o,u,d)},e.prototype.delete=function(e,t,n,i,r,o,a,l,s,c){var u=this;void 0===o&&(o={}),this.request((function(i){return u.instrumentedHttp.delete(e,t,n,i,a,l)}),e,i,r,o,s,c)},e.prototype.patch=function(e,t,n,i,r,o,a,l,s,c,u,d){var p=this;void 0===o&&(o={}),this.request((function(i){return p.instrumentedHttp.patch(e,t,n,i,a,l,s,c)}),e,i,r,o,u,d)},e.prototype.isAuthError=function(e){return 401===e},e.prototype.isRetriableError=function(e){return!1},e.prototype.getRetryInterval=function(){var e=Math.floor(1e3*Math.random())%this.retryIntervalsInMs.length;return this.retryIntervalsInMs[e]},e.prototype.getRequestIdFromResponse=function(e,t){return void 0===t&&(t="request-id"),this.getHeaderValue(e.headers,t)},e.prototype.getHeaderValue=function(e,t){return e&&t&&e.get(t)},e.prototype.updateRequestConfig=function(e,t,n){t&&t.success&&e&&(this.setAuthHeader(e.headers,t),n&&n(e,t))},e.prototype.setAuthHeader=function(e,t){t&&e.set("Authorization",(""+("RPSCompact"===t.format?this.rpsCompactAuthHeaderPrefix:"Bearer ")+t.token).trim())},e.prototype.request=function(e,t,n,r,a,l,s,c,u,d,p){var h=this;void 0===a&&(a={}),void 0===u&&(u=!1),void 0===d&&(d=!1),void 0===p&&(p=null);var f=void 0===l?this.tokenConsumer:l,m="OfficeHome"===f,b=this.officeHomeApiConfigService.config,v="None"===f||m&&!b.jwtAuthEnabled,g=function(e){var n=e.status,a=Number.NaN;!v&&h.isAuthError(n)?a=i.a.TokenRefreshFailed:h.isRetriableError(n)&&(a=i.a.RetryFailed),a!==Number.NaN&&h.logCustomError(t,a,u),r(new o(e))};for(var y in this.queryParams)if(y&&this.queryParams.hasOwnProperty(y)){var S=this.queryParams[y];this.handleQueryParam(y.toLowerCase(),S,a)}a.headers||(a.headers=new Map),(v?Promise.resolve(null):this.accessTokenService.getAccessToken(f,!1,s,d,p)).then((function(l){var d,p,y;if(!v){if(!(l&&l.success||m&&b.jwtAuthEnabled&&b.jwtAuthOnOfficeHome)){var S=null!==(p=null===(d=null==l?void 0:l.error)||void 0===d?void 0:d.message)&&void 0!==p?p:"";return h.logCustomError(t,i.a.TokenUnavailable,u,S),void r(new o({data:"CAP_Error"===S?S:null,status:i.a.TokenUnavailable,subStatus:null===(y=null==l?void 0:l.error)||void 0===y?void 0:y.statusCode,headers:null,config:null,ok:!1,statusText:"Failed to fetch access token",fromCache:!1}))}h.updateRequestConfig(a,l,c)}var w=e(a);n(w),w.catch((function(t){if(!v&&h.isAuthError(t.status))h.accessTokenService.getAccessToken(f,!0,s).then((function(i){if(i.success){h.updateRequestConfig(a,i,c);var r=e(a);n(r),r.catch(g)}else g(t)}));else if(h.isRetriableError(t.status)){var i=h.getHeaderValue(t.headers,"Retry-After"),l=parseFloat(i||"0");!function(t,i){void 0===i&&(i=0),setTimeout((function(){var i=e(t);n(i),i.catch(g)}),i||h.getRetryInterval())}(a,Math.ceil(1e3*l))}else r(new o(t))}))}))},e.prototype.logCustomError=function(e,t,n,i){void 0===i&&(i=""),this.instrumentationService.logRequestEvent(e,t,-1,i,n)},e}()},pd4Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("/I02"),r=n("keVe"),o=function(){function e(e){this.contextService=e,this.startDate=new Date;var t=this.contextService.sharedContext.dateOverride;t&&(this.mockDate=new Date(t))}return e.prototype.getCurrentDate=function(){if(this.mockDate){var e=(new Date).getTime()-this.startDate.getTime();return new Date(this.mockDate.getTime()+e)}return new Date},e.prototype.getCurrentDateMinuteGranularity=function(){var e=this.getCurrentDate();return e.setSeconds(0,0),e},e.prototype.getLocalMidnight=function(){var e=this.getCurrentDate();return e.setHours(0,0,0,0),e},e.prototype.timespanInSeconds=function(e){return(this.getCurrentDate().getTime()-e.getTime())/1e3},e.prototype.getStartOfYear=function(){var e=this.getCurrentDate();return new Date(e.getFullYear(),0,0,0,0,0,0)},e.prototype.addDays=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())},e.prototype.addHours=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()+t,e.getMinutes(),e.getSeconds(),e.getMilliseconds())},e.prototype.addSeconds=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()+t,e.getMilliseconds())},e.DAY=864e5,e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},pdjy:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a}));var i=0,r=2,o=3,a=4},pgLp:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var i=3;function r(e){var t=e.slice(0,1)[0];if(t!==i)throw new Error("Encryption Version Mismatch. Cannot Decrypt. Expected: "+i+". Received: "+t);return e.slice(1,e.byteLength)}},pjz5:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("bb6g"),r=function(){function e(){}return e.getHostName=function(t){var n=e.getLocation(t);return n&&n.hostname||""},e.getLocation=function(t){if(t&&t.length){var n=t.match(e.UrlParserRegex);return n&&{href:t,protocol:n[1],host:n[2],hostname:n[3],port:n[4],path:n[5],search:n[6],hash:n[7]}}return null},e.getQueryParams=function(e){var t,n,r={};if(e){var o=e.split("&");try{for(var a=Object(i.__values)(o),l=a.next();!l.done;l=a.next()){var s=l.value,c=Object(i.__read)(s.split("="),2);r[c[0]]=c[1]}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}return r},e.getOrigin=function(t){var n=e.getLocation(t);return n&&n.protocol&&n.hostname?n.protocol+"//"+n.hostname:""},e.removeFileNameFromDocUrl=function(e){if(e)return e.substring(0,e.lastIndexOf("/"))},e.addMissingProtocol=function(e){return!(e=e.toLowerCase())||e.startsWith("http:")||e.startsWith("https:")||e.startsWith("mailto:")||e.startsWith("sip:")||e.startsWith("tel:")||e.startsWith("im:")?e:"https://"+e},e.UrlParserRegex=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join("")),e}()},pzhl:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return h}));var i=n("keVe"),r=n("TOqr"),o=n("xSeq"),a=n("g0MB"),l=n("w1PR"),s=n("PkQn"),c=n("4/We"),u=i.xb({encapsulation:2,styles:[],data:{}});function d(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"span",[],[[8,"id",0],[1,"title",0],[1,"aria-hidden",0]],null,null,null,null)),i.yb(1,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.yb(2,278528,null,0,r.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.classAttrValue),e(t,2,0,n.styleAttrValue)}),(function(e,t){var n=t.component;e(t,0,0,n.id||"",n.title,!n.ariaVisible)}))}function p(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"button",[["keyboardFocusTooltip",""]],[[8,"id",0],[8,"title",0],[1,"aria-label",0],[1,"aria-hidden",0],[1,"data-area",0],[1,"data-nav",0]],[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.handleClick()&&i),i}),null,null)),i.yb(1,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.yb(2,278528,null,0,r.n,[i.l,i.t,i.D],{ngStyle:[0,"ngStyle"]},null),i.yb(3,4210688,null,0,o.a,[i.l,i.h],{focusOnLoad:[0,"focusOnLoad"]},null),i.yb(4,4210688,null,0,a.a,[i.l,i.D,l.b],null,null)],(function(e,t){var n=t.component;e(t,1,0,n.classAttrValue),e(t,2,0,n.styleAttrValue),e(t,3,0,n.focusOnLoad)}),(function(e,t){var n=t.component;e(t,0,0,n.id||"",n.title,n.ariaLabel,!n.ariaVisible,n.dataArea,n.dataNav)}))}function h(e){return i.bc(2,[(e()(),i.ib(16777216,null,null,1,null,d)),i.yb(1,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,p)),i.yb(3,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,1,0,!n.iconButton),e(t,3,0,n.iconButton)}),null)}i.vb("ohp-icon-font",s.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-icon-font",[],null,null,null,h,u)),i.yb(1,638976,null,0,s.a,[c.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{color:"color",cssClass:"cssClass",iconFontCssClass:"iconFontCssClass",iconFontName:"iconFontName",iconFontType:"iconFontType",id:"id",size:"size",style:"style",title:"title",ariaVisible:"ariaVisible",ariaLabel:"ariaLabel",dataArea:"dataArea",dataNav:"dataNav",iconButton:"iconButton",isThirdParty:"isThirdParty",focusOnLoad:"focusOnLoad"},{iconClicked:"iconClicked"},[])},qTBP:function(e,t,n){},qfyf:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=new(n("keVe").q)("PERFORMANCE_QUEUE")},rBEp:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},rPZ4:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var i=n("keVe"),r=n("TOqr"),o=n("pzhl"),a=n("PkQn"),l=n("4/We"),s=n("Zy3K"),c=n("PBJH"),u=i.xb({encapsulation:2,styles:[],data:{}});function d(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,13,"div",[["class","create-location-wrapper"]],null,null,null,null,null)),i.yb(1,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(e()(),i.zb(2,0,null,null,11,"div",[["class","create-location"]],null,null,null,null,null)),i.yb(3,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(4,{"create-location--margin":0,"create-location--fluent":1}),(e()(),i.zb(5,0,null,null,3,"span",[["class","create-location__prompt"]],null,null,null,null,null)),i.yb(6,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(7,{"ms-fcl-ns":0,"ms-fcl-np":1}),(e()(),i.Yb(8,null,["",""])),(e()(),i.zb(9,0,null,null,1,"ohp-icon-font",[["cssClass","ms-ohp-svg-Icon ms-ohp-Icon--oneDriveLogo create-location__icon"],["size","16"]],null,null,null,o.b,o.a)),i.yb(10,638976,null,0,a.a,[l.a],{color:[0,"color"],cssClass:[1,"cssClass"],size:[2,"size"]},null),(e()(),i.zb(11,0,null,null,2,"span",[["class","create-location__path"]],[[8,"innerHTML",1]],null,null,null,null)),i.yb(12,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(13,{"ms-fcl-ns":0,"ms-fcl-np":1})],(function(e,t){var n=t.component;e(t,1,0,"create-location-wrapper",n.cssClass);var i=e(t,4,0,n.showMargin,n.fluentRefresh);e(t,3,0,"create-location",i);var r=e(t,7,0,!n.fluentRefresh,n.fluentRefresh);e(t,6,0,"create-location__prompt",r),e(t,10,0,n.oneDriveColor,"ms-ohp-svg-Icon ms-ohp-Icon--oneDriveLogo create-location__icon","16");var o=e(t,13,0,!n.fluentRefresh,n.fluentRefresh);e(t,12,0,"create-location__path",o)}),(function(e,t){var n=t.component;e(t,8,0,n.createLocationPrompt),e(t,11,0,n.createLocation)}))}i.vb("ohp-create-location",s.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-create-location",[],null,null,null,d,u)),i.yb(1,114688,null,0,s.a,[l.a,c.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{app:"app",showMargin:"showMargin",cssClass:"cssClass"},{},[])},rbdM:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("bb6g"),r=(n("EUVs"),n("4/We"),function(e){function t(t,n){var i=e.call(this,(function(){return i.wacContentService.loadMruItem(i.itemInfo.item,i.itemInfo.wdOriginType,!0)}))||this;return i.capabilitiesService=t,i.wacContentService=n,i}return Object(i.__extends)(t,e),t.prototype.enabled=function(){return this.capabilitiesService.wacHostEnabledForFileType(this.itemInfo.item.fileType)&&this.capabilitiesService.capabilities.wacHostHoverPreloadEnabled},t}(n("adME").a))},re3B:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("W3Zz"),r=n("BMb5"),o=n("keVe"),a=function(){function e(e,t){this.windowService=e;var n=t.getDeviceInfo(),r=n.platform.platformType;this.handlePageHide=(r===i.d.iPhone||r===i.d.iPad)&&n.browser.browserType===i.a.Safari}return e.prototype.addUnloadEvent=function(e,t){void 0===t&&(t=!1);var n=!1,i=this.windowService.nativeWindow,r=function(i,r){var o=void 0;return t&&r&&(o=r(i)),n||(n=!0,e()),!t&&r&&(o=r(i)),o},o=i.onbeforeunload;if(i.onbeforeunload=function(e){return r(e,o&&o.bind(i))},this.handlePageHide){var a=i.onpagehide;i.onpagehide=function(e){return r(e,a&&a.bind(i))}}},e.ɵprov=o.cc({factory:function(){return new e(o.dc(r.b),o.dc(i.b))},token:e,providedIn:"root"}),e}()},"s+Eq":function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return s}));var i=n("keVe"),r=n("lrJm"),o=(n("5FMq"),n("24t9")),a=(n("mu6k"),function(){return function(){}}()),l=function(){return function(e){this.templateRef=e}}(),s=function(){function e(e,t){this.changeDetectorRef=e,this.contextMenuService=t,this.leftAlignedCard=!1,this.fullWidth=!1,this.toggleDisabled=!1,this.hideContent=!1,this.multiSelect=!1,this.ariaRole="option",this.selectedIndex=-1,this.toggleMenu=new i.n,this.selectItem=new i.n,this.focusLink=new i.n}return e.prototype.ngOnInit=function(){var e=this;this.opened=!1,this.focusActive=!1,this.mobileContextMenu&&this.contextMenuService.subscribeToCloseEvents((function(t){t&&t.menu&&e.menuModel&&t.menu.id===e.menuModel.id&&e.onCloseMenu()})),this.themeEnabled&&this.themeEnabled.subscribe((function(t){e.isThemeEnabled=t}))},e.prototype.ngOnDestroy=function(){this.opened&&this.toggleMenu.emit(!1)},e.prototype.ngAfterViewInit=function(){if(1!==this.menuItems.length)throw new r.a("Must have exactly 1 *ohpDropdownMenuItemContent in a DropdownMenu as a child");this.menuItemTemplate=this.menuItems.first.templateRef,this.changeDetectorRef.detectChanges()},e.prototype.onToggleMenu=function(e,t){if(t.preventDefault(),this.toggleDisabled&&!this.fullWidth)return this.opened=!0,void this.toggleMenu.emit(!0);this.opened!==e&&(e||!this.menu?(e&&!this.hideContent&&this.mobileContextMenu&&this.contextMenuService.showMenu({menu:this.menuModel,position:{left:0,top:0},focusFirstItem:this.focusActive}),this.opened=e,this.toggleMenu.emit(e)):this.menu.close())},e.prototype.onSelectItem=function(e){this.selectItem.emit(e)},e.prototype.onCloseMenu=function(e){this.opened=!1,(this.focusActive||e)&&this.dropdownLink.nativeElement.focus(),this.focusActive=!1,this.toggleMenu.emit(!1)},e.prototype.handleKey=function(t){var n=o.a.getKey(t);if(this.opened){if(-1!==e.expectedKeys.indexOf(n)){t.preventDefault();var i=this.menuModel.items.length-1;switch(n){case 1:case 2:case 3:this.onToggleMenu(!1,t);break;case 4:this.focusActive=!0,this.menu.setActiveIndex(i,!0);break;case 5:this.focusActive=!0,this.menu.setActiveIndex(0,!0)}}}else 2===n&&(this.focusActive=!0)},e.prototype.handleFocus=function(e){this.focusLink.emit(e)},e.expectedKeys=[1,2,3,4,5],e}()},sCgQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"sH0/":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("firstRunCalloutsConfig")||{hideInTestMode:!0,version:0,dragAndDropCalloutEnabled:!1,findMoreAppsCommercialSvg:"",findMoreAppsConsumerSvg:"",findMoreAppsEduSvg:"",manageContentSvg:"",createHereSvg:"",uploadContentSvg:"",allSetSvg:"",upgradeSvg:"",welcomeBackSvg:"",adminCenterSvg:"",officeMobileAppSvg:""}}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},tjsK:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("bb6g"),r=function(e){function t(t,n){var i=e.call(this,t)||this;return i.message=t,i.originalError=n,i.name="ApplicationError",i}return Object(i.__extends)(t,e),t}(Error)},ttrr:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("5FMq"),n("W3Zz");var i=function(){function e(e,t){this.contextMenuService=e,this.deviceDetector=t}return e.prototype.ngOnInit=function(){this.desktop=this.deviceDetector.isDesktopDevice()},e.prototype.onContextMenu=function(e){var t=this;this.desktop&&this.model&&e&&!this.disabled&&(e.preventDefault(),setTimeout((function(){t.contextMenuService.showMenu({menu:t.model,position:{left:e.clientX,top:e.clientY}})}),0))},e}()},tuJr:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return y}));var i=n("keVe"),r=n("TOqr"),o=n("RitX"),a=n("mu6k"),l=n("W3Zz"),s=n("hZW2"),c=n("PBJH"),u=n("BMb5"),d=n("g0MB"),p=n("w1PR"),h=n("s+Eq"),f=n("5FMq"),m=i.xb({encapsulation:2,styles:[],data:{}});function b(e){return i.bc(0,[(e()(),i.ib(0,null,null,0))],null,null)}function v(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,2,null,b)),i.yb(2,540672,null,0,r.o,[i.O],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),i.Rb(3,{item:0,index:1}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,3,0,t.context.item,t.context.index);e(t,2,0,i,n.menuItemTemplate)}),null)}function g(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"ohp-menu",[],null,[[null,"selectItem"],[null,"closeMenu"]],(function(e,t,n){var i=!0,r=e.component;return"selectItem"===t&&(i=!1!==r.onSelectItem(n)&&i),"closeMenu"===t&&(i=!1!==r.onCloseMenu(n)&&i),i}),o.b,o.a)),i.yb(1,4440064,[[2,4]],1,a.a,[l.b,s.a,i.h,c.a,i.D,i.l,u.b],{menuModel:[0,"menuModel"],animateClose:[1,"animateClose"],leftAlignedCard:[2,"leftAlignedCard"],multiSelect:[3,"multiSelect"],contextAriaLabel:[4,"contextAriaLabel"],ariaRole:[5,"ariaRole"],selectedIndex:[6,"selectedIndex"]},{selectItem:"selectItem",closeMenu:"closeMenu"}),i.Ub(603979776,3,{menuItems:1}),(e()(),i.ib(0,null,null,1,null,v)),i.yb(4,16384,[[3,4]],0,a.b,[i.L],null,null)],(function(e,t){var n=t.component;e(t,1,0,n.menuModel,!0,n.leftAlignedCard,n.multiSelect,n.menuModel.linkAriaLabel,n.ariaRole,n.selectedIndex)}),null)}function y(e){return i.bc(0,[i.Ub(671088640,1,{dropdownLink:0}),i.Ub(671088640,2,{menu:0}),(e()(),i.zb(2,0,null,null,11,"div",[["class","dropdown-menu-wrapper"]],[[8,"id",0]],null,null,null,null)),i.yb(3,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(4,{"dropdown-menu-wrapper--relative":0,"dropdown-menu-wrapper--max-width":1}),(e()(),i.zb(5,0,[[1,0],["dropdownLink",1]],null,4,"button",[["data-clicklog","custom"],["keyboardFocusTooltip",""]],[[8,"id",0],[1,"aria-label",0],[1,"aria-expanded",0],[1,"aria-owns",0],[1,"aria-describedby",0],[8,"title",0]],[[null,"click"],[null,"keydown"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.onToggleMenu(!r.opened,n)&&i),"keydown"===t&&(i=!1!==r.handleKey(n)&&i),"focus"===t&&(i=!1!==r.handleFocus(!0)&&i),"blur"===t&&(i=!1!==r.handleFocus(!1)&&i),i}),null,null)),i.yb(6,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Pb(7,3),i.yb(8,4210688,null,0,d.a,[i.l,i.D,p.b],null,null),i.Nb(null,0),(e()(),i.zb(10,0,null,null,1,"p",[["class","aria-description"]],[[8,"id",0]],null,null,null,null)),(e()(),i.Yb(11,null,["",""])),(e()(),i.ib(16777216,null,null,1,null,g)),i.yb(13,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,4,0,!n.overridePositioning,n.fullWidth);e(t,3,0,"dropdown-menu-wrapper",i);var r=e(t,7,0,n.menuModel.linkCssClass,n.isThemeEnabled&&n.menuModel.themeCssClass&&!n.opened?n.menuModel.themeCssClass:"",n.opened&&n.menuModel.openCssClass?n.menuModel.openCssClass:"");e(t,6,0,r),e(t,13,0,n.opened&&!n.mobileContextMenu&&!n.hideContent)}),(function(e,t){var n=t.component;e(t,2,0,i.Gb(1,"",n.menuModel.id,"-dropdown-wrapper")),e(t,5,0,i.Gb(1,"",n.menuModel.id+"-dropdown-link",""),n.menuModel.linkAriaLabel,n.opened?"true":"false",n.opened?n.menuModel.id+"-dropdown":null,n.menuModel.id+"-button-description",n.menuModel.linkTooltip||""),e(t,10,0,i.Gb(1,"",n.menuModel.id+"-button-description","")),e(t,11,0,n.menuModel.linkAriaDescription)}))}i.vb("ohp-dropdown-menu",h.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"ohp-dropdown-menu",[],null,null,null,y,m)),i.yb(1,4440064,null,1,h.a,[i.h,f.a],null,null),i.Ub(603979776,1,{menuItems:1})],(function(e,t){e(t,1,0)}),null)}),{menuModel:"menuModel",overridePositioning:"overridePositioning",mobileContextMenu:"mobileContextMenu",leftAlignedCard:"leftAlignedCard",fullWidth:"fullWidth",toggleDisabled:"toggleDisabled",themeEnabled:"themeEnabled",hideContent:"hideContent",multiSelect:"multiSelect",ariaRole:"ariaRole",selectedIndex:"selectedIndex"},{toggleMenu:"toggleMenu",selectItem:"selectItem",focusLink:"focusLink"},["[ohpMenuLinkContent]"])},"tv+F":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(e,t){this.router=e,this.capabilitiesService=t}return e.prototype.checkEnabledAndRedirect=function(e,t,n,i){return e||(null!=i?!i:this.router.navigated)||this.router.navigate([null!=t?t:this.getDefaultRedirect()],n?{queryParams:n}:{}),e},e.prototype.getDefaultRedirect=function(){switch(this.capabilitiesService.getWorkload()){case"embed":return"embed/home";default:return"home"}},e}()},twlh:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("lrJm"),r=n("Uqr9"),o=n("re3B"),a=n("/I02"),l=n("uUrA"),s=n("keVe"),c=n("y1jW"),u=function(){function e(e,t,n){this.contextService=e,this.unloadEventService=t,this.eventManager=n,this.currentSessionIndex=0,this.currentSessionId=null,this.currentSessionStartTime=0,this.currentSessionClickCount=0,this.inactivityStartTime=0,this.inactivityTrackerStartTime=0,this.cumulativeDurationOfActivitySessions=0,this.cumulativeDurationBetweenActivitySessions=0,this.cumulativeClickCount=0}return e.prototype.initialize=function(e){var t=this;if(this.contextService.sharedContext.activityTrackingEnabled){this.instrumentationService=e;var n=function(){t.startSession(),t.trackInactivity()};n(),this.mousedownListener=this.eventManager.addGlobalEventListener("document","mousedown",n),this.mousemoveListener=this.eventManager.addGlobalEventListener("document","mousemove",n),this.keypressListener=this.eventManager.addGlobalEventListener("document","keypress",n),this.unloadEventService.addUnloadEvent((function(){t.mousedownListener&&t.mousedownListener(),t.mousemoveListener&&t.mousemoveListener(),t.keypressListener&&t.keypressListener(),clearTimeout(t.inactivityTrackerTimeout),t.endSession(t.inactivityTrackerStartTime?r.a.now()-t.inactivityTrackerStartTime:0)}))}},e.prototype.startSession=function(){if(!this.contextService.sharedContext.activityTrackingEnabled)return null;if(this.currentSessionId)return this.currentSessionId;this.currentSessionStartTime=r.a.now(),this.currentSessionId=l.a.createGuid(),this.currentSessionIndex++,this.currentSessionClickCount=0;var e={};if(e.ActivitySessionId=this.currentSessionId,e.Index=this.currentSessionIndex.toString(),this.currentSessionIndex>1){if(this.inactivityStartTime<=0)throw new i.a("Logical error in ActivitySessionService: inactivityStartTime must be set to valid value when startSession() is called");var t=this.currentSessionStartTime-this.inactivityStartTime;this.cumulativeDurationBetweenActivitySessions+=t,e.Latency=Math.ceil(t).toString()}return this.instrumentationService.logGenericEvent("Activity_Session_Started",e),this.currentSessionId},e.prototype.endSession=function(e){if(void 0===e&&(e=0),!this.contextService.sharedContext.activityTrackingEnabled)return null;if(!this.currentSessionId)return this.getCurrentStats();this.inactivityStartTime=r.a.now()-e;var t={};t.ActivitySessionId=this.currentSessionId,t.Index=this.currentSessionIndex.toString(),t.ClickCount=this.currentSessionClickCount.toString();var n=this.inactivityStartTime-this.currentSessionStartTime;return this.cumulativeDurationOfActivitySessions+=n,t.Latency=Math.ceil(n).toString(),this.instrumentationService.logGenericEvent("Activity_Session_Finished",t),this.currentSessionId=null,this.getCurrentStats()},e.prototype.incrementClick=function(){this.startSession(),this.currentSessionClickCount++,this.cumulativeClickCount++},e.prototype.getCurrentStats=function(){return{activitySessionsCount:this.currentSessionIndex,cumulativeClickCount:this.cumulativeClickCount,cumulativeDurationOfActivitySessions:this.cumulativeDurationOfActivitySessions,cumulativeDurationBetweenActivitySessions:this.cumulativeDurationBetweenActivitySessions,inactivityStartTime:this.inactivityStartTime}},e.prototype.trackInactivity=function(){var e=this;clearTimeout(this.inactivityTrackerTimeout),this.inactivityTrackerStartTime=r.a.now(),this.inactivityTrackerTimeout=setTimeout((function(){return e.endSession(r.a.now()-e.inactivityTrackerStartTime)}),1e3*this.contextService.sharedContext.inactivityTimeoutInSeconds)},e.ɵprov=s.cc({factory:function(){return new e(s.dc(a.a),s.dc(o.a),s.dc(c.d))},token:e,providedIn:"root"}),e}()},u51t:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("Uqr9"),r=(n("hhzZ"),n("4/We"),function(){function e(e,t){this.instrumentationService=t,this.enabled=e.capabilities.hoverPreloadTelemetryEnabled}return e.prototype.onMouseEnter=function(){this.enabled&&(this.startTime=i.a.now())},e.prototype.onMouseLeave=function(){this.startTime&&this.log(!1)},e.prototype.onClick=function(){this.startTime&&this.log(!0)},e.prototype.reset=function(){this.startTime=null},e.prototype.log=function(e){var t=this.getTimeElapsed().toString(),n={};n.TimeElapsed=t,n.Area=this.area,n.DocumentHoverClick=e.toString(),this.instrumentationService.logGenericEvent("Document_Hover",n),this.reset()},e.prototype.getTimeElapsed=function(){return i.a.now()-this.startTime},e}())},uG5N:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("AlWG"),r=n("k+kJ"),o=n("keVe"),a=function(){function e(){this._uploadResources=new i.a(null),this.uploadResources=this._uploadResources.asObservable(),this._uploadSession=new i.a(null),this.uploadSession=this._uploadSession.asObservable()}return e.prototype.upload=function(e,t,n,i,r){var o=this;if(this.uploadInProgress&&!this.uploadInProgress.finished())return null;this.currentSubscription&&(this.currentSubscription.unsubscribe(),this.currentSubscription=null,this.uploadInProgress=null);var a=t.upload(e,n,r);return a&&(this.currentSubscription=a.subscribe((function(e){o._uploadResources.next(i),o.uploadInProgress=e,o._uploadSession.next(e)}))),a},e.prototype.uploadFiles=function(e,t,n,o){var a=this;if(this.uploadInProgress&&!this.uploadInProgress.finished())return null;this.currentSubscription&&(this.currentSubscription.unsubscribe(),this.currentSubscription=null,this.uploadInProgress=null);var l=new r.b(t,e[0],o),s=new i.a(l);return l.cancellationToken.onCancel((function(){l.state=r.c.Cancelled,s.next(l)})),l.error={title:n.multipleFilesErrorTitle,type:r.a.MultipleFiles,message:n.multipleFiles},l.state=r.c.Failed,s.next(l),this.currentSubscription=s.subscribe((function(e){a._uploadResources.next(n),a.uploadInProgress=e,a._uploadSession.next(e)})),s.asObservable()},e.prototype.cancelUpload=function(){this.uploadInProgress&&this.uploadInProgress.cancellationToken.cancel()},e.ɵprov=o.cc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},"uH9+":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("pd4Y"),r=n("keVe"),o=function(){function e(e){this.dateService=e}return e.prototype.getTimestampType=function(e){var t=this.dateService.timespanInSeconds(e),n=this.dateService.getLocalMidnight(),i=this.dateService.addDays(n,-1),r=this.dateService.addDays(n,-6),o=this.dateService.getStartOfYear();return t>=-3300&&t<-60?9:t<0?0:t<120?1:t<3600?2:e>=n?3:e>=i?4:e>=r?5:e>=o?6:7},e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},uNUv:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("hhzZ"),r=n("BaAg"),o=n("kfAr"),a=n("QOOv"),l=n("keVe"),s=function(){function e(e,t){this.instrumentationService=e,this.mruConfigService=t,this.recordedThumbnails=new Set}return e.prototype.instrumentThumbnailLoad=function(e,t,n,i,r){if(this.mruConfigService.config.logThumbnailLoadSuccess&&!this.recordedThumbnails.has(t)&&o.a.thumbnailFileTypes.has(r)){var a=this.getInstrumentationParams(e?"Success":"Failed",n,i,r);this.instrumentationService.logGenericEvent("Thumbnail_Load",a),this.recordedThumbnails.add(t)}},e.prototype.getInstrumentationParams=function(e,t,n,i){var o={};return o.State=e,o.ItemCategory=t,o.Index=n.toString(),o.DocumentType=r.b[i],o},e.ɵprov=l.cc({factory:function(){return new e(l.dc(i.a),l.dc(a.a))},token:e,providedIn:"root"}),e}()},uReB:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var i=n("bb6g"),r=n("hBZP"),o=function(e){return e.ActionsUpdated="actions-updated",e}({}),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.on=function(t,n){return e.prototype.on.call(this,t,n)},t.prototype.once=function(t,n){return e.prototype.once.call(this,t,n)},t.prototype.emit=function(t){return e.prototype.emit.call(this,t)},t}(r.EventEmitter)},uUrA:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("Uqr9"),r=function(){function e(){}return e.createGuid=function(){var e=i.a.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))},e}()},uV9m:function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return m}));var i,r,o=n("tjsK"),a=n("ZBSS"),l=n("Y22C"),s=n("kxm0"),c=[],u=new l.a,d=!1;function p(e,t){void 0===t&&(t={}),c.length>0?c.forEach((function(n){e&&function(e){switch(e[a.k]){case"PageView":return r.pageViewEnabled;case"Action":return r.actionEnabled;default:return!1}}(t)&&n.logEvent(e,t)})):(e||void 0===e&&Object(s.c)(t))&&u.queueEvent({eventName:e,params:t})}function h(e,t,n){if(c.length>0)throw new o.a("initializeInstrumentationService is not allowed to be called more than once");if(!e||0===e.length)throw new o.a("Must specify at least one event factory when calling initializeInstrumentation");i=t,d=!0,r=n,c=e.slice(),function(){u.drainQueue().forEach((function(e){Object(s.c)(e.params)&&(e.params=Object(s.e)(e.params),e.eventName=Object(s.a)(Object(s.b)(e.params))),p(e.eventName,e.params)}))}()}function f(){return d}function m(){return i()}},uWZl:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.fullPageReady=function(){return e.readyPromise?e.readyPromise:e.readyPromise=e.createListener("FullAuthPageRendered")},e.shellAndConfigsReady=function(){return e.shellAndConfigsReadyPromise?e.shellAndConfigsReadyPromise:e.shellAndConfigsReadyPromise=e.createListener("ShellInfoLoaded")},e.createListener=function(e){var t="readystatechange";return new Promise((function(n){var i=function(){/^(?:interactive|complete)$/.test(document.readyState)&&(document.removeEventListener(t,i),document.getElementById(e)&&n())};document.addEventListener(t,i),i()}))},e}()},ufVG:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.reactShellConfig=e.parse("reactShellConfiguration")||{activityTimeout:0,correlationId:null,culture:null,feedbackLinkText:null,homePageTitle:null,homePageUrl:null,isConsumer:!1,logoutText:null,logoutUrl:null,mePhotoSource:null,puid:null,responsiveShellEnabled:!1,searchInHeader:!1,shellBootHost:null,shellDelayResourcesEnabled:!1,showOCVFeedbackLink:!1,signinState:[],controlsClaim:[],stickyNotesEnabled:!1,switchAccountLinkText:null,testTraffic:!1,thirdPartyNoticeLinkText:null,thirdPartyNoticeUrl:null,upn:null,userDisplayName:null,version:null,workloadSettingsSubLinksTitle:null,darkModeEnabled:!1,resourceUrl:null,environment:null,consumerShellServiceEnabled:!1,languageCode:null,acctSwitchingConfig:null,meetNowLinkUrl:"",meetNowEnabled:!1}}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},up2P:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},upmJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"uqr+":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("zGJG");function r(e){return e.join(i.a)}},uzn7:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("bb6g"),r=n("hhzZ"),o=n("cgnd"),a=n("XV2T"),l=n("BMb5"),s=n("keVe"),c=function(e){function t(t,n,i){var r=this;try{r=e.call(this,n.config.puid,i.getStorage(l.a.LocalStorage))||this,i.isStorageAvailable(l.a.LocalStorage)||t.logGenericEvent("Local_Storage_Unavailable")}catch(e){}return r}return Object(i.__extends)(t,e),t.ɵprov=s.cc({factory:function(){return new t(s.dc(r.a),s.dc(o.b),s.dc(l.b))},token:t,providedIn:"root"}),t}(a.a)},v3sZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("oneNoteConfig")||{oneNoteApiPath:null,enableOneNoteApis:!1}}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},vHlr:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var i=n("hhzZ"),r=n("BaAg"),o=n("p6Zr"),a=n("kpuN"),l=n("hZW2"),s=n("Bc8L"),c=n("TIi1"),u=n("EUVs"),d=n("4/We"),p=n("cgnd"),h=n("/I02"),f=n("ZBli"),m=n("k+kJ"),b=n("JScD"),v=n("uG5N"),g=n("9MHL"),y=n("keVe"),S=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d){this.accessTokenService=e,this.documentService=t,this.capabilitiesService=n,this.contextService=i,this.instrumentationService=r,this.localAppLauncherService=o,this.startupConfigService=a,this.uploadManagerService=l,this.uploadConfigService=s,this.oneDriveUploadService=c,this.urlLauncherService=u,this.wacContentService=d}return e.prototype.getClickDataForId=function(e,t,n,r,o){var a={};return a.UploadSessionId=t,a.ElementId=e=r?e+"-"+r:e,a.Area=this.contextService.isEdgeworth?i.b.Edgeworth:i.b.Documents,a.ItemCount=(o||0).toString(),a.ItemCategory=m.d[n],{eventName:"Upload_Click",params:a,metrics:[]}},e.prototype.uploadFile=function(e,t,i,o,a){var l=this,s=r.a.fileTypeFromFileName(e.name),c=!1,u=function(e,t){c||(c=!0,l.logClick(o,i,a,s,e,t))},d=this.uploadManagerService.upload(e,this.oneDriveUploadService,i,this.uploadConfigService.config.oneDriveResources,a);if(d){var p=(new Date).getTime(),h=p.toString(),b=!1;this.uploadSubscription=d.subscribe((function(e){if(e.state===m.c.Completed){b=!0;var o={};o.UploadSessionId=i,o.Latency=Math.ceil(e.duration).toString(),o.ItemCategory=m.d[a],l.instrumentationService.logGenericEvent("Upload_Completed",o,["Upload_Completed"]);var c=l.capabilitiesService.capabilities.outgoingLoginHintEnabled,d=f.a.appendLoginHint(e.result.canonicalUrl,l.startupConfigService.config.loginHint,c),v={wdNewAndOpenCt:h,ct:h,wdPreviousSession:l.startupConfigService.config.sharedClientStartupContext.correlationId,wdOrigin:l.contextService.getWdOrigin("UPLOAD")};c&&(v.login_hint=l.startupConfigService.config.loginHint);var g=f.a.appendQueryParams(e.result.webUrl,v),y=function(){if("cloudtest"!==l.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment){var t=function(t){if(u(!0,"Web"),l.capabilitiesService.capabilities.wacHostUploadEnabled&&l.capabilitiesService.wacHostEnabledForFileType(s)){var i=e.result;l.wacContentService.bootstrapAndRoute({docId:i.docId,driveId:i.driveId,docUrl:g,fileType:s,wdOrigin:v.wdOrigin},void 0,p),e.markCompletedAndOpenedInOfficeHome()}else l.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(g,{action:"Upload",linkTarget:t})})):l.urlLauncherService.openUrl(g,"Upload",t)};l.capabilitiesService.capabilities.isEmbedMode&&l.capabilitiesService.capabilities.embedModeEnabled?t("_blank"):d?l.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchApp(r.b[s],d,{action:"OpenDocument"}).then((function(e){e.success?u(!0,"Native"):t("_blank")})).catch((function(){return t("_top")}))})):l.localAppLauncherService.launchOfficeApp(r.b[s],d).then((function(e){e?u(!0,"Native"):t("_blank")})).catch((function(){return t("_top")})):t(l.capabilitiesService.capabilities.pwaEnabled?"_blank":"_top")}},S=l.uploadConfigService.config.minUploadDuration-e.duration;S<=0?y():setTimeout(y,S)}else e.state===m.c.Cancelled?(l.uploadSubscription.unsubscribe(),t&&setTimeout((function(){return t.nativeElement.focus()}),0),b||u(!1)):e.state===m.c.Failed&&u(!1)}))}},e.prototype.uploadFiles=function(e,t,n,i){var a=this,l=r.a.fileTypeFromFileName(e[0].name),s=!1,c=function(e,c){if(!s){s=!0;var u=a.getClickDataForId(n,t,i);a.instrumentationService.logClickEvent(u.eventName,n,u.params.Area,e?a.uploadConfigService.config.uploadFileTypes.has(l)?r.a.referralFromFileType(l):o.a.OneDrive:"",c,u.params,u.metrics)}},u=this.uploadManagerService.uploadFiles(e,t,this.uploadConfigService.config.oneDriveResources,i);u&&(this.uploadSubscription=u.subscribe((function(e){e.state===m.c.Cancelled?(a.uploadSubscription.unsubscribe(),c(!1)):e.state===m.c.Failed&&c(!1)})))},e.prototype.startUploadFlow=function(e,t,n,i,o){var a=this;this.documentService.selectFile(e).then((function(e){var l=e[0],s=r.a.fileTypeFromFileName(l.name),c=a.startupConfigService.config.authType===p.a.MSA;a.accessTokenService.getAccessToken(c?"OneDrive":"Graph",!1,null,c||a.uploadConfigService.config.capPopupEnabled,{category:"Upload",fileType:s}).then((function(){a.uploadFile(l,n,t,i,o)}))}))},e.prototype.logClick=function(e,t,n,i,a,l){var s=this.getClickDataForId(e,t,n);this.instrumentationService.logClickEvent(s.eventName,e,s.params.Area,a?this.uploadConfigService.config.uploadFileTypes.has(i)?r.a.referralFromFileType(i):o.a.OneDrive:"",l,s.params,s.metrics)},e.ɵprov=y.cc({factory:function(){return new e(y.dc(a.b),y.dc(l.a),y.dc(d.a),y.dc(h.a),y.dc(i.a),y.dc(s.a),y.dc(p.b),y.dc(v.a),y.dc(b.a),y.dc(g.a),y.dc(c.a),y.dc(u.a))},token:e,providedIn:"root"}),e}()},vW6f:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=new(n("keVe").q)("ShellHeight")},vXf5:function(e,t,n){"use strict";var i,r;n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e[e.Darker=0]="Darker",e[e.Dark=1]="Dark",e[e.DarkAlt=2]="DarkAlt",e[e.Primary=3]="Primary",e[e.Secondary=4]="Secondary",e[e.Tertiary=5]="Tertiary",e[e.Light=6]="Light",e[e.Lighter=7]="Lighter",e[e.LighterAlt=8]="LighterAlt"}(i||(i={})),function(e){e[e.White=0]="White",e[e.NeutralLighterAlt=1]="NeutralLighterAlt",e[e.NeutralLighter=2]="NeutralLighter",e[e.NeutralLight=3]="NeutralLight",e[e.NeutralQuaternaryAlt=4]="NeutralQuaternaryAlt",e[e.NeutralQuaternary=5]="NeutralQuaternary",e[e.NeutralTertiaryAlt=6]="NeutralTertiaryAlt",e[e.NeutralTertiary=7]="NeutralTertiary",e[e.NeutralSecondaryAlt=8]="NeutralSecondaryAlt",e[e.NeutralSecondary=9]="NeutralSecondary",e[e.NeutralPrimaryAlt=10]="NeutralPrimaryAlt",e[e.NeutralPrimary=11]="NeutralPrimary",e[e.NeutralDark=12]="NeutralDark",e[e.Black=13]="Black",e[e.WhiteHover=14]="WhiteHover",e[e.NeutralLighterAltHover=15]="NeutralLighterAltHover",e[e.NeutralLighterHover=16]="NeutralLighterHover",e[e.WhitePressed=17]="WhitePressed",e[e.NeutralLighterAltPressed=18]="NeutralLighterAltPressed",e[e.NeutralLighterPressed=19]="NeutralLighterPressed",e[e.WhiteSelected=20]="WhiteSelected",e[e.NeutralLighterSelected=21]="NeutralLighterSelected",e[e.Disabled=22]="Disabled"}(r||(r={}));var o="ohpAppTheme"},vcPZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,h,f,m,b,v,g,y,S,w,C){void 0===o&&(o=[]),void 0===a&&(a=[]),void 0===l&&(l="callout"),void 0===s&&(s=!1),void 0===c&&(c=!1),void 0===u&&(u=!1),void 0===d&&(d=""),void 0===p&&(p=!1),void 0===h&&(h=null),void 0===w&&(w=!1),this.calloutElement=e,this.calloutType=t,this.area=n,this.title=i,this.subTitle=r,this.activationClasses=o,this.initialClasses=a,this.buttonIdPrefix=l,this.persistDismissal=s,this.persistCompletion=c,this.inline=u,this.imageClass=d,this.teachingCallout=p,this.dismissCalloutObservable=h,this.horizontalOffsetOverride=f,this.verticalOffsetOverride=m,this.footer=b,this.arrowDisplacementOffset=v,this.ariaDescription=g,this.svgImage=y,this.calloutOnTop=S,this.centered=w,this.instrumentImpressionEvent=C,this.completed=!1}return e.prototype.isValid=function(){return(this.calloutElement||this.centered)&&(!!this.subTitle||!!this.title)},e}()},w1PR:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return x}));var i,r=n("bb6g"),o=n("dlqR"),a=n("NLr0"),l=n("XjVN"),s=n("SQAW"),c=n("beop"),u=n("1zhX"),d=n("f0qX"),p=n("dpyN"),h=n("6/Wk"),f=n("Q3dK"),m=n("zvoD"),b=n("vXf5"),v=n("hhzZ"),g=n("BaAg"),y=n("4/We"),S=n("cgnd"),w=n("/I02"),C=n("PBJH"),I=n("JH4S"),T=n("MFXD"),k=n("dFxn"),A=n("hZW2"),P=n("7Gwk"),E=n("R4AA"),_=n("Z0U4"),O=n("casz"),F=n("5aVq"),D=n("Ax7d"),M=n("BMb5"),R=n("keVe");!function(e){e.Side="Side",e.Pattern="Pattern",e.Default="Default"}(i||(i={}));var x=function(){function e(e,t,i,o,s,b,v,y,w,C,I,k,A,P,E,_){var O=this;this.documentService=e,this.eventService=t,this.capabilitiesService=i,this.clientStartupService=s,this.contextService=b,this.instrumentationService=v,this.userContext=y,this.routeService=w,this.schedulerService=C,this.locService=I,this.windowService=k,this.ngZone=A,this.shellShimService=P,this.webPwaService=E,this.ntpService=_,this.fluentThemeSubject=new T.a,this.fluentThemeSubscription=this.fluentThemeSubject.asScopableObservable(),this.isSearchDarkModeEcsConfigEnable=!1;var F=this.capabilitiesService.capabilities;this.defaultTheme=F.fluentRefresh?k.nativeWindow.commercialDefaultThemeFluent:k.nativeWindow.commercialDefaultTheme,F.fluentRefresh&&this.clientStartupService.config.authType===S.a.OrgId&&this.schedulerService.scheduleWork((function(){Promise.all([n.e(12),n.e(447)]).then(n.bind(null,"fFwu")).then((function(e){e.initializeFluentTheme(O.fluentThemeSubscription)}))}),0),this.isPWA=i.capabilities.pwaEnabled,this.themeShadeClassPostfixes=new Map,this.grayscaleThemeShadeClassPostfixes=new Map,this.supportedAppThemes=new Map,this.currentRouteApp=g.b.Unknown;var D=this.createThemeChangeObservable();this.themeConfig=o.parse("themeConfig"),this.initializeUserTheme();var M=this.getStartingTheme();this.themeShades=Object(a.a)(M).pipe(Object(c.a)(D),Object(u.a)(1)),this.darkModeSubscription=Object(l.b)(this.themeShades,this.routeService.getRouteChangeEndObservable()).pipe(Object(d.a)((function(e){var t=Object(r.__read)(e,2),n=t[1];return!("OfficeHome"!==n.currentRoute.route&&"Pwa"!==n.currentRoute.route&&"AppGallery"!==n.currentRoute.route&&"Start"!==n.currentRoute.route&&"Templates"!==n.currentRoute.route&&"Create"!==n.currentRoute.route&&"MyContent"!==n.currentRoute.route&&"SpaceGallery"!==n.currentRoute.route&&"SpaceContent"!==n.currentRoute.route&&"M365Apps"!==n.currentRoute.route&&(!O.isSearchDarkModeEcsConfigEnable||"SearchPersonScoped"!==n.currentRoute.route&&"Search"!==n.currentRoute.route))&&t[0].theme.reactShellTheme.IsDarkMode})));var R=this.eventService.whenEventFired("darkModeAvailable",1).then((function(e){return e.args[0]}));this.setShowSearchDarkMode(R),this.processedInitialPageLoad=!1,this.displayedAppTheme=g.b.Unknown,this.initializeThemeUtilities(),M.userSelected||this.changeAppTheme(M.theme.shades,M.appPage),(i.capabilities.wacStartPageEnabled||i.capabilities.fluidSupportEnabled)&&(this.initializeAppThemeChangeHandler(),this.shellShimService.afterShellRendered.then((function(){var e=O.themeConfig.appPageTypeOnLoad&&g.a.fileTypeNameToFileType(O.themeConfig.appPageTypeOnLoad)||O.currentRouteApp;e!==g.b.Unknown&&O.changeShell(e),O.processedInitialPageLoad=!0})));var x=this.routeService.getRouteChangeEndObservable().pipe(Object(d.a)((function(e){return!(!e.currentRoute||O.capabilitiesService.capabilities.leftNavReact||"OfficeHome"!==e.currentRoute.route&&"Pwa"!==e.currentRoute.route)})),Object(p.a)());x.pipe(Object(h.a)(1)).subscribe((function(e){return Object(r.__awaiter)(O,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.shellShimService.getShellShim()];case 1:return(t=n.sent())&&t.Theme&&t.Theme.SetFullBleedEnabled&&t.Theme.SetFullBleedEnabled(e),[2]}}))}))}));var L=this.themeShades.pipe(Object(p.a)());this._fullBleedTheming=Object(l.b)(L,x).pipe(Object(d.a)((function(e){var t=Object(r.__read)(e,2),n=t[0],i=t[1];return{shouldFullBleed:O.determineFullBleedTheming(n)&&i,bleedColor:O.getNavBarColor(n),bleedFontColor:O.getBleedFontColor(n),themeData:n}}))).pipe(Object(u.a)()).pipe(Object(f.a)({shouldFullBleed:!1,bleedColor:this.getNavBarColor(M),bleedFontColor:this.getBleedFontColor(M),themeData:M})),Object(l.b)(L,this.webPwaService.isStandalone).pipe(Object(m.a)((function(e){return Object(r.__read)(e,2)[1]}))).subscribe((function(e){var t=Object(r.__read)(e,1)[0];O.webPwaService.isOfficeApp()&&O.documentService.updateThemeColor(O.getNavBarColor(t))}))}return Object.defineProperty(e.prototype,"fullBleedTheming",{get:function(){return this._fullBleedTheming},enumerable:!0,configurable:!0}),e.prototype.getEduHeaderImageForWidth=function(e,t){return t>=1366?e[1920]:t>=1024?e[1366]:t>=640?e[1024]:e[640]},e.prototype.createThemeChangeObservable=function(){var t=this;return s.a.create((function(n){t.eventService.events.withScope(0).pipe(Object(m.a)((function(e){return"themeChanged"===e.name&&!!e.args}))).subscribe((function(i){var r=i.args,o=r[0];o.IsDarkMode&&(t.capabilitiesService.capabilities.antpLoaded||t.capabilitiesService.capabilities.isPwaInUwp?o=e.darkTheme:"base"!==o.ThemeId||o.PreferOfficeTheme&&t.capabilitiesService.capabilities.fluentRefresh||(o.Primary=o.Accent));var a=[o.Darker||o.Primary,o.Dark||o.Primary,o.DarkAlt||o.Primary,o.Primary||o.Primary,o.Secondary||o.Primary,o.Tertiary||o.Primary,o.Light||o.Primary,o.Lighter||o.Primary,o.LighterAlt||o.Primary],l=t.showDarkMode();t.ngZone.run((function(){return n.next({theme:{shades:a,reactShellTheme:o,themeType:o.ThemeType,themeId:o.ThemeId,grayscaleThemeShades:l?e.grayscaleThemeShadesDark:e.grayscaleThemeShades},userSelected:r[1]})}))}))}))},e.prototype.getNavBarColor=function(e){var t=e.theme.reactShellTheme;return t?t.NavBar||t.Primary:e.theme.shades[b.c.Primary]},e.prototype.getBleedFontColor=function(e){var t=e.theme.reactShellTheme;return t&&t.DefaultText?t.DefaultText:"#FFFFFF"},e.prototype.determineFullBleedTheming=function(e){return!this.capabilitiesService.capabilities.leftNavReact&&e.theme.reactShellTheme&&null!=e.theme.reactShellTheme.FullBleedImages},e.prototype.changeShell=function(e){this.changeShellAppTheme(e),this.changeShellAppHeader(e),this.changeShellHelpPane(e)},e.prototype.changeShellAppTheme=function(e,t){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a,l;return Object(r.__generator)(this,(function(s){switch(s.label){case 0:return!this.supportedAppThemes.has(e)||e===this.displayedAppTheme&&!t?[2]:(n=this.supportedAppThemes.get(e),(i=this.showDarkMode()&&n.darkTheme||n.theme)?(o=this.getThemeShades(i),e!==this.displayedAppTheme&&this.changeAppTheme(o,e),[4,this.shellShimService.getShellShim()]):[2]);case 1:return a=s.sent(),l=this.capabilitiesService.capabilities.fluentRefresh?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},this.defaultTheme),n.theme),{AppName:n.theme.Primary,Accent:n.theme.Dark}):n.theme,n.darkTheme&&(l.DarkTheme=this.capabilitiesService.capabilities.fluentRefresh?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},this.defaultTheme.DarkTheme),n.darkTheme),{AppName:n.darkTheme.Primary}):n.darkTheme),a.Theme.SetAppBrandTheme(l),this.eventService.broadcastEvent({name:"themeChanged",args:[i,!1]}),this.displayedAppTheme=e,[2]}}))}))},e.prototype.darkMode=function(){var t=e.darkTheme;return{shades:this.getThemeShades(t),reactShellTheme:t,themeType:"App",themeId:e.darkTheme.ThemeId}},e.prototype.changeShellAppHeader=function(e){if(this.supportedAppThemes.has(e)){var t=this.supportedAppThemes.get(e);this.updateShellHeader(t.headerText)}},e.prototype.changeShellHelpPane=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return this.supportedAppThemes.has(e)&&(t=this.supportedAppThemes.get(e)).helpPaneNamespace?[4,this.shellShimService.getShellShim()]:[2];case 1:return n.sent().NFD.UpdateHelpNamespace(t.helpPaneNamespace),[2]}}))}))},e.prototype.resetShellHelpPane=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return e="",e=this.isPWA?this.clientStartupService.config.authType===S.a.OrgId?"IWPWA":"MSAPWA":this.clientStartupService.config.authType===S.a.OrgId?"IWAPP":"IWAPPC",[4,this.shellShimService.getShellShim()];case 1:return t.sent().NFD.UpdateHelpNamespace(e),[2]}}))}))},e.prototype.resetShellTheme=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return this.displayedAppTheme===g.b.Unknown?[2]:(this.clientStartupService.config.authType===S.a.MSA&&this.changeAppTheme(this.userTheme.shades),[4,this.shellShimService.getShellShim()]);case 1:return e.sent().Theme.SetAppBrandTheme(this.defaultTheme),this.eventService.broadcastEvent({name:"themeChanged",args:[this.userTheme.reactShellTheme,!1]}),this.displayedAppTheme=g.b.Unknown,[2]}}))}))},e.prototype.resetShellHeader=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return this.updateShellHeader(this.isPWA&&"Tenant"!==this.userTheme.themeType?"":this.themeConfig.homePageTitle),[2]}))}))},e.prototype.resetShell=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return this.resetShellTheme(),this.resetShellHeader(),this.resetShellHelpPane(),[2]}))}))},e.prototype.initializeThemeUtilities=function(){var e=this;this.themeShadeClassPostfixes.set(b.c.Darker,"tdr"),this.themeShadeClassPostfixes.set(b.c.Dark,"td"),this.themeShadeClassPostfixes.set(b.c.DarkAlt,"tda"),this.themeShadeClassPostfixes.set(b.c.Primary,"tp"),this.themeShadeClassPostfixes.set(b.c.Secondary,"ts"),this.themeShadeClassPostfixes.set(b.c.Tertiary,"tt"),this.themeShadeClassPostfixes.set(b.c.Light,"tl"),this.themeShadeClassPostfixes.set(b.c.Lighter,"tlr"),this.themeShadeClassPostfixes.set(b.c.LighterAlt,"tlra"),this.grayscaleThemeShadeClassPostfixes.set(b.a.White,"w"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLighterAlt,"nla"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLighter,"nlr"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLight,"nl"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralQuaternaryAlt,"g50"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralQuaternary,"g40"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralTertiaryAlt,"nta"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralTertiary,"nt"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralSecondaryAlt,"nsa"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralSecondary,"ns"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralPrimaryAlt,"npa"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralPrimary,"np"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralDark,"nd"),this.grayscaleThemeShadeClassPostfixes.set(b.a.Black,"bl"),this.grayscaleThemeShadeClassPostfixes.set(b.a.WhiteHover,"wh"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLighterAltHover,"nlah"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLighterHover,"nlh"),this.grayscaleThemeShadeClassPostfixes.set(b.a.WhitePressed,"wp"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLighterAltPressed,"nlap"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLighterPressed,"nlp"),this.grayscaleThemeShadeClassPostfixes.set(b.a.WhiteSelected,"ws"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLighterSelected,"nls"),this.grayscaleThemeShadeClassPostfixes.set(b.a.Disabled,"d"),this.themeShades.subscribe((function(t){if(t.userSelected)if(e.userTheme=t.theme,e.currentRouteApp===g.b.Unknown||e.currentRouteApp!==g.b.FluidActivityBlueprint&&e.currentRouteApp!==g.b.Fluid)if(e.currentRouteApp===g.b.Unknown)e.isPWA&&e.updateShellHeader("Tenant"!==e.userTheme.themeType?"":e.themeConfig.homePageTitle),e.changeAppTheme(e.userTheme.shades);else{var n=e.supportedAppThemes.get(e.currentRouteApp),i=e.showDarkMode()&&(null==n?void 0:n.darkTheme)||(null==n?void 0:n.theme),r=i?e.getThemeShades(i):e.userTheme.shades;e.changeAppTheme(r,i?e.currentRouteApp:null)}else e.changeAppTheme(e.userTheme.shades)}))},e.prototype.showDarkMode=function(){return this.capabilitiesService.capabilities.darkModeEnabled&&this.userTheme&&this.userTheme.reactShellTheme&&this.userTheme.reactShellTheme.IsDarkMode&&this.darkModeSupported()},e.prototype.darkModeSupported=function(){var e="Search"===this.currentPage||"SearchPersonScoped"===this.currentPage||"SearchSiteScoped"===this.currentPage;return this.isSearchDarkModeEcsConfigEnable&&e||!e&&(!("Content"===this.currentPage)||!(this.currentRouteApp===g.b.Fluid||this.currentRouteApp===g.b.FluidActivityBlueprint))},e.prototype.setShowSearchDarkMode=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t=this,[4,e];case 1:return t.isSearchDarkModeEcsConfigEnable=n.sent(),[2]}}))}))},e.prototype.initializeAppThemeChangeHandler=function(){var e=this;this.routeService.getRouteChangeStartObservable().pipe(Object(m.a)((function(t){var n;return e.capabilitiesService.capabilities.wacHeaderDisabled||t.currentRoute&&"Content"!==t.currentRoute.route||"Content"===(null===(n=t.currentRoute)||void 0===n?void 0:n.route)&&(t.currentRoute.app===g.b.Fluid||t.currentRoute.app===g.b.FluidActivityBlueprint)}))).subscribe((function(t){e.currentRouteApp=t.currentRoute&&t.currentRoute.app?t.currentRoute.app:g.b.Unknown,e.currentPage=t.currentRoute.route,e.processedInitialPageLoad&&(e.currentRouteApp===g.b.Fluid||e.currentRouteApp===g.b.FluidActivityBlueprint?(e.resetShellTheme(),e.resetShellHeader(),e.changeShellHelpPane(e.currentRouteApp),e.changeAppTheme(e.userTheme.shades)):e.currentRouteApp?e.changeShell(e.currentRouteApp):(e.resetShell(),e.capabilitiesService.capabilities.darkModeEnabled&&e.changeAppTheme(e.userTheme.shades)))}))},e.prototype.initializeUserTheme=function(){var e=this.themeConfig;this.supportedAppThemes.set(g.b.Word,{theme:this.configThemeShadesToTheme(e.wordThemeShades),darkTheme:this.configThemeShadesToTheme(e.wordThemeShadesDark),headerText:this.locService.WordName,helpPaneNamespace:"WDWAENDUSER"}),this.supportedAppThemes.set(g.b.Excel,{theme:this.configThemeShadesToTheme(e.excelThemeShades),darkTheme:this.configThemeShadesToTheme(e.excelThemeShadesDark),headerText:this.locService.ExcelName,helpPaneNamespace:"XLWAENDUSER"}),this.supportedAppThemes.set(g.b.PowerPoint,{theme:this.configThemeShadesToTheme(e.powerpointThemeShades),darkTheme:this.configThemeShadesToTheme(e.powerpointThemeShadesDark),headerText:this.locService.PowerPointName,helpPaneNamespace:"PPWAENDUSER"}),this.supportedAppThemes.set(g.b.Sway,{theme:this.configThemeShadesToTheme(e.swayThemeShades),darkTheme:this.configThemeShadesToTheme(e.swayThemeShadesDark),headerText:this.locService.SwayName,helpPaneNamespace:"STORYIM"}),this.supportedAppThemes.set(g.b.OneNote,{theme:this.configThemeShadesToTheme(e.onenoteThemeShades),darkTheme:this.configThemeShadesToTheme(e.onenoteThemeShadesDark),headerText:this.locService.OneNoteName,helpPaneNamespace:"ONWAENDUSER"}),this.supportedAppThemes.set(g.b.Forms,{theme:this.configThemeShadesToTheme(e.formsThemeShades),darkTheme:this.configThemeShadesToTheme(e.formsThemeShadesDark),headerText:"Forms",helpPaneNamespace:"MICROSOFTFORMS"}),this.supportedAppThemes.set(g.b.Visio,{theme:this.configThemeShadesToTheme(e.visioThemeShades),darkTheme:this.configThemeShadesToTheme(e.visioThemeShadesDark),headerText:this.locService.VisioName,helpPaneNamespace:"VIWAENDUSER"}),this.supportedAppThemes.set(g.b.Stream,{theme:this.configThemeShadesToTheme(e.streamThemeShades),darkTheme:this.configThemeShadesToTheme(e.streamThemeShadesDark),headerText:this.locService.StreamName,helpPaneNamespace:"STREAM"}),this.supportedAppThemes.set(g.b.Fluid,{theme:null,headerText:e.homePageTitle,helpPaneNamespace:"FLUID365"}),this.supportedAppThemes.set(g.b.FluidActivityBlueprint,{theme:null,headerText:e.homePageTitle,helpPaneNamespace:"FLUID365"}),this.userTheme=this.getUserTheme()},e.prototype.configThemeShadesToTheme=function(e){return this.getAppBrandTheme(e.map((function(e){return"#"+e})))},e.prototype.getUserTheme=function(){var e=this.themeConfig;if(this.capabilitiesService.capabilities.antpLoaded){if(this.ntpService.isDarkMode())return this.darkMode()}else if(this.capabilitiesService.capabilities.darkModeEnabled)if(this.capabilitiesService.capabilities.isPwaInUwp){var t=(new Windows.UI.ViewManagement.UISettings).getColorValue(Windows.UI.ViewManagement.UIColorType.background);if(255===t.a&&0===t.b&&0===t.g&&0===t.r)return this.darkMode()}else if(e.isDarkMode||this.capabilitiesService.capabilities.darkModeOverride)return this.darkMode();if(e.preferOfficeTheme){var n,i=this.defaultTheme;return{shades:n=this.getThemeShades(i),reactShellTheme:i,themeType:"App",themeId:this.userContext.user.themeId}}return{shades:n=(this.themeConfig&&this.themeConfig.userThemeShades||[]).map((function(e){return"#"+e})),reactShellTheme:Object(r.__assign)(Object(r.__assign)({},this.defaultTheme),this.getAppBrandTheme(n)),themeType:this.themeConfig.useTenantTheme?"Tenant":"User",themeId:this.userContext.user.themeId}},e.prototype.getStartingTheme=function(){var e=this.themeConfig.appPageTypeOnLoad;if(e){var t=g.a.fileTypeNameToFileType(e);if(this.supportedAppThemes.has(t)){var n=this.supportedAppThemes.get(t),i=this.showDarkMode()&&n.darkTheme||n.theme;if(i){var o=this.getThemeShades(i);return{theme:{shades:o,reactShellTheme:Object(r.__assign)(Object(r.__assign)({},this.defaultTheme),this.getAppBrandTheme(o)),themeType:"App",themeId:this.userContext.user.themeId},userSelected:!1,appPage:t}}}}return{theme:this.userTheme,userSelected:!0}},e.prototype.changeAppTheme=function(t,n){var i=this;if(t&&9===t.length){var r=this.showDarkMode(),o=function(t,n){for(var r="",o=0;o<e.themeProperties.length;o++){var a=e.themeProperties[o],l=a.propName;i.contextService.isRtl&&(l=l.replace(/(left|right)/g,(function(e){return"left"===e?"right":"left"}))),r+="."+b.b+" .ms-"+a.className+"-"+t+"{"+l+":"+n+"}";for(var s=0;s<e.themeSelectorPostfixes.length;s++)r+="."+b.b+" .ms-"+a.className+"-"+t+"-"+e.themeSelectorPostfixes[s]+"{"+l+":"+n+"}"}return r},a=(this.capabilitiesService.capabilities.fluentRefresh?r?e.grayscaleThemeShadesFluentDark:e.grayscaleThemeShadesFluent:r?e.grayscaleThemeShadesDark:e.grayscaleThemeShades).reduce((function(e,t,n){var r=i.grayscaleThemeShadeClassPostfixes.get(n);return""+e+o(r,t)}),""),l=t.reduce((function(e,t,n){var r=i.themeShadeClassPostfixes.get(n);return""+e+o(r,t)}),a);this.documentService.addOrUpdateStyleTag("ohp-app-theme",l),this.clientStartupService.config.authType===S.a.OrgId&&this.changeFluentTheme(r,n)}},e.prototype.brandThemeFromBase=function(e){return{themeDarker:e.Darker,themeDark:e.Dark,themeDarkAlt:e.DarkAlt,themePrimary:e.Primary,themeSecondary:e.Secondary,themeTertiary:e.Tertiary,themeLight:e.Light,themeLighter:e.Lighter,themeLighterAlt:e.LighterAlt}},e.prototype.hasRequiredDarkShades=function(e){var t=null==e?void 0:e.DarkTheme;return!!((null==t?void 0:t.Dark)&&(null==t?void 0:t.DarkAlt)&&(null==t?void 0:t.Primary)&&(null==t?void 0:t.Tertiary)&&(null==t?void 0:t.Light)&&(null==t?void 0:t.Lighter))},e.prototype.changeFluentTheme=function(t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,l,s,c,u=this;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return this.lastFluentTheme=a=""+(i=this.userTheme.themeId)+t+n,l=function(e,n){u.fluentThemeSubject.next({mode:t?o.d.dark:o.d.default,lightBrandColors:u.brandThemeFromBase(e),darkBrandColors:n&&u.brandThemeFromBase(n)})},n&&this.supportedAppThemes.has(n)&&(s=this.supportedAppThemes.get(n)).theme?(l(s.theme,s.darkTheme),[2]):i!==e.baseThemeId&&i!==e.staticDarkTheme||!this.userTheme.reactShellTheme.PreferOfficeTheme&&!t?[4,this.shellShimService.getShellShim()]:(l(c=this.windowService.nativeWindow.commercialDefaultThemeFluent,c.DarkTheme),[2]);case 1:return r.sent().Theme.GetUserThemeJsonByID(i,(function(e){var n;if(a===u.lastFluentTheme)if(!e||t&&!u.hasRequiredDarkShades(e)){if(!e){var r=((n={}).DebugInfo=i,n);u.instrumentationService.logGenericEvent("Unknown_Theme",r)}var o=u.windowService.nativeWindow.commercialDefaultThemeFluent;l(o,o.DarkTheme)}else l(e,e.DarkTheme)})),[2]}}))}))},e.prototype.getAppBrandTheme=function(e){return{Darker:e[0],Dark:e[1],DarkAlt:e[2],Primary:e[3],Secondary:e[4],Tertiary:e[5],Light:e[6],Lighter:e[7],LighterAlt:e[8]}},e.prototype.getThemeShades=function(e){return[e.Darker,e.Dark,e.DarkAlt,e.Primary,e.Secondary,e.Tertiary,e.Light,e.Lighter,e.LighterAlt]},e.prototype.updateShellHeader=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.shellShimService.getShellShim()];case 1:return(t=n.sent())&&t.Header.UpdateHeaderLink(e,null),[2]}}))}))},e.darkTheme={IsDarkMode:!0,ThemeType:"User",ThemeId:e.staticDarkTheme="dark-mode",NavBar:"#1B1A19",Accent:"#F7894A",Dark:"#F7894A",Darker:"#F7894A",DarkAlt:"#F7894A",Primary:"#F7894A",Secondary:"#F7894A",Tertiary:"#F7894A",Light:"#F7894A",Lighter:"#F7894A",LighterAlt:"#F7894A"},e.eduThemeBackplateOverrides={backpack:{"background-color":"rgba(255, 179, 221, 0.9)"},unicorn:{"background-color":"rgba(72, 117, 46, 0.9)",color:"#FFFFFF"}},e.themeProperties=[{className:"fcl",propName:"color"},{className:"bgc",propName:"background-color"},{className:"bcl",propName:"border-color"},{className:"bclt",propName:"border-top-color"},{className:"bclb",propName:"border-bottom-color"},{className:"bclr",propName:"border-right-color"}],e.themeSelectorPostfixes=["f:focus","h:hover","a:active","af:after"],e.grayscaleThemeShades=["#FFFFFF","#FAF9F8","#F3F2F1","#EDEBE9","#E1DFDD","#D2D0CE","#C8C6C4","#A19F9D","#8A8886","#605E5C","#3B3A39","#323130","#252423","#000000","#F3F2F1","#EDEBE9","#E1DFDD","#C8C6C4","#C8C6C4","#C8C6C4","#E1DFDD","#C8C6C4","#EDEBE9"],e.grayscaleThemeShadesDark=["#252423","#1B1A19","#F3F2F1","#323130","#323130","#3B3A39","#484644","#A19F9D","#8A8886","#B3B0AD","#3B3A39","#D2D0CE","#E9E8E8","#FFFFFF","#323130","#323130","#252423","#1B1A19","#1B1A19","#1B1A19","#323130","#252423","#1B1A19"],e.grayscaleThemeShadesFluent=["#FFFFFF","#FAFAFA","#F5F5F5","#F0F0F0","#EBEBEB","#E5E5E5","#E0E0E0","#D1D1D1","#BDBDBD","#707070","#616161","#424242","#242424","#000000","#F5F5F5","#F0F0F0","#EBEBEB","#E0E0E0","#DBDBDB","#D6D6D6","#EBEBEB","#E0E0E0","#F0F0F0"],e.grayscaleThemeShadesFluentDark=["#292929","#1F1F1F","#141414","#3D3D3D","#333333","#2E2E2E","#525252","#525252","#5C5C5C","#999999","#ADADAD","#D6D6D6","#FFFFFF","#FFFFFF","#3D3D3D","#333333","#292929","#1F1F1F","#141414","#0A0A0A","#383838","#242424","#141414"],e.baseThemeId="base",e.ɵprov=R.cc({factory:function(){return new e(R.dc(A.a),R.dc(P.a),R.dc(y.a),R.dc(k.a),R.dc(S.b),R.dc(w.a),R.dc(v.a),R.dc(I.a),R.dc(_.a),R.dc(O.a),R.dc(C.a),R.dc(M.b),R.dc(R.z),R.dc(F.a),R.dc(D.a),R.dc(E.a))},token:e,providedIn:"root"}),e}()},wwmn:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("officeHomeApiConfig")||{authTypeHeader:null,authVersionHeader:null,correlationIdHeader:null,defaultTimeoutInMs:3e5,externalTrafficHeader:null,featureOverrides:null,featureOverridesParamName:null,flightOverrides:null,flightOverridesParamName:null,jwtAuthEnabled:!1,jwtAuthOnOfficeHome:!1,mockRequestHeader:null,tenantIdHeader:null,testTrafficHeader:null,userIdHeader:null,workloadQueryParameter:null}}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},"x+6c":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},xIlw:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},xJIt:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("bb6g"),r=(n("cj6A"),function(e){function t(t){var n=e.call(this,(function(){return n.preloadService.preload(n.preloadPath)}))||this;return n.preloadService=t,n}return Object(i.__extends)(t,e),t.prototype.enabled=function(){return!!this.preloadPath},t}(n("adME").a))},xSeq:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(e,t){this.elementRef=e,this.changeDetectorRef=t}return e.prototype.ngAfterViewInit=function(){this.focusOnLoad&&(this.elementRef.nativeElement.focus(),this.detectChanges&&this.changeDetectorRef.detectChanges())},e}()},xaJZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=new(n("keVe").q)("SERVICE_WORKER_ENABLED")},xoWf:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},xv22:function(e,t,n){},"y3b+":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("installConfig")||{consumerDirectInstallUrl:"",consumerInstallLink:"",commercialMySoftwarePageUrl:"",dimeEnabled:!1,dimeJSUrl:"",dimeTimeoutMs:5e3,goPremiumUrl:"",goPremiumUrlPremiumTemplates:"",installApiRoot:"",installApiSWEnabled:!1,pwaInstallMoveEnabled:!1,resources:null,sendRequestId:!1,shellGoPremiumUrl:"",wizardImageAssets:"",wizardSupportLink:"",buyOffice365Url:"",haveOfficeProductKeyUrl:"",needHelpInstallingOfficeUrl:"",ecsInstallNoLicenseOptionsEnabled:!1}}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},y9oG:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("bb6g"),r=n("BaAg");function o(e,t,n){var o;return void 0===n&&(n={}),Object(i.__assign)(((o={}).ResourceId=e,o.WacHostEntry=t.wdOrigin,o.FileFormat=r.a.fileTypeNameFromType(t.fileType),o),n)}},z0B0:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("AGMK");function r(e){var t=function(){return e(Object(i.b)())};return document.addEventListener("visibilitychange",t),t}},zGJG:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var i=".",r="1.0.0"},zPZ9:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=new Promise((function(e){return i=e}));function o(e){i(e)}},zwsB:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("formsConfig")||{defaultImagesAvailable:null,defaultThumbnailColor:null,formsApiPath:null,formsCdnPath:null,formsMsaTenantId:null,formsThemingConfigUrl:null,formsThumbnailImagesUrl:null,neoPortalPageEnabled:!1,groupPhotoRequestInBatch:!1,termsOfServiceLinkOrgId:null}}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()}});
//# sourceMappingURL=app-bundle-9d0262a19a5d2191ca50.js.map